var lN=Object.defineProperty;var cN=(r,e,t)=>e in r?lN(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var ad=(r,e,t)=>cN(r,typeof e!="symbol"?e+"":e,t);function uN(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in r)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(r,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function PA(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var RA={exports:{}},hg={},OA={exports:{}},we={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mh=Symbol.for("react.element"),hN=Symbol.for("react.portal"),dN=Symbol.for("react.fragment"),fN=Symbol.for("react.strict_mode"),pN=Symbol.for("react.profiler"),gN=Symbol.for("react.provider"),mN=Symbol.for("react.context"),yN=Symbol.for("react.forward_ref"),vN=Symbol.for("react.suspense"),_N=Symbol.for("react.memo"),wN=Symbol.for("react.lazy"),DC=Symbol.iterator;function SN(r){return r===null||typeof r!="object"?null:(r=DC&&r[DC]||r["@@iterator"],typeof r=="function"?r:null)}var DA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},MA=Object.assign,NA={};function Gl(r,e,t){this.props=r,this.context=e,this.refs=NA,this.updater=t||DA}Gl.prototype.isReactComponent={};Gl.prototype.setState=function(r,e){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,e,"setState")};Gl.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function FA(){}FA.prototype=Gl.prototype;function U_(r,e,t){this.props=r,this.context=e,this.refs=NA,this.updater=t||DA}var B_=U_.prototype=new FA;B_.constructor=U_;MA(B_,Gl.prototype);B_.isPureReactComponent=!0;var MC=Array.isArray,LA=Object.prototype.hasOwnProperty,z_={current:null},VA={key:!0,ref:!0,__self:!0,__source:!0};function jA(r,e,t){var n,s={},i=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)LA.call(e,n)&&!VA.hasOwnProperty(n)&&(s[n]=e[n]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(r&&r.defaultProps)for(n in a=r.defaultProps,a)s[n]===void 0&&(s[n]=a[n]);return{$$typeof:mh,type:r,key:i,ref:o,props:s,_owner:z_.current}}function TN(r,e){return{$$typeof:mh,type:r.type,key:e,ref:r.ref,props:r.props,_owner:r._owner}}function W_(r){return typeof r=="object"&&r!==null&&r.$$typeof===mh}function CN(r){var e={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(t){return e[t]})}var NC=/\/+/g;function _y(r,e){return typeof r=="object"&&r!==null&&r.key!=null?CN(""+r.key):e.toString(36)}function hf(r,e,t,n,s){var i=typeof r;(i==="undefined"||i==="boolean")&&(r=null);var o=!1;if(r===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(r.$$typeof){case mh:case hN:o=!0}}if(o)return o=r,s=s(o),r=n===""?"."+_y(o,0):n,MC(s)?(t="",r!=null&&(t=r.replace(NC,"$&/")+"/"),hf(s,e,t,"",function(c){return c})):s!=null&&(W_(s)&&(s=TN(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(NC,"$&/")+"/")+r)),e.push(s)),1;if(o=0,n=n===""?".":n+":",MC(r))for(var a=0;a<r.length;a++){i=r[a];var l=n+_y(i,a);o+=hf(i,e,t,l,s)}else if(l=SN(r),typeof l=="function")for(r=l.call(r),a=0;!(i=r.next()).done;)i=i.value,l=n+_y(i,a++),o+=hf(i,e,t,l,s);else if(i==="object")throw e=String(r),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ld(r,e,t){if(r==null)return r;var n=[],s=0;return hf(r,n,"","",function(i){return e.call(t,i,s++)}),n}function EN(r){if(r._status===-1){var e=r._result;e=e(),e.then(function(t){(r._status===0||r._status===-1)&&(r._status=1,r._result=t)},function(t){(r._status===0||r._status===-1)&&(r._status=2,r._result=t)}),r._status===-1&&(r._status=0,r._result=e)}if(r._status===1)return r._result.default;throw r._result}var wr={current:null},df={transition:null},xN={ReactCurrentDispatcher:wr,ReactCurrentBatchConfig:df,ReactCurrentOwner:z_};function $A(){throw Error("act(...) is not supported in production builds of React.")}we.Children={map:ld,forEach:function(r,e,t){ld(r,function(){e.apply(this,arguments)},t)},count:function(r){var e=0;return ld(r,function(){e++}),e},toArray:function(r){return ld(r,function(e){return e})||[]},only:function(r){if(!W_(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};we.Component=Gl;we.Fragment=dN;we.Profiler=pN;we.PureComponent=U_;we.StrictMode=fN;we.Suspense=vN;we.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xN;we.act=$A;we.cloneElement=function(r,e,t){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var n=MA({},r.props),s=r.key,i=r.ref,o=r._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=z_.current),e.key!==void 0&&(s=""+e.key),r.type&&r.type.defaultProps)var a=r.type.defaultProps;for(l in e)LA.call(e,l)&&!VA.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];n.children=a}return{$$typeof:mh,type:r.type,key:s,ref:i,props:n,_owner:o}};we.createContext=function(r){return r={$$typeof:mN,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:gN,_context:r},r.Consumer=r};we.createElement=jA;we.createFactory=function(r){var e=jA.bind(null,r);return e.type=r,e};we.createRef=function(){return{current:null}};we.forwardRef=function(r){return{$$typeof:yN,render:r}};we.isValidElement=W_;we.lazy=function(r){return{$$typeof:wN,_payload:{_status:-1,_result:r},_init:EN}};we.memo=function(r,e){return{$$typeof:_N,type:r,compare:e===void 0?null:e}};we.startTransition=function(r){var e=df.transition;df.transition={};try{r()}finally{df.transition=e}};we.unstable_act=$A;we.useCallback=function(r,e){return wr.current.useCallback(r,e)};we.useContext=function(r){return wr.current.useContext(r)};we.useDebugValue=function(){};we.useDeferredValue=function(r){return wr.current.useDeferredValue(r)};we.useEffect=function(r,e){return wr.current.useEffect(r,e)};we.useId=function(){return wr.current.useId()};we.useImperativeHandle=function(r,e,t){return wr.current.useImperativeHandle(r,e,t)};we.useInsertionEffect=function(r,e){return wr.current.useInsertionEffect(r,e)};we.useLayoutEffect=function(r,e){return wr.current.useLayoutEffect(r,e)};we.useMemo=function(r,e){return wr.current.useMemo(r,e)};we.useReducer=function(r,e,t){return wr.current.useReducer(r,e,t)};we.useRef=function(r){return wr.current.useRef(r)};we.useState=function(r){return wr.current.useState(r)};we.useSyncExternalStore=function(r,e,t){return wr.current.useSyncExternalStore(r,e,t)};we.useTransition=function(){return wr.current.useTransition()};we.version="18.3.1";OA.exports=we;var L=OA.exports;const nr=PA(L),FC=uN({__proto__:null,default:nr},[L]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bN=L,AN=Symbol.for("react.element"),kN=Symbol.for("react.fragment"),IN=Object.prototype.hasOwnProperty,PN=bN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RN={key:!0,ref:!0,__self:!0,__source:!0};function UA(r,e,t){var n,s={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)IN.call(e,n)&&!RN.hasOwnProperty(n)&&(s[n]=e[n]);if(r&&r.defaultProps)for(n in e=r.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:AN,type:r,key:i,ref:o,props:s,_owner:PN.current}}hg.Fragment=kN;hg.jsx=UA;hg.jsxs=UA;RA.exports=hg;var D=RA.exports,BA={exports:{}},Jr={},zA={exports:{}},WA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function e(Y,ce){var he=Y.length;Y.push(ce);e:for(;0<he;){var Ie=he-1>>>1,xe=Y[Ie];if(0<s(xe,ce))Y[Ie]=ce,Y[he]=xe,he=Ie;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var ce=Y[0],he=Y.pop();if(he!==ce){Y[0]=he;e:for(var Ie=0,xe=Y.length,De=xe>>>1;Ie<De;){var vt=2*(Ie+1)-1,jt=Y[vt],At=vt+1,kt=Y[At];if(0>s(jt,he))At<xe&&0>s(kt,jt)?(Y[Ie]=kt,Y[At]=he,Ie=At):(Y[Ie]=jt,Y[vt]=he,Ie=vt);else if(At<xe&&0>s(kt,he))Y[Ie]=kt,Y[At]=he,Ie=At;else break e}}return ce}function s(Y,ce){var he=Y.sortIndex-ce.sortIndex;return he!==0?he:Y.id-ce.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;r.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();r.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,d=null,f=3,p=!1,m=!1,v=!1,T=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(Y){for(var ce=t(c);ce!==null;){if(ce.callback===null)n(c);else if(ce.startTime<=Y)n(c),ce.sortIndex=ce.expirationTime,e(l,ce);else break;ce=t(c)}}function k(Y){if(v=!1,C(Y),!m)if(t(l)!==null)m=!0,ue(O);else{var ce=t(c);ce!==null&&ge(k,ce.startTime-Y)}}function O(Y,ce){m=!1,v&&(v=!1,w(E),E=-1),p=!0;var he=f;try{for(C(ce),d=t(l);d!==null&&(!(d.expirationTime>ce)||Y&&!R());){var Ie=d.callback;if(typeof Ie=="function"){d.callback=null,f=d.priorityLevel;var xe=Ie(d.expirationTime<=ce);ce=r.unstable_now(),typeof xe=="function"?d.callback=xe:d===t(l)&&n(l),C(ce)}else n(l);d=t(l)}if(d!==null)var De=!0;else{var vt=t(c);vt!==null&&ge(k,vt.startTime-ce),De=!1}return De}finally{d=null,f=he,p=!1}}var M=!1,x=null,E=-1,A=5,P=-1;function R(){return!(r.unstable_now()-P<A)}function _(){if(x!==null){var Y=r.unstable_now();P=Y;var ce=!0;try{ce=x(!0,Y)}finally{ce?b():(M=!1,x=null)}}else M=!1}var b;if(typeof y=="function")b=function(){y(_)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,te=B.port2;B.port1.onmessage=_,b=function(){te.postMessage(null)}}else b=function(){T(_,0)};function ue(Y){x=Y,M||(M=!0,b())}function ge(Y,ce){E=T(function(){Y(r.unstable_now())},ce)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Y){Y.callback=null},r.unstable_continueExecution=function(){m||p||(m=!0,ue(O))},r.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<Y?Math.floor(1e3/Y):5},r.unstable_getCurrentPriorityLevel=function(){return f},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(Y){switch(f){case 1:case 2:case 3:var ce=3;break;default:ce=f}var he=f;f=ce;try{return Y()}finally{f=he}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Y,ce){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var he=f;f=Y;try{return ce()}finally{f=he}},r.unstable_scheduleCallback=function(Y,ce,he){var Ie=r.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?Ie+he:Ie):he=Ie,Y){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=he+xe,Y={id:u++,callback:ce,priorityLevel:Y,startTime:he,expirationTime:xe,sortIndex:-1},he>Ie?(Y.sortIndex=he,e(c,Y),t(l)===null&&Y===t(c)&&(v?(w(E),E=-1):v=!0,ge(k,he-Ie))):(Y.sortIndex=xe,e(l,Y),m||p||(m=!0,ue(O))),Y},r.unstable_shouldYield=R,r.unstable_wrapCallback=function(Y){var ce=f;return function(){var he=f;f=ce;try{return Y.apply(this,arguments)}finally{f=he}}}})(WA);zA.exports=WA;var ON=zA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DN=L,Xr=ON;function X(r){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+r,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+r+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var HA=new Set,Au={};function ua(r,e){Pl(r,e),Pl(r+"Capture",e)}function Pl(r,e){for(Au[r]=e,r=0;r<e.length;r++)HA.add(e[r])}var qs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lv=Object.prototype.hasOwnProperty,MN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,LC={},VC={};function NN(r){return Lv.call(VC,r)?!0:Lv.call(LC,r)?!1:MN.test(r)?VC[r]=!0:(LC[r]=!0,!1)}function FN(r,e,t,n){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:t!==null?!t.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function LN(r,e,t,n){if(e===null||typeof e>"u"||FN(r,e,t,n))return!0;if(n)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Sr(r,e,t,n,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=r,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){Xt[r]=new Sr(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var e=r[0];Xt[e]=new Sr(e,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){Xt[r]=new Sr(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){Xt[r]=new Sr(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){Xt[r]=new Sr(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){Xt[r]=new Sr(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){Xt[r]=new Sr(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){Xt[r]=new Sr(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){Xt[r]=new Sr(r,5,!1,r.toLowerCase(),null,!1,!1)});var H_=/[\-:]([a-z])/g;function G_(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var e=r.replace(H_,G_);Xt[e]=new Sr(e,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var e=r.replace(H_,G_);Xt[e]=new Sr(e,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var e=r.replace(H_,G_);Xt[e]=new Sr(e,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){Xt[r]=new Sr(r,1,!1,r.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new Sr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){Xt[r]=new Sr(r,1,!1,r.toLowerCase(),null,!0,!0)});function q_(r,e,t,n){var s=Xt.hasOwnProperty(e)?Xt[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(LN(e,t,s,n)&&(t=null),n||s===null?NN(e)&&(t===null?r.removeAttribute(e):r.setAttribute(e,""+t)):s.mustUseProperty?r[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,n=s.attributeNamespace,t===null?r.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,n?r.setAttributeNS(n,e,t):r.setAttribute(e,t))))}var li=DN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cd=Symbol.for("react.element"),Ka=Symbol.for("react.portal"),Qa=Symbol.for("react.fragment"),Y_=Symbol.for("react.strict_mode"),Vv=Symbol.for("react.profiler"),GA=Symbol.for("react.provider"),qA=Symbol.for("react.context"),X_=Symbol.for("react.forward_ref"),jv=Symbol.for("react.suspense"),$v=Symbol.for("react.suspense_list"),K_=Symbol.for("react.memo"),vi=Symbol.for("react.lazy"),YA=Symbol.for("react.offscreen"),jC=Symbol.iterator;function kc(r){return r===null||typeof r!="object"?null:(r=jC&&r[jC]||r["@@iterator"],typeof r=="function"?r:null)}var st=Object.assign,wy;function zc(r){if(wy===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);wy=e&&e[1]||""}return`
`+wy+r}var Sy=!1;function Ty(r,e){if(!r||Sy)return"";Sy=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var n=c}Reflect.construct(r,[],e)}else{try{e.call()}catch(c){n=c}r.call(e.prototype)}else{try{throw Error()}catch(c){n=c}r()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return r.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",r.displayName)),l}while(1<=o&&0<=a);break}}}finally{Sy=!1,Error.prepareStackTrace=t}return(r=r?r.displayName||r.name:"")?zc(r):""}function VN(r){switch(r.tag){case 5:return zc(r.type);case 16:return zc("Lazy");case 13:return zc("Suspense");case 19:return zc("SuspenseList");case 0:case 2:case 15:return r=Ty(r.type,!1),r;case 11:return r=Ty(r.type.render,!1),r;case 1:return r=Ty(r.type,!0),r;default:return""}}function Uv(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case Qa:return"Fragment";case Ka:return"Portal";case Vv:return"Profiler";case Y_:return"StrictMode";case jv:return"Suspense";case $v:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case qA:return(r.displayName||"Context")+".Consumer";case GA:return(r._context.displayName||"Context")+".Provider";case X_:var e=r.render;return r=r.displayName,r||(r=e.displayName||e.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case K_:return e=r.displayName||null,e!==null?e:Uv(r.type)||"Memo";case vi:e=r._payload,r=r._init;try{return Uv(r(e))}catch{}}return null}function jN(r){var e=r.type;switch(r.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=e.render,r=r.displayName||r.name||"",e.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Uv(e);case 8:return e===Y_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hi(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function XA(r){var e=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $N(r){var e=XA(r)?"checked":"value",t=Object.getOwnPropertyDescriptor(r.constructor.prototype,e),n=""+r[e];if(!r.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(r,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(r,e,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){r._valueTracker=null,delete r[e]}}}}function ud(r){r._valueTracker||(r._valueTracker=$N(r))}function KA(r){if(!r)return!1;var e=r._valueTracker;if(!e)return!0;var t=e.getValue(),n="";return r&&(n=XA(r)?r.checked?"true":"false":r.value),r=n,r!==t?(e.setValue(r),!0):!1}function Jf(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Bv(r,e){var t=e.checked;return st({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??r._wrapperState.initialChecked})}function $C(r,e){var t=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;t=Hi(e.value!=null?e.value:t),r._wrapperState={initialChecked:n,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function QA(r,e){e=e.checked,e!=null&&q_(r,"checked",e,!1)}function zv(r,e){QA(r,e);var t=Hi(e.value),n=e.type;if(t!=null)n==="number"?(t===0&&r.value===""||r.value!=t)&&(r.value=""+t):r.value!==""+t&&(r.value=""+t);else if(n==="submit"||n==="reset"){r.removeAttribute("value");return}e.hasOwnProperty("value")?Wv(r,e.type,t):e.hasOwnProperty("defaultValue")&&Wv(r,e.type,Hi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(r.defaultChecked=!!e.defaultChecked)}function UC(r,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+r._wrapperState.initialValue,t||e===r.value||(r.value=e),r.defaultValue=e}t=r.name,t!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,t!==""&&(r.name=t)}function Wv(r,e,t){(e!=="number"||Jf(r.ownerDocument)!==r)&&(t==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+t&&(r.defaultValue=""+t))}var Wc=Array.isArray;function dl(r,e,t,n){if(r=r.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<r.length;t++)s=e.hasOwnProperty("$"+r[t].value),r[t].selected!==s&&(r[t].selected=s),s&&n&&(r[t].defaultSelected=!0)}else{for(t=""+Hi(t),e=null,s=0;s<r.length;s++){if(r[s].value===t){r[s].selected=!0,n&&(r[s].defaultSelected=!0);return}e!==null||r[s].disabled||(e=r[s])}e!==null&&(e.selected=!0)}}function Hv(r,e){if(e.dangerouslySetInnerHTML!=null)throw Error(X(91));return st({},e,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function BC(r,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(X(92));if(Wc(t)){if(1<t.length)throw Error(X(93));t=t[0]}e=t}e==null&&(e=""),t=e}r._wrapperState={initialValue:Hi(t)}}function JA(r,e){var t=Hi(e.value),n=Hi(e.defaultValue);t!=null&&(t=""+t,t!==r.value&&(r.value=t),e.defaultValue==null&&r.defaultValue!==t&&(r.defaultValue=t)),n!=null&&(r.defaultValue=""+n)}function zC(r){var e=r.textContent;e===r._wrapperState.initialValue&&e!==""&&e!==null&&(r.value=e)}function ZA(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gv(r,e){return r==null||r==="http://www.w3.org/1999/xhtml"?ZA(e):r==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var hd,ek=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,n,s){MSApp.execUnsafeLocalFunction(function(){return r(e,t,n,s)})}:r}(function(r,e){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=e;else{for(hd=hd||document.createElement("div"),hd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hd.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;e.firstChild;)r.appendChild(e.firstChild)}});function ku(r,e){if(e){var t=r.firstChild;if(t&&t===r.lastChild&&t.nodeType===3){t.nodeValue=e;return}}r.textContent=e}var su={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UN=["Webkit","ms","Moz","O"];Object.keys(su).forEach(function(r){UN.forEach(function(e){e=e+r.charAt(0).toUpperCase()+r.substring(1),su[e]=su[r]})});function tk(r,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||su.hasOwnProperty(r)&&su[r]?(""+e).trim():e+"px"}function rk(r,e){r=r.style;for(var t in e)if(e.hasOwnProperty(t)){var n=t.indexOf("--")===0,s=tk(t,e[t],n);t==="float"&&(t="cssFloat"),n?r.setProperty(t,s):r[t]=s}}var BN=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qv(r,e){if(e){if(BN[r]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(X(137,r));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(X(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(X(61))}if(e.style!=null&&typeof e.style!="object")throw Error(X(62))}}function Yv(r,e){if(r.indexOf("-")===-1)return typeof e.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xv=null;function Q_(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Kv=null,fl=null,pl=null;function WC(r){if(r=_h(r)){if(typeof Kv!="function")throw Error(X(280));var e=r.stateNode;e&&(e=mg(e),Kv(r.stateNode,r.type,e))}}function nk(r){fl?pl?pl.push(r):pl=[r]:fl=r}function sk(){if(fl){var r=fl,e=pl;if(pl=fl=null,WC(r),e)for(r=0;r<e.length;r++)WC(e[r])}}function ik(r,e){return r(e)}function ok(){}var Cy=!1;function ak(r,e,t){if(Cy)return r(e,t);Cy=!0;try{return ik(r,e,t)}finally{Cy=!1,(fl!==null||pl!==null)&&(ok(),sk())}}function Iu(r,e){var t=r.stateNode;if(t===null)return null;var n=mg(t);if(n===null)return null;t=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(r=r.type,n=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!n;break e;default:r=!1}if(r)return null;if(t&&typeof t!="function")throw Error(X(231,e,typeof t));return t}var Qv=!1;if(qs)try{var Ic={};Object.defineProperty(Ic,"passive",{get:function(){Qv=!0}}),window.addEventListener("test",Ic,Ic),window.removeEventListener("test",Ic,Ic)}catch{Qv=!1}function zN(r,e,t,n,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var iu=!1,Zf=null,ep=!1,Jv=null,WN={onError:function(r){iu=!0,Zf=r}};function HN(r,e,t,n,s,i,o,a,l){iu=!1,Zf=null,zN.apply(WN,arguments)}function GN(r,e,t,n,s,i,o,a,l){if(HN.apply(this,arguments),iu){if(iu){var c=Zf;iu=!1,Zf=null}else throw Error(X(198));ep||(ep=!0,Jv=c)}}function ha(r){var e=r,t=r;if(r.alternate)for(;e.return;)e=e.return;else{r=e;do e=r,e.flags&4098&&(t=e.return),r=e.return;while(r)}return e.tag===3?t:null}function lk(r){if(r.tag===13){var e=r.memoizedState;if(e===null&&(r=r.alternate,r!==null&&(e=r.memoizedState)),e!==null)return e.dehydrated}return null}function HC(r){if(ha(r)!==r)throw Error(X(188))}function qN(r){var e=r.alternate;if(!e){if(e=ha(r),e===null)throw Error(X(188));return e!==r?null:r}for(var t=r,n=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){t=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return HC(s),r;if(i===n)return HC(s),e;i=i.sibling}throw Error(X(188))}if(t.return!==n.return)t=s,n=i;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,n=i;break}if(a===n){o=!0,n=s,t=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===t){o=!0,t=i,n=s;break}if(a===n){o=!0,n=i,t=s;break}a=a.sibling}if(!o)throw Error(X(189))}}if(t.alternate!==n)throw Error(X(190))}if(t.tag!==3)throw Error(X(188));return t.stateNode.current===t?r:e}function ck(r){return r=qN(r),r!==null?uk(r):null}function uk(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var e=uk(r);if(e!==null)return e;r=r.sibling}return null}var hk=Xr.unstable_scheduleCallback,GC=Xr.unstable_cancelCallback,YN=Xr.unstable_shouldYield,XN=Xr.unstable_requestPaint,ft=Xr.unstable_now,KN=Xr.unstable_getCurrentPriorityLevel,J_=Xr.unstable_ImmediatePriority,dk=Xr.unstable_UserBlockingPriority,tp=Xr.unstable_NormalPriority,QN=Xr.unstable_LowPriority,fk=Xr.unstable_IdlePriority,dg=null,is=null;function JN(r){if(is&&typeof is.onCommitFiberRoot=="function")try{is.onCommitFiberRoot(dg,r,void 0,(r.current.flags&128)===128)}catch{}}var Fn=Math.clz32?Math.clz32:tF,ZN=Math.log,eF=Math.LN2;function tF(r){return r>>>=0,r===0?32:31-(ZN(r)/eF|0)|0}var dd=64,fd=4194304;function Hc(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function rp(r,e){var t=r.pendingLanes;if(t===0)return 0;var n=0,s=r.suspendedLanes,i=r.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?n=Hc(a):(i&=o,i!==0&&(n=Hc(i)))}else o=t&~s,o!==0?n=Hc(o):i!==0&&(n=Hc(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=t&16),e=r.entangledLanes,e!==0)for(r=r.entanglements,e&=n;0<e;)t=31-Fn(e),s=1<<t,n|=r[t],e&=~s;return n}function rF(r,e){switch(r){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nF(r,e){for(var t=r.suspendedLanes,n=r.pingedLanes,s=r.expirationTimes,i=r.pendingLanes;0<i;){var o=31-Fn(i),a=1<<o,l=s[o];l===-1?(!(a&t)||a&n)&&(s[o]=rF(a,e)):l<=e&&(r.expiredLanes|=a),i&=~a}}function Zv(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function pk(){var r=dd;return dd<<=1,!(dd&4194240)&&(dd=64),r}function Ey(r){for(var e=[],t=0;31>t;t++)e.push(r);return e}function yh(r,e,t){r.pendingLanes|=e,e!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,e=31-Fn(e),r[e]=t}function sF(r,e){var t=r.pendingLanes&~e;r.pendingLanes=e,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=e,r.mutableReadLanes&=e,r.entangledLanes&=e,e=r.entanglements;var n=r.eventTimes;for(r=r.expirationTimes;0<t;){var s=31-Fn(t),i=1<<s;e[s]=0,n[s]=-1,r[s]=-1,t&=~i}}function Z_(r,e){var t=r.entangledLanes|=e;for(r=r.entanglements;t;){var n=31-Fn(t),s=1<<n;s&e|r[n]&e&&(r[n]|=e),t&=~s}}var je=0;function gk(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var mk,ew,yk,vk,_k,e0=!1,pd=[],Oi=null,Di=null,Mi=null,Pu=new Map,Ru=new Map,wi=[],iF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qC(r,e){switch(r){case"focusin":case"focusout":Oi=null;break;case"dragenter":case"dragleave":Di=null;break;case"mouseover":case"mouseout":Mi=null;break;case"pointerover":case"pointerout":Pu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ru.delete(e.pointerId)}}function Pc(r,e,t,n,s,i){return r===null||r.nativeEvent!==i?(r={blockedOn:e,domEventName:t,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=_h(e),e!==null&&ew(e)),r):(r.eventSystemFlags|=n,e=r.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),r)}function oF(r,e,t,n,s){switch(e){case"focusin":return Oi=Pc(Oi,r,e,t,n,s),!0;case"dragenter":return Di=Pc(Di,r,e,t,n,s),!0;case"mouseover":return Mi=Pc(Mi,r,e,t,n,s),!0;case"pointerover":var i=s.pointerId;return Pu.set(i,Pc(Pu.get(i)||null,r,e,t,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Ru.set(i,Pc(Ru.get(i)||null,r,e,t,n,s)),!0}return!1}function wk(r){var e=Ro(r.target);if(e!==null){var t=ha(e);if(t!==null){if(e=t.tag,e===13){if(e=lk(t),e!==null){r.blockedOn=e,_k(r.priority,function(){yk(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){r.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}r.blockedOn=null}function ff(r){if(r.blockedOn!==null)return!1;for(var e=r.targetContainers;0<e.length;){var t=t0(r.domEventName,r.eventSystemFlags,e[0],r.nativeEvent);if(t===null){t=r.nativeEvent;var n=new t.constructor(t.type,t);Xv=n,t.target.dispatchEvent(n),Xv=null}else return e=_h(t),e!==null&&ew(e),r.blockedOn=t,!1;e.shift()}return!0}function YC(r,e,t){ff(r)&&t.delete(e)}function aF(){e0=!1,Oi!==null&&ff(Oi)&&(Oi=null),Di!==null&&ff(Di)&&(Di=null),Mi!==null&&ff(Mi)&&(Mi=null),Pu.forEach(YC),Ru.forEach(YC)}function Rc(r,e){r.blockedOn===e&&(r.blockedOn=null,e0||(e0=!0,Xr.unstable_scheduleCallback(Xr.unstable_NormalPriority,aF)))}function Ou(r){function e(s){return Rc(s,r)}if(0<pd.length){Rc(pd[0],r);for(var t=1;t<pd.length;t++){var n=pd[t];n.blockedOn===r&&(n.blockedOn=null)}}for(Oi!==null&&Rc(Oi,r),Di!==null&&Rc(Di,r),Mi!==null&&Rc(Mi,r),Pu.forEach(e),Ru.forEach(e),t=0;t<wi.length;t++)n=wi[t],n.blockedOn===r&&(n.blockedOn=null);for(;0<wi.length&&(t=wi[0],t.blockedOn===null);)wk(t),t.blockedOn===null&&wi.shift()}var gl=li.ReactCurrentBatchConfig,np=!0;function lF(r,e,t,n){var s=je,i=gl.transition;gl.transition=null;try{je=1,tw(r,e,t,n)}finally{je=s,gl.transition=i}}function cF(r,e,t,n){var s=je,i=gl.transition;gl.transition=null;try{je=4,tw(r,e,t,n)}finally{je=s,gl.transition=i}}function tw(r,e,t,n){if(np){var s=t0(r,e,t,n);if(s===null)My(r,e,n,sp,t),qC(r,n);else if(oF(s,r,e,t,n))n.stopPropagation();else if(qC(r,n),e&4&&-1<iF.indexOf(r)){for(;s!==null;){var i=_h(s);if(i!==null&&mk(i),i=t0(r,e,t,n),i===null&&My(r,e,n,sp,t),i===s)break;s=i}s!==null&&n.stopPropagation()}else My(r,e,n,null,t)}}var sp=null;function t0(r,e,t,n){if(sp=null,r=Q_(n),r=Ro(r),r!==null)if(e=ha(r),e===null)r=null;else if(t=e.tag,t===13){if(r=lk(e),r!==null)return r;r=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;r=null}else e!==r&&(r=null);return sp=r,null}function Sk(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(KN()){case J_:return 1;case dk:return 4;case tp:case QN:return 16;case fk:return 536870912;default:return 16}default:return 16}}var Ii=null,rw=null,pf=null;function Tk(){if(pf)return pf;var r,e=rw,t=e.length,n,s="value"in Ii?Ii.value:Ii.textContent,i=s.length;for(r=0;r<t&&e[r]===s[r];r++);var o=t-r;for(n=1;n<=o&&e[t-n]===s[i-n];n++);return pf=s.slice(r,1<n?1-n:void 0)}function gf(r){var e=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&e===13&&(r=13)):r=e,r===10&&(r=13),32<=r||r===13?r:0}function gd(){return!0}function XC(){return!1}function Zr(r){function e(t,n,s,i,o){this._reactName=t,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in r)r.hasOwnProperty(a)&&(t=r[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?gd:XC,this.isPropagationStopped=XC,this}return st(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=gd)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=gd)},persist:function(){},isPersistent:gd}),e}var ql={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nw=Zr(ql),vh=st({},ql,{view:0,detail:0}),uF=Zr(vh),xy,by,Oc,fg=st({},vh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:sw,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Oc&&(Oc&&r.type==="mousemove"?(xy=r.screenX-Oc.screenX,by=r.screenY-Oc.screenY):by=xy=0,Oc=r),xy)},movementY:function(r){return"movementY"in r?r.movementY:by}}),KC=Zr(fg),hF=st({},fg,{dataTransfer:0}),dF=Zr(hF),fF=st({},vh,{relatedTarget:0}),Ay=Zr(fF),pF=st({},ql,{animationName:0,elapsedTime:0,pseudoElement:0}),gF=Zr(pF),mF=st({},ql,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),yF=Zr(mF),vF=st({},ql,{data:0}),QC=Zr(vF),_F={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TF(r){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(r):(r=SF[r])?!!e[r]:!1}function sw(){return TF}var CF=st({},vh,{key:function(r){if(r.key){var e=_F[r.key]||r.key;if(e!=="Unidentified")return e}return r.type==="keypress"?(r=gf(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?wF[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:sw,charCode:function(r){return r.type==="keypress"?gf(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?gf(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),EF=Zr(CF),xF=st({},fg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),JC=Zr(xF),bF=st({},vh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:sw}),AF=Zr(bF),kF=st({},ql,{propertyName:0,elapsedTime:0,pseudoElement:0}),IF=Zr(kF),PF=st({},fg,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),RF=Zr(PF),OF=[9,13,27,32],iw=qs&&"CompositionEvent"in window,ou=null;qs&&"documentMode"in document&&(ou=document.documentMode);var DF=qs&&"TextEvent"in window&&!ou,Ck=qs&&(!iw||ou&&8<ou&&11>=ou),ZC=" ",e1=!1;function Ek(r,e){switch(r){case"keyup":return OF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xk(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ja=!1;function MF(r,e){switch(r){case"compositionend":return xk(e);case"keypress":return e.which!==32?null:(e1=!0,ZC);case"textInput":return r=e.data,r===ZC&&e1?null:r;default:return null}}function NF(r,e){if(Ja)return r==="compositionend"||!iw&&Ek(r,e)?(r=Tk(),pf=rw=Ii=null,Ja=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ck&&e.locale!=="ko"?null:e.data;default:return null}}var FF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function t1(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e==="input"?!!FF[r.type]:e==="textarea"}function bk(r,e,t,n){nk(n),e=ip(e,"onChange"),0<e.length&&(t=new nw("onChange","change",null,t,n),r.push({event:t,listeners:e}))}var au=null,Du=null;function LF(r){Lk(r,0)}function pg(r){var e=tl(r);if(KA(e))return r}function VF(r,e){if(r==="change")return e}var Ak=!1;if(qs){var ky;if(qs){var Iy="oninput"in document;if(!Iy){var r1=document.createElement("div");r1.setAttribute("oninput","return;"),Iy=typeof r1.oninput=="function"}ky=Iy}else ky=!1;Ak=ky&&(!document.documentMode||9<document.documentMode)}function n1(){au&&(au.detachEvent("onpropertychange",kk),Du=au=null)}function kk(r){if(r.propertyName==="value"&&pg(Du)){var e=[];bk(e,Du,r,Q_(r)),ak(LF,e)}}function jF(r,e,t){r==="focusin"?(n1(),au=e,Du=t,au.attachEvent("onpropertychange",kk)):r==="focusout"&&n1()}function $F(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return pg(Du)}function UF(r,e){if(r==="click")return pg(e)}function BF(r,e){if(r==="input"||r==="change")return pg(e)}function zF(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var $n=typeof Object.is=="function"?Object.is:zF;function Mu(r,e){if($n(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;var t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var s=t[n];if(!Lv.call(e,s)||!$n(r[s],e[s]))return!1}return!0}function s1(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function i1(r,e){var t=s1(r);r=0;for(var n;t;){if(t.nodeType===3){if(n=r+t.textContent.length,r<=e&&n>=e)return{node:t,offset:e-r};r=n}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=s1(t)}}function Ik(r,e){return r&&e?r===e?!0:r&&r.nodeType===3?!1:e&&e.nodeType===3?Ik(r,e.parentNode):"contains"in r?r.contains(e):r.compareDocumentPosition?!!(r.compareDocumentPosition(e)&16):!1:!1}function Pk(){for(var r=window,e=Jf();e instanceof r.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)r=e.contentWindow;else break;e=Jf(r.document)}return e}function ow(r){var e=r&&r.nodeName&&r.nodeName.toLowerCase();return e&&(e==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||e==="textarea"||r.contentEditable==="true")}function WF(r){var e=Pk(),t=r.focusedElem,n=r.selectionRange;if(e!==t&&t&&t.ownerDocument&&Ik(t.ownerDocument.documentElement,t)){if(n!==null&&ow(t)){if(e=n.start,r=n.end,r===void 0&&(r=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(r,t.value.length);else if(r=(e=t.ownerDocument||document)&&e.defaultView||window,r.getSelection){r=r.getSelection();var s=t.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!r.extend&&i>n&&(s=n,n=i,i=s),s=i1(t,i);var o=i1(t,n);s&&o&&(r.rangeCount!==1||r.anchorNode!==s.node||r.anchorOffset!==s.offset||r.focusNode!==o.node||r.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),r.removeAllRanges(),i>n?(r.addRange(e),r.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),r.addRange(e)))}}for(e=[],r=t;r=r.parentNode;)r.nodeType===1&&e.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)r=e[t],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var HF=qs&&"documentMode"in document&&11>=document.documentMode,Za=null,r0=null,lu=null,n0=!1;function o1(r,e,t){var n=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;n0||Za==null||Za!==Jf(n)||(n=Za,"selectionStart"in n&&ow(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),lu&&Mu(lu,n)||(lu=n,n=ip(r0,"onSelect"),0<n.length&&(e=new nw("onSelect","select",null,e,t),r.push({event:e,listeners:n}),e.target=Za)))}function md(r,e){var t={};return t[r.toLowerCase()]=e.toLowerCase(),t["Webkit"+r]="webkit"+e,t["Moz"+r]="moz"+e,t}var el={animationend:md("Animation","AnimationEnd"),animationiteration:md("Animation","AnimationIteration"),animationstart:md("Animation","AnimationStart"),transitionend:md("Transition","TransitionEnd")},Py={},Rk={};qs&&(Rk=document.createElement("div").style,"AnimationEvent"in window||(delete el.animationend.animation,delete el.animationiteration.animation,delete el.animationstart.animation),"TransitionEvent"in window||delete el.transitionend.transition);function gg(r){if(Py[r])return Py[r];if(!el[r])return r;var e=el[r],t;for(t in e)if(e.hasOwnProperty(t)&&t in Rk)return Py[r]=e[t];return r}var Ok=gg("animationend"),Dk=gg("animationiteration"),Mk=gg("animationstart"),Nk=gg("transitionend"),Fk=new Map,a1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function so(r,e){Fk.set(r,e),ua(e,[r])}for(var Ry=0;Ry<a1.length;Ry++){var Oy=a1[Ry],GF=Oy.toLowerCase(),qF=Oy[0].toUpperCase()+Oy.slice(1);so(GF,"on"+qF)}so(Ok,"onAnimationEnd");so(Dk,"onAnimationIteration");so(Mk,"onAnimationStart");so("dblclick","onDoubleClick");so("focusin","onFocus");so("focusout","onBlur");so(Nk,"onTransitionEnd");Pl("onMouseEnter",["mouseout","mouseover"]);Pl("onMouseLeave",["mouseout","mouseover"]);Pl("onPointerEnter",["pointerout","pointerover"]);Pl("onPointerLeave",["pointerout","pointerover"]);ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ua("onBeforeInput",["compositionend","keypress","textInput","paste"]);ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YF=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gc));function l1(r,e,t){var n=r.type||"unknown-event";r.currentTarget=t,GN(n,e,void 0,r),r.currentTarget=null}function Lk(r,e){e=(e&4)!==0;for(var t=0;t<r.length;t++){var n=r[t],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var o=n.length-1;0<=o;o--){var a=n[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;l1(s,a,c),i=l}else for(o=0;o<n.length;o++){if(a=n[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;l1(s,a,c),i=l}}}if(ep)throw r=Jv,ep=!1,Jv=null,r}function Xe(r,e){var t=e[l0];t===void 0&&(t=e[l0]=new Set);var n=r+"__bubble";t.has(n)||(Vk(e,r,2,!1),t.add(n))}function Dy(r,e,t){var n=0;e&&(n|=4),Vk(t,r,n,e)}var yd="_reactListening"+Math.random().toString(36).slice(2);function Nu(r){if(!r[yd]){r[yd]=!0,HA.forEach(function(t){t!=="selectionchange"&&(YF.has(t)||Dy(t,!1,r),Dy(t,!0,r))});var e=r.nodeType===9?r:r.ownerDocument;e===null||e[yd]||(e[yd]=!0,Dy("selectionchange",!1,e))}}function Vk(r,e,t,n){switch(Sk(e)){case 1:var s=lF;break;case 4:s=cF;break;default:s=tw}t=s.bind(null,e,t,r),s=void 0,!Qv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?r.addEventListener(e,t,{capture:!0,passive:s}):r.addEventListener(e,t,!0):s!==void 0?r.addEventListener(e,t,{passive:s}):r.addEventListener(e,t,!1)}function My(r,e,t,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var a=n.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ro(a),o===null)return;if(l=o.tag,l===5||l===6){n=i=o;continue e}a=a.parentNode}}n=n.return}ak(function(){var c=i,u=Q_(t),d=[];e:{var f=Fk.get(r);if(f!==void 0){var p=nw,m=r;switch(r){case"keypress":if(gf(t)===0)break e;case"keydown":case"keyup":p=EF;break;case"focusin":m="focus",p=Ay;break;case"focusout":m="blur",p=Ay;break;case"beforeblur":case"afterblur":p=Ay;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=KC;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=dF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=AF;break;case Ok:case Dk:case Mk:p=gF;break;case Nk:p=IF;break;case"scroll":p=uF;break;case"wheel":p=RF;break;case"copy":case"cut":case"paste":p=yF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=JC}var v=(e&4)!==0,T=!v&&r==="scroll",w=v?f!==null?f+"Capture":null:f;v=[];for(var y=c,C;y!==null;){C=y;var k=C.stateNode;if(C.tag===5&&k!==null&&(C=k,w!==null&&(k=Iu(y,w),k!=null&&v.push(Fu(y,k,C)))),T)break;y=y.return}0<v.length&&(f=new p(f,m,null,t,u),d.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=r==="mouseover"||r==="pointerover",p=r==="mouseout"||r==="pointerout",f&&t!==Xv&&(m=t.relatedTarget||t.fromElement)&&(Ro(m)||m[Ys]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(m=t.relatedTarget||t.toElement,p=c,m=m?Ro(m):null,m!==null&&(T=ha(m),m!==T||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=c),p!==m)){if(v=KC,k="onMouseLeave",w="onMouseEnter",y="mouse",(r==="pointerout"||r==="pointerover")&&(v=JC,k="onPointerLeave",w="onPointerEnter",y="pointer"),T=p==null?f:tl(p),C=m==null?f:tl(m),f=new v(k,y+"leave",p,t,u),f.target=T,f.relatedTarget=C,k=null,Ro(u)===c&&(v=new v(w,y+"enter",m,t,u),v.target=C,v.relatedTarget=T,k=v),T=k,p&&m)t:{for(v=p,w=m,y=0,C=v;C;C=Ma(C))y++;for(C=0,k=w;k;k=Ma(k))C++;for(;0<y-C;)v=Ma(v),y--;for(;0<C-y;)w=Ma(w),C--;for(;y--;){if(v===w||w!==null&&v===w.alternate)break t;v=Ma(v),w=Ma(w)}v=null}else v=null;p!==null&&c1(d,f,p,v,!1),m!==null&&T!==null&&c1(d,T,m,v,!0)}}e:{if(f=c?tl(c):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var O=VF;else if(t1(f))if(Ak)O=BF;else{O=$F;var M=jF}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(O=UF);if(O&&(O=O(r,c))){bk(d,O,t,u);break e}M&&M(r,f,c),r==="focusout"&&(M=f._wrapperState)&&M.controlled&&f.type==="number"&&Wv(f,"number",f.value)}switch(M=c?tl(c):window,r){case"focusin":(t1(M)||M.contentEditable==="true")&&(Za=M,r0=c,lu=null);break;case"focusout":lu=r0=Za=null;break;case"mousedown":n0=!0;break;case"contextmenu":case"mouseup":case"dragend":n0=!1,o1(d,t,u);break;case"selectionchange":if(HF)break;case"keydown":case"keyup":o1(d,t,u)}var x;if(iw)e:{switch(r){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ja?Ek(r,t)&&(E="onCompositionEnd"):r==="keydown"&&t.keyCode===229&&(E="onCompositionStart");E&&(Ck&&t.locale!=="ko"&&(Ja||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ja&&(x=Tk()):(Ii=u,rw="value"in Ii?Ii.value:Ii.textContent,Ja=!0)),M=ip(c,E),0<M.length&&(E=new QC(E,r,null,t,u),d.push({event:E,listeners:M}),x?E.data=x:(x=xk(t),x!==null&&(E.data=x)))),(x=DF?MF(r,t):NF(r,t))&&(c=ip(c,"onBeforeInput"),0<c.length&&(u=new QC("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=x))}Lk(d,e)})}function Fu(r,e,t){return{instance:r,listener:e,currentTarget:t}}function ip(r,e){for(var t=e+"Capture",n=[];r!==null;){var s=r,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Iu(r,t),i!=null&&n.unshift(Fu(r,i,s)),i=Iu(r,e),i!=null&&n.push(Fu(r,i,s))),r=r.return}return n}function Ma(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function c1(r,e,t,n,s){for(var i=e._reactName,o=[];t!==null&&t!==n;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===n)break;a.tag===5&&c!==null&&(a=c,s?(l=Iu(t,i),l!=null&&o.unshift(Fu(t,l,a))):s||(l=Iu(t,i),l!=null&&o.push(Fu(t,l,a)))),t=t.return}o.length!==0&&r.push({event:e,listeners:o})}var XF=/\r\n?/g,KF=/\u0000|\uFFFD/g;function u1(r){return(typeof r=="string"?r:""+r).replace(XF,`
`).replace(KF,"")}function vd(r,e,t){if(e=u1(e),u1(r)!==e&&t)throw Error(X(425))}function op(){}var s0=null,i0=null;function o0(r,e){return r==="textarea"||r==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var a0=typeof setTimeout=="function"?setTimeout:void 0,QF=typeof clearTimeout=="function"?clearTimeout:void 0,h1=typeof Promise=="function"?Promise:void 0,JF=typeof queueMicrotask=="function"?queueMicrotask:typeof h1<"u"?function(r){return h1.resolve(null).then(r).catch(ZF)}:a0;function ZF(r){setTimeout(function(){throw r})}function Ny(r,e){var t=e,n=0;do{var s=t.nextSibling;if(r.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(n===0){r.removeChild(s),Ou(e);return}n--}else t!=="$"&&t!=="$?"&&t!=="$!"||n++;t=s}while(t);Ou(e)}function Ni(r){for(;r!=null;r=r.nextSibling){var e=r.nodeType;if(e===1||e===3)break;if(e===8){if(e=r.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return r}function d1(r){r=r.previousSibling;for(var e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return r;e--}else t==="/$"&&e++}r=r.previousSibling}return null}var Yl=Math.random().toString(36).slice(2),ts="__reactFiber$"+Yl,Lu="__reactProps$"+Yl,Ys="__reactContainer$"+Yl,l0="__reactEvents$"+Yl,eL="__reactListeners$"+Yl,tL="__reactHandles$"+Yl;function Ro(r){var e=r[ts];if(e)return e;for(var t=r.parentNode;t;){if(e=t[Ys]||t[ts]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(r=d1(r);r!==null;){if(t=r[ts])return t;r=d1(r)}return e}r=t,t=r.parentNode}return null}function _h(r){return r=r[ts]||r[Ys],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function tl(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(X(33))}function mg(r){return r[Lu]||null}var c0=[],rl=-1;function io(r){return{current:r}}function Ke(r){0>rl||(r.current=c0[rl],c0[rl]=null,rl--)}function qe(r,e){rl++,c0[rl]=r.current,r.current=e}var Gi={},lr=io(Gi),Pr=io(!1),qo=Gi;function Rl(r,e){var t=r.type.contextTypes;if(!t)return Gi;var n=r.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return n&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=e,r.__reactInternalMemoizedMaskedChildContext=s),s}function Rr(r){return r=r.childContextTypes,r!=null}function ap(){Ke(Pr),Ke(lr)}function f1(r,e,t){if(lr.current!==Gi)throw Error(X(168));qe(lr,e),qe(Pr,t)}function jk(r,e,t){var n=r.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return t;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(X(108,jN(r)||"Unknown",s));return st({},t,n)}function lp(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Gi,qo=lr.current,qe(lr,r),qe(Pr,Pr.current),!0}function p1(r,e,t){var n=r.stateNode;if(!n)throw Error(X(169));t?(r=jk(r,e,qo),n.__reactInternalMemoizedMergedChildContext=r,Ke(Pr),Ke(lr),qe(lr,r)):Ke(Pr),qe(Pr,t)}var Ps=null,yg=!1,Fy=!1;function $k(r){Ps===null?Ps=[r]:Ps.push(r)}function rL(r){yg=!0,$k(r)}function oo(){if(!Fy&&Ps!==null){Fy=!0;var r=0,e=je;try{var t=Ps;for(je=1;r<t.length;r++){var n=t[r];do n=n(!0);while(n!==null)}Ps=null,yg=!1}catch(s){throw Ps!==null&&(Ps=Ps.slice(r+1)),hk(J_,oo),s}finally{je=e,Fy=!1}}return null}var nl=[],sl=0,cp=null,up=0,rn=[],nn=0,Yo=null,Ms=1,Ns="";function Eo(r,e){nl[sl++]=up,nl[sl++]=cp,cp=r,up=e}function Uk(r,e,t){rn[nn++]=Ms,rn[nn++]=Ns,rn[nn++]=Yo,Yo=r;var n=Ms;r=Ns;var s=32-Fn(n)-1;n&=~(1<<s),t+=1;var i=32-Fn(e)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Ms=1<<32-Fn(e)+s|t<<s|n,Ns=i+r}else Ms=1<<i|t<<s|n,Ns=r}function aw(r){r.return!==null&&(Eo(r,1),Uk(r,1,0))}function lw(r){for(;r===cp;)cp=nl[--sl],nl[sl]=null,up=nl[--sl],nl[sl]=null;for(;r===Yo;)Yo=rn[--nn],rn[nn]=null,Ns=rn[--nn],rn[nn]=null,Ms=rn[--nn],rn[nn]=null}var Hr=null,zr=null,Je=!1,An=null;function Bk(r,e){var t=ln(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=r,e=r.deletions,e===null?(r.deletions=[t],r.flags|=16):e.push(t)}function g1(r,e){switch(r.tag){case 5:var t=r.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(r.stateNode=e,Hr=r,zr=Ni(e.firstChild),!0):!1;case 6:return e=r.pendingProps===""||e.nodeType!==3?null:e,e!==null?(r.stateNode=e,Hr=r,zr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Yo!==null?{id:Ms,overflow:Ns}:null,r.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ln(18,null,null,0),t.stateNode=e,t.return=r,r.child=t,Hr=r,zr=null,!0):!1;default:return!1}}function u0(r){return(r.mode&1)!==0&&(r.flags&128)===0}function h0(r){if(Je){var e=zr;if(e){var t=e;if(!g1(r,e)){if(u0(r))throw Error(X(418));e=Ni(t.nextSibling);var n=Hr;e&&g1(r,e)?Bk(n,t):(r.flags=r.flags&-4097|2,Je=!1,Hr=r)}}else{if(u0(r))throw Error(X(418));r.flags=r.flags&-4097|2,Je=!1,Hr=r}}}function m1(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Hr=r}function _d(r){if(r!==Hr)return!1;if(!Je)return m1(r),Je=!0,!1;var e;if((e=r.tag!==3)&&!(e=r.tag!==5)&&(e=r.type,e=e!=="head"&&e!=="body"&&!o0(r.type,r.memoizedProps)),e&&(e=zr)){if(u0(r))throw zk(),Error(X(418));for(;e;)Bk(r,e),e=Ni(e.nextSibling)}if(m1(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(X(317));e:{for(r=r.nextSibling,e=0;r;){if(r.nodeType===8){var t=r.data;if(t==="/$"){if(e===0){zr=Ni(r.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}r=r.nextSibling}zr=null}}else zr=Hr?Ni(r.stateNode.nextSibling):null;return!0}function zk(){for(var r=zr;r;)r=Ni(r.nextSibling)}function Ol(){zr=Hr=null,Je=!1}function cw(r){An===null?An=[r]:An.push(r)}var nL=li.ReactCurrentBatchConfig;function Dc(r,e,t){if(r=t.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(X(309));var n=t.stateNode}if(!n)throw Error(X(147,r));var s=n,i=""+r;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof r!="string")throw Error(X(284));if(!t._owner)throw Error(X(290,r))}return r}function wd(r,e){throw r=Object.prototype.toString.call(e),Error(X(31,r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r))}function y1(r){var e=r._init;return e(r._payload)}function Wk(r){function e(w,y){if(r){var C=w.deletions;C===null?(w.deletions=[y],w.flags|=16):C.push(y)}}function t(w,y){if(!r)return null;for(;y!==null;)e(w,y),y=y.sibling;return null}function n(w,y){for(w=new Map;y!==null;)y.key!==null?w.set(y.key,y):w.set(y.index,y),y=y.sibling;return w}function s(w,y){return w=ji(w,y),w.index=0,w.sibling=null,w}function i(w,y,C){return w.index=C,r?(C=w.alternate,C!==null?(C=C.index,C<y?(w.flags|=2,y):C):(w.flags|=2,y)):(w.flags|=1048576,y)}function o(w){return r&&w.alternate===null&&(w.flags|=2),w}function a(w,y,C,k){return y===null||y.tag!==6?(y=zy(C,w.mode,k),y.return=w,y):(y=s(y,C),y.return=w,y)}function l(w,y,C,k){var O=C.type;return O===Qa?u(w,y,C.props.children,k,C.key):y!==null&&(y.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===vi&&y1(O)===y.type)?(k=s(y,C.props),k.ref=Dc(w,y,C),k.return=w,k):(k=Tf(C.type,C.key,C.props,null,w.mode,k),k.ref=Dc(w,y,C),k.return=w,k)}function c(w,y,C,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==C.containerInfo||y.stateNode.implementation!==C.implementation?(y=Wy(C,w.mode,k),y.return=w,y):(y=s(y,C.children||[]),y.return=w,y)}function u(w,y,C,k,O){return y===null||y.tag!==7?(y=zo(C,w.mode,k,O),y.return=w,y):(y=s(y,C),y.return=w,y)}function d(w,y,C){if(typeof y=="string"&&y!==""||typeof y=="number")return y=zy(""+y,w.mode,C),y.return=w,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case cd:return C=Tf(y.type,y.key,y.props,null,w.mode,C),C.ref=Dc(w,null,y),C.return=w,C;case Ka:return y=Wy(y,w.mode,C),y.return=w,y;case vi:var k=y._init;return d(w,k(y._payload),C)}if(Wc(y)||kc(y))return y=zo(y,w.mode,C,null),y.return=w,y;wd(w,y)}return null}function f(w,y,C,k){var O=y!==null?y.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return O!==null?null:a(w,y,""+C,k);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case cd:return C.key===O?l(w,y,C,k):null;case Ka:return C.key===O?c(w,y,C,k):null;case vi:return O=C._init,f(w,y,O(C._payload),k)}if(Wc(C)||kc(C))return O!==null?null:u(w,y,C,k,null);wd(w,C)}return null}function p(w,y,C,k,O){if(typeof k=="string"&&k!==""||typeof k=="number")return w=w.get(C)||null,a(y,w,""+k,O);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case cd:return w=w.get(k.key===null?C:k.key)||null,l(y,w,k,O);case Ka:return w=w.get(k.key===null?C:k.key)||null,c(y,w,k,O);case vi:var M=k._init;return p(w,y,C,M(k._payload),O)}if(Wc(k)||kc(k))return w=w.get(C)||null,u(y,w,k,O,null);wd(y,k)}return null}function m(w,y,C,k){for(var O=null,M=null,x=y,E=y=0,A=null;x!==null&&E<C.length;E++){x.index>E?(A=x,x=null):A=x.sibling;var P=f(w,x,C[E],k);if(P===null){x===null&&(x=A);break}r&&x&&P.alternate===null&&e(w,x),y=i(P,y,E),M===null?O=P:M.sibling=P,M=P,x=A}if(E===C.length)return t(w,x),Je&&Eo(w,E),O;if(x===null){for(;E<C.length;E++)x=d(w,C[E],k),x!==null&&(y=i(x,y,E),M===null?O=x:M.sibling=x,M=x);return Je&&Eo(w,E),O}for(x=n(w,x);E<C.length;E++)A=p(x,w,E,C[E],k),A!==null&&(r&&A.alternate!==null&&x.delete(A.key===null?E:A.key),y=i(A,y,E),M===null?O=A:M.sibling=A,M=A);return r&&x.forEach(function(R){return e(w,R)}),Je&&Eo(w,E),O}function v(w,y,C,k){var O=kc(C);if(typeof O!="function")throw Error(X(150));if(C=O.call(C),C==null)throw Error(X(151));for(var M=O=null,x=y,E=y=0,A=null,P=C.next();x!==null&&!P.done;E++,P=C.next()){x.index>E?(A=x,x=null):A=x.sibling;var R=f(w,x,P.value,k);if(R===null){x===null&&(x=A);break}r&&x&&R.alternate===null&&e(w,x),y=i(R,y,E),M===null?O=R:M.sibling=R,M=R,x=A}if(P.done)return t(w,x),Je&&Eo(w,E),O;if(x===null){for(;!P.done;E++,P=C.next())P=d(w,P.value,k),P!==null&&(y=i(P,y,E),M===null?O=P:M.sibling=P,M=P);return Je&&Eo(w,E),O}for(x=n(w,x);!P.done;E++,P=C.next())P=p(x,w,E,P.value,k),P!==null&&(r&&P.alternate!==null&&x.delete(P.key===null?E:P.key),y=i(P,y,E),M===null?O=P:M.sibling=P,M=P);return r&&x.forEach(function(_){return e(w,_)}),Je&&Eo(w,E),O}function T(w,y,C,k){if(typeof C=="object"&&C!==null&&C.type===Qa&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case cd:e:{for(var O=C.key,M=y;M!==null;){if(M.key===O){if(O=C.type,O===Qa){if(M.tag===7){t(w,M.sibling),y=s(M,C.props.children),y.return=w,w=y;break e}}else if(M.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===vi&&y1(O)===M.type){t(w,M.sibling),y=s(M,C.props),y.ref=Dc(w,M,C),y.return=w,w=y;break e}t(w,M);break}else e(w,M);M=M.sibling}C.type===Qa?(y=zo(C.props.children,w.mode,k,C.key),y.return=w,w=y):(k=Tf(C.type,C.key,C.props,null,w.mode,k),k.ref=Dc(w,y,C),k.return=w,w=k)}return o(w);case Ka:e:{for(M=C.key;y!==null;){if(y.key===M)if(y.tag===4&&y.stateNode.containerInfo===C.containerInfo&&y.stateNode.implementation===C.implementation){t(w,y.sibling),y=s(y,C.children||[]),y.return=w,w=y;break e}else{t(w,y);break}else e(w,y);y=y.sibling}y=Wy(C,w.mode,k),y.return=w,w=y}return o(w);case vi:return M=C._init,T(w,y,M(C._payload),k)}if(Wc(C))return m(w,y,C,k);if(kc(C))return v(w,y,C,k);wd(w,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,y!==null&&y.tag===6?(t(w,y.sibling),y=s(y,C),y.return=w,w=y):(t(w,y),y=zy(C,w.mode,k),y.return=w,w=y),o(w)):t(w,y)}return T}var Dl=Wk(!0),Hk=Wk(!1),hp=io(null),dp=null,il=null,uw=null;function hw(){uw=il=dp=null}function dw(r){var e=hp.current;Ke(hp),r._currentValue=e}function d0(r,e,t){for(;r!==null;){var n=r.alternate;if((r.childLanes&e)!==e?(r.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),r===t)break;r=r.return}}function ml(r,e){dp=r,uw=il=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&e&&(Ir=!0),r.firstContext=null)}function dn(r){var e=r._currentValue;if(uw!==r)if(r={context:r,memoizedValue:e,next:null},il===null){if(dp===null)throw Error(X(308));il=r,dp.dependencies={lanes:0,firstContext:r}}else il=il.next=r;return e}var Oo=null;function fw(r){Oo===null?Oo=[r]:Oo.push(r)}function Gk(r,e,t,n){var s=e.interleaved;return s===null?(t.next=t,fw(e)):(t.next=s.next,s.next=t),e.interleaved=t,Xs(r,n)}function Xs(r,e){r.lanes|=e;var t=r.alternate;for(t!==null&&(t.lanes|=e),t=r,r=r.return;r!==null;)r.childLanes|=e,t=r.alternate,t!==null&&(t.childLanes|=e),t=r,r=r.return;return t.tag===3?t.stateNode:null}var _i=!1;function pw(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qk(r,e){r=r.updateQueue,e.updateQueue===r&&(e.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function $s(r,e){return{eventTime:r,lane:e,tag:0,payload:null,callback:null,next:null}}function Fi(r,e,t){var n=r.updateQueue;if(n===null)return null;if(n=n.shared,be&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Xs(r,t)}return s=n.interleaved,s===null?(e.next=e,fw(n)):(e.next=s.next,s.next=e),n.interleaved=e,Xs(r,t)}function mf(r,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var n=e.lanes;n&=r.pendingLanes,t|=n,e.lanes=t,Z_(r,t)}}function v1(r,e){var t=r.updateQueue,n=r.alternate;if(n!==null&&(n=n.updateQueue,t===n)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},r.updateQueue=t;return}r=t.lastBaseUpdate,r===null?t.firstBaseUpdate=e:r.next=e,t.lastBaseUpdate=e}function fp(r,e,t,n){var s=r.updateQueue;_i=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=r.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=s.baseState;o=0,u=c=l=null,a=i;do{var f=a.lane,p=a.eventTime;if((n&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var m=r,v=a;switch(f=e,p=t,v.tag){case 1:if(m=v.payload,typeof m=="function"){d=m.call(p,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=v.payload,f=typeof m=="function"?m.call(p,d,f):m,f==null)break e;d=st({},d,f);break e;case 2:_i=!0}}a.callback!==null&&a.lane!==0&&(r.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else p={eventTime:p,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(u===null&&(l=d),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ko|=o,r.lanes=o,r.memoizedState=d}}function _1(r,e,t){if(r=e.effects,e.effects=null,r!==null)for(e=0;e<r.length;e++){var n=r[e],s=n.callback;if(s!==null){if(n.callback=null,n=t,typeof s!="function")throw Error(X(191,s));s.call(n)}}}var wh={},os=io(wh),Vu=io(wh),ju=io(wh);function Do(r){if(r===wh)throw Error(X(174));return r}function gw(r,e){switch(qe(ju,e),qe(Vu,r),qe(os,wh),r=e.nodeType,r){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Gv(null,"");break;default:r=r===8?e.parentNode:e,e=r.namespaceURI||null,r=r.tagName,e=Gv(e,r)}Ke(os),qe(os,e)}function Ml(){Ke(os),Ke(Vu),Ke(ju)}function Yk(r){Do(ju.current);var e=Do(os.current),t=Gv(e,r.type);e!==t&&(qe(Vu,r),qe(os,t))}function mw(r){Vu.current===r&&(Ke(os),Ke(Vu))}var tt=io(0);function pp(r){for(var e=r;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ly=[];function yw(){for(var r=0;r<Ly.length;r++)Ly[r]._workInProgressVersionPrimary=null;Ly.length=0}var yf=li.ReactCurrentDispatcher,Vy=li.ReactCurrentBatchConfig,Xo=0,rt=null,It=null,Ft=null,gp=!1,cu=!1,$u=0,sL=0;function Zt(){throw Error(X(321))}function vw(r,e){if(e===null)return!1;for(var t=0;t<e.length&&t<r.length;t++)if(!$n(r[t],e[t]))return!1;return!0}function _w(r,e,t,n,s,i){if(Xo=i,rt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,yf.current=r===null||r.memoizedState===null?lL:cL,r=t(n,s),cu){i=0;do{if(cu=!1,$u=0,25<=i)throw Error(X(301));i+=1,Ft=It=null,e.updateQueue=null,yf.current=uL,r=t(n,s)}while(cu)}if(yf.current=mp,e=It!==null&&It.next!==null,Xo=0,Ft=It=rt=null,gp=!1,e)throw Error(X(300));return r}function ww(){var r=$u!==0;return $u=0,r}function Yn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?rt.memoizedState=Ft=r:Ft=Ft.next=r,Ft}function fn(){if(It===null){var r=rt.alternate;r=r!==null?r.memoizedState:null}else r=It.next;var e=Ft===null?rt.memoizedState:Ft.next;if(e!==null)Ft=e,It=r;else{if(r===null)throw Error(X(310));It=r,r={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},Ft===null?rt.memoizedState=Ft=r:Ft=Ft.next=r}return Ft}function Uu(r,e){return typeof e=="function"?e(r):e}function jy(r){var e=fn(),t=e.queue;if(t===null)throw Error(X(311));t.lastRenderedReducer=r;var n=It,s=n.baseQueue,i=t.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,n=n.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((Xo&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:r(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,o=n):l=l.next=d,rt.lanes|=u,Ko|=u}c=c.next}while(c!==null&&c!==i);l===null?o=n:l.next=a,$n(n,e.memoizedState)||(Ir=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=l,t.lastRenderedState=n}if(r=t.interleaved,r!==null){s=r;do i=s.lane,rt.lanes|=i,Ko|=i,s=s.next;while(s!==r)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function $y(r){var e=fn(),t=e.queue;if(t===null)throw Error(X(311));t.lastRenderedReducer=r;var n=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do i=r(i,o.action),o=o.next;while(o!==s);$n(i,e.memoizedState)||(Ir=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,n]}function Xk(){}function Kk(r,e){var t=rt,n=fn(),s=e(),i=!$n(n.memoizedState,s);if(i&&(n.memoizedState=s,Ir=!0),n=n.queue,Sw(Zk.bind(null,t,n,r),[r]),n.getSnapshot!==e||i||Ft!==null&&Ft.memoizedState.tag&1){if(t.flags|=2048,Bu(9,Jk.bind(null,t,n,s,e),void 0,null),Lt===null)throw Error(X(349));Xo&30||Qk(t,e,s)}return s}function Qk(r,e,t){r.flags|=16384,r={getSnapshot:e,value:t},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.stores=[r]):(t=e.stores,t===null?e.stores=[r]:t.push(r))}function Jk(r,e,t,n){e.value=t,e.getSnapshot=n,eI(e)&&tI(r)}function Zk(r,e,t){return t(function(){eI(e)&&tI(r)})}function eI(r){var e=r.getSnapshot;r=r.value;try{var t=e();return!$n(r,t)}catch{return!0}}function tI(r){var e=Xs(r,1);e!==null&&Ln(e,r,1,-1)}function w1(r){var e=Yn();return typeof r=="function"&&(r=r()),e.memoizedState=e.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Uu,lastRenderedState:r},e.queue=r,r=r.dispatch=aL.bind(null,rt,r),[e.memoizedState,r]}function Bu(r,e,t,n){return r={tag:r,create:e,destroy:t,deps:n,next:null},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.lastEffect=r.next=r):(t=e.lastEffect,t===null?e.lastEffect=r.next=r:(n=t.next,t.next=r,r.next=n,e.lastEffect=r)),r}function rI(){return fn().memoizedState}function vf(r,e,t,n){var s=Yn();rt.flags|=r,s.memoizedState=Bu(1|e,t,void 0,n===void 0?null:n)}function vg(r,e,t,n){var s=fn();n=n===void 0?null:n;var i=void 0;if(It!==null){var o=It.memoizedState;if(i=o.destroy,n!==null&&vw(n,o.deps)){s.memoizedState=Bu(e,t,i,n);return}}rt.flags|=r,s.memoizedState=Bu(1|e,t,i,n)}function S1(r,e){return vf(8390656,8,r,e)}function Sw(r,e){return vg(2048,8,r,e)}function nI(r,e){return vg(4,2,r,e)}function sI(r,e){return vg(4,4,r,e)}function iI(r,e){if(typeof e=="function")return r=r(),e(r),function(){e(null)};if(e!=null)return r=r(),e.current=r,function(){e.current=null}}function oI(r,e,t){return t=t!=null?t.concat([r]):null,vg(4,4,iI.bind(null,e,r),t)}function Tw(){}function aI(r,e){var t=fn();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&vw(e,n[1])?n[0]:(t.memoizedState=[r,e],r)}function lI(r,e){var t=fn();e=e===void 0?null:e;var n=t.memoizedState;return n!==null&&e!==null&&vw(e,n[1])?n[0]:(r=r(),t.memoizedState=[r,e],r)}function cI(r,e,t){return Xo&21?($n(t,e)||(t=pk(),rt.lanes|=t,Ko|=t,r.baseState=!0),e):(r.baseState&&(r.baseState=!1,Ir=!0),r.memoizedState=t)}function iL(r,e){var t=je;je=t!==0&&4>t?t:4,r(!0);var n=Vy.transition;Vy.transition={};try{r(!1),e()}finally{je=t,Vy.transition=n}}function uI(){return fn().memoizedState}function oL(r,e,t){var n=Vi(r);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},hI(r))dI(e,t);else if(t=Gk(r,e,t,n),t!==null){var s=yr();Ln(t,r,n,s),fI(t,e,n)}}function aL(r,e,t){var n=Vi(r),s={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(hI(r))dI(e,s);else{var i=r.alternate;if(r.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,t);if(s.hasEagerState=!0,s.eagerState=a,$n(a,o)){var l=e.interleaved;l===null?(s.next=s,fw(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=Gk(r,e,s,n),t!==null&&(s=yr(),Ln(t,r,n,s),fI(t,e,n))}}function hI(r){var e=r.alternate;return r===rt||e!==null&&e===rt}function dI(r,e){cu=gp=!0;var t=r.pending;t===null?e.next=e:(e.next=t.next,t.next=e),r.pending=e}function fI(r,e,t){if(t&4194240){var n=e.lanes;n&=r.pendingLanes,t|=n,e.lanes=t,Z_(r,t)}}var mp={readContext:dn,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},lL={readContext:dn,useCallback:function(r,e){return Yn().memoizedState=[r,e===void 0?null:e],r},useContext:dn,useEffect:S1,useImperativeHandle:function(r,e,t){return t=t!=null?t.concat([r]):null,vf(4194308,4,iI.bind(null,e,r),t)},useLayoutEffect:function(r,e){return vf(4194308,4,r,e)},useInsertionEffect:function(r,e){return vf(4,2,r,e)},useMemo:function(r,e){var t=Yn();return e=e===void 0?null:e,r=r(),t.memoizedState=[r,e],r},useReducer:function(r,e,t){var n=Yn();return e=t!==void 0?t(e):e,n.memoizedState=n.baseState=e,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:e},n.queue=r,r=r.dispatch=oL.bind(null,rt,r),[n.memoizedState,r]},useRef:function(r){var e=Yn();return r={current:r},e.memoizedState=r},useState:w1,useDebugValue:Tw,useDeferredValue:function(r){return Yn().memoizedState=r},useTransition:function(){var r=w1(!1),e=r[0];return r=iL.bind(null,r[1]),Yn().memoizedState=r,[e,r]},useMutableSource:function(){},useSyncExternalStore:function(r,e,t){var n=rt,s=Yn();if(Je){if(t===void 0)throw Error(X(407));t=t()}else{if(t=e(),Lt===null)throw Error(X(349));Xo&30||Qk(n,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,S1(Zk.bind(null,n,i,r),[r]),n.flags|=2048,Bu(9,Jk.bind(null,n,i,t,e),void 0,null),t},useId:function(){var r=Yn(),e=Lt.identifierPrefix;if(Je){var t=Ns,n=Ms;t=(n&~(1<<32-Fn(n)-1)).toString(32)+t,e=":"+e+"R"+t,t=$u++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=sL++,e=":"+e+"r"+t.toString(32)+":";return r.memoizedState=e},unstable_isNewReconciler:!1},cL={readContext:dn,useCallback:aI,useContext:dn,useEffect:Sw,useImperativeHandle:oI,useInsertionEffect:nI,useLayoutEffect:sI,useMemo:lI,useReducer:jy,useRef:rI,useState:function(){return jy(Uu)},useDebugValue:Tw,useDeferredValue:function(r){var e=fn();return cI(e,It.memoizedState,r)},useTransition:function(){var r=jy(Uu)[0],e=fn().memoizedState;return[r,e]},useMutableSource:Xk,useSyncExternalStore:Kk,useId:uI,unstable_isNewReconciler:!1},uL={readContext:dn,useCallback:aI,useContext:dn,useEffect:Sw,useImperativeHandle:oI,useInsertionEffect:nI,useLayoutEffect:sI,useMemo:lI,useReducer:$y,useRef:rI,useState:function(){return $y(Uu)},useDebugValue:Tw,useDeferredValue:function(r){var e=fn();return It===null?e.memoizedState=r:cI(e,It.memoizedState,r)},useTransition:function(){var r=$y(Uu)[0],e=fn().memoizedState;return[r,e]},useMutableSource:Xk,useSyncExternalStore:Kk,useId:uI,unstable_isNewReconciler:!1};function En(r,e){if(r&&r.defaultProps){e=st({},e),r=r.defaultProps;for(var t in r)e[t]===void 0&&(e[t]=r[t]);return e}return e}function f0(r,e,t,n){e=r.memoizedState,t=t(n,e),t=t==null?e:st({},e,t),r.memoizedState=t,r.lanes===0&&(r.updateQueue.baseState=t)}var _g={isMounted:function(r){return(r=r._reactInternals)?ha(r)===r:!1},enqueueSetState:function(r,e,t){r=r._reactInternals;var n=yr(),s=Vi(r),i=$s(n,s);i.payload=e,t!=null&&(i.callback=t),e=Fi(r,i,s),e!==null&&(Ln(e,r,s,n),mf(e,r,s))},enqueueReplaceState:function(r,e,t){r=r._reactInternals;var n=yr(),s=Vi(r),i=$s(n,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=Fi(r,i,s),e!==null&&(Ln(e,r,s,n),mf(e,r,s))},enqueueForceUpdate:function(r,e){r=r._reactInternals;var t=yr(),n=Vi(r),s=$s(t,n);s.tag=2,e!=null&&(s.callback=e),e=Fi(r,s,n),e!==null&&(Ln(e,r,n,t),mf(e,r,n))}};function T1(r,e,t,n,s,i,o){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(n,i,o):e.prototype&&e.prototype.isPureReactComponent?!Mu(t,n)||!Mu(s,i):!0}function pI(r,e,t){var n=!1,s=Gi,i=e.contextType;return typeof i=="object"&&i!==null?i=dn(i):(s=Rr(e)?qo:lr.current,n=e.contextTypes,i=(n=n!=null)?Rl(r,s):Gi),e=new e(t,i),r.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=_g,r.stateNode=e,e._reactInternals=r,n&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=s,r.__reactInternalMemoizedMaskedChildContext=i),e}function C1(r,e,t,n){r=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,n),e.state!==r&&_g.enqueueReplaceState(e,e.state,null)}function p0(r,e,t,n){var s=r.stateNode;s.props=t,s.state=r.memoizedState,s.refs={},pw(r);var i=e.contextType;typeof i=="object"&&i!==null?s.context=dn(i):(i=Rr(e)?qo:lr.current,s.context=Rl(r,i)),s.state=r.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(f0(r,e,i,t),s.state=r.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&_g.enqueueReplaceState(s,s.state,null),fp(r,t,s,n),s.state=r.memoizedState),typeof s.componentDidMount=="function"&&(r.flags|=4194308)}function Nl(r,e){try{var t="",n=e;do t+=VN(n),n=n.return;while(n);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:r,source:e,stack:s,digest:null}}function Uy(r,e,t){return{value:r,source:null,stack:t??null,digest:e??null}}function g0(r,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var hL=typeof WeakMap=="function"?WeakMap:Map;function gI(r,e,t){t=$s(-1,t),t.tag=3,t.payload={element:null};var n=e.value;return t.callback=function(){vp||(vp=!0,x0=n),g0(r,e)},t}function mI(r,e,t){t=$s(-1,t),t.tag=3;var n=r.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;t.payload=function(){return n(s)},t.callback=function(){g0(r,e)}}var i=r.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){g0(r,e),typeof n!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function E1(r,e,t){var n=r.pingCache;if(n===null){n=r.pingCache=new hL;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(t)||(s.add(t),r=xL.bind(null,r,e,t),e.then(r,r))}function x1(r){do{var e;if((e=r.tag===13)&&(e=r.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return r;r=r.return}while(r!==null);return null}function b1(r,e,t,n,s){return r.mode&1?(r.flags|=65536,r.lanes=s,r):(r===e?r.flags|=65536:(r.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=$s(-1,1),e.tag=2,Fi(t,e,1))),t.lanes|=1),r)}var dL=li.ReactCurrentOwner,Ir=!1;function dr(r,e,t,n){e.child=r===null?Hk(e,null,t,n):Dl(e,r.child,t,n)}function A1(r,e,t,n,s){t=t.render;var i=e.ref;return ml(e,s),n=_w(r,e,t,n,i,s),t=ww(),r!==null&&!Ir?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~s,Ks(r,e,s)):(Je&&t&&aw(e),e.flags|=1,dr(r,e,n,s),e.child)}function k1(r,e,t,n,s){if(r===null){var i=t.type;return typeof i=="function"&&!Pw(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,yI(r,e,i,n,s)):(r=Tf(t.type,null,n,e,e.mode,s),r.ref=e.ref,r.return=e,e.child=r)}if(i=r.child,!(r.lanes&s)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Mu,t(o,n)&&r.ref===e.ref)return Ks(r,e,s)}return e.flags|=1,r=ji(i,n),r.ref=e.ref,r.return=e,e.child=r}function yI(r,e,t,n,s){if(r!==null){var i=r.memoizedProps;if(Mu(i,n)&&r.ref===e.ref)if(Ir=!1,e.pendingProps=n=i,(r.lanes&s)!==0)r.flags&131072&&(Ir=!0);else return e.lanes=r.lanes,Ks(r,e,s)}return m0(r,e,t,n,s)}function vI(r,e,t){var n=e.pendingProps,s=n.children,i=r!==null?r.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(al,$r),$r|=t;else{if(!(t&1073741824))return r=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:r,cachePool:null,transitions:null},e.updateQueue=null,qe(al,$r),$r|=r,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:t,qe(al,$r),$r|=n}else i!==null?(n=i.baseLanes|t,e.memoizedState=null):n=t,qe(al,$r),$r|=n;return dr(r,e,s,t),e.child}function _I(r,e){var t=e.ref;(r===null&&t!==null||r!==null&&r.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function m0(r,e,t,n,s){var i=Rr(t)?qo:lr.current;return i=Rl(e,i),ml(e,s),t=_w(r,e,t,n,i,s),n=ww(),r!==null&&!Ir?(e.updateQueue=r.updateQueue,e.flags&=-2053,r.lanes&=~s,Ks(r,e,s)):(Je&&n&&aw(e),e.flags|=1,dr(r,e,t,s),e.child)}function I1(r,e,t,n,s){if(Rr(t)){var i=!0;lp(e)}else i=!1;if(ml(e,s),e.stateNode===null)_f(r,e),pI(e,t,n),p0(e,t,n,s),n=!0;else if(r===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=t.contextType;typeof c=="object"&&c!==null?c=dn(c):(c=Rr(t)?qo:lr.current,c=Rl(e,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==n||l!==c)&&C1(e,o,n,c),_i=!1;var f=e.memoizedState;o.state=f,fp(e,n,o,s),l=e.memoizedState,a!==n||f!==l||Pr.current||_i?(typeof u=="function"&&(f0(e,t,u,n),l=e.memoizedState),(a=_i||T1(e,t,a,n,f,l,c))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),o.props=n,o.state=l,o.context=c,n=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,qk(r,e),a=e.memoizedProps,c=e.type===e.elementType?a:En(e.type,a),o.props=c,d=e.pendingProps,f=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=dn(l):(l=Rr(t)?qo:lr.current,l=Rl(e,l));var p=t.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||f!==l)&&C1(e,o,n,l),_i=!1,f=e.memoizedState,o.state=f,fp(e,n,o,s);var m=e.memoizedState;a!==d||f!==m||Pr.current||_i?(typeof p=="function"&&(f0(e,t,p,n),m=e.memoizedState),(c=_i||T1(e,t,c,n,f,m,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===r.memoizedProps&&f===r.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===r.memoizedProps&&f===r.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=m),o.props=n,o.state=m,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||a===r.memoizedProps&&f===r.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===r.memoizedProps&&f===r.memoizedState||(e.flags|=1024),n=!1)}return y0(r,e,t,n,i,s)}function y0(r,e,t,n,s,i){_I(r,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&p1(e,t,!1),Ks(r,e,i);n=e.stateNode,dL.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,r!==null&&o?(e.child=Dl(e,r.child,null,i),e.child=Dl(e,null,a,i)):dr(r,e,a,i),e.memoizedState=n.state,s&&p1(e,t,!0),e.child}function wI(r){var e=r.stateNode;e.pendingContext?f1(r,e.pendingContext,e.pendingContext!==e.context):e.context&&f1(r,e.context,!1),gw(r,e.containerInfo)}function P1(r,e,t,n,s){return Ol(),cw(s),e.flags|=256,dr(r,e,t,n),e.child}var v0={dehydrated:null,treeContext:null,retryLane:0};function _0(r){return{baseLanes:r,cachePool:null,transitions:null}}function SI(r,e,t){var n=e.pendingProps,s=tt.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=r!==null&&r.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(r===null||r.memoizedState!==null)&&(s|=1),qe(tt,s&1),r===null)return h0(e),r=e.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(e.mode&1?r.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,r=n.fallback,i?(n=e.mode,i=e.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Tg(o,n,0,null),r=zo(r,n,t,null),i.return=e,r.return=e,i.sibling=r,e.child=i,e.child.memoizedState=_0(t),e.memoizedState=v0,r):Cw(e,o));if(s=r.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return fL(r,e,o,n,a,s,t);if(i){i=n.fallback,o=e.mode,s=r.child,a=s.sibling;var l={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=ji(s,l),n.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ji(a,i):(i=zo(i,o,t,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,o=r.child.memoizedState,o=o===null?_0(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=r.childLanes&~t,e.memoizedState=v0,n}return i=r.child,r=i.sibling,n=ji(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=t),n.return=e,n.sibling=null,r!==null&&(t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)),e.child=n,e.memoizedState=null,n}function Cw(r,e){return e=Tg({mode:"visible",children:e},r.mode,0,null),e.return=r,r.child=e}function Sd(r,e,t,n){return n!==null&&cw(n),Dl(e,r.child,null,t),r=Cw(e,e.pendingProps.children),r.flags|=2,e.memoizedState=null,r}function fL(r,e,t,n,s,i,o){if(t)return e.flags&256?(e.flags&=-257,n=Uy(Error(X(422))),Sd(r,e,o,n)):e.memoizedState!==null?(e.child=r.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Tg({mode:"visible",children:n.children},s,0,null),i=zo(i,s,o,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Dl(e,r.child,null,o),e.child.memoizedState=_0(o),e.memoizedState=v0,i);if(!(e.mode&1))return Sd(r,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var a=n.dgst;return n=a,i=Error(X(419)),n=Uy(i,n,void 0),Sd(r,e,o,n)}if(a=(o&r.childLanes)!==0,Ir||a){if(n=Lt,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Xs(r,s),Ln(n,r,s,-1))}return Iw(),n=Uy(Error(X(421))),Sd(r,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=r.child,e=bL.bind(null,r),s._reactRetry=e,null):(r=i.treeContext,zr=Ni(s.nextSibling),Hr=e,Je=!0,An=null,r!==null&&(rn[nn++]=Ms,rn[nn++]=Ns,rn[nn++]=Yo,Ms=r.id,Ns=r.overflow,Yo=e),e=Cw(e,n.children),e.flags|=4096,e)}function R1(r,e,t){r.lanes|=e;var n=r.alternate;n!==null&&(n.lanes|=e),d0(r.return,e,t)}function By(r,e,t,n,s){var i=r.memoizedState;i===null?r.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=t,i.tailMode=s)}function TI(r,e,t){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(dr(r,e,n.children,t),n=tt.current,n&2)n=n&1|2,e.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=e.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&R1(r,t,e);else if(r.tag===19)R1(r,t,e);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}n&=1}if(qe(tt,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)r=t.alternate,r!==null&&pp(r)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),By(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(r=s.alternate,r!==null&&pp(r)===null){e.child=s;break}r=s.sibling,s.sibling=t,t=s,s=r}By(e,!0,t,null,i);break;case"together":By(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function _f(r,e){!(e.mode&1)&&r!==null&&(r.alternate=null,e.alternate=null,e.flags|=2)}function Ks(r,e,t){if(r!==null&&(e.dependencies=r.dependencies),Ko|=e.lanes,!(t&e.childLanes))return null;if(r!==null&&e.child!==r.child)throw Error(X(153));if(e.child!==null){for(r=e.child,t=ji(r,r.pendingProps),e.child=t,t.return=e;r.sibling!==null;)r=r.sibling,t=t.sibling=ji(r,r.pendingProps),t.return=e;t.sibling=null}return e.child}function pL(r,e,t){switch(e.tag){case 3:wI(e),Ol();break;case 5:Yk(e);break;case 1:Rr(e.type)&&lp(e);break;case 4:gw(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;qe(hp,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(qe(tt,tt.current&1),e.flags|=128,null):t&e.child.childLanes?SI(r,e,t):(qe(tt,tt.current&1),r=Ks(r,e,t),r!==null?r.sibling:null);qe(tt,tt.current&1);break;case 19:if(n=(t&e.childLanes)!==0,r.flags&128){if(n)return TI(r,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),qe(tt,tt.current),n)break;return null;case 22:case 23:return e.lanes=0,vI(r,e,t)}return Ks(r,e,t)}var CI,w0,EI,xI;CI=function(r,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)r.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};w0=function(){};EI=function(r,e,t,n){var s=r.memoizedProps;if(s!==n){r=e.stateNode,Do(os.current);var i=null;switch(t){case"input":s=Bv(r,s),n=Bv(r,n),i=[];break;case"select":s=st({},s,{value:void 0}),n=st({},n,{value:void 0}),i=[];break;case"textarea":s=Hv(r,s),n=Hv(r,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(r.onclick=op)}qv(t,n);var o;t=null;for(c in s)if(!n.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Au.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(a=s!=null?s[c]:void 0,n.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Au.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Xe("scroll",r),i||a===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};xI=function(r,e,t,n){t!==n&&(e.flags|=4)};function Mc(r,e){if(!Je)switch(r.tailMode){case"hidden":e=r.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?r.tail=null:t.sibling=null;break;case"collapsed":t=r.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e||r.tail===null?r.tail=null:r.tail.sibling=null:n.sibling=null}}function er(r){var e=r.alternate!==null&&r.alternate.child===r.child,t=0,n=0;if(e)for(var s=r.child;s!==null;)t|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=r,s=s.sibling;else for(s=r.child;s!==null;)t|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=r,s=s.sibling;return r.subtreeFlags|=n,r.childLanes=t,e}function gL(r,e,t){var n=e.pendingProps;switch(lw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return er(e),null;case 1:return Rr(e.type)&&ap(),er(e),null;case 3:return n=e.stateNode,Ml(),Ke(Pr),Ke(lr),yw(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(r===null||r.child===null)&&(_d(e)?e.flags|=4:r===null||r.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,An!==null&&(k0(An),An=null))),w0(r,e),er(e),null;case 5:mw(e);var s=Do(ju.current);if(t=e.type,r!==null&&e.stateNode!=null)EI(r,e,t,n,s),r.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(X(166));return er(e),null}if(r=Do(os.current),_d(e)){n=e.stateNode,t=e.type;var i=e.memoizedProps;switch(n[ts]=e,n[Lu]=i,r=(e.mode&1)!==0,t){case"dialog":Xe("cancel",n),Xe("close",n);break;case"iframe":case"object":case"embed":Xe("load",n);break;case"video":case"audio":for(s=0;s<Gc.length;s++)Xe(Gc[s],n);break;case"source":Xe("error",n);break;case"img":case"image":case"link":Xe("error",n),Xe("load",n);break;case"details":Xe("toggle",n);break;case"input":$C(n,i),Xe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Xe("invalid",n);break;case"textarea":BC(n,i),Xe("invalid",n)}qv(t,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?n.textContent!==a&&(i.suppressHydrationWarning!==!0&&vd(n.textContent,a,r),s=["children",a]):typeof a=="number"&&n.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&vd(n.textContent,a,r),s=["children",""+a]):Au.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Xe("scroll",n)}switch(t){case"input":ud(n),UC(n,i,!0);break;case"textarea":ud(n),zC(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=op)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=ZA(t)),r==="http://www.w3.org/1999/xhtml"?t==="script"?(r=o.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof n.is=="string"?r=o.createElement(t,{is:n.is}):(r=o.createElement(t),t==="select"&&(o=r,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):r=o.createElementNS(r,t),r[ts]=e,r[Lu]=n,CI(r,e,!1,!1),e.stateNode=r;e:{switch(o=Yv(t,n),t){case"dialog":Xe("cancel",r),Xe("close",r),s=n;break;case"iframe":case"object":case"embed":Xe("load",r),s=n;break;case"video":case"audio":for(s=0;s<Gc.length;s++)Xe(Gc[s],r);s=n;break;case"source":Xe("error",r),s=n;break;case"img":case"image":case"link":Xe("error",r),Xe("load",r),s=n;break;case"details":Xe("toggle",r),s=n;break;case"input":$C(r,n),s=Bv(r,n),Xe("invalid",r);break;case"option":s=n;break;case"select":r._wrapperState={wasMultiple:!!n.multiple},s=st({},n,{value:void 0}),Xe("invalid",r);break;case"textarea":BC(r,n),s=Hv(r,n),Xe("invalid",r);break;default:s=n}qv(t,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?rk(r,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&ek(r,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&ku(r,l):typeof l=="number"&&ku(r,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Au.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Xe("scroll",r):l!=null&&q_(r,i,l,o))}switch(t){case"input":ud(r),UC(r,n,!1);break;case"textarea":ud(r),zC(r);break;case"option":n.value!=null&&r.setAttribute("value",""+Hi(n.value));break;case"select":r.multiple=!!n.multiple,i=n.value,i!=null?dl(r,!!n.multiple,i,!1):n.defaultValue!=null&&dl(r,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(r.onclick=op)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return er(e),null;case 6:if(r&&e.stateNode!=null)xI(r,e,r.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(X(166));if(t=Do(ju.current),Do(os.current),_d(e)){if(n=e.stateNode,t=e.memoizedProps,n[ts]=e,(i=n.nodeValue!==t)&&(r=Hr,r!==null))switch(r.tag){case 3:vd(n.nodeValue,t,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&vd(n.nodeValue,t,(r.mode&1)!==0)}i&&(e.flags|=4)}else n=(t.nodeType===9?t:t.ownerDocument).createTextNode(n),n[ts]=e,e.stateNode=n}return er(e),null;case 13:if(Ke(tt),n=e.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Je&&zr!==null&&e.mode&1&&!(e.flags&128))zk(),Ol(),e.flags|=98560,i=!1;else if(i=_d(e),n!==null&&n.dehydrated!==null){if(r===null){if(!i)throw Error(X(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(X(317));i[ts]=e}else Ol(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;er(e),i=!1}else An!==null&&(k0(An),An=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(n=n!==null,n!==(r!==null&&r.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(r===null||tt.current&1?Pt===0&&(Pt=3):Iw())),e.updateQueue!==null&&(e.flags|=4),er(e),null);case 4:return Ml(),w0(r,e),r===null&&Nu(e.stateNode.containerInfo),er(e),null;case 10:return dw(e.type._context),er(e),null;case 17:return Rr(e.type)&&ap(),er(e),null;case 19:if(Ke(tt),i=e.memoizedState,i===null)return er(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)Mc(i,!1);else{if(Pt!==0||r!==null&&r.flags&128)for(r=e.child;r!==null;){if(o=pp(r),o!==null){for(e.flags|=128,Mc(i,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=t,t=e.child;t!==null;)i=t,r=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=r,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,r=o.dependencies,i.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),t=t.sibling;return qe(tt,tt.current&1|2),e.child}r=r.sibling}i.tail!==null&&ft()>Fl&&(e.flags|=128,n=!0,Mc(i,!1),e.lanes=4194304)}else{if(!n)if(r=pp(o),r!==null){if(e.flags|=128,n=!0,t=r.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Mc(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Je)return er(e),null}else 2*ft()-i.renderingStartTime>Fl&&t!==1073741824&&(e.flags|=128,n=!0,Mc(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ft(),e.sibling=null,t=tt.current,qe(tt,n?t&1|2:t&1),e):(er(e),null);case 22:case 23:return kw(),n=e.memoizedState!==null,r!==null&&r.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?$r&1073741824&&(er(e),e.subtreeFlags&6&&(e.flags|=8192)):er(e),null;case 24:return null;case 25:return null}throw Error(X(156,e.tag))}function mL(r,e){switch(lw(e),e.tag){case 1:return Rr(e.type)&&ap(),r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 3:return Ml(),Ke(Pr),Ke(lr),yw(),r=e.flags,r&65536&&!(r&128)?(e.flags=r&-65537|128,e):null;case 5:return mw(e),null;case 13:if(Ke(tt),r=e.memoizedState,r!==null&&r.dehydrated!==null){if(e.alternate===null)throw Error(X(340));Ol()}return r=e.flags,r&65536?(e.flags=r&-65537|128,e):null;case 19:return Ke(tt),null;case 4:return Ml(),null;case 10:return dw(e.type._context),null;case 22:case 23:return kw(),null;case 24:return null;default:return null}}var Td=!1,ir=!1,yL=typeof WeakSet=="function"?WeakSet:Set,ae=null;function ol(r,e){var t=r.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(n){ct(r,e,n)}else t.current=null}function S0(r,e,t){try{t()}catch(n){ct(r,e,n)}}var O1=!1;function vL(r,e){if(s0=np,r=Pk(),ow(r)){if("selectionStart"in r)var t={start:r.selectionStart,end:r.selectionEnd};else e:{t=(t=r.ownerDocument)&&t.defaultView||window;var n=t.getSelection&&t.getSelection();if(n&&n.rangeCount!==0){t=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,c=0,u=0,d=r,f=null;t:for(;;){for(var p;d!==t||s!==0&&d.nodeType!==3||(a=o+s),d!==i||n!==0&&d.nodeType!==3||(l=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(p=d.firstChild)!==null;)f=d,d=p;for(;;){if(d===r)break t;if(f===t&&++c===s&&(a=o),f===i&&++u===n&&(l=o),(p=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=p}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(i0={focusedElem:r,selectionRange:t},np=!1,ae=e;ae!==null;)if(e=ae,r=e.child,(e.subtreeFlags&1028)!==0&&r!==null)r.return=e,ae=r;else for(;ae!==null;){e=ae;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var v=m.memoizedProps,T=m.memoizedState,w=e.stateNode,y=w.getSnapshotBeforeUpdate(e.elementType===e.type?v:En(e.type,v),T);w.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(X(163))}}catch(k){ct(e,e.return,k)}if(r=e.sibling,r!==null){r.return=e.return,ae=r;break}ae=e.return}return m=O1,O1=!1,m}function uu(r,e,t){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&r)===r){var i=s.destroy;s.destroy=void 0,i!==void 0&&S0(e,t,i)}s=s.next}while(s!==n)}}function wg(r,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&r)===r){var n=t.create;t.destroy=n()}t=t.next}while(t!==e)}}function T0(r){var e=r.ref;if(e!==null){var t=r.stateNode;switch(r.tag){case 5:r=t;break;default:r=t}typeof e=="function"?e(r):e.current=r}}function bI(r){var e=r.alternate;e!==null&&(r.alternate=null,bI(e)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(e=r.stateNode,e!==null&&(delete e[ts],delete e[Lu],delete e[l0],delete e[eL],delete e[tL])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function AI(r){return r.tag===5||r.tag===3||r.tag===4}function D1(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||AI(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function C0(r,e,t){var n=r.tag;if(n===5||n===6)r=r.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(r,e):t.insertBefore(r,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(r,t)):(e=t,e.appendChild(r)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=op));else if(n!==4&&(r=r.child,r!==null))for(C0(r,e,t),r=r.sibling;r!==null;)C0(r,e,t),r=r.sibling}function E0(r,e,t){var n=r.tag;if(n===5||n===6)r=r.stateNode,e?t.insertBefore(r,e):t.appendChild(r);else if(n!==4&&(r=r.child,r!==null))for(E0(r,e,t),r=r.sibling;r!==null;)E0(r,e,t),r=r.sibling}var zt=null,xn=!1;function pi(r,e,t){for(t=t.child;t!==null;)kI(r,e,t),t=t.sibling}function kI(r,e,t){if(is&&typeof is.onCommitFiberUnmount=="function")try{is.onCommitFiberUnmount(dg,t)}catch{}switch(t.tag){case 5:ir||ol(t,e);case 6:var n=zt,s=xn;zt=null,pi(r,e,t),zt=n,xn=s,zt!==null&&(xn?(r=zt,t=t.stateNode,r.nodeType===8?r.parentNode.removeChild(t):r.removeChild(t)):zt.removeChild(t.stateNode));break;case 18:zt!==null&&(xn?(r=zt,t=t.stateNode,r.nodeType===8?Ny(r.parentNode,t):r.nodeType===1&&Ny(r,t),Ou(r)):Ny(zt,t.stateNode));break;case 4:n=zt,s=xn,zt=t.stateNode.containerInfo,xn=!0,pi(r,e,t),zt=n,xn=s;break;case 0:case 11:case 14:case 15:if(!ir&&(n=t.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&S0(t,e,o),s=s.next}while(s!==n)}pi(r,e,t);break;case 1:if(!ir&&(ol(t,e),n=t.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(a){ct(t,e,a)}pi(r,e,t);break;case 21:pi(r,e,t);break;case 22:t.mode&1?(ir=(n=ir)||t.memoizedState!==null,pi(r,e,t),ir=n):pi(r,e,t);break;default:pi(r,e,t)}}function M1(r){var e=r.updateQueue;if(e!==null){r.updateQueue=null;var t=r.stateNode;t===null&&(t=r.stateNode=new yL),e.forEach(function(n){var s=AL.bind(null,r,n);t.has(n)||(t.add(n),n.then(s,s))})}}function wn(r,e){var t=e.deletions;if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];try{var i=r,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:zt=a.stateNode,xn=!1;break e;case 3:zt=a.stateNode.containerInfo,xn=!0;break e;case 4:zt=a.stateNode.containerInfo,xn=!0;break e}a=a.return}if(zt===null)throw Error(X(160));kI(i,o,s),zt=null,xn=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){ct(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)II(e,r),e=e.sibling}function II(r,e){var t=r.alternate,n=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(wn(e,r),Gn(r),n&4){try{uu(3,r,r.return),wg(3,r)}catch(v){ct(r,r.return,v)}try{uu(5,r,r.return)}catch(v){ct(r,r.return,v)}}break;case 1:wn(e,r),Gn(r),n&512&&t!==null&&ol(t,t.return);break;case 5:if(wn(e,r),Gn(r),n&512&&t!==null&&ol(t,t.return),r.flags&32){var s=r.stateNode;try{ku(s,"")}catch(v){ct(r,r.return,v)}}if(n&4&&(s=r.stateNode,s!=null)){var i=r.memoizedProps,o=t!==null?t.memoizedProps:i,a=r.type,l=r.updateQueue;if(r.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&QA(s,i),Yv(a,o);var c=Yv(a,i);for(o=0;o<l.length;o+=2){var u=l[o],d=l[o+1];u==="style"?rk(s,d):u==="dangerouslySetInnerHTML"?ek(s,d):u==="children"?ku(s,d):q_(s,u,d,c)}switch(a){case"input":zv(s,i);break;case"textarea":JA(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?dl(s,!!i.multiple,p,!1):f!==!!i.multiple&&(i.defaultValue!=null?dl(s,!!i.multiple,i.defaultValue,!0):dl(s,!!i.multiple,i.multiple?[]:"",!1))}s[Lu]=i}catch(v){ct(r,r.return,v)}}break;case 6:if(wn(e,r),Gn(r),n&4){if(r.stateNode===null)throw Error(X(162));s=r.stateNode,i=r.memoizedProps;try{s.nodeValue=i}catch(v){ct(r,r.return,v)}}break;case 3:if(wn(e,r),Gn(r),n&4&&t!==null&&t.memoizedState.isDehydrated)try{Ou(e.containerInfo)}catch(v){ct(r,r.return,v)}break;case 4:wn(e,r),Gn(r);break;case 13:wn(e,r),Gn(r),s=r.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(bw=ft())),n&4&&M1(r);break;case 22:if(u=t!==null&&t.memoizedState!==null,r.mode&1?(ir=(c=ir)||u,wn(e,r),ir=c):wn(e,r),Gn(r),n&8192){if(c=r.memoizedState!==null,(r.stateNode.isHidden=c)&&!u&&r.mode&1)for(ae=r,u=r.child;u!==null;){for(d=ae=u;ae!==null;){switch(f=ae,p=f.child,f.tag){case 0:case 11:case 14:case 15:uu(4,f,f.return);break;case 1:ol(f,f.return);var m=f.stateNode;if(typeof m.componentWillUnmount=="function"){n=f,t=f.return;try{e=n,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(v){ct(n,t,v)}}break;case 5:ol(f,f.return);break;case 22:if(f.memoizedState!==null){F1(d);continue}}p!==null?(p.return=f,ae=p):F1(d)}u=u.sibling}e:for(u=null,d=r;;){if(d.tag===5){if(u===null){u=d;try{s=d.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=tk("display",o))}catch(v){ct(r,r.return,v)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(v){ct(r,r.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===r)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===r)break e;for(;d.sibling===null;){if(d.return===null||d.return===r)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:wn(e,r),Gn(r),n&4&&M1(r);break;case 21:break;default:wn(e,r),Gn(r)}}function Gn(r){var e=r.flags;if(e&2){try{e:{for(var t=r.return;t!==null;){if(AI(t)){var n=t;break e}t=t.return}throw Error(X(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(ku(s,""),n.flags&=-33);var i=D1(r);E0(r,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,a=D1(r);C0(r,a,o);break;default:throw Error(X(161))}}catch(l){ct(r,r.return,l)}r.flags&=-3}e&4096&&(r.flags&=-4097)}function _L(r,e,t){ae=r,PI(r)}function PI(r,e,t){for(var n=(r.mode&1)!==0;ae!==null;){var s=ae,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||Td;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||ir;a=Td;var c=ir;if(Td=o,(ir=l)&&!c)for(ae=s;ae!==null;)o=ae,l=o.child,o.tag===22&&o.memoizedState!==null?L1(s):l!==null?(l.return=o,ae=l):L1(s);for(;i!==null;)ae=i,PI(i),i=i.sibling;ae=s,Td=a,ir=c}N1(r)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ae=i):N1(r)}}function N1(r){for(;ae!==null;){var e=ae;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ir||wg(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!ir)if(t===null)n.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:En(e.type,t.memoizedProps);n.componentDidUpdate(s,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&_1(e,i,n);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}_1(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Ou(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(X(163))}ir||e.flags&512&&T0(e)}catch(f){ct(e,e.return,f)}}if(e===r){ae=null;break}if(t=e.sibling,t!==null){t.return=e.return,ae=t;break}ae=e.return}}function F1(r){for(;ae!==null;){var e=ae;if(e===r){ae=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ae=t;break}ae=e.return}}function L1(r){for(;ae!==null;){var e=ae;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{wg(4,e)}catch(l){ct(e,t,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){ct(e,s,l)}}var i=e.return;try{T0(e)}catch(l){ct(e,i,l)}break;case 5:var o=e.return;try{T0(e)}catch(l){ct(e,o,l)}}}catch(l){ct(e,e.return,l)}if(e===r){ae=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ae=a;break}ae=e.return}}var wL=Math.ceil,yp=li.ReactCurrentDispatcher,Ew=li.ReactCurrentOwner,cn=li.ReactCurrentBatchConfig,be=0,Lt=null,Et=null,Yt=0,$r=0,al=io(0),Pt=0,zu=null,Ko=0,Sg=0,xw=0,hu=null,Ar=null,bw=0,Fl=1/0,Is=null,vp=!1,x0=null,Li=null,Cd=!1,Pi=null,_p=0,du=0,b0=null,wf=-1,Sf=0;function yr(){return be&6?ft():wf!==-1?wf:wf=ft()}function Vi(r){return r.mode&1?be&2&&Yt!==0?Yt&-Yt:nL.transition!==null?(Sf===0&&(Sf=pk()),Sf):(r=je,r!==0||(r=window.event,r=r===void 0?16:Sk(r.type)),r):1}function Ln(r,e,t,n){if(50<du)throw du=0,b0=null,Error(X(185));yh(r,t,n),(!(be&2)||r!==Lt)&&(r===Lt&&(!(be&2)&&(Sg|=t),Pt===4&&Si(r,Yt)),Or(r,n),t===1&&be===0&&!(e.mode&1)&&(Fl=ft()+500,yg&&oo()))}function Or(r,e){var t=r.callbackNode;nF(r,e);var n=rp(r,r===Lt?Yt:0);if(n===0)t!==null&&GC(t),r.callbackNode=null,r.callbackPriority=0;else if(e=n&-n,r.callbackPriority!==e){if(t!=null&&GC(t),e===1)r.tag===0?rL(V1.bind(null,r)):$k(V1.bind(null,r)),JF(function(){!(be&6)&&oo()}),t=null;else{switch(gk(n)){case 1:t=J_;break;case 4:t=dk;break;case 16:t=tp;break;case 536870912:t=fk;break;default:t=tp}t=VI(t,RI.bind(null,r))}r.callbackPriority=e,r.callbackNode=t}}function RI(r,e){if(wf=-1,Sf=0,be&6)throw Error(X(327));var t=r.callbackNode;if(yl()&&r.callbackNode!==t)return null;var n=rp(r,r===Lt?Yt:0);if(n===0)return null;if(n&30||n&r.expiredLanes||e)e=wp(r,n);else{e=n;var s=be;be|=2;var i=DI();(Lt!==r||Yt!==e)&&(Is=null,Fl=ft()+500,Bo(r,e));do try{CL();break}catch(a){OI(r,a)}while(!0);hw(),yp.current=i,be=s,Et!==null?e=0:(Lt=null,Yt=0,e=Pt)}if(e!==0){if(e===2&&(s=Zv(r),s!==0&&(n=s,e=A0(r,s))),e===1)throw t=zu,Bo(r,0),Si(r,n),Or(r,ft()),t;if(e===6)Si(r,n);else{if(s=r.current.alternate,!(n&30)&&!SL(s)&&(e=wp(r,n),e===2&&(i=Zv(r),i!==0&&(n=i,e=A0(r,i))),e===1))throw t=zu,Bo(r,0),Si(r,n),Or(r,ft()),t;switch(r.finishedWork=s,r.finishedLanes=n,e){case 0:case 1:throw Error(X(345));case 2:xo(r,Ar,Is);break;case 3:if(Si(r,n),(n&130023424)===n&&(e=bw+500-ft(),10<e)){if(rp(r,0)!==0)break;if(s=r.suspendedLanes,(s&n)!==n){yr(),r.pingedLanes|=r.suspendedLanes&s;break}r.timeoutHandle=a0(xo.bind(null,r,Ar,Is),e);break}xo(r,Ar,Is);break;case 4:if(Si(r,n),(n&4194240)===n)break;for(e=r.eventTimes,s=-1;0<n;){var o=31-Fn(n);i=1<<o,o=e[o],o>s&&(s=o),n&=~i}if(n=s,n=ft()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*wL(n/1960))-n,10<n){r.timeoutHandle=a0(xo.bind(null,r,Ar,Is),n);break}xo(r,Ar,Is);break;case 5:xo(r,Ar,Is);break;default:throw Error(X(329))}}}return Or(r,ft()),r.callbackNode===t?RI.bind(null,r):null}function A0(r,e){var t=hu;return r.current.memoizedState.isDehydrated&&(Bo(r,e).flags|=256),r=wp(r,e),r!==2&&(e=Ar,Ar=t,e!==null&&k0(e)),r}function k0(r){Ar===null?Ar=r:Ar.push.apply(Ar,r)}function SL(r){for(var e=r;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var n=0;n<t.length;n++){var s=t[n],i=s.getSnapshot;s=s.value;try{if(!$n(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===r)break;for(;e.sibling===null;){if(e.return===null||e.return===r)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Si(r,e){for(e&=~xw,e&=~Sg,r.suspendedLanes|=e,r.pingedLanes&=~e,r=r.expirationTimes;0<e;){var t=31-Fn(e),n=1<<t;r[t]=-1,e&=~n}}function V1(r){if(be&6)throw Error(X(327));yl();var e=rp(r,0);if(!(e&1))return Or(r,ft()),null;var t=wp(r,e);if(r.tag!==0&&t===2){var n=Zv(r);n!==0&&(e=n,t=A0(r,n))}if(t===1)throw t=zu,Bo(r,0),Si(r,e),Or(r,ft()),t;if(t===6)throw Error(X(345));return r.finishedWork=r.current.alternate,r.finishedLanes=e,xo(r,Ar,Is),Or(r,ft()),null}function Aw(r,e){var t=be;be|=1;try{return r(e)}finally{be=t,be===0&&(Fl=ft()+500,yg&&oo())}}function Qo(r){Pi!==null&&Pi.tag===0&&!(be&6)&&yl();var e=be;be|=1;var t=cn.transition,n=je;try{if(cn.transition=null,je=1,r)return r()}finally{je=n,cn.transition=t,be=e,!(be&6)&&oo()}}function kw(){$r=al.current,Ke(al)}function Bo(r,e){r.finishedWork=null,r.finishedLanes=0;var t=r.timeoutHandle;if(t!==-1&&(r.timeoutHandle=-1,QF(t)),Et!==null)for(t=Et.return;t!==null;){var n=t;switch(lw(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ap();break;case 3:Ml(),Ke(Pr),Ke(lr),yw();break;case 5:mw(n);break;case 4:Ml();break;case 13:Ke(tt);break;case 19:Ke(tt);break;case 10:dw(n.type._context);break;case 22:case 23:kw()}t=t.return}if(Lt=r,Et=r=ji(r.current,null),Yt=$r=e,Pt=0,zu=null,xw=Sg=Ko=0,Ar=hu=null,Oo!==null){for(e=0;e<Oo.length;e++)if(t=Oo[e],n=t.interleaved,n!==null){t.interleaved=null;var s=n.next,i=t.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}t.pending=n}Oo=null}return r}function OI(r,e){do{var t=Et;try{if(hw(),yf.current=mp,gp){for(var n=rt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}gp=!1}if(Xo=0,Ft=It=rt=null,cu=!1,$u=0,Ew.current=null,t===null||t.return===null){Pt=1,zu=e,Et=null;break}e:{var i=r,o=t.return,a=t,l=e;if(e=Yt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=x1(o);if(p!==null){p.flags&=-257,b1(p,o,a,i,e),p.mode&1&&E1(i,c,e),e=p,l=c;var m=e.updateQueue;if(m===null){var v=new Set;v.add(l),e.updateQueue=v}else m.add(l);break e}else{if(!(e&1)){E1(i,c,e),Iw();break e}l=Error(X(426))}}else if(Je&&a.mode&1){var T=x1(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),b1(T,o,a,i,e),cw(Nl(l,a));break e}}i=l=Nl(l,a),Pt!==4&&(Pt=2),hu===null?hu=[i]:hu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=gI(i,l,e);v1(i,w);break e;case 1:a=l;var y=i.type,C=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Li===null||!Li.has(C)))){i.flags|=65536,e&=-e,i.lanes|=e;var k=mI(i,a,e);v1(i,k);break e}}i=i.return}while(i!==null)}NI(t)}catch(O){e=O,Et===t&&t!==null&&(Et=t=t.return);continue}break}while(!0)}function DI(){var r=yp.current;return yp.current=mp,r===null?mp:r}function Iw(){(Pt===0||Pt===3||Pt===2)&&(Pt=4),Lt===null||!(Ko&268435455)&&!(Sg&268435455)||Si(Lt,Yt)}function wp(r,e){var t=be;be|=2;var n=DI();(Lt!==r||Yt!==e)&&(Is=null,Bo(r,e));do try{TL();break}catch(s){OI(r,s)}while(!0);if(hw(),be=t,yp.current=n,Et!==null)throw Error(X(261));return Lt=null,Yt=0,Pt}function TL(){for(;Et!==null;)MI(Et)}function CL(){for(;Et!==null&&!YN();)MI(Et)}function MI(r){var e=LI(r.alternate,r,$r);r.memoizedProps=r.pendingProps,e===null?NI(r):Et=e,Ew.current=null}function NI(r){var e=r;do{var t=e.alternate;if(r=e.return,e.flags&32768){if(t=mL(t,e),t!==null){t.flags&=32767,Et=t;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Pt=6,Et=null;return}}else if(t=gL(t,e,$r),t!==null){Et=t;return}if(e=e.sibling,e!==null){Et=e;return}Et=e=r}while(e!==null);Pt===0&&(Pt=5)}function xo(r,e,t){var n=je,s=cn.transition;try{cn.transition=null,je=1,EL(r,e,t,n)}finally{cn.transition=s,je=n}return null}function EL(r,e,t,n){do yl();while(Pi!==null);if(be&6)throw Error(X(327));t=r.finishedWork;var s=r.finishedLanes;if(t===null)return null;if(r.finishedWork=null,r.finishedLanes=0,t===r.current)throw Error(X(177));r.callbackNode=null,r.callbackPriority=0;var i=t.lanes|t.childLanes;if(sF(r,i),r===Lt&&(Et=Lt=null,Yt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Cd||(Cd=!0,VI(tp,function(){return yl(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=cn.transition,cn.transition=null;var o=je;je=1;var a=be;be|=4,Ew.current=null,vL(r,t),II(t,r),WF(i0),np=!!s0,i0=s0=null,r.current=t,_L(t),XN(),be=a,je=o,cn.transition=i}else r.current=t;if(Cd&&(Cd=!1,Pi=r,_p=s),i=r.pendingLanes,i===0&&(Li=null),JN(t.stateNode),Or(r,ft()),e!==null)for(n=r.onRecoverableError,t=0;t<e.length;t++)s=e[t],n(s.value,{componentStack:s.stack,digest:s.digest});if(vp)throw vp=!1,r=x0,x0=null,r;return _p&1&&r.tag!==0&&yl(),i=r.pendingLanes,i&1?r===b0?du++:(du=0,b0=r):du=0,oo(),null}function yl(){if(Pi!==null){var r=gk(_p),e=cn.transition,t=je;try{if(cn.transition=null,je=16>r?16:r,Pi===null)var n=!1;else{if(r=Pi,Pi=null,_p=0,be&6)throw Error(X(331));var s=be;for(be|=4,ae=r.current;ae!==null;){var i=ae,o=i.child;if(ae.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ae=c;ae!==null;){var u=ae;switch(u.tag){case 0:case 11:case 15:uu(8,u,i)}var d=u.child;if(d!==null)d.return=u,ae=d;else for(;ae!==null;){u=ae;var f=u.sibling,p=u.return;if(bI(u),u===c){ae=null;break}if(f!==null){f.return=p,ae=f;break}ae=p}}}var m=i.alternate;if(m!==null){var v=m.child;if(v!==null){m.child=null;do{var T=v.sibling;v.sibling=null,v=T}while(v!==null)}}ae=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ae=o;else e:for(;ae!==null;){if(i=ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:uu(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,ae=w;break e}ae=i.return}}var y=r.current;for(ae=y;ae!==null;){o=ae;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,ae=C;else e:for(o=y;ae!==null;){if(a=ae,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:wg(9,a)}}catch(O){ct(a,a.return,O)}if(a===o){ae=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,ae=k;break e}ae=a.return}}if(be=s,oo(),is&&typeof is.onPostCommitFiberRoot=="function")try{is.onPostCommitFiberRoot(dg,r)}catch{}n=!0}return n}finally{je=t,cn.transition=e}}return!1}function j1(r,e,t){e=Nl(t,e),e=gI(r,e,1),r=Fi(r,e,1),e=yr(),r!==null&&(yh(r,1,e),Or(r,e))}function ct(r,e,t){if(r.tag===3)j1(r,r,t);else for(;e!==null;){if(e.tag===3){j1(e,r,t);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Li===null||!Li.has(n))){r=Nl(t,r),r=mI(e,r,1),e=Fi(e,r,1),r=yr(),e!==null&&(yh(e,1,r),Or(e,r));break}}e=e.return}}function xL(r,e,t){var n=r.pingCache;n!==null&&n.delete(e),e=yr(),r.pingedLanes|=r.suspendedLanes&t,Lt===r&&(Yt&t)===t&&(Pt===4||Pt===3&&(Yt&130023424)===Yt&&500>ft()-bw?Bo(r,0):xw|=t),Or(r,e)}function FI(r,e){e===0&&(r.mode&1?(e=fd,fd<<=1,!(fd&130023424)&&(fd=4194304)):e=1);var t=yr();r=Xs(r,e),r!==null&&(yh(r,e,t),Or(r,t))}function bL(r){var e=r.memoizedState,t=0;e!==null&&(t=e.retryLane),FI(r,t)}function AL(r,e){var t=0;switch(r.tag){case 13:var n=r.stateNode,s=r.memoizedState;s!==null&&(t=s.retryLane);break;case 19:n=r.stateNode;break;default:throw Error(X(314))}n!==null&&n.delete(e),FI(r,t)}var LI;LI=function(r,e,t){if(r!==null)if(r.memoizedProps!==e.pendingProps||Pr.current)Ir=!0;else{if(!(r.lanes&t)&&!(e.flags&128))return Ir=!1,pL(r,e,t);Ir=!!(r.flags&131072)}else Ir=!1,Je&&e.flags&1048576&&Uk(e,up,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;_f(r,e),r=e.pendingProps;var s=Rl(e,lr.current);ml(e,t),s=_w(null,e,n,r,s,t);var i=ww();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rr(n)?(i=!0,lp(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,pw(e),s.updater=_g,e.stateNode=s,s._reactInternals=e,p0(e,n,r,t),e=y0(null,e,n,!0,i,t)):(e.tag=0,Je&&i&&aw(e),dr(null,e,s,t),e=e.child),e;case 16:n=e.elementType;e:{switch(_f(r,e),r=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=IL(n),r=En(n,r),s){case 0:e=m0(null,e,n,r,t);break e;case 1:e=I1(null,e,n,r,t);break e;case 11:e=A1(null,e,n,r,t);break e;case 14:e=k1(null,e,n,En(n.type,r),t);break e}throw Error(X(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:En(n,s),m0(r,e,n,s,t);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:En(n,s),I1(r,e,n,s,t);case 3:e:{if(wI(e),r===null)throw Error(X(387));n=e.pendingProps,i=e.memoizedState,s=i.element,qk(r,e),fp(e,n,null,t);var o=e.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Nl(Error(X(423)),e),e=P1(r,e,n,t,s);break e}else if(n!==s){s=Nl(Error(X(424)),e),e=P1(r,e,n,t,s);break e}else for(zr=Ni(e.stateNode.containerInfo.firstChild),Hr=e,Je=!0,An=null,t=Hk(e,null,n,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Ol(),n===s){e=Ks(r,e,t);break e}dr(r,e,n,t)}e=e.child}return e;case 5:return Yk(e),r===null&&h0(e),n=e.type,s=e.pendingProps,i=r!==null?r.memoizedProps:null,o=s.children,o0(n,s)?o=null:i!==null&&o0(n,i)&&(e.flags|=32),_I(r,e),dr(r,e,o,t),e.child;case 6:return r===null&&h0(e),null;case 13:return SI(r,e,t);case 4:return gw(e,e.stateNode.containerInfo),n=e.pendingProps,r===null?e.child=Dl(e,null,n,t):dr(r,e,n,t),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:En(n,s),A1(r,e,n,s,t);case 7:return dr(r,e,e.pendingProps,t),e.child;case 8:return dr(r,e,e.pendingProps.children,t),e.child;case 12:return dr(r,e,e.pendingProps.children,t),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,qe(hp,n._currentValue),n._currentValue=o,i!==null)if($n(i.value,o)){if(i.children===s.children&&!Pr.current){e=Ks(r,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=$s(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),d0(i.return,t,e),a.lanes|=t;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(X(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),d0(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}dr(r,e,s.children,t),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,ml(e,t),s=dn(s),n=n(s),e.flags|=1,dr(r,e,n,t),e.child;case 14:return n=e.type,s=En(n,e.pendingProps),s=En(n.type,s),k1(r,e,n,s,t);case 15:return yI(r,e,e.type,e.pendingProps,t);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:En(n,s),_f(r,e),e.tag=1,Rr(n)?(r=!0,lp(e)):r=!1,ml(e,t),pI(e,n,s),p0(e,n,s,t),y0(null,e,n,!0,r,t);case 19:return TI(r,e,t);case 22:return vI(r,e,t)}throw Error(X(156,e.tag))};function VI(r,e){return hk(r,e)}function kL(r,e,t,n){this.tag=r,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ln(r,e,t,n){return new kL(r,e,t,n)}function Pw(r){return r=r.prototype,!(!r||!r.isReactComponent)}function IL(r){if(typeof r=="function")return Pw(r)?1:0;if(r!=null){if(r=r.$$typeof,r===X_)return 11;if(r===K_)return 14}return 2}function ji(r,e){var t=r.alternate;return t===null?(t=ln(r.tag,e,r.key,r.mode),t.elementType=r.elementType,t.type=r.type,t.stateNode=r.stateNode,t.alternate=r,r.alternate=t):(t.pendingProps=e,t.type=r.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=r.flags&14680064,t.childLanes=r.childLanes,t.lanes=r.lanes,t.child=r.child,t.memoizedProps=r.memoizedProps,t.memoizedState=r.memoizedState,t.updateQueue=r.updateQueue,e=r.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=r.sibling,t.index=r.index,t.ref=r.ref,t}function Tf(r,e,t,n,s,i){var o=2;if(n=r,typeof r=="function")Pw(r)&&(o=1);else if(typeof r=="string")o=5;else e:switch(r){case Qa:return zo(t.children,s,i,e);case Y_:o=8,s|=8;break;case Vv:return r=ln(12,t,e,s|2),r.elementType=Vv,r.lanes=i,r;case jv:return r=ln(13,t,e,s),r.elementType=jv,r.lanes=i,r;case $v:return r=ln(19,t,e,s),r.elementType=$v,r.lanes=i,r;case YA:return Tg(t,s,i,e);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case GA:o=10;break e;case qA:o=9;break e;case X_:o=11;break e;case K_:o=14;break e;case vi:o=16,n=null;break e}throw Error(X(130,r==null?r:typeof r,""))}return e=ln(o,t,e,s),e.elementType=r,e.type=n,e.lanes=i,e}function zo(r,e,t,n){return r=ln(7,r,n,e),r.lanes=t,r}function Tg(r,e,t,n){return r=ln(22,r,n,e),r.elementType=YA,r.lanes=t,r.stateNode={isHidden:!1},r}function zy(r,e,t){return r=ln(6,r,null,e),r.lanes=t,r}function Wy(r,e,t){return e=ln(4,r.children!==null?r.children:[],r.key,e),e.lanes=t,e.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},e}function PL(r,e,t,n,s){this.tag=e,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ey(0),this.expirationTimes=Ey(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ey(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Rw(r,e,t,n,s,i,o,a,l){return r=new PL(r,e,t,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ln(3,null,null,e),r.current=i,i.stateNode=r,i.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},pw(i),r}function RL(r,e,t){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ka,key:n==null?null:""+n,children:r,containerInfo:e,implementation:t}}function jI(r){if(!r)return Gi;r=r._reactInternals;e:{if(ha(r)!==r||r.tag!==1)throw Error(X(170));var e=r;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Rr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(X(171))}if(r.tag===1){var t=r.type;if(Rr(t))return jk(r,t,e)}return e}function $I(r,e,t,n,s,i,o,a,l){return r=Rw(t,n,!0,r,s,i,o,a,l),r.context=jI(null),t=r.current,n=yr(),s=Vi(t),i=$s(n,s),i.callback=e??null,Fi(t,i,s),r.current.lanes=s,yh(r,s,n),Or(r,n),r}function Cg(r,e,t,n){var s=e.current,i=yr(),o=Vi(s);return t=jI(t),e.context===null?e.context=t:e.pendingContext=t,e=$s(i,o),e.payload={element:r},n=n===void 0?null:n,n!==null&&(e.callback=n),r=Fi(s,e,o),r!==null&&(Ln(r,s,o,i),mf(r,s,o)),o}function Sp(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function $1(r,e){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var t=r.retryLane;r.retryLane=t!==0&&t<e?t:e}}function Ow(r,e){$1(r,e),(r=r.alternate)&&$1(r,e)}function OL(){return null}var UI=typeof reportError=="function"?reportError:function(r){console.error(r)};function Dw(r){this._internalRoot=r}Eg.prototype.render=Dw.prototype.render=function(r){var e=this._internalRoot;if(e===null)throw Error(X(409));Cg(r,e,null,null)};Eg.prototype.unmount=Dw.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var e=r.containerInfo;Qo(function(){Cg(null,r,null,null)}),e[Ys]=null}};function Eg(r){this._internalRoot=r}Eg.prototype.unstable_scheduleHydration=function(r){if(r){var e=vk();r={blockedOn:null,target:r,priority:e};for(var t=0;t<wi.length&&e!==0&&e<wi[t].priority;t++);wi.splice(t,0,r),t===0&&wk(r)}};function Mw(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function xg(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function U1(){}function DL(r,e,t,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var c=Sp(o);i.call(c)}}var o=$I(e,n,r,0,null,!1,!1,"",U1);return r._reactRootContainer=o,r[Ys]=o.current,Nu(r.nodeType===8?r.parentNode:r),Qo(),o}for(;s=r.lastChild;)r.removeChild(s);if(typeof n=="function"){var a=n;n=function(){var c=Sp(l);a.call(c)}}var l=Rw(r,0,!1,null,null,!1,!1,"",U1);return r._reactRootContainer=l,r[Ys]=l.current,Nu(r.nodeType===8?r.parentNode:r),Qo(function(){Cg(e,l,t,n)}),l}function bg(r,e,t,n,s){var i=t._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Sp(o);a.call(l)}}Cg(e,o,r,s)}else o=DL(t,e,r,s,n);return Sp(o)}mk=function(r){switch(r.tag){case 3:var e=r.stateNode;if(e.current.memoizedState.isDehydrated){var t=Hc(e.pendingLanes);t!==0&&(Z_(e,t|1),Or(e,ft()),!(be&6)&&(Fl=ft()+500,oo()))}break;case 13:Qo(function(){var n=Xs(r,1);if(n!==null){var s=yr();Ln(n,r,1,s)}}),Ow(r,1)}};ew=function(r){if(r.tag===13){var e=Xs(r,134217728);if(e!==null){var t=yr();Ln(e,r,134217728,t)}Ow(r,134217728)}};yk=function(r){if(r.tag===13){var e=Vi(r),t=Xs(r,e);if(t!==null){var n=yr();Ln(t,r,e,n)}Ow(r,e)}};vk=function(){return je};_k=function(r,e){var t=je;try{return je=r,e()}finally{je=t}};Kv=function(r,e,t){switch(e){case"input":if(zv(r,t),e=t.name,t.type==="radio"&&e!=null){for(t=r;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var n=t[e];if(n!==r&&n.form===r.form){var s=mg(n);if(!s)throw Error(X(90));KA(n),zv(n,s)}}}break;case"textarea":JA(r,t);break;case"select":e=t.value,e!=null&&dl(r,!!t.multiple,e,!1)}};ik=Aw;ok=Qo;var ML={usingClientEntryPoint:!1,Events:[_h,tl,mg,nk,sk,Aw]},Nc={findFiberByHostInstance:Ro,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NL={bundleType:Nc.bundleType,version:Nc.version,rendererPackageName:Nc.rendererPackageName,rendererConfig:Nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:li.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=ck(r),r===null?null:r.stateNode},findFiberByHostInstance:Nc.findFiberByHostInstance||OL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ed=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ed.isDisabled&&Ed.supportsFiber)try{dg=Ed.inject(NL),is=Ed}catch{}}Jr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ML;Jr.createPortal=function(r,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mw(e))throw Error(X(200));return RL(r,e,null,t)};Jr.createRoot=function(r,e){if(!Mw(r))throw Error(X(299));var t=!1,n="",s=UI;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Rw(r,1,!1,null,null,t,!1,n,s),r[Ys]=e.current,Nu(r.nodeType===8?r.parentNode:r),new Dw(e)};Jr.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var e=r._reactInternals;if(e===void 0)throw typeof r.render=="function"?Error(X(188)):(r=Object.keys(r).join(","),Error(X(268,r)));return r=ck(e),r=r===null?null:r.stateNode,r};Jr.flushSync=function(r){return Qo(r)};Jr.hydrate=function(r,e,t){if(!xg(e))throw Error(X(200));return bg(null,r,e,!0,t)};Jr.hydrateRoot=function(r,e,t){if(!Mw(r))throw Error(X(405));var n=t!=null&&t.hydratedSources||null,s=!1,i="",o=UI;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=$I(e,null,r,1,t??null,s,!1,i,o),r[Ys]=e.current,Nu(r),n)for(r=0;r<n.length;r++)t=n[r],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Eg(e)};Jr.render=function(r,e,t){if(!xg(e))throw Error(X(200));return bg(null,r,e,!1,t)};Jr.unmountComponentAtNode=function(r){if(!xg(r))throw Error(X(40));return r._reactRootContainer?(Qo(function(){bg(null,null,r,!1,function(){r._reactRootContainer=null,r[Ys]=null})}),!0):!1};Jr.unstable_batchedUpdates=Aw;Jr.unstable_renderSubtreeIntoContainer=function(r,e,t,n){if(!xg(t))throw Error(X(200));if(r==null||r._reactInternals===void 0)throw Error(X(38));return bg(r,e,t,!1,n)};Jr.version="18.3.1-next-f1338f8080-20240426";function BI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(BI)}catch(r){console.error(r)}}BI(),BA.exports=Jr;var FL=BA.exports,zI,B1=FL;zI=B1.createRoot,B1.hydrateRoot;var WI={exports:{}},HI={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sh=L;function LL(r,e){return r===e&&(r!==0||1/r===1/e)||r!==r&&e!==e}var VL=typeof Object.is=="function"?Object.is:LL,jL=Sh.useSyncExternalStore,$L=Sh.useRef,UL=Sh.useEffect,BL=Sh.useMemo,zL=Sh.useDebugValue;HI.useSyncExternalStoreWithSelector=function(r,e,t,n,s){var i=$L(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=BL(function(){function l(p){if(!c){if(c=!0,u=p,p=n(p),s!==void 0&&o.hasValue){var m=o.value;if(s(m,p))return d=m}return d=p}if(m=d,VL(u,p))return m;var v=n(p);return s!==void 0&&s(m,v)?(u=p,m):(u=p,d=v)}var c=!1,u,d,f=t===void 0?null:t;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,t,n,s]);var a=jL(r,i[0],i[1]);return UL(function(){o.hasValue=!0,o.value=a},[a]),zL(a),a};WI.exports=HI;var WL=WI.exports;function HL(r){r()}function GL(){let r=null,e=null;return{clear(){r=null,e=null},notify(){HL(()=>{let t=r;for(;t;)t.callback(),t=t.next})},get(){const t=[];let n=r;for(;n;)t.push(n),n=n.next;return t},subscribe(t){let n=!0;const s=e={callback:t,next:null,prev:e};return s.prev?s.prev.next=s:r=s,function(){!n||r===null||(n=!1,s.next?s.next.prev=s.prev:e=s.prev,s.prev?s.prev.next=s.next:r=s.next)}}}}var z1={notify(){},get:()=>[]};function qL(r,e){let t,n=z1,s=0,i=!1;function o(v){u();const T=n.subscribe(v);let w=!1;return()=>{w||(w=!0,T(),d())}}function a(){n.notify()}function l(){m.onStateChange&&m.onStateChange()}function c(){return i}function u(){s++,t||(t=r.subscribe(l),n=GL())}function d(){s--,t&&s===0&&(t(),t=void 0,n.clear(),n=z1)}function f(){i||(i=!0,u())}function p(){i&&(i=!1,d())}const m={addNestedSub:o,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:c,trySubscribe:f,tryUnsubscribe:p,getListeners:()=>n};return m}var YL=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",XL=YL(),KL=()=>typeof navigator<"u"&&navigator.product==="ReactNative",QL=KL(),JL=()=>XL||QL?L.useLayoutEffect:L.useEffect,ZL=JL(),Hy=Symbol.for("react-redux-context"),Gy=typeof globalThis<"u"?globalThis:{};function eV(){if(!L.createContext)return{};const r=Gy[Hy]??(Gy[Hy]=new Map);let e=r.get(L.createContext);return e||(e=L.createContext(null),r.set(L.createContext,e)),e}var qi=eV();function tV(r){const{children:e,context:t,serverState:n,store:s}=r,i=L.useMemo(()=>{const l=qL(s);return{store:s,subscription:l,getServerState:n?()=>n:void 0}},[s,n]),o=L.useMemo(()=>s.getState(),[s]);ZL(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==s.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,o]);const a=t||qi;return L.createElement(a.Provider,{value:i},e)}var rV=tV;function Nw(r=qi){return function(){return L.useContext(r)}}var GI=Nw();function qI(r=qi){const e=r===qi?GI:Nw(r),t=()=>{const{store:n}=e();return n};return Object.assign(t,{withTypes:()=>t}),t}var nV=qI();function sV(r=qi){const e=r===qi?nV:qI(r),t=()=>e().dispatch;return Object.assign(t,{withTypes:()=>t}),t}var iV=sV(),oV=(r,e)=>r===e;function aV(r=qi){const e=r===qi?GI:Nw(r),t=(n,s={})=>{const{equalityFn:i=oV}=typeof s=="function"?{equalityFn:s}:s,o=e(),{store:a,subscription:l,getServerState:c}=o;L.useRef(!0);const u=L.useCallback({[n.name](f){return n(f)}}[n.name],[n]),d=WL.useSyncExternalStoreWithSelector(l.addNestedSub,a.getState,c||a.getState,u,i);return L.useDebugValue(d),d};return Object.assign(t,{withTypes:()=>t}),t}var lV=aV();/**
 * react-router v7.8.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var W1="popstate";function cV(r={}){function e(n,s){let{pathname:i,search:o,hash:a}=n.location;return I0("",{pathname:i,search:o,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:Wu(s)}return hV(e,t,null,r)}function nt(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function fs(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function uV(){return Math.random().toString(36).substring(2,10)}function H1(r,e){return{usr:r.state,key:r.key,idx:e}}function I0(r,e,t=null,n){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof e=="string"?Xl(e):e,state:t,key:e&&e.key||n||uV()}}function Wu({pathname:r="/",search:e="",hash:t=""}){return e&&e!=="?"&&(r+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(r+=t.charAt(0)==="#"?t:"#"+t),r}function Xl(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substring(t),r=r.substring(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substring(n),r=r.substring(0,n)),r&&(e.pathname=r)}return e}function hV(r,e,t,n={}){let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,a="POP",l=null,c=u();c==null&&(c=0,o.replaceState({...o.state,idx:c},""));function u(){return(o.state||{idx:null}).idx}function d(){a="POP";let T=u(),w=T==null?null:T-c;c=T,l&&l({action:a,location:v.location,delta:w})}function f(T,w){a="PUSH";let y=I0(v.location,T,w);c=u()+1;let C=H1(y,c),k=v.createHref(y);try{o.pushState(C,"",k)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(k)}i&&l&&l({action:a,location:v.location,delta:1})}function p(T,w){a="REPLACE";let y=I0(v.location,T,w);c=u();let C=H1(y,c),k=v.createHref(y);o.replaceState(C,"",k),i&&l&&l({action:a,location:v.location,delta:0})}function m(T){return dV(T)}let v={get action(){return a},get location(){return r(s,o)},listen(T){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(W1,d),l=T,()=>{s.removeEventListener(W1,d),l=null}},createHref(T){return e(s,T)},createURL:m,encodeLocation(T){let w=m(T);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:f,replace:p,go(T){return o.go(T)}};return v}function dV(r,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),nt(t,"No window.location.(origin|href) available to create URL");let n=typeof r=="string"?r:Wu(r);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function YI(r,e,t="/"){return fV(r,e,t,!1)}function fV(r,e,t,n){let s=typeof e=="string"?Xl(e):e,i=Qs(s.pathname||"/",t);if(i==null)return null;let o=XI(r);pV(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let c=xV(i);a=CV(o[l],c,n)}return a}function XI(r,e=[],t=[],n="",s=!1){let i=(o,a,l=s,c)=>{let u={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:a,route:o};if(u.relativePath.startsWith("/")){if(!u.relativePath.startsWith(n)&&l)return;nt(u.relativePath.startsWith(n),`Absolute route path "${u.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(n.length)}let d=Us([n,u.relativePath]),f=t.concat(u);o.children&&o.children.length>0&&(nt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),XI(o.children,e,f,d,l)),!(o.path==null&&!o.index)&&e.push({path:d,score:SV(d,o.index),routesMeta:f})};return r.forEach((o,a)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))i(o,a);else for(let c of KI(o.path))i(o,a,!0,c)}),e}function KI(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=KI(n.join("/")),a=[];return a.push(...o.map(l=>l===""?i:[i,l].join("/"))),s&&a.push(...o),a.map(l=>r.startsWith("/")&&l===""?"/":l)}function pV(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:TV(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var gV=/^:[\w-]+$/,mV=3,yV=2,vV=1,_V=10,wV=-2,G1=r=>r==="*";function SV(r,e){let t=r.split("/"),n=t.length;return t.some(G1)&&(n+=wV),e&&(n+=yV),t.filter(s=>!G1(s)).reduce((s,i)=>s+(gV.test(i)?mV:i===""?vV:_V),n)}function TV(r,e){return r.length===e.length&&r.slice(0,-1).every((n,s)=>n===e[s])?r[r.length-1]-e[e.length-1]:0}function CV(r,e,t=!1){let{routesMeta:n}=r,s={},i="/",o=[];for(let a=0;a<n.length;++a){let l=n[a],c=a===n.length-1,u=i==="/"?e:e.slice(i.length)||"/",d=Tp({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),f=l.route;if(!d&&c&&t&&!n[n.length-1].route.index&&(d=Tp({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:Us([i,d.pathname]),pathnameBase:IV(Us([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=Us([i,d.pathnameBase]))}return o}function Tp(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=EV(r.path,r.caseSensitive,r.end),s=e.match(t);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:n.reduce((c,{paramName:u,isOptional:d},f)=>{if(u==="*"){let m=a[f]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[f];return d&&!p?c[u]=void 0:c[u]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:r}}function EV(r,e=!1,t=!0){fs(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let n=[],s="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(n.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(n.push({paramName:"*"}),s+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":r!==""&&r!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function xV(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return fs(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),r}}function Qs(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function bV(r,e="/"){let{pathname:t,search:n="",hash:s=""}=typeof r=="string"?Xl(r):r;return{pathname:t?t.startsWith("/")?t:AV(t,e):e,search:PV(n),hash:RV(s)}}function AV(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function qy(r,e,t,n){return`Cannot include a '${r}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function kV(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function QI(r){let e=kV(r);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function JI(r,e,t,n=!1){let s;typeof r=="string"?s=Xl(r):(s={...r},nt(!s.pathname||!s.pathname.includes("?"),qy("?","pathname","search",s)),nt(!s.pathname||!s.pathname.includes("#"),qy("#","pathname","hash",s)),nt(!s.search||!s.search.includes("#"),qy("#","search","hash",s)));let i=r===""||s.pathname==="",o=i?"/":s.pathname,a;if(o==null)a=t;else{let d=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=bV(s,a),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Us=r=>r.join("/").replace(/\/\/+/g,"/"),IV=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),PV=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,RV=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function OV(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}var ZI=["POST","PUT","PATCH","DELETE"];new Set(ZI);var DV=["GET",...ZI];new Set(DV);var Kl=L.createContext(null);Kl.displayName="DataRouter";var Ag=L.createContext(null);Ag.displayName="DataRouterState";L.createContext(!1);var e2=L.createContext({isTransitioning:!1});e2.displayName="ViewTransition";var MV=L.createContext(new Map);MV.displayName="Fetchers";var NV=L.createContext(null);NV.displayName="Await";var _s=L.createContext(null);_s.displayName="Navigation";var Th=L.createContext(null);Th.displayName="Location";var ws=L.createContext({outlet:null,matches:[],isDataRoute:!1});ws.displayName="Route";var Fw=L.createContext(null);Fw.displayName="RouteError";function FV(r,{relative:e}={}){nt(Ch(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=L.useContext(_s),{hash:s,pathname:i,search:o}=Eh(r,{relative:e}),a=i;return t!=="/"&&(a=i==="/"?t:Us([t,i])),n.createHref({pathname:a,search:o,hash:s})}function Ch(){return L.useContext(Th)!=null}function da(){return nt(Ch(),"useLocation() may be used only in the context of a <Router> component."),L.useContext(Th).location}var t2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function r2(r){L.useContext(_s).static||L.useLayoutEffect(r)}function kg(){let{isDataRoute:r}=L.useContext(ws);return r?KV():LV()}function LV(){nt(Ch(),"useNavigate() may be used only in the context of a <Router> component.");let r=L.useContext(Kl),{basename:e,navigator:t}=L.useContext(_s),{matches:n}=L.useContext(ws),{pathname:s}=da(),i=JSON.stringify(QI(n)),o=L.useRef(!1);return r2(()=>{o.current=!0}),L.useCallback((l,c={})=>{if(fs(o.current,t2),!o.current)return;if(typeof l=="number"){t.go(l);return}let u=JI(l,JSON.parse(i),s,c.relative==="path");r==null&&e!=="/"&&(u.pathname=u.pathname==="/"?e:Us([e,u.pathname])),(c.replace?t.replace:t.push)(u,c.state,c)},[e,t,i,s,r])}L.createContext(null);function VV(){let{matches:r}=L.useContext(ws),e=r[r.length-1];return e?e.params:{}}function Eh(r,{relative:e}={}){let{matches:t}=L.useContext(ws),{pathname:n}=da(),s=JSON.stringify(QI(t));return L.useMemo(()=>JI(r,JSON.parse(s),n,e==="path"),[r,s,n,e])}function jV(r,e){return n2(r,e)}function n2(r,e,t,n){var w;nt(Ch(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=L.useContext(_s),{matches:i}=L.useContext(ws),o=i[i.length-1],a=o?o.params:{},l=o?o.pathname:"/",c=o?o.pathnameBase:"/",u=o&&o.route;{let y=u&&u.path||"";s2(l,!u||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let d=da(),f;if(e){let y=typeof e=="string"?Xl(e):e;nt(c==="/"||((w=y.pathname)==null?void 0:w.startsWith(c)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${c}" but pathname "${y.pathname}" was given in the \`location\` prop.`),f=y}else f=d;let p=f.pathname||"/",m=p;if(c!=="/"){let y=c.replace(/^\//,"").split("/");m="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let v=YI(r,{pathname:m});fs(u||v!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),fs(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=WV(v&&v.map(y=>Object.assign({},y,{params:Object.assign({},a,y.params),pathname:Us([c,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Us([c,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,t,n);return e&&T?L.createElement(Th.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},T):T}function $V(){let r=XV(),e=OV(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",r),o=L.createElement(L.Fragment,null,L.createElement("p",null,"💿 Hey developer 👋"),L.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",L.createElement("code",{style:i},"ErrorBoundary")," or"," ",L.createElement("code",{style:i},"errorElement")," prop on your route.")),L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},e),t?L.createElement("pre",{style:s},t):null,o)}var UV=L.createElement($V,null),BV=class extends L.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,e){return e.location!==r.location||e.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:e.error,location:e.location,revalidation:r.revalidation||e.revalidation}}componentDidCatch(r,e){console.error("React Router caught the following error during render",r,e)}render(){return this.state.error!==void 0?L.createElement(ws.Provider,{value:this.props.routeContext},L.createElement(Fw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function zV({routeContext:r,match:e,children:t}){let n=L.useContext(Kl);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),L.createElement(ws.Provider,{value:r},t)}function WV(r,e=[],t=null,n=null){if(r==null){if(!t)return null;if(t.errors)r=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let s=r,i=t==null?void 0:t.errors;if(i!=null){let l=s.findIndex(c=>c.route.id&&(i==null?void 0:i[c.route.id])!==void 0);nt(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,l+1))}let o=!1,a=-1;if(t)for(let l=0;l<s.length;l++){let c=s[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(a=l),c.route.id){let{loaderData:u,errors:d}=t,f=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!d||d[c.route.id]===void 0);if(c.route.lazy||f){o=!0,a>=0?s=s.slice(0,a+1):s=[s[0]];break}}}return s.reduceRight((l,c,u)=>{let d,f=!1,p=null,m=null;t&&(d=i&&c.route.id?i[c.route.id]:void 0,p=c.route.errorElement||UV,o&&(a<0&&u===0?(s2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):a===u&&(f=!0,m=c.route.hydrateFallbackElement||null)));let v=e.concat(s.slice(0,u+1)),T=()=>{let w;return d?w=p:f?w=m:c.route.Component?w=L.createElement(c.route.Component,null):c.route.element?w=c.route.element:w=l,L.createElement(zV,{match:c,routeContext:{outlet:l,matches:v,isDataRoute:t!=null},children:w})};return t&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?L.createElement(BV,{location:t.location,revalidation:t.revalidation,component:p,error:d,children:T(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):T()},null)}function Lw(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function HV(r){let e=L.useContext(Kl);return nt(e,Lw(r)),e}function GV(r){let e=L.useContext(Ag);return nt(e,Lw(r)),e}function qV(r){let e=L.useContext(ws);return nt(e,Lw(r)),e}function Vw(r){let e=qV(r),t=e.matches[e.matches.length-1];return nt(t.route.id,`${r} can only be used on routes that contain a unique "id"`),t.route.id}function YV(){return Vw("useRouteId")}function XV(){var n;let r=L.useContext(Fw),e=GV("useRouteError"),t=Vw("useRouteError");return r!==void 0?r:(n=e.errors)==null?void 0:n[t]}function KV(){let{router:r}=HV("useNavigate"),e=Vw("useNavigate"),t=L.useRef(!1);return r2(()=>{t.current=!0}),L.useCallback(async(s,i={})=>{fs(t.current,t2),t.current&&(typeof s=="number"?r.navigate(s):await r.navigate(s,{fromRouteId:e,...i}))},[r,e])}var q1={};function s2(r,e,t){!e&&!q1[r]&&(q1[r]=!0,fs(!1,t))}L.memo(QV);function QV({routes:r,future:e,state:t}){return n2(r,void 0,t,e)}function qc(r){nt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function JV({basename:r="/",children:e=null,location:t,navigationType:n="POP",navigator:s,static:i=!1}){nt(!Ch(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=r.replace(/^\/*/,"/"),a=L.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof t=="string"&&(t=Xl(t));let{pathname:l="/",search:c="",hash:u="",state:d=null,key:f="default"}=t,p=L.useMemo(()=>{let m=Qs(l,o);return m==null?null:{location:{pathname:m,search:c,hash:u,state:d,key:f},navigationType:n}},[o,l,c,u,d,f,n]);return fs(p!=null,`<Router basename="${o}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:L.createElement(_s.Provider,{value:a},L.createElement(Th.Provider,{children:e,value:p}))}function ZV({children:r,location:e}){return jV(P0(r),e)}function P0(r,e=[]){let t=[];return L.Children.forEach(r,(n,s)=>{if(!L.isValidElement(n))return;let i=[...e,s];if(n.type===L.Fragment){t.push.apply(t,P0(n.props.children,i));return}nt(n.type===qc,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),nt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=P0(n.props.children,i)),t.push(o)}),t}var Cf="get",Ef="application/x-www-form-urlencoded";function Ig(r){return r!=null&&typeof r.tagName=="string"}function ej(r){return Ig(r)&&r.tagName.toLowerCase()==="button"}function tj(r){return Ig(r)&&r.tagName.toLowerCase()==="form"}function rj(r){return Ig(r)&&r.tagName.toLowerCase()==="input"}function nj(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function sj(r,e){return r.button===0&&(!e||e==="_self")&&!nj(r)}var xd=null;function ij(){if(xd===null)try{new FormData(document.createElement("form"),0),xd=!1}catch{xd=!0}return xd}var oj=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Yy(r){return r!=null&&!oj.has(r)?(fs(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ef}"`),null):r}function aj(r,e){let t,n,s,i,o;if(tj(r)){let a=r.getAttribute("action");n=a?Qs(a,e):null,t=r.getAttribute("method")||Cf,s=Yy(r.getAttribute("enctype"))||Ef,i=new FormData(r)}else if(ej(r)||rj(r)&&(r.type==="submit"||r.type==="image")){let a=r.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=r.getAttribute("formaction")||a.getAttribute("action");if(n=l?Qs(l,e):null,t=r.getAttribute("formmethod")||a.getAttribute("method")||Cf,s=Yy(r.getAttribute("formenctype"))||Yy(a.getAttribute("enctype"))||Ef,i=new FormData(a,r),!ij()){let{name:c,type:u,value:d}=r;if(u==="image"){let f=c?`${c}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else c&&i.append(c,d)}}else{if(Ig(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Cf,n=null,s=Ef,o=r}return i&&s==="text/plain"&&(o=i,i=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function jw(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function lj(r,e,t){let n=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return n.pathname==="/"?n.pathname=`_root.${t}`:e&&Qs(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${t}`,n}async function cj(r,e){if(r.id in e)return e[r.id];try{let t=await import(r.module);return e[r.id]=t,t}catch(t){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function uj(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function hj(r,e,t){let n=await Promise.all(r.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await cj(i,t);return o.links?o.links():[]}return[]}));return gj(n.flat(1).filter(uj).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Y1(r,e,t,n,s,i){let o=(l,c)=>t[c]?l.route.id!==t[c].route.id:!0,a=(l,c)=>{var u;return t[c].pathname!==l.pathname||((u=t[c].route.path)==null?void 0:u.endsWith("*"))&&t[c].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,c)=>o(l,c)||a(l,c)):i==="data"?e.filter((l,c)=>{var d;let u=n.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(o(l,c)||a(l,c))return!0;if(l.route.shouldRevalidate){let f=l.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((d=t[0])==null?void 0:d.params)||{},nextUrl:new URL(r,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function dj(r,e,{includeHydrateFallback:t}={}){return fj(r.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function fj(r){return[...new Set(r)]}function pj(r){let e={},t=Object.keys(r).sort();for(let n of t)e[n]=r[n];return e}function gj(r,e){let t=new Set;return new Set(e),r.reduce((n,s)=>{let i=JSON.stringify(pj(s));return t.has(i)||(t.add(i),n.push({key:i,link:s})),n},[])}function i2(){let r=L.useContext(Kl);return jw(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function mj(){let r=L.useContext(Ag);return jw(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var $w=L.createContext(void 0);$w.displayName="FrameworkContext";function o2(){let r=L.useContext($w);return jw(r,"You must render this element inside a <HydratedRouter> element"),r}function yj(r,e){let t=L.useContext($w),[n,s]=L.useState(!1),[i,o]=L.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:d}=e,f=L.useRef(null);L.useEffect(()=>{if(r==="render"&&o(!0),r==="viewport"){let v=w=>{w.forEach(y=>{o(y.isIntersecting)})},T=new IntersectionObserver(v,{threshold:.5});return f.current&&T.observe(f.current),()=>{T.disconnect()}}},[r]),L.useEffect(()=>{if(n){let v=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(v)}}},[n]);let p=()=>{s(!0)},m=()=>{s(!1),o(!1)};return t?r!=="intent"?[i,f,{}]:[i,f,{onFocus:Fc(a,p),onBlur:Fc(l,m),onMouseEnter:Fc(c,p),onMouseLeave:Fc(u,m),onTouchStart:Fc(d,p)}]:[!1,f,{}]}function Fc(r,e){return t=>{r&&r(t),t.defaultPrevented||e(t)}}function vj({page:r,...e}){let{router:t}=i2(),n=L.useMemo(()=>YI(t.routes,r,t.basename),[t.routes,r,t.basename]);return n?L.createElement(wj,{page:r,matches:n,...e}):null}function _j(r){let{manifest:e,routeModules:t}=o2(),[n,s]=L.useState([]);return L.useEffect(()=>{let i=!1;return hj(r,e,t).then(o=>{i||s(o)}),()=>{i=!0}},[r,e,t]),n}function wj({page:r,matches:e,...t}){let n=da(),{manifest:s,routeModules:i}=o2(),{basename:o}=i2(),{loaderData:a,matches:l}=mj(),c=L.useMemo(()=>Y1(r,e,l,s,n,"data"),[r,e,l,s,n]),u=L.useMemo(()=>Y1(r,e,l,s,n,"assets"),[r,e,l,s,n]),d=L.useMemo(()=>{if(r===n.pathname+n.search+n.hash)return[];let m=new Set,v=!1;if(e.forEach(w=>{var C;let y=s.routes[w.route.id];!y||!y.hasLoader||(!c.some(k=>k.route.id===w.route.id)&&w.route.id in a&&((C=i[w.route.id])!=null&&C.shouldRevalidate)||y.hasClientLoader?v=!0:m.add(w.route.id))}),m.size===0)return[];let T=lj(r,o,"data");return v&&m.size>0&&T.searchParams.set("_routes",e.filter(w=>m.has(w.route.id)).map(w=>w.route.id).join(",")),[T.pathname+T.search]},[o,a,n,s,c,e,r,i]),f=L.useMemo(()=>dj(u,s),[u,s]),p=_j(u);return L.createElement(L.Fragment,null,d.map(m=>L.createElement("link",{key:m,rel:"prefetch",as:"fetch",href:m,...t})),f.map(m=>L.createElement("link",{key:m,rel:"modulepreload",href:m,...t})),p.map(({key:m,link:v})=>L.createElement("link",{key:m,nonce:t.nonce,...v})))}function Sj(...r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var a2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{a2&&(window.__reactRouterVersion="7.8.1")}catch{}function Tj({basename:r,children:e,window:t}){let n=L.useRef();n.current==null&&(n.current=cV({window:t,v5Compat:!0}));let s=n.current,[i,o]=L.useState({action:s.action,location:s.location}),a=L.useCallback(l=>{L.startTransition(()=>o(l))},[o]);return L.useLayoutEffect(()=>s.listen(a),[s,a]),L.createElement(JV,{basename:r,children:e,location:i.location,navigationType:i.action,navigator:s})}var l2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jo=L.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:s,reloadDocument:i,replace:o,state:a,target:l,to:c,preventScrollReset:u,viewTransition:d,...f},p){let{basename:m}=L.useContext(_s),v=typeof c=="string"&&l2.test(c),T,w=!1;if(typeof c=="string"&&v&&(T=c,a2))try{let A=new URL(window.location.href),P=c.startsWith("//")?new URL(A.protocol+c):new URL(c),R=Qs(P.pathname,m);P.origin===A.origin&&R!=null?c=R+P.search+P.hash:w=!0}catch{fs(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let y=FV(c,{relative:s}),[C,k,O]=yj(n,f),M=bj(c,{replace:o,state:a,target:l,preventScrollReset:u,relative:s,viewTransition:d});function x(A){e&&e(A),A.defaultPrevented||M(A)}let E=L.createElement("a",{...f,...O,href:T||y,onClick:w||i?e:x,ref:Sj(p,k),target:l,"data-discover":!v&&t==="render"?"true":void 0});return C&&!v?L.createElement(L.Fragment,null,E,L.createElement(vj,{page:y})):E});Jo.displayName="Link";var Cj=L.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:s=!1,style:i,to:o,viewTransition:a,children:l,...c},u){let d=Eh(o,{relative:c.relative}),f=da(),p=L.useContext(Ag),{navigator:m,basename:v}=L.useContext(_s),T=p!=null&&Rj(d)&&a===!0,w=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,y=f.pathname,C=p&&p.navigation&&p.navigation.location?p.navigation.location.pathname:null;t||(y=y.toLowerCase(),C=C?C.toLowerCase():null,w=w.toLowerCase()),C&&v&&(C=Qs(C,v)||C);const k=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let O=y===w||!s&&y.startsWith(w)&&y.charAt(k)==="/",M=C!=null&&(C===w||!s&&C.startsWith(w)&&C.charAt(w.length)==="/"),x={isActive:O,isPending:M,isTransitioning:T},E=O?e:void 0,A;typeof n=="function"?A=n(x):A=[n,O?"active":null,M?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let P=typeof i=="function"?i(x):i;return L.createElement(Jo,{...c,"aria-current":E,className:A,ref:u,style:P,to:o,viewTransition:a},typeof l=="function"?l(x):l)});Cj.displayName="NavLink";var Ej=L.forwardRef(({discover:r="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:s,state:i,method:o=Cf,action:a,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:d,...f},p)=>{let m=Ij(),v=Pj(a,{relative:c}),T=o.toLowerCase()==="get"?"get":"post",w=typeof a=="string"&&l2.test(a),y=C=>{if(l&&l(C),C.defaultPrevented)return;C.preventDefault();let k=C.nativeEvent.submitter,O=(k==null?void 0:k.getAttribute("formmethod"))||o;m(k||C.currentTarget,{fetcherKey:e,method:O,navigate:t,replace:s,state:i,relative:c,preventScrollReset:u,viewTransition:d})};return L.createElement("form",{ref:p,method:T,action:v,onSubmit:n?l:y,...f,"data-discover":!w&&r==="render"?"true":void 0})});Ej.displayName="Form";function xj(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function c2(r){let e=L.useContext(Kl);return nt(e,xj(r)),e}function bj(r,{target:e,replace:t,state:n,preventScrollReset:s,relative:i,viewTransition:o}={}){let a=kg(),l=da(),c=Eh(r,{relative:i});return L.useCallback(u=>{if(sj(u,e)){u.preventDefault();let d=t!==void 0?t:Wu(l)===Wu(c);a(r,{replace:d,state:n,preventScrollReset:s,relative:i,viewTransition:o})}},[l,a,c,t,n,e,r,s,i,o])}var Aj=0,kj=()=>`__${String(++Aj)}__`;function Ij(){let{router:r}=c2("useSubmit"),{basename:e}=L.useContext(_s),t=YV();return L.useCallback(async(n,s={})=>{let{action:i,method:o,encType:a,formData:l,body:c}=aj(n,e);if(s.navigate===!1){let u=s.fetcherKey||kj();await r.fetch(u,t,s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||o,formEncType:s.encType||a,flushSync:s.flushSync})}else await r.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:l,body:c,formMethod:s.method||o,formEncType:s.encType||a,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[r,e,t])}function Pj(r,{relative:e}={}){let{basename:t}=L.useContext(_s),n=L.useContext(ws);nt(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),i={...Eh(r||".",{relative:e})},o=da();if(r==null){i.search=o.search;let a=new URLSearchParams(i.search),l=a.getAll("index");if(l.some(u=>u==="")){a.delete("index"),l.filter(d=>d).forEach(d=>a.append("index",d));let u=a.toString();i.search=u?`?${u}`:""}}return(!r||r===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(i.pathname=i.pathname==="/"?t:Us([t,i.pathname])),Wu(i)}function Rj(r,{relative:e}={}){let t=L.useContext(e2);nt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=c2("useViewTransitionState"),s=Eh(r,{relative:e});if(!t.isTransitioning)return!1;let i=Qs(t.currentLocation.pathname,n)||t.currentLocation.pathname,o=Qs(t.nextLocation.pathname,n)||t.nextLocation.pathname;return Tp(s.pathname,o)!=null||Tp(s.pathname,i)!=null}function Zo(r,...e){const t=new URL(`https://mui.com/production-error/?code=${r}`);return e.forEach(n=>t.searchParams.append("args[]",n)),`Minified MUI error #${r}; visit ${t} for the full message.`}function u2(r){if(typeof r!="string")throw new Error(Zo(7));return r.charAt(0).toUpperCase()+r.slice(1)}var h2={exports:{}},We={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uw=Symbol.for("react.transitional.element"),Bw=Symbol.for("react.portal"),Pg=Symbol.for("react.fragment"),Rg=Symbol.for("react.strict_mode"),Og=Symbol.for("react.profiler"),Dg=Symbol.for("react.consumer"),Mg=Symbol.for("react.context"),Ng=Symbol.for("react.forward_ref"),Fg=Symbol.for("react.suspense"),Lg=Symbol.for("react.suspense_list"),Vg=Symbol.for("react.memo"),jg=Symbol.for("react.lazy"),Oj=Symbol.for("react.view_transition"),Dj=Symbol.for("react.client.reference");function yn(r){if(typeof r=="object"&&r!==null){var e=r.$$typeof;switch(e){case Uw:switch(r=r.type,r){case Pg:case Og:case Rg:case Fg:case Lg:case Oj:return r;default:switch(r=r&&r.$$typeof,r){case Mg:case Ng:case jg:case Vg:return r;case Dg:return r;default:return e}}case Bw:return e}}}We.ContextConsumer=Dg;We.ContextProvider=Mg;We.Element=Uw;We.ForwardRef=Ng;We.Fragment=Pg;We.Lazy=jg;We.Memo=Vg;We.Portal=Bw;We.Profiler=Og;We.StrictMode=Rg;We.Suspense=Fg;We.SuspenseList=Lg;We.isContextConsumer=function(r){return yn(r)===Dg};We.isContextProvider=function(r){return yn(r)===Mg};We.isElement=function(r){return typeof r=="object"&&r!==null&&r.$$typeof===Uw};We.isForwardRef=function(r){return yn(r)===Ng};We.isFragment=function(r){return yn(r)===Pg};We.isLazy=function(r){return yn(r)===jg};We.isMemo=function(r){return yn(r)===Vg};We.isPortal=function(r){return yn(r)===Bw};We.isProfiler=function(r){return yn(r)===Og};We.isStrictMode=function(r){return yn(r)===Rg};We.isSuspense=function(r){return yn(r)===Fg};We.isSuspenseList=function(r){return yn(r)===Lg};We.isValidElementType=function(r){return typeof r=="string"||typeof r=="function"||r===Pg||r===Og||r===Rg||r===Fg||r===Lg||typeof r=="object"&&r!==null&&(r.$$typeof===jg||r.$$typeof===Vg||r.$$typeof===Mg||r.$$typeof===Dg||r.$$typeof===Ng||r.$$typeof===Dj||r.getModuleId!==void 0)};We.typeOf=yn;h2.exports=We;var d2=h2.exports;function Ti(r){if(typeof r!="object"||r===null)return!1;const e=Object.getPrototypeOf(r);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in r)&&!(Symbol.iterator in r)}function f2(r){if(L.isValidElement(r)||d2.isValidElementType(r)||!Ti(r))return r;const e={};return Object.keys(r).forEach(t=>{e[t]=f2(r[t])}),e}function Gr(r,e,t={clone:!0}){const n=t.clone?{...r}:r;return Ti(r)&&Ti(e)&&Object.keys(e).forEach(s=>{L.isValidElement(e[s])||d2.isValidElementType(e[s])?n[s]=e[s]:Ti(e[s])&&Object.prototype.hasOwnProperty.call(r,s)&&Ti(r[s])?n[s]=Gr(r[s],e[s],t):t.clone?n[s]=Ti(e[s])?f2(e[s]):e[s]:n[s]=e[s]}),n}function fu(r,e){return e?Gr(r,e,{clone:!1}):r}function X1(r,e){if(!r.containerQueries)return e;const t=Object.keys(e).filter(n=>n.startsWith("@container")).sort((n,s)=>{var o,a;const i=/min-width:\s*([0-9.]+)/;return+(((o=n.match(i))==null?void 0:o[1])||0)-+(((a=s.match(i))==null?void 0:a[1])||0)});return t.length?t.reduce((n,s)=>{const i=e[s];return delete n[s],n[s]=i,n},{...e}):e}function Mj(r,e){return e==="@"||e.startsWith("@")&&(r.some(t=>e.startsWith(`@${t}`))||!!e.match(/^@\d/))}function Nj(r,e){const t=e.match(/^@([^/]+)?\/?(.+)?$/);if(!t)return null;const[,n,s]=t,i=Number.isNaN(+n)?n||0:+n;return r.containerQueries(s).up(i)}function Fj(r){const e=(i,o)=>i.replace("@media",o?`@container ${o}`:"@container");function t(i,o){i.up=(...a)=>e(r.breakpoints.up(...a),o),i.down=(...a)=>e(r.breakpoints.down(...a),o),i.between=(...a)=>e(r.breakpoints.between(...a),o),i.only=(...a)=>e(r.breakpoints.only(...a),o),i.not=(...a)=>{const l=e(r.breakpoints.not(...a),o);return l.includes("not all and")?l.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):l}}const n={},s=i=>(t(n,i),n);return t(s),{...r,containerQueries:s}}const $g={xs:0,sm:600,md:900,lg:1200,xl:1536},K1={keys:["xs","sm","md","lg","xl"],up:r=>`@media (min-width:${$g[r]}px)`},Lj={containerQueries:r=>({up:e=>{let t=typeof e=="number"?e:$g[e]||e;return typeof t=="number"&&(t=`${t}px`),r?`@container ${r} (min-width:${t})`:`@container (min-width:${t})`}})};function Js(r,e,t){const n=r.theme||{};if(Array.isArray(e)){const i=n.breakpoints||K1;return e.reduce((o,a,l)=>(o[i.up(i.keys[l])]=t(e[l]),o),{})}if(typeof e=="object"){const i=n.breakpoints||K1;return Object.keys(e).reduce((o,a)=>{if(Mj(i.keys,a)){const l=Nj(n.containerQueries?n:Lj,a);l&&(o[l]=t(e[a],a))}else if(Object.keys(i.values||$g).includes(a)){const l=i.up(a);o[l]=t(e[a],a)}else{const l=a;o[l]=e[l]}return o},{})}return t(e)}function Vj(r={}){var t;return((t=r.keys)==null?void 0:t.reduce((n,s)=>{const i=r.up(s);return n[i]={},n},{}))||{}}function Q1(r,e){return r.reduce((t,n)=>{const s=t[n];return(!s||Object.keys(s).length===0)&&delete t[n],t},e)}function Ug(r,e,t=!0){if(!e||typeof e!="string")return null;if(r&&r.vars&&t){const n=`vars.${e}`.split(".").reduce((s,i)=>s&&s[i]?s[i]:null,r);if(n!=null)return n}return e.split(".").reduce((n,s)=>n&&n[s]!=null?n[s]:null,r)}function Cp(r,e,t,n=t){let s;return typeof r=="function"?s=r(t):Array.isArray(r)?s=r[t]||n:s=Ug(r,t)||n,e&&(s=e(s,n,r)),s}function yt(r){const{prop:e,cssProperty:t=r.prop,themeKey:n,transform:s}=r,i=o=>{if(o[e]==null)return null;const a=o[e],l=o.theme,c=Ug(l,n)||{};return Js(o,a,d=>{let f=Cp(c,s,d);return d===f&&typeof d=="string"&&(f=Cp(c,s,`${e}${d==="default"?"":u2(d)}`,d)),t===!1?f:{[t]:f}})};return i.propTypes={},i.filterProps=[e],i}function jj(r){const e={};return t=>(e[t]===void 0&&(e[t]=r(t)),e[t])}const $j={m:"margin",p:"padding"},Uj={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},J1={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Bj=jj(r=>{if(r.length>2)if(J1[r])r=J1[r];else return[r];const[e,t]=r.split(""),n=$j[e],s=Uj[t]||"";return Array.isArray(s)?s.map(i=>n+i):[n+s]}),zw=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Ww=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...zw,...Ww];function xh(r,e,t,n){const s=Ug(r,e,!0)??t;return typeof s=="number"||typeof s=="string"?i=>typeof i=="string"?i:typeof s=="string"?s.startsWith("var(")&&i===0?0:s.startsWith("var(")&&i===1?s:`calc(${i} * ${s})`:s*i:Array.isArray(s)?i=>{if(typeof i=="string")return i;const o=Math.abs(i),a=s[o];return i>=0?a:typeof a=="number"?-a:typeof a=="string"&&a.startsWith("var(")?`calc(-1 * ${a})`:`-${a}`}:typeof s=="function"?s:()=>{}}function Hw(r){return xh(r,"spacing",8)}function bh(r,e){return typeof e=="string"||e==null?e:r(e)}function zj(r,e){return t=>r.reduce((n,s)=>(n[s]=bh(e,t),n),{})}function Wj(r,e,t,n){if(!e.includes(t))return null;const s=Bj(t),i=zj(s,n),o=r[t];return Js(r,o,i)}function p2(r,e){const t=Hw(r.theme);return Object.keys(r).map(n=>Wj(r,e,n,t)).reduce(fu,{})}function at(r){return p2(r,zw)}at.propTypes={};at.filterProps=zw;function lt(r){return p2(r,Ww)}lt.propTypes={};lt.filterProps=Ww;function Bg(...r){const e=r.reduce((n,s)=>(s.filterProps.forEach(i=>{n[i]=s}),n),{}),t=n=>Object.keys(n).reduce((s,i)=>e[i]?fu(s,e[i](n)):s,{});return t.propTypes={},t.filterProps=r.reduce((n,s)=>n.concat(s.filterProps),[]),t}function sn(r){return typeof r!="number"?r:`${r}px solid`}function vn(r,e){return yt({prop:r,themeKey:"borders",transform:e})}const Hj=vn("border",sn),Gj=vn("borderTop",sn),qj=vn("borderRight",sn),Yj=vn("borderBottom",sn),Xj=vn("borderLeft",sn),Kj=vn("borderColor"),Qj=vn("borderTopColor"),Jj=vn("borderRightColor"),Zj=vn("borderBottomColor"),e4=vn("borderLeftColor"),t4=vn("outline",sn),r4=vn("outlineColor"),zg=r=>{if(r.borderRadius!==void 0&&r.borderRadius!==null){const e=xh(r.theme,"shape.borderRadius",4),t=n=>({borderRadius:bh(e,n)});return Js(r,r.borderRadius,t)}return null};zg.propTypes={};zg.filterProps=["borderRadius"];Bg(Hj,Gj,qj,Yj,Xj,Kj,Qj,Jj,Zj,e4,zg,t4,r4);const Wg=r=>{if(r.gap!==void 0&&r.gap!==null){const e=xh(r.theme,"spacing",8),t=n=>({gap:bh(e,n)});return Js(r,r.gap,t)}return null};Wg.propTypes={};Wg.filterProps=["gap"];const Hg=r=>{if(r.columnGap!==void 0&&r.columnGap!==null){const e=xh(r.theme,"spacing",8),t=n=>({columnGap:bh(e,n)});return Js(r,r.columnGap,t)}return null};Hg.propTypes={};Hg.filterProps=["columnGap"];const Gg=r=>{if(r.rowGap!==void 0&&r.rowGap!==null){const e=xh(r.theme,"spacing",8),t=n=>({rowGap:bh(e,n)});return Js(r,r.rowGap,t)}return null};Gg.propTypes={};Gg.filterProps=["rowGap"];const n4=yt({prop:"gridColumn"}),s4=yt({prop:"gridRow"}),i4=yt({prop:"gridAutoFlow"}),o4=yt({prop:"gridAutoColumns"}),a4=yt({prop:"gridAutoRows"}),l4=yt({prop:"gridTemplateColumns"}),c4=yt({prop:"gridTemplateRows"}),u4=yt({prop:"gridTemplateAreas"}),h4=yt({prop:"gridArea"});Bg(Wg,Hg,Gg,n4,s4,i4,o4,a4,l4,c4,u4,h4);function vl(r,e){return e==="grey"?e:r}const d4=yt({prop:"color",themeKey:"palette",transform:vl}),f4=yt({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:vl}),p4=yt({prop:"backgroundColor",themeKey:"palette",transform:vl});Bg(d4,f4,p4);function Ur(r){return r<=1&&r!==0?`${r*100}%`:r}const g4=yt({prop:"width",transform:Ur}),Gw=r=>{if(r.maxWidth!==void 0&&r.maxWidth!==null){const e=t=>{var s,i,o,a,l;const n=((o=(i=(s=r.theme)==null?void 0:s.breakpoints)==null?void 0:i.values)==null?void 0:o[t])||$g[t];return n?((l=(a=r.theme)==null?void 0:a.breakpoints)==null?void 0:l.unit)!=="px"?{maxWidth:`${n}${r.theme.breakpoints.unit}`}:{maxWidth:n}:{maxWidth:Ur(t)}};return Js(r,r.maxWidth,e)}return null};Gw.filterProps=["maxWidth"];const m4=yt({prop:"minWidth",transform:Ur}),y4=yt({prop:"height",transform:Ur}),v4=yt({prop:"maxHeight",transform:Ur}),_4=yt({prop:"minHeight",transform:Ur});yt({prop:"size",cssProperty:"width",transform:Ur});yt({prop:"size",cssProperty:"height",transform:Ur});const w4=yt({prop:"boxSizing"});Bg(g4,Gw,m4,y4,v4,_4,w4);const qg={border:{themeKey:"borders",transform:sn},borderTop:{themeKey:"borders",transform:sn},borderRight:{themeKey:"borders",transform:sn},borderBottom:{themeKey:"borders",transform:sn},borderLeft:{themeKey:"borders",transform:sn},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:sn},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:zg},color:{themeKey:"palette",transform:vl},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:vl},backgroundColor:{themeKey:"palette",transform:vl},p:{style:lt},pt:{style:lt},pr:{style:lt},pb:{style:lt},pl:{style:lt},px:{style:lt},py:{style:lt},padding:{style:lt},paddingTop:{style:lt},paddingRight:{style:lt},paddingBottom:{style:lt},paddingLeft:{style:lt},paddingX:{style:lt},paddingY:{style:lt},paddingInline:{style:lt},paddingInlineStart:{style:lt},paddingInlineEnd:{style:lt},paddingBlock:{style:lt},paddingBlockStart:{style:lt},paddingBlockEnd:{style:lt},m:{style:at},mt:{style:at},mr:{style:at},mb:{style:at},ml:{style:at},mx:{style:at},my:{style:at},margin:{style:at},marginTop:{style:at},marginRight:{style:at},marginBottom:{style:at},marginLeft:{style:at},marginX:{style:at},marginY:{style:at},marginInline:{style:at},marginInlineStart:{style:at},marginInlineEnd:{style:at},marginBlock:{style:at},marginBlockStart:{style:at},marginBlockEnd:{style:at},displayPrint:{cssProperty:!1,transform:r=>({"@media print":{display:r}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Wg},rowGap:{style:Gg},columnGap:{style:Hg},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Ur},maxWidth:{style:Gw},minWidth:{transform:Ur},height:{transform:Ur},maxHeight:{transform:Ur},minHeight:{transform:Ur},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function S4(...r){const e=r.reduce((n,s)=>n.concat(Object.keys(s)),[]),t=new Set(e);return r.every(n=>t.size===Object.keys(n).length)}function T4(r,e){return typeof r=="function"?r(e):r}function C4(){function r(t,n,s,i){const o={[t]:n,theme:s},a=i[t];if(!a)return{[t]:n};const{cssProperty:l=t,themeKey:c,transform:u,style:d}=a;if(n==null)return null;if(c==="typography"&&n==="inherit")return{[t]:n};const f=Ug(s,c)||{};return d?d(o):Js(o,n,m=>{let v=Cp(f,u,m);return m===v&&typeof m=="string"&&(v=Cp(f,u,`${t}${m==="default"?"":u2(m)}`,m)),l===!1?v:{[l]:v}})}function e(t){const{sx:n,theme:s={},nested:i}=t||{};if(!n)return null;const o=s.unstable_sxConfig??qg;function a(l){let c=l;if(typeof l=="function")c=l(s);else if(typeof l!="object")return l;if(!c)return null;const u=Vj(s.breakpoints),d=Object.keys(u);let f=u;return Object.keys(c).forEach(p=>{const m=T4(c[p],s);if(m!=null)if(typeof m=="object")if(o[p])f=fu(f,r(p,m,s,o));else{const v=Js({theme:s},m,T=>({[p]:T}));S4(v,m)?f[p]=e({sx:m,theme:s,nested:!0}):f=fu(f,v)}else f=fu(f,r(p,m,s,o))}),!i&&s.modularCssLayers?{"@layer sx":X1(s,Q1(d,f))}:X1(s,Q1(d,f))}return Array.isArray(n)?n.map(a):a(n)}return e}const Yg=C4();Yg.filterProps=["sx"];function R0(){return R0=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},R0.apply(null,arguments)}function E4(r){if(r.sheet)return r.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===r)return document.styleSheets[e]}function x4(r){var e=document.createElement("style");return e.setAttribute("data-emotion",r.key),r.nonce!==void 0&&e.setAttribute("nonce",r.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var b4=function(){function r(t){var n=this;this._insertTag=function(s){var i;n.tags.length===0?n.insertionPoint?i=n.insertionPoint.nextSibling:n.prepend?i=n.container.firstChild:i=n.before:i=n.tags[n.tags.length-1].nextSibling,n.container.insertBefore(s,i),n.tags.push(s)},this.isSpeedy=t.speedy===void 0?!0:t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.prepend=t.prepend,this.insertionPoint=t.insertionPoint,this.before=null}var e=r.prototype;return e.hydrate=function(n){n.forEach(this._insertTag)},e.insert=function(n){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(x4(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var i=E4(s);try{i.insertRule(n,i.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(n));this.ctr++},e.flush=function(){this.tags.forEach(function(n){var s;return(s=n.parentNode)==null?void 0:s.removeChild(n)}),this.tags=[],this.ctr=0},r}(),rr="-ms-",Ep="-moz-",Re="-webkit-",g2="comm",qw="rule",Yw="decl",A4="@import",m2="@keyframes",k4="@layer",I4=Math.abs,Xg=String.fromCharCode,P4=Object.assign;function R4(r,e){return Ht(r,0)^45?(((e<<2^Ht(r,0))<<2^Ht(r,1))<<2^Ht(r,2))<<2^Ht(r,3):0}function y2(r){return r.trim()}function O4(r,e){return(r=e.exec(r))?r[0]:r}function Oe(r,e,t){return r.replace(e,t)}function O0(r,e){return r.indexOf(e)}function Ht(r,e){return r.charCodeAt(e)|0}function Hu(r,e,t){return r.slice(e,t)}function Jn(r){return r.length}function Xw(r){return r.length}function bd(r,e){return e.push(r),r}function D4(r,e){return r.map(e).join("")}var Kg=1,Ll=1,v2=0,Fr=0,Tt=0,Ql="";function Qg(r,e,t,n,s,i,o){return{value:r,root:e,parent:t,type:n,props:s,children:i,line:Kg,column:Ll,length:o,return:""}}function Lc(r,e){return P4(Qg("",null,null,"",null,null,0),r,{length:-r.length},e)}function M4(){return Tt}function N4(){return Tt=Fr>0?Ht(Ql,--Fr):0,Ll--,Tt===10&&(Ll=1,Kg--),Tt}function qr(){return Tt=Fr<v2?Ht(Ql,Fr++):0,Ll++,Tt===10&&(Ll=1,Kg++),Tt}function as(){return Ht(Ql,Fr)}function xf(){return Fr}function Ah(r,e){return Hu(Ql,r,e)}function Gu(r){switch(r){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function _2(r){return Kg=Ll=1,v2=Jn(Ql=r),Fr=0,[]}function w2(r){return Ql="",r}function bf(r){return y2(Ah(Fr-1,D0(r===91?r+2:r===40?r+1:r)))}function F4(r){for(;(Tt=as())&&Tt<33;)qr();return Gu(r)>2||Gu(Tt)>3?"":" "}function L4(r,e){for(;--e&&qr()&&!(Tt<48||Tt>102||Tt>57&&Tt<65||Tt>70&&Tt<97););return Ah(r,xf()+(e<6&&as()==32&&qr()==32))}function D0(r){for(;qr();)switch(Tt){case r:return Fr;case 34:case 39:r!==34&&r!==39&&D0(Tt);break;case 40:r===41&&D0(r);break;case 92:qr();break}return Fr}function V4(r,e){for(;qr()&&r+Tt!==57;)if(r+Tt===84&&as()===47)break;return"/*"+Ah(e,Fr-1)+"*"+Xg(r===47?r:qr())}function j4(r){for(;!Gu(as());)qr();return Ah(r,Fr)}function $4(r){return w2(Af("",null,null,null,[""],r=_2(r),0,[0],r))}function Af(r,e,t,n,s,i,o,a,l){for(var c=0,u=0,d=o,f=0,p=0,m=0,v=1,T=1,w=1,y=0,C="",k=s,O=i,M=n,x=C;T;)switch(m=y,y=qr()){case 40:if(m!=108&&Ht(x,d-1)==58){O0(x+=Oe(bf(y),"&","&\f"),"&\f")!=-1&&(w=-1);break}case 34:case 39:case 91:x+=bf(y);break;case 9:case 10:case 13:case 32:x+=F4(m);break;case 92:x+=L4(xf()-1,7);continue;case 47:switch(as()){case 42:case 47:bd(U4(V4(qr(),xf()),e,t),l);break;default:x+="/"}break;case 123*v:a[c++]=Jn(x)*w;case 125*v:case 59:case 0:switch(y){case 0:case 125:T=0;case 59+u:w==-1&&(x=Oe(x,/\f/g,"")),p>0&&Jn(x)-d&&bd(p>32?eE(x+";",n,t,d-1):eE(Oe(x," ","")+";",n,t,d-2),l);break;case 59:x+=";";default:if(bd(M=Z1(x,e,t,c,u,s,a,C,k=[],O=[],d),i),y===123)if(u===0)Af(x,e,M,M,k,i,d,a,O);else switch(f===99&&Ht(x,3)===110?100:f){case 100:case 108:case 109:case 115:Af(r,M,M,n&&bd(Z1(r,M,M,0,0,s,a,C,s,k=[],d),O),s,O,d,a,n?k:O);break;default:Af(x,M,M,M,[""],O,0,a,O)}}c=u=p=0,v=w=1,C=x="",d=o;break;case 58:d=1+Jn(x),p=m;default:if(v<1){if(y==123)--v;else if(y==125&&v++==0&&N4()==125)continue}switch(x+=Xg(y),y*v){case 38:w=u>0?1:(x+="\f",-1);break;case 44:a[c++]=(Jn(x)-1)*w,w=1;break;case 64:as()===45&&(x+=bf(qr())),f=as(),u=d=Jn(C=x+=j4(xf())),y++;break;case 45:m===45&&Jn(x)==2&&(v=0)}}return i}function Z1(r,e,t,n,s,i,o,a,l,c,u){for(var d=s-1,f=s===0?i:[""],p=Xw(f),m=0,v=0,T=0;m<n;++m)for(var w=0,y=Hu(r,d+1,d=I4(v=o[m])),C=r;w<p;++w)(C=y2(v>0?f[w]+" "+y:Oe(y,/&\f/g,f[w])))&&(l[T++]=C);return Qg(r,e,t,s===0?qw:a,l,c,u)}function U4(r,e,t){return Qg(r,e,t,g2,Xg(M4()),Hu(r,2,-2),0)}function eE(r,e,t,n){return Qg(r,e,t,Yw,Hu(r,0,n),Hu(r,n+1,-1),n)}function _l(r,e){for(var t="",n=Xw(r),s=0;s<n;s++)t+=e(r[s],s,r,e)||"";return t}function B4(r,e,t,n){switch(r.type){case k4:if(r.children.length)break;case A4:case Yw:return r.return=r.return||r.value;case g2:return"";case m2:return r.return=r.value+"{"+_l(r.children,n)+"}";case qw:r.value=r.props.join(",")}return Jn(t=_l(r.children,n))?r.return=r.value+"{"+t+"}":""}function z4(r){var e=Xw(r);return function(t,n,s,i){for(var o="",a=0;a<e;a++)o+=r[a](t,n,s,i)||"";return o}}function W4(r){return function(e){e.root||(e=e.return)&&r(e)}}function S2(r){var e=Object.create(null);return function(t){return e[t]===void 0&&(e[t]=r(t)),e[t]}}var H4=function(e,t,n){for(var s=0,i=0;s=i,i=as(),s===38&&i===12&&(t[n]=1),!Gu(i);)qr();return Ah(e,Fr)},G4=function(e,t){var n=-1,s=44;do switch(Gu(s)){case 0:s===38&&as()===12&&(t[n]=1),e[n]+=H4(Fr-1,t,n);break;case 2:e[n]+=bf(s);break;case 4:if(s===44){e[++n]=as()===58?"&\f":"",t[n]=e[n].length;break}default:e[n]+=Xg(s)}while(s=qr());return e},q4=function(e,t){return w2(G4(_2(e),t))},tE=new WeakMap,Y4=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var t=e.value,n=e.parent,s=e.column===n.column&&e.line===n.line;n.type!=="rule";)if(n=n.parent,!n)return;if(!(e.props.length===1&&t.charCodeAt(0)!==58&&!tE.get(n))&&!s){tE.set(e,!0);for(var i=[],o=q4(t,i),a=n.props,l=0,c=0;l<o.length;l++)for(var u=0;u<a.length;u++,c++)e.props[c]=i[l]?o[l].replace(/&\f/g,a[u]):a[u]+" "+o[l]}}},X4=function(e){if(e.type==="decl"){var t=e.value;t.charCodeAt(0)===108&&t.charCodeAt(2)===98&&(e.return="",e.value="")}};function T2(r,e){switch(R4(r,e)){case 5103:return Re+"print-"+r+r;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Re+r+r;case 5349:case 4246:case 4810:case 6968:case 2756:return Re+r+Ep+r+rr+r+r;case 6828:case 4268:return Re+r+rr+r+r;case 6165:return Re+r+rr+"flex-"+r+r;case 5187:return Re+r+Oe(r,/(\w+).+(:[^]+)/,Re+"box-$1$2"+rr+"flex-$1$2")+r;case 5443:return Re+r+rr+"flex-item-"+Oe(r,/flex-|-self/,"")+r;case 4675:return Re+r+rr+"flex-line-pack"+Oe(r,/align-content|flex-|-self/,"")+r;case 5548:return Re+r+rr+Oe(r,"shrink","negative")+r;case 5292:return Re+r+rr+Oe(r,"basis","preferred-size")+r;case 6060:return Re+"box-"+Oe(r,"-grow","")+Re+r+rr+Oe(r,"grow","positive")+r;case 4554:return Re+Oe(r,/([^-])(transform)/g,"$1"+Re+"$2")+r;case 6187:return Oe(Oe(Oe(r,/(zoom-|grab)/,Re+"$1"),/(image-set)/,Re+"$1"),r,"")+r;case 5495:case 3959:return Oe(r,/(image-set\([^]*)/,Re+"$1$`$1");case 4968:return Oe(Oe(r,/(.+:)(flex-)?(.*)/,Re+"box-pack:$3"+rr+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Re+r+r;case 4095:case 3583:case 4068:case 2532:return Oe(r,/(.+)-inline(.+)/,Re+"$1$2")+r;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Jn(r)-1-e>6)switch(Ht(r,e+1)){case 109:if(Ht(r,e+4)!==45)break;case 102:return Oe(r,/(.+:)(.+)-([^]+)/,"$1"+Re+"$2-$3$1"+Ep+(Ht(r,e+3)==108?"$3":"$2-$3"))+r;case 115:return~O0(r,"stretch")?T2(Oe(r,"stretch","fill-available"),e)+r:r}break;case 4949:if(Ht(r,e+1)!==115)break;case 6444:switch(Ht(r,Jn(r)-3-(~O0(r,"!important")&&10))){case 107:return Oe(r,":",":"+Re)+r;case 101:return Oe(r,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Re+(Ht(r,14)===45?"inline-":"")+"box$3$1"+Re+"$2$3$1"+rr+"$2box$3")+r}break;case 5936:switch(Ht(r,e+11)){case 114:return Re+r+rr+Oe(r,/[svh]\w+-[tblr]{2}/,"tb")+r;case 108:return Re+r+rr+Oe(r,/[svh]\w+-[tblr]{2}/,"tb-rl")+r;case 45:return Re+r+rr+Oe(r,/[svh]\w+-[tblr]{2}/,"lr")+r}return Re+r+rr+r+r}return r}var K4=function(e,t,n,s){if(e.length>-1&&!e.return)switch(e.type){case Yw:e.return=T2(e.value,e.length);break;case m2:return _l([Lc(e,{value:Oe(e.value,"@","@"+Re)})],s);case qw:if(e.length)return D4(e.props,function(i){switch(O4(i,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return _l([Lc(e,{props:[Oe(i,/:(read-\w+)/,":"+Ep+"$1")]})],s);case"::placeholder":return _l([Lc(e,{props:[Oe(i,/:(plac\w+)/,":"+Re+"input-$1")]}),Lc(e,{props:[Oe(i,/:(plac\w+)/,":"+Ep+"$1")]}),Lc(e,{props:[Oe(i,/:(plac\w+)/,rr+"input-$1")]})],s)}return""})}},Q4=[K4],J4=function(e){var t=e.key;if(t==="css"){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,function(v){var T=v.getAttribute("data-emotion");T.indexOf(" ")!==-1&&(document.head.appendChild(v),v.setAttribute("data-s",""))})}var s=e.stylisPlugins||Q4,i={},o,a=[];o=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),function(v){for(var T=v.getAttribute("data-emotion").split(" "),w=1;w<T.length;w++)i[T[w]]=!0;a.push(v)});var l,c=[Y4,X4];{var u,d=[B4,W4(function(v){u.insert(v)})],f=z4(c.concat(s,d)),p=function(T){return _l($4(T),f)};l=function(T,w,y,C){u=y,p(T?T+"{"+w.styles+"}":w.styles),C&&(m.inserted[w.name]=!0)}}var m={key:t,sheet:new b4({key:t,container:o,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:i,registered:{},insert:l};return m.sheet.hydrate(a),m},C2={exports:{}},$e={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vt=typeof Symbol=="function"&&Symbol.for,Kw=Vt?Symbol.for("react.element"):60103,Qw=Vt?Symbol.for("react.portal"):60106,Jg=Vt?Symbol.for("react.fragment"):60107,Zg=Vt?Symbol.for("react.strict_mode"):60108,em=Vt?Symbol.for("react.profiler"):60114,tm=Vt?Symbol.for("react.provider"):60109,rm=Vt?Symbol.for("react.context"):60110,Jw=Vt?Symbol.for("react.async_mode"):60111,nm=Vt?Symbol.for("react.concurrent_mode"):60111,sm=Vt?Symbol.for("react.forward_ref"):60112,im=Vt?Symbol.for("react.suspense"):60113,Z4=Vt?Symbol.for("react.suspense_list"):60120,om=Vt?Symbol.for("react.memo"):60115,am=Vt?Symbol.for("react.lazy"):60116,e5=Vt?Symbol.for("react.block"):60121,t5=Vt?Symbol.for("react.fundamental"):60117,r5=Vt?Symbol.for("react.responder"):60118,n5=Vt?Symbol.for("react.scope"):60119;function en(r){if(typeof r=="object"&&r!==null){var e=r.$$typeof;switch(e){case Kw:switch(r=r.type,r){case Jw:case nm:case Jg:case em:case Zg:case im:return r;default:switch(r=r&&r.$$typeof,r){case rm:case sm:case am:case om:case tm:return r;default:return e}}case Qw:return e}}}function E2(r){return en(r)===nm}$e.AsyncMode=Jw;$e.ConcurrentMode=nm;$e.ContextConsumer=rm;$e.ContextProvider=tm;$e.Element=Kw;$e.ForwardRef=sm;$e.Fragment=Jg;$e.Lazy=am;$e.Memo=om;$e.Portal=Qw;$e.Profiler=em;$e.StrictMode=Zg;$e.Suspense=im;$e.isAsyncMode=function(r){return E2(r)||en(r)===Jw};$e.isConcurrentMode=E2;$e.isContextConsumer=function(r){return en(r)===rm};$e.isContextProvider=function(r){return en(r)===tm};$e.isElement=function(r){return typeof r=="object"&&r!==null&&r.$$typeof===Kw};$e.isForwardRef=function(r){return en(r)===sm};$e.isFragment=function(r){return en(r)===Jg};$e.isLazy=function(r){return en(r)===am};$e.isMemo=function(r){return en(r)===om};$e.isPortal=function(r){return en(r)===Qw};$e.isProfiler=function(r){return en(r)===em};$e.isStrictMode=function(r){return en(r)===Zg};$e.isSuspense=function(r){return en(r)===im};$e.isValidElementType=function(r){return typeof r=="string"||typeof r=="function"||r===Jg||r===nm||r===em||r===Zg||r===im||r===Z4||typeof r=="object"&&r!==null&&(r.$$typeof===am||r.$$typeof===om||r.$$typeof===tm||r.$$typeof===rm||r.$$typeof===sm||r.$$typeof===t5||r.$$typeof===r5||r.$$typeof===n5||r.$$typeof===e5)};$e.typeOf=en;C2.exports=$e;var s5=C2.exports,x2=s5,i5={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o5={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},b2={};b2[x2.ForwardRef]=i5;b2[x2.Memo]=o5;var a5=!0;function A2(r,e,t){var n="";return t.split(" ").forEach(function(s){r[s]!==void 0?e.push(r[s]+";"):s&&(n+=s+" ")}),n}var Zw=function(e,t,n){var s=e.key+"-"+t.name;(n===!1||a5===!1)&&e.registered[s]===void 0&&(e.registered[s]=t.styles)},eS=function(e,t,n){Zw(e,t,n);var s=e.key+"-"+t.name;if(e.inserted[t.name]===void 0){var i=t;do e.insert(t===i?"."+s:"",i,e.sheet,!0),i=i.next;while(i!==void 0)}};function l5(r){for(var e=0,t,n=0,s=r.length;s>=4;++n,s-=4)t=r.charCodeAt(n)&255|(r.charCodeAt(++n)&255)<<8|(r.charCodeAt(++n)&255)<<16|(r.charCodeAt(++n)&255)<<24,t=(t&65535)*1540483477+((t>>>16)*59797<<16),t^=t>>>24,e=(t&65535)*1540483477+((t>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(r.charCodeAt(n+2)&255)<<16;case 2:e^=(r.charCodeAt(n+1)&255)<<8;case 1:e^=r.charCodeAt(n)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var c5={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},u5=/[A-Z]|^ms/g,h5=/_EMO_([^_]+?)_([^]*?)_EMO_/g,k2=function(e){return e.charCodeAt(1)===45},rE=function(e){return e!=null&&typeof e!="boolean"},Xy=S2(function(r){return k2(r)?r:r.replace(u5,"-$&").toLowerCase()}),nE=function(e,t){switch(e){case"animation":case"animationName":if(typeof t=="string")return t.replace(h5,function(n,s,i){return Zn={name:s,styles:i,next:Zn},s})}return c5[e]!==1&&!k2(e)&&typeof t=="number"&&t!==0?t+"px":t};function qu(r,e,t){if(t==null)return"";var n=t;if(n.__emotion_styles!==void 0)return n;switch(typeof t){case"boolean":return"";case"object":{var s=t;if(s.anim===1)return Zn={name:s.name,styles:s.styles,next:Zn},s.name;var i=t;if(i.styles!==void 0){var o=i.next;if(o!==void 0)for(;o!==void 0;)Zn={name:o.name,styles:o.styles,next:Zn},o=o.next;var a=i.styles+";";return a}return d5(r,e,t)}case"function":{if(r!==void 0){var l=Zn,c=t(r);return Zn=l,qu(r,e,c)}break}}var u=t;if(e==null)return u;var d=e[u];return d!==void 0?d:u}function d5(r,e,t){var n="";if(Array.isArray(t))for(var s=0;s<t.length;s++)n+=qu(r,e,t[s])+";";else for(var i in t){var o=t[i];if(typeof o!="object"){var a=o;e!=null&&e[a]!==void 0?n+=i+"{"+e[a]+"}":rE(a)&&(n+=Xy(i)+":"+nE(i,a)+";")}else if(Array.isArray(o)&&typeof o[0]=="string"&&(e==null||e[o[0]]===void 0))for(var l=0;l<o.length;l++)rE(o[l])&&(n+=Xy(i)+":"+nE(i,o[l])+";");else{var c=qu(r,e,o);switch(i){case"animation":case"animationName":{n+=Xy(i)+":"+c+";";break}default:n+=i+"{"+c+"}"}}}return n}var sE=/label:\s*([^\s;{]+)\s*(;|$)/g,Zn;function lm(r,e,t){if(r.length===1&&typeof r[0]=="object"&&r[0]!==null&&r[0].styles!==void 0)return r[0];var n=!0,s="";Zn=void 0;var i=r[0];if(i==null||i.raw===void 0)n=!1,s+=qu(t,e,i);else{var o=i;s+=o[0]}for(var a=1;a<r.length;a++)if(s+=qu(t,e,r[a]),n){var l=i;s+=l[a]}sE.lastIndex=0;for(var c="",u;(u=sE.exec(s))!==null;)c+="-"+u[1];var d=l5(s)+c;return{name:d,styles:s,next:Zn}}var f5=function(e){return e()},I2=FC.useInsertionEffect?FC.useInsertionEffect:!1,P2=I2||f5,iE=I2||L.useLayoutEffect,R2=L.createContext(typeof HTMLElement<"u"?J4({key:"css"}):null);R2.Provider;var tS=function(e){return L.forwardRef(function(t,n){var s=L.useContext(R2);return e(t,s,n)})},cm=L.createContext({}),rS={}.hasOwnProperty,M0="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",p5=function(e,t){var n={};for(var s in t)rS.call(t,s)&&(n[s]=t[s]);return n[M0]=e,n},g5=function(e){var t=e.cache,n=e.serialized,s=e.isStringTag;return Zw(t,n,s),P2(function(){return eS(t,n,s)}),null},m5=tS(function(r,e,t){var n=r.css;typeof n=="string"&&e.registered[n]!==void 0&&(n=e.registered[n]);var s=r[M0],i=[n],o="";typeof r.className=="string"?o=A2(e.registered,i,r.className):r.className!=null&&(o=r.className+" ");var a=lm(i,void 0,L.useContext(cm));o+=e.key+"-"+a.name;var l={};for(var c in r)rS.call(r,c)&&c!=="css"&&c!==M0&&(l[c]=r[c]);return l.className=o,t&&(l.ref=t),L.createElement(L.Fragment,null,L.createElement(g5,{cache:e,serialized:a,isStringTag:typeof s=="string"}),L.createElement(s,l))}),y5=m5,oE=function(e,t){var n=arguments;if(t==null||!rS.call(t,"css"))return L.createElement.apply(void 0,n);var s=n.length,i=new Array(s);i[0]=y5,i[1]=p5(e,t);for(var o=2;o<s;o++)i[o]=n[o];return L.createElement.apply(null,i)};(function(r){var e;e||(e=r.JSX||(r.JSX={}))})(oE||(oE={}));var v5=tS(function(r,e){var t=r.styles,n=lm([t],void 0,L.useContext(cm)),s=L.useRef();return iE(function(){var i=e.key+"-global",o=new e.sheet.constructor({key:i,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),a=!1,l=document.querySelector('style[data-emotion="'+i+" "+n.name+'"]');return e.sheet.tags.length&&(o.before=e.sheet.tags[0]),l!==null&&(a=!0,l.setAttribute("data-emotion",i),o.hydrate([l])),s.current=[o,a],function(){o.flush()}},[e]),iE(function(){var i=s.current,o=i[0],a=i[1];if(a){i[1]=!1;return}if(n.next!==void 0&&eS(e,n.next,!0),o.tags.length){var l=o.tags[o.tags.length-1].nextElementSibling;o.before=l,o.flush()}e.insert("",n,o,!1)},[e,n.name]),null}),_5=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,w5=S2(function(r){return _5.test(r)||r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)<91}),S5=w5,T5=function(e){return e!=="theme"},aE=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?S5:T5},lE=function(e,t,n){var s;if(t){var i=t.shouldForwardProp;s=e.__emotion_forwardProp&&i?function(o){return e.__emotion_forwardProp(o)&&i(o)}:i}return typeof s!="function"&&n&&(s=e.__emotion_forwardProp),s},C5=function(e){var t=e.cache,n=e.serialized,s=e.isStringTag;return Zw(t,n,s),P2(function(){return eS(t,n,s)}),null},E5=function r(e,t){var n=e.__emotion_real===e,s=n&&e.__emotion_base||e,i,o;t!==void 0&&(i=t.label,o=t.target);var a=lE(e,t,n),l=a||aE(s),c=!l("as");return function(){var u=arguments,d=n&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(i!==void 0&&d.push("label:"+i+";"),u[0]==null||u[0].raw===void 0)d.push.apply(d,u);else{var f=u[0];d.push(f[0]);for(var p=u.length,m=1;m<p;m++)d.push(u[m],f[m])}var v=tS(function(T,w,y){var C=c&&T.as||s,k="",O=[],M=T;if(T.theme==null){M={};for(var x in T)M[x]=T[x];M.theme=L.useContext(cm)}typeof T.className=="string"?k=A2(w.registered,O,T.className):T.className!=null&&(k=T.className+" ");var E=lm(d.concat(O),w.registered,M);k+=w.key+"-"+E.name,o!==void 0&&(k+=" "+o);var A=c&&a===void 0?aE(C):l,P={};for(var R in T)c&&R==="as"||A(R)&&(P[R]=T[R]);return P.className=k,y&&(P.ref=y),L.createElement(L.Fragment,null,L.createElement(C5,{cache:w,serialized:E,isStringTag:typeof C=="string"}),L.createElement(C,P))});return v.displayName=i!==void 0?i:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",v.defaultProps=e.defaultProps,v.__emotion_real=v,v.__emotion_base=s,v.__emotion_styles=d,v.__emotion_forwardProp=a,Object.defineProperty(v,"toString",{value:function(){return"."+o}}),v.withComponent=function(T,w){var y=r(T,R0({},t,w,{shouldForwardProp:lE(v,w,!0)}));return y.apply(void 0,d)},v}},x5=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],cE=E5.bind(null);x5.forEach(function(r){cE[r]=cE(r)});function b5(r){return r==null||Object.keys(r).length===0}function A5(r){const{styles:e,defaultTheme:t={}}=r,n=typeof e=="function"?s=>e(b5(s)?t:s):e;return D.jsx(v5,{styles:n})}const uE=[];function k5(r){return uE[0]=r,lm(uE)}const I5=r=>{const e=Object.keys(r).map(t=>({key:t,val:r[t]}))||[];return e.sort((t,n)=>t.val-n.val),e.reduce((t,n)=>({...t,[n.key]:n.val}),{})};function P5(r){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:t="px",step:n=5,...s}=r,i=I5(e),o=Object.keys(i);function a(f){return`@media (min-width:${typeof e[f]=="number"?e[f]:f}${t})`}function l(f){return`@media (max-width:${(typeof e[f]=="number"?e[f]:f)-n/100}${t})`}function c(f,p){const m=o.indexOf(p);return`@media (min-width:${typeof e[f]=="number"?e[f]:f}${t}) and (max-width:${(m!==-1&&typeof e[o[m]]=="number"?e[o[m]]:p)-n/100}${t})`}function u(f){return o.indexOf(f)+1<o.length?c(f,o[o.indexOf(f)+1]):a(f)}function d(f){const p=o.indexOf(f);return p===0?a(o[1]):p===o.length-1?l(o[p]):c(f,o[o.indexOf(f)+1]).replace("@media","@media not all and")}return{keys:o,values:i,up:a,down:l,between:c,only:u,not:d,unit:t,...s}}const R5={borderRadius:4};function O2(r=8,e=Hw({spacing:r})){if(r.mui)return r;const t=(...n)=>(n.length===0?[1]:n).map(i=>{const o=e(i);return typeof o=="number"?`${o}px`:o}).join(" ");return t.mui=!0,t}function O5(r,e){var n;const t=this;if(t.vars){if(!((n=t.colorSchemes)!=null&&n[r])||typeof t.getColorSchemeSelector!="function")return{};let s=t.getColorSchemeSelector(r);return s==="&"?e:((s.includes("data-")||s.includes("."))&&(s=`*:where(${s.replace(/\s*&$/,"")}) &`),{[s]:e})}return t.palette.mode===r?e:{}}function D2(r={},...e){const{breakpoints:t={},palette:n={},spacing:s,shape:i={},...o}=r,a=P5(t),l=O2(s);let c=Gr({breakpoints:a,direction:"ltr",components:{},palette:{mode:"light",...n},spacing:l,shape:{...R5,...i}},o);return c=Fj(c),c.applyStyles=O5,c=e.reduce((u,d)=>Gr(u,d),c),c.unstable_sxConfig={...qg,...o==null?void 0:o.unstable_sxConfig},c.unstable_sx=function(d){return Yg({sx:d,theme:this})},c}function D5(r){return Object.keys(r).length===0}function M5(r=null){const e=L.useContext(cm);return!e||D5(e)?r:e}const N5=D2();function F5(r=N5){return M5(r)}function Ky(r){const e=k5(r);return r!==e&&e.styles?(e.styles.match(/^@layer\s+[^{]*$/)||(e.styles=`@layer global{${e.styles}}`),e):r}function L5({styles:r,themeId:e,defaultTheme:t={}}){const n=F5(t),s=e&&n[e]||n;let i=typeof r=="function"?r(s):r;return s.modularCssLayers&&(Array.isArray(i)?i=i.map(o=>Ky(typeof o=="function"?o(s):o)):i=Ky(i)),D.jsx(A5,{styles:i})}function M2(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var s=r.length;for(e=0;e<s;e++)r[e]&&(t=M2(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function V5(){for(var r,e,t=0,n="",s=arguments.length;t<s;t++)(r=arguments[t])&&(e=M2(r))&&(n&&(n+=" "),n+=e);return n}function N0(r,e,t=!1){const n={...e};for(const s in r)if(Object.prototype.hasOwnProperty.call(r,s)){const i=s;if(i==="components"||i==="slots")n[i]={...r[i],...n[i]};else if(i==="componentsProps"||i==="slotProps"){const o=r[i],a=e[i];if(!a)n[i]=o||{};else if(!o)n[i]=a;else{n[i]={...a};for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const c=l;n[i][c]=N0(o[c],a[c],t)}}}else i==="className"&&t&&e.className?n.className=V5(r==null?void 0:r.className,e==null?void 0:e.className):i==="style"&&t&&e.style?n.style={...r==null?void 0:r.style,...e==null?void 0:e.style}:n[i]===void 0&&(n[i]=r[i])}return n}function j5(r,e=Number.MIN_SAFE_INTEGER,t=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(r,t))}function nS(r,e=0,t=1){return j5(r,e,t)}function $5(r){r=r.slice(1);const e=new RegExp(`.{1,${r.length>=6?2:1}}`,"g");let t=r.match(e);return t&&t[0].length===1&&(t=t.map(n=>n+n)),t?`rgb${t.length===4?"a":""}(${t.map((n,s)=>s<3?parseInt(n,16):Math.round(parseInt(n,16)/255*1e3)/1e3).join(", ")})`:""}function Yi(r){if(r.type)return r;if(r.charAt(0)==="#")return Yi($5(r));const e=r.indexOf("("),t=r.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(t))throw new Error(Zo(9,r));let n=r.substring(e+1,r.length-1),s;if(t==="color"){if(n=n.split(" "),s=n.shift(),n.length===4&&n[3].charAt(0)==="/"&&(n[3]=n[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(s))throw new Error(Zo(10,s))}else n=n.split(",");return n=n.map(i=>parseFloat(i)),{type:t,values:n,colorSpace:s}}const U5=r=>{const e=Yi(r);return e.values.slice(0,3).map((t,n)=>e.type.includes("hsl")&&n!==0?`${t}%`:t).join(" ")},Yc=(r,e)=>{try{return U5(r)}catch{return r}};function um(r){const{type:e,colorSpace:t}=r;let{values:n}=r;return e.includes("rgb")?n=n.map((s,i)=>i<3?parseInt(s,10):s):e.includes("hsl")&&(n[1]=`${n[1]}%`,n[2]=`${n[2]}%`),e.includes("color")?n=`${t} ${n.join(" ")}`:n=`${n.join(", ")}`,`${e}(${n})`}function N2(r){r=Yi(r);const{values:e}=r,t=e[0],n=e[1]/100,s=e[2]/100,i=n*Math.min(s,1-s),o=(c,u=(c+t/30)%12)=>s-i*Math.max(Math.min(u-3,9-u,1),-1);let a="rgb";const l=[Math.round(o(0)*255),Math.round(o(8)*255),Math.round(o(4)*255)];return r.type==="hsla"&&(a+="a",l.push(e[3])),um({type:a,values:l})}function F0(r){r=Yi(r);let e=r.type==="hsl"||r.type==="hsla"?Yi(N2(r)).values:r.values;return e=e.map(t=>(r.type!=="color"&&(t/=255),t<=.03928?t/12.92:((t+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function B5(r,e){const t=F0(r),n=F0(e);return(Math.max(t,n)+.05)/(Math.min(t,n)+.05)}function F2(r,e){return r=Yi(r),e=nS(e),(r.type==="rgb"||r.type==="hsl")&&(r.type+="a"),r.type==="color"?r.values[3]=`/${e}`:r.values[3]=e,um(r)}function So(r,e,t){try{return F2(r,e)}catch{return r}}function hm(r,e){if(r=Yi(r),e=nS(e),r.type.includes("hsl"))r.values[2]*=1-e;else if(r.type.includes("rgb")||r.type.includes("color"))for(let t=0;t<3;t+=1)r.values[t]*=1-e;return um(r)}function Fe(r,e,t){try{return hm(r,e)}catch{return r}}function dm(r,e){if(r=Yi(r),e=nS(e),r.type.includes("hsl"))r.values[2]+=(100-r.values[2])*e;else if(r.type.includes("rgb"))for(let t=0;t<3;t+=1)r.values[t]+=(255-r.values[t])*e;else if(r.type.includes("color"))for(let t=0;t<3;t+=1)r.values[t]+=(1-r.values[t])*e;return um(r)}function Le(r,e,t){try{return dm(r,e)}catch{return r}}function z5(r,e=.15){return F0(r)>.5?hm(r,e):dm(r,e)}function Ad(r,e,t){try{return z5(r,e)}catch{return r}}const W5=L.createContext(void 0);function H5(r){const{theme:e,name:t,props:n}=r;if(!e||!e.components||!e.components[t])return n;const s=e.components[t];return s.defaultProps?N0(s.defaultProps,n,e.components.mergeClassNameAndStyle):!s.styleOverrides&&!s.variants?N0(s,n,e.components.mergeClassNameAndStyle):n}function G5({props:r,name:e}){const t=L.useContext(W5);return H5({props:r,name:e,theme:{components:t}})}function q5(r=""){function e(...n){if(!n.length)return"";const s=n[0];return typeof s=="string"&&!s.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${r?`${r}-`:""}${s}${e(...n.slice(1))})`:`, ${s}`}return(n,...s)=>`var(--${r?`${r}-`:""}${n}${e(...s)})`}const hE=(r,e,t,n=[])=>{let s=r;e.forEach((i,o)=>{o===e.length-1?Array.isArray(s)?s[Number(i)]=t:s&&typeof s=="object"&&(s[i]=t):s&&typeof s=="object"&&(s[i]||(s[i]=n.includes(i)?[]:{}),s=s[i])})},Y5=(r,e,t)=>{function n(s,i=[],o=[]){Object.entries(s).forEach(([a,l])=>{(!t||t&&!t([...i,a]))&&l!=null&&(typeof l=="object"&&Object.keys(l).length>0?n(l,[...i,a],Array.isArray(l)?[...o,a]:o):e([...i,a],l,o))})}n(r)},X5=(r,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(n=>r.includes(n))||r[r.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function Qy(r,e){const{prefix:t,shouldSkipGeneratingVar:n}=e||{},s={},i={},o={};return Y5(r,(a,l,c)=>{if((typeof l=="string"||typeof l=="number")&&(!n||!n(a,l))){const u=`--${t?`${t}-`:""}${a.join("-")}`,d=X5(a,l);Object.assign(s,{[u]:d}),hE(i,a,`var(${u})`,c),hE(o,a,`var(${u}, ${d})`,c)}},a=>a[0]==="vars"),{css:s,vars:i,varsWithDefaults:o}}function K5(r,e={}){const{getSelector:t=w,disableCssColorScheme:n,colorSchemeSelector:s,enableContrastVars:i}=e,{colorSchemes:o={},components:a,defaultColorScheme:l="light",...c}=r,{vars:u,css:d,varsWithDefaults:f}=Qy(c,e);let p=f;const m={},{[l]:v,...T}=o;if(Object.entries(T||{}).forEach(([k,O])=>{const{vars:M,css:x,varsWithDefaults:E}=Qy(O,e);p=Gr(p,E),m[k]={css:x,vars:M}}),v){const{css:k,vars:O,varsWithDefaults:M}=Qy(v,e);p=Gr(p,M),m[l]={css:k,vars:O}}function w(k,O){var x,E;let M=s;if(s==="class"&&(M=".%s"),s==="data"&&(M="[data-%s]"),s!=null&&s.startsWith("data-")&&!s.includes("%s")&&(M=`[${s}="%s"]`),k){if(M==="media")return r.defaultColorScheme===k?":root":{[`@media (prefers-color-scheme: ${((E=(x=o[k])==null?void 0:x.palette)==null?void 0:E.mode)||k})`]:{":root":O}};if(M)return r.defaultColorScheme===k?`:root, ${M.replace("%s",String(k))}`:M.replace("%s",String(k))}return":root"}return{vars:p,generateThemeVars:()=>{let k={...u};return Object.entries(m).forEach(([,{vars:O}])=>{k=Gr(k,O)}),k},generateStyleSheets:()=>{var A,P;const k=[],O=r.defaultColorScheme||"light";function M(R,_){Object.keys(_).length&&k.push(typeof R=="string"?{[R]:{..._}}:R)}M(t(void 0,{...d}),d);const{[O]:x,...E}=m;if(x){const{css:R}=x,_=(P=(A=o[O])==null?void 0:A.palette)==null?void 0:P.mode,b=!n&&_?{colorScheme:_,...R}:{...R};M(t(O,{...b}),b)}return Object.entries(E).forEach(([R,{css:_}])=>{var te,ue;const b=(ue=(te=o[R])==null?void 0:te.palette)==null?void 0:ue.mode,B=!n&&b?{colorScheme:b,..._}:{..._};M(t(R,{...B}),B)}),i&&k.push({":root":{"--__l-threshold":"0.7","--__l":"clamp(0, (l / var(--__l-threshold) - 1) * -infinity, 1)","--__a":"clamp(0.87, (l / var(--__l-threshold) - 1) * -infinity, 1)"}}),k}}}function Q5(r){return function(t){return r==="media"?`@media (prefers-color-scheme: ${t})`:r?r.startsWith("data-")&&!r.includes("%s")?`[${r}="${t}"] &`:r==="class"?`.${t} &`:r==="data"?`[data-${t}] &`:`${r.replace("%s",t)} &`:"&"}}const Yu={black:"#000",white:"#fff"},J5={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Na={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},Fa={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},Vc={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},La={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},Va={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},ja={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function L2(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Yu.white,default:Yu.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const V2=L2();function j2(){return{text:{primary:Yu.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Yu.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const L0=j2();function dE(r,e,t,n){const s=n.light||n,i=n.dark||n*1.5;r[e]||(r.hasOwnProperty(t)?r[e]=r[t]:e==="light"?r.light=dm(r.main,s):e==="dark"&&(r.dark=hm(r.main,i)))}function fE(r,e,t,n,s){const i=s.light||s,o=s.dark||s*1.5;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:t==="light"?e.light=`color-mix(in ${r}, ${e.main}, #fff ${(i*100).toFixed(0)}%)`:t==="dark"&&(e.dark=`color-mix(in ${r}, ${e.main}, #000 ${(o*100).toFixed(0)}%)`))}function Z5(r="light"){return r==="dark"?{main:La[200],light:La[50],dark:La[400]}:{main:La[700],light:La[400],dark:La[800]}}function e3(r="light"){return r==="dark"?{main:Na[200],light:Na[50],dark:Na[400]}:{main:Na[500],light:Na[300],dark:Na[700]}}function t3(r="light"){return r==="dark"?{main:Fa[500],light:Fa[300],dark:Fa[700]}:{main:Fa[700],light:Fa[400],dark:Fa[800]}}function r3(r="light"){return r==="dark"?{main:Va[400],light:Va[300],dark:Va[700]}:{main:Va[700],light:Va[500],dark:Va[900]}}function n3(r="light"){return r==="dark"?{main:ja[400],light:ja[300],dark:ja[700]}:{main:ja[800],light:ja[500],dark:ja[900]}}function s3(r="light"){return r==="dark"?{main:Vc[400],light:Vc[300],dark:Vc[700]}:{main:"#ed6c02",light:Vc[500],dark:Vc[900]}}function i3(r){return`oklch(from ${r} var(--__l) 0 h / var(--__a))`}function sS(r){const{mode:e="light",contrastThreshold:t=3,tonalOffset:n=.2,colorSpace:s,...i}=r,o=r.primary||Z5(e),a=r.secondary||e3(e),l=r.error||t3(e),c=r.info||r3(e),u=r.success||n3(e),d=r.warning||s3(e);function f(T){return s?i3(T):B5(T,L0.text.primary)>=t?L0.text.primary:V2.text.primary}const p=({color:T,name:w,mainShade:y=500,lightShade:C=300,darkShade:k=700})=>{if(T={...T},!T.main&&T[y]&&(T.main=T[y]),!T.hasOwnProperty("main"))throw new Error(Zo(11,w?` (${w})`:"",y));if(typeof T.main!="string")throw new Error(Zo(12,w?` (${w})`:"",JSON.stringify(T.main)));return s?(fE(s,T,"light",C,n),fE(s,T,"dark",k,n)):(dE(T,"light",C,n),dE(T,"dark",k,n)),T.contrastText||(T.contrastText=f(T.main)),T};let m;return e==="light"?m=L2():e==="dark"&&(m=j2()),Gr({common:{...Yu},mode:e,primary:p({color:o,name:"primary"}),secondary:p({color:a,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:p({color:l,name:"error"}),warning:p({color:d,name:"warning"}),info:p({color:c,name:"info"}),success:p({color:u,name:"success"}),grey:J5,contrastThreshold:t,getContrastText:f,augmentColor:p,tonalOffset:n,...m},i)}function o3(r){const e={};return Object.entries(r).forEach(n=>{const[s,i]=n;typeof i=="object"&&(e[s]=`${i.fontStyle?`${i.fontStyle} `:""}${i.fontVariant?`${i.fontVariant} `:""}${i.fontWeight?`${i.fontWeight} `:""}${i.fontStretch?`${i.fontStretch} `:""}${i.fontSize||""}${i.lineHeight?`/${i.lineHeight} `:""}${i.fontFamily||""}`)}),e}function a3(r,e){return{toolbar:{minHeight:56,[r.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[r.up("sm")]:{minHeight:64}},...e}}function l3(r){return Math.round(r*1e5)/1e5}const pE={textTransform:"uppercase"},gE='"Roboto", "Helvetica", "Arial", sans-serif';function c3(r,e){const{fontFamily:t=gE,fontSize:n=14,fontWeightLight:s=300,fontWeightRegular:i=400,fontWeightMedium:o=500,fontWeightBold:a=700,htmlFontSize:l=16,allVariants:c,pxToRem:u,...d}=typeof e=="function"?e(r):e,f=n/14,p=u||(T=>`${T/l*f}rem`),m=(T,w,y,C,k)=>({fontFamily:t,fontWeight:T,fontSize:p(w),lineHeight:y,...t===gE?{letterSpacing:`${l3(C/w)}em`}:{},...k,...c}),v={h1:m(s,96,1.167,-1.5),h2:m(s,60,1.2,-.5),h3:m(i,48,1.167,0),h4:m(i,34,1.235,.25),h5:m(i,24,1.334,0),h6:m(o,20,1.6,.15),subtitle1:m(i,16,1.75,.15),subtitle2:m(o,14,1.57,.1),body1:m(i,16,1.5,.15),body2:m(i,14,1.43,.15),button:m(o,14,1.75,.4,pE),caption:m(i,12,1.66,.4),overline:m(i,12,2.66,1,pE),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Gr({htmlFontSize:l,pxToRem:p,fontFamily:t,fontSize:n,fontWeightLight:s,fontWeightRegular:i,fontWeightMedium:o,fontWeightBold:a,...v},d,{clone:!1})}const u3=.2,h3=.14,d3=.12;function Qe(...r){return[`${r[0]}px ${r[1]}px ${r[2]}px ${r[3]}px rgba(0,0,0,${u3})`,`${r[4]}px ${r[5]}px ${r[6]}px ${r[7]}px rgba(0,0,0,${h3})`,`${r[8]}px ${r[9]}px ${r[10]}px ${r[11]}px rgba(0,0,0,${d3})`].join(",")}const f3=["none",Qe(0,2,1,-1,0,1,1,0,0,1,3,0),Qe(0,3,1,-2,0,2,2,0,0,1,5,0),Qe(0,3,3,-2,0,3,4,0,0,1,8,0),Qe(0,2,4,-1,0,4,5,0,0,1,10,0),Qe(0,3,5,-1,0,5,8,0,0,1,14,0),Qe(0,3,5,-1,0,6,10,0,0,1,18,0),Qe(0,4,5,-2,0,7,10,1,0,2,16,1),Qe(0,5,5,-3,0,8,10,1,0,3,14,2),Qe(0,5,6,-3,0,9,12,1,0,3,16,2),Qe(0,6,6,-3,0,10,14,1,0,4,18,3),Qe(0,6,7,-4,0,11,15,1,0,4,20,3),Qe(0,7,8,-4,0,12,17,2,0,5,22,4),Qe(0,7,8,-4,0,13,19,2,0,5,24,4),Qe(0,7,9,-4,0,14,21,2,0,5,26,4),Qe(0,8,9,-5,0,15,22,2,0,6,28,5),Qe(0,8,10,-5,0,16,24,2,0,6,30,5),Qe(0,8,11,-5,0,17,26,2,0,6,32,5),Qe(0,9,11,-5,0,18,28,2,0,7,34,6),Qe(0,9,12,-6,0,19,29,2,0,7,36,6),Qe(0,10,13,-6,0,20,31,3,0,8,38,7),Qe(0,10,13,-6,0,21,33,3,0,8,40,7),Qe(0,10,14,-6,0,22,35,3,0,8,42,7),Qe(0,11,14,-7,0,23,36,3,0,9,44,8),Qe(0,11,15,-7,0,24,38,3,0,9,46,8)],p3={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},g3={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function mE(r){return`${Math.round(r)}ms`}function m3(r){if(!r)return 0;const e=r/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function y3(r){const e={...p3,...r.easing},t={...g3,...r.duration};return{getAutoHeightDuration:m3,create:(s=["all"],i={})=>{const{duration:o=t.standard,easing:a=e.easeInOut,delay:l=0,...c}=i;return(Array.isArray(s)?s:[s]).map(u=>`${u} ${typeof o=="string"?o:mE(o)} ${a} ${typeof l=="string"?l:mE(l)}`).join(",")},...r,easing:e,duration:t}}const v3={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function _3(r){return Ti(r)||typeof r>"u"||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||Array.isArray(r)}function $2(r={}){const e={...r};function t(n){const s=Object.entries(n);for(let i=0;i<s.length;i++){const[o,a]=s[i];!_3(a)||o.startsWith("unstable_")?delete n[o]:Ti(a)&&(n[o]={...a},t(n[o]))}}return t(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function yE(r){return typeof r=="number"?`${(r*100).toFixed(0)}%`:`calc((${r}) * 100%)`}const w3=r=>{if(!Number.isNaN(+r))return+r;const e=r.match(/\d*\.?\d+/g);if(!e)return 0;let t=0;for(let n=0;n<e.length;n+=1)t+=+e[n];return t};function S3(r){Object.assign(r,{alpha(e,t){const n=this||r;return n.colorSpace?`oklch(from ${e} l c h / ${typeof t=="string"?`calc(${t})`:t})`:n.vars?`rgba(${e.replace(/var\(--([^,\s)]+)(?:,[^)]+)?\)+/g,"var(--$1Channel)")} / ${typeof t=="string"?`calc(${t})`:t})`:F2(e,w3(t))},lighten(e,t){const n=this||r;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #fff ${yE(t)})`:dm(e,t)},darken(e,t){const n=this||r;return n.colorSpace?`color-mix(in ${n.colorSpace}, ${e}, #000 ${yE(t)})`:hm(e,t)}})}function V0(r={},...e){const{breakpoints:t,mixins:n={},spacing:s,palette:i={},transitions:o={},typography:a={},shape:l,colorSpace:c,...u}=r;if(r.vars&&r.generateThemeVars===void 0)throw new Error(Zo(20));const d=sS({...i,colorSpace:c}),f=D2(r);let p=Gr(f,{mixins:a3(f.breakpoints,n),palette:d,shadows:f3.slice(),typography:c3(d,a),transitions:y3(o),zIndex:{...v3}});return p=Gr(p,u),p=e.reduce((m,v)=>Gr(m,v),p),p.unstable_sxConfig={...qg,...u==null?void 0:u.unstable_sxConfig},p.unstable_sx=function(v){return Yg({sx:v,theme:this})},p.toRuntimeSource=$2,S3(p),p}function T3(r){let e;return r<1?e=5.11916*r**2:e=4.5*Math.log(r+1)+2,Math.round(e*10)/1e3}const C3=[...Array(25)].map((r,e)=>{if(e===0)return"none";const t=T3(e);return`linear-gradient(rgba(255 255 255 / ${t}), rgba(255 255 255 / ${t}))`});function U2(r){return{inputPlaceholder:r==="dark"?.5:.42,inputUnderline:r==="dark"?.7:.42,switchTrackDisabled:r==="dark"?.2:.12,switchTrack:r==="dark"?.3:.38}}function B2(r){return r==="dark"?C3:[]}function E3(r){const{palette:e={mode:"light"},opacity:t,overlays:n,colorSpace:s,...i}=r,o=sS({...e,colorSpace:s});return{palette:o,opacity:{...U2(o.mode),...t},overlays:n||B2(o.mode),...i}}function x3(r){var e;return!!r[0].match(/(cssVarPrefix|colorSchemeSelector|modularCssLayers|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!r[0].match(/sxConfig$/)||r[0]==="palette"&&!!((e=r[1])!=null&&e.match(/(mode|contrastThreshold|tonalOffset)/))}const b3=r=>[...[...Array(25)].map((e,t)=>`--${r?`${r}-`:""}overlays-${t}`),`--${r?`${r}-`:""}palette-AppBar-darkBg`,`--${r?`${r}-`:""}palette-AppBar-darkColor`],A3=r=>(e,t)=>{const n=r.rootSelector||":root",s=r.colorSchemeSelector;let i=s;if(s==="class"&&(i=".%s"),s==="data"&&(i="[data-%s]"),s!=null&&s.startsWith("data-")&&!s.includes("%s")&&(i=`[${s}="%s"]`),r.defaultColorScheme===e){if(e==="dark"){const o={};return b3(r.cssVarPrefix).forEach(a=>{o[a]=t[a],delete t[a]}),i==="media"?{[n]:t,"@media (prefers-color-scheme: dark)":{[n]:o}}:i?{[i.replace("%s",e)]:o,[`${n}, ${i.replace("%s",e)}`]:t}:{[n]:{...t,...o}}}if(i&&i!=="media")return`${n}, ${i.replace("%s",String(e))}`}else if(e){if(i==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[n]:t}};if(i)return i.replace("%s",String(e))}return n};function k3(r,e){e.forEach(t=>{r[t]||(r[t]={})})}function W(r,e,t){!r[e]&&t&&(r[e]=t)}function Xc(r){return typeof r!="string"||!r.startsWith("hsl")?r:N2(r)}function xs(r,e){`${e}Channel`in r||(r[`${e}Channel`]=Yc(Xc(r[e])))}function I3(r){return typeof r=="number"?`${r}px`:typeof r=="string"||typeof r=="function"||Array.isArray(r)?r:"8px"}const qn=r=>{try{return r()}catch{}},P3=(r="mui")=>q5(r);function Jy(r,e,t,n,s){if(!t)return;t=t===!0?{}:t;const i=s==="dark"?"dark":"light";if(!n){e[s]=E3({...t,palette:{mode:i,...t==null?void 0:t.palette},colorSpace:r});return}const{palette:o,...a}=V0({...n,palette:{mode:i,...t==null?void 0:t.palette},colorSpace:r});return e[s]={...t,palette:o,opacity:{...U2(i),...t==null?void 0:t.opacity},overlays:(t==null?void 0:t.overlays)||B2(i)},a}function R3(r={},...e){const{colorSchemes:t={light:!0},defaultColorScheme:n,disableCssColorScheme:s=!1,cssVarPrefix:i="mui",nativeColor:o=!1,shouldSkipGeneratingVar:a=x3,colorSchemeSelector:l=t.light&&t.dark?"media":void 0,rootSelector:c=":root",...u}=r,d=Object.keys(t)[0],f=n||(t.light&&d!=="light"?"light":d),p=P3(i),{[f]:m,light:v,dark:T,...w}=t,y={...w};let C=m;if((f==="dark"&&!("dark"in t)||f==="light"&&!("light"in t))&&(C=!0),!C)throw new Error(Zo(21,f));let k;o&&(k="oklch");const O=Jy(k,y,C,u,f);v&&!y.light&&Jy(k,y,v,void 0,"light"),T&&!y.dark&&Jy(k,y,T,void 0,"dark");let M={defaultColorScheme:f,...O,cssVarPrefix:i,colorSchemeSelector:l,rootSelector:c,getCssVar:p,colorSchemes:y,font:{...o3(O.typography),...O.font},spacing:I3(u.spacing)};Object.keys(M.colorSchemes).forEach(R=>{const _=M.colorSchemes[R].palette,b=te=>{const ue=te.split("-"),ge=ue[1],Y=ue[2];return p(te,_[ge][Y])};_.mode==="light"&&(W(_.common,"background","#fff"),W(_.common,"onBackground","#000")),_.mode==="dark"&&(W(_.common,"background","#000"),W(_.common,"onBackground","#fff"));function B(te,ue,ge){if(k){let Y;return te===So&&(Y=`transparent ${((1-ge)*100).toFixed(0)}%`),te===Fe&&(Y=`#000 ${(ge*100).toFixed(0)}%`),te===Le&&(Y=`#fff ${(ge*100).toFixed(0)}%`),`color-mix(in ${k}, ${ue}, ${Y})`}return te(ue,ge)}if(k3(_,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),_.mode==="light"){W(_.Alert,"errorColor",B(Fe,_.error.light,.6)),W(_.Alert,"infoColor",B(Fe,_.info.light,.6)),W(_.Alert,"successColor",B(Fe,_.success.light,.6)),W(_.Alert,"warningColor",B(Fe,_.warning.light,.6)),W(_.Alert,"errorFilledBg",b("palette-error-main")),W(_.Alert,"infoFilledBg",b("palette-info-main")),W(_.Alert,"successFilledBg",b("palette-success-main")),W(_.Alert,"warningFilledBg",b("palette-warning-main")),W(_.Alert,"errorFilledColor",qn(()=>_.getContrastText(_.error.main))),W(_.Alert,"infoFilledColor",qn(()=>_.getContrastText(_.info.main))),W(_.Alert,"successFilledColor",qn(()=>_.getContrastText(_.success.main))),W(_.Alert,"warningFilledColor",qn(()=>_.getContrastText(_.warning.main))),W(_.Alert,"errorStandardBg",B(Le,_.error.light,.9)),W(_.Alert,"infoStandardBg",B(Le,_.info.light,.9)),W(_.Alert,"successStandardBg",B(Le,_.success.light,.9)),W(_.Alert,"warningStandardBg",B(Le,_.warning.light,.9)),W(_.Alert,"errorIconColor",b("palette-error-main")),W(_.Alert,"infoIconColor",b("palette-info-main")),W(_.Alert,"successIconColor",b("palette-success-main")),W(_.Alert,"warningIconColor",b("palette-warning-main")),W(_.AppBar,"defaultBg",b("palette-grey-100")),W(_.Avatar,"defaultBg",b("palette-grey-400")),W(_.Button,"inheritContainedBg",b("palette-grey-300")),W(_.Button,"inheritContainedHoverBg",b("palette-grey-A100")),W(_.Chip,"defaultBorder",b("palette-grey-400")),W(_.Chip,"defaultAvatarColor",b("palette-grey-700")),W(_.Chip,"defaultIconColor",b("palette-grey-700")),W(_.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),W(_.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),W(_.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),W(_.LinearProgress,"primaryBg",B(Le,_.primary.main,.62)),W(_.LinearProgress,"secondaryBg",B(Le,_.secondary.main,.62)),W(_.LinearProgress,"errorBg",B(Le,_.error.main,.62)),W(_.LinearProgress,"infoBg",B(Le,_.info.main,.62)),W(_.LinearProgress,"successBg",B(Le,_.success.main,.62)),W(_.LinearProgress,"warningBg",B(Le,_.warning.main,.62)),W(_.Skeleton,"bg",k?B(So,_.text.primary,.11):`rgba(${b("palette-text-primaryChannel")} / 0.11)`),W(_.Slider,"primaryTrack",B(Le,_.primary.main,.62)),W(_.Slider,"secondaryTrack",B(Le,_.secondary.main,.62)),W(_.Slider,"errorTrack",B(Le,_.error.main,.62)),W(_.Slider,"infoTrack",B(Le,_.info.main,.62)),W(_.Slider,"successTrack",B(Le,_.success.main,.62)),W(_.Slider,"warningTrack",B(Le,_.warning.main,.62));const te=k?B(Fe,_.background.default,.6825):Ad(_.background.default,.8);W(_.SnackbarContent,"bg",te),W(_.SnackbarContent,"color",qn(()=>k?L0.text.primary:_.getContrastText(te))),W(_.SpeedDialAction,"fabHoverBg",Ad(_.background.paper,.15)),W(_.StepConnector,"border",b("palette-grey-400")),W(_.StepContent,"border",b("palette-grey-400")),W(_.Switch,"defaultColor",b("palette-common-white")),W(_.Switch,"defaultDisabledColor",b("palette-grey-100")),W(_.Switch,"primaryDisabledColor",B(Le,_.primary.main,.62)),W(_.Switch,"secondaryDisabledColor",B(Le,_.secondary.main,.62)),W(_.Switch,"errorDisabledColor",B(Le,_.error.main,.62)),W(_.Switch,"infoDisabledColor",B(Le,_.info.main,.62)),W(_.Switch,"successDisabledColor",B(Le,_.success.main,.62)),W(_.Switch,"warningDisabledColor",B(Le,_.warning.main,.62)),W(_.TableCell,"border",B(Le,B(So,_.divider,1),.88)),W(_.Tooltip,"bg",B(So,_.grey[700],.92))}if(_.mode==="dark"){W(_.Alert,"errorColor",B(Le,_.error.light,.6)),W(_.Alert,"infoColor",B(Le,_.info.light,.6)),W(_.Alert,"successColor",B(Le,_.success.light,.6)),W(_.Alert,"warningColor",B(Le,_.warning.light,.6)),W(_.Alert,"errorFilledBg",b("palette-error-dark")),W(_.Alert,"infoFilledBg",b("palette-info-dark")),W(_.Alert,"successFilledBg",b("palette-success-dark")),W(_.Alert,"warningFilledBg",b("palette-warning-dark")),W(_.Alert,"errorFilledColor",qn(()=>_.getContrastText(_.error.dark))),W(_.Alert,"infoFilledColor",qn(()=>_.getContrastText(_.info.dark))),W(_.Alert,"successFilledColor",qn(()=>_.getContrastText(_.success.dark))),W(_.Alert,"warningFilledColor",qn(()=>_.getContrastText(_.warning.dark))),W(_.Alert,"errorStandardBg",B(Fe,_.error.light,.9)),W(_.Alert,"infoStandardBg",B(Fe,_.info.light,.9)),W(_.Alert,"successStandardBg",B(Fe,_.success.light,.9)),W(_.Alert,"warningStandardBg",B(Fe,_.warning.light,.9)),W(_.Alert,"errorIconColor",b("palette-error-main")),W(_.Alert,"infoIconColor",b("palette-info-main")),W(_.Alert,"successIconColor",b("palette-success-main")),W(_.Alert,"warningIconColor",b("palette-warning-main")),W(_.AppBar,"defaultBg",b("palette-grey-900")),W(_.AppBar,"darkBg",b("palette-background-paper")),W(_.AppBar,"darkColor",b("palette-text-primary")),W(_.Avatar,"defaultBg",b("palette-grey-600")),W(_.Button,"inheritContainedBg",b("palette-grey-800")),W(_.Button,"inheritContainedHoverBg",b("palette-grey-700")),W(_.Chip,"defaultBorder",b("palette-grey-700")),W(_.Chip,"defaultAvatarColor",b("palette-grey-300")),W(_.Chip,"defaultIconColor",b("palette-grey-300")),W(_.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),W(_.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),W(_.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),W(_.LinearProgress,"primaryBg",B(Fe,_.primary.main,.5)),W(_.LinearProgress,"secondaryBg",B(Fe,_.secondary.main,.5)),W(_.LinearProgress,"errorBg",B(Fe,_.error.main,.5)),W(_.LinearProgress,"infoBg",B(Fe,_.info.main,.5)),W(_.LinearProgress,"successBg",B(Fe,_.success.main,.5)),W(_.LinearProgress,"warningBg",B(Fe,_.warning.main,.5)),W(_.Skeleton,"bg",k?B(So,_.text.primary,.13):`rgba(${b("palette-text-primaryChannel")} / 0.13)`),W(_.Slider,"primaryTrack",B(Fe,_.primary.main,.5)),W(_.Slider,"secondaryTrack",B(Fe,_.secondary.main,.5)),W(_.Slider,"errorTrack",B(Fe,_.error.main,.5)),W(_.Slider,"infoTrack",B(Fe,_.info.main,.5)),W(_.Slider,"successTrack",B(Fe,_.success.main,.5)),W(_.Slider,"warningTrack",B(Fe,_.warning.main,.5));const te=k?B(Le,_.background.default,.985):Ad(_.background.default,.98);W(_.SnackbarContent,"bg",te),W(_.SnackbarContent,"color",qn(()=>k?V2.text.primary:_.getContrastText(te))),W(_.SpeedDialAction,"fabHoverBg",Ad(_.background.paper,.15)),W(_.StepConnector,"border",b("palette-grey-600")),W(_.StepContent,"border",b("palette-grey-600")),W(_.Switch,"defaultColor",b("palette-grey-300")),W(_.Switch,"defaultDisabledColor",b("palette-grey-600")),W(_.Switch,"primaryDisabledColor",B(Fe,_.primary.main,.55)),W(_.Switch,"secondaryDisabledColor",B(Fe,_.secondary.main,.55)),W(_.Switch,"errorDisabledColor",B(Fe,_.error.main,.55)),W(_.Switch,"infoDisabledColor",B(Fe,_.info.main,.55)),W(_.Switch,"successDisabledColor",B(Fe,_.success.main,.55)),W(_.Switch,"warningDisabledColor",B(Fe,_.warning.main,.55)),W(_.TableCell,"border",B(Fe,B(So,_.divider,1),.68)),W(_.Tooltip,"bg",B(So,_.grey[700],.92))}xs(_.background,"default"),xs(_.background,"paper"),xs(_.common,"background"),xs(_.common,"onBackground"),xs(_,"divider"),Object.keys(_).forEach(te=>{const ue=_[te];te!=="tonalOffset"&&ue&&typeof ue=="object"&&(ue.main&&W(_[te],"mainChannel",Yc(Xc(ue.main))),ue.light&&W(_[te],"lightChannel",Yc(Xc(ue.light))),ue.dark&&W(_[te],"darkChannel",Yc(Xc(ue.dark))),ue.contrastText&&W(_[te],"contrastTextChannel",Yc(Xc(ue.contrastText))),te==="text"&&(xs(_[te],"primary"),xs(_[te],"secondary")),te==="action"&&(ue.active&&xs(_[te],"active"),ue.selected&&xs(_[te],"selected")))})}),M=e.reduce((R,_)=>Gr(R,_),M);const x={prefix:i,disableCssColorScheme:s,shouldSkipGeneratingVar:a,getSelector:A3(M),enableContrastVars:o},{vars:E,generateThemeVars:A,generateStyleSheets:P}=K5(M,x);return M.vars=E,Object.entries(M.colorSchemes[M.defaultColorScheme]).forEach(([R,_])=>{M[R]=_}),M.generateThemeVars=A,M.generateStyleSheets=P,M.generateSpacing=function(){return O2(u.spacing,Hw(this))},M.getColorSchemeSelector=Q5(l),M.spacing=M.generateSpacing(),M.shouldSkipGeneratingVar=a,M.unstable_sxConfig={...qg,...u==null?void 0:u.unstable_sxConfig},M.unstable_sx=function(_){return Yg({sx:_,theme:this})},M.toRuntimeSource=$2,M}function vE(r,e,t){r.colorSchemes&&t&&(r.colorSchemes[e]={...t!==!0&&t,palette:sS({...t===!0?{}:t.palette,mode:e})})}function O3(r={},...e){const{palette:t,cssVariables:n=!1,colorSchemes:s=t?void 0:{light:!0},defaultColorScheme:i=t==null?void 0:t.mode,...o}=r,a=i||"light",l=s==null?void 0:s[a],c={...s,...t?{[a]:{...typeof l!="boolean"&&l,palette:t}}:void 0};if(n===!1){if(!("colorSchemes"in r))return V0(r,...e);let u=t;"palette"in r||c[a]&&(c[a]!==!0?u=c[a].palette:a==="dark"&&(u={mode:"dark"}));const d=V0({...r,palette:u},...e);return d.defaultColorScheme=a,d.colorSchemes=c,d.palette.mode==="light"&&(d.colorSchemes.light={...c.light!==!0&&c.light,palette:d.palette},vE(d,"dark",c.dark)),d.palette.mode==="dark"&&(d.colorSchemes.dark={...c.dark!==!0&&c.dark,palette:d.palette},vE(d,"light",c.light)),d}return!t&&!("light"in c)&&a==="light"&&(c.light=!0),R3({...o,colorSchemes:c,defaultColorScheme:a,...typeof n!="boolean"&&n},...e)}const D3=O3(),M3="$$material";function N3(r){return D.jsx(L5,{...r,defaultTheme:D3,themeId:M3})}function z2(r){return function(t){return D.jsx(N3,{styles:typeof r=="function"?n=>r({theme:n,...t}):r})}}function F3(r){return G5(r)}const j0=typeof z2({})=="function",L3=(r,e)=>({WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale",boxSizing:"border-box",WebkitTextSizeAdjust:"100%",...e&&!r.vars&&{colorScheme:r.palette.mode}}),V3=r=>({color:(r.vars||r).palette.text.primary,...r.typography.body1,backgroundColor:(r.vars||r).palette.background.default,"@media print":{backgroundColor:(r.vars||r).palette.common.white}}),W2=(r,e=!1)=>{var i,o;const t={};e&&r.colorSchemes&&typeof r.getColorSchemeSelector=="function"&&Object.entries(r.colorSchemes).forEach(([a,l])=>{var u,d;const c=r.getColorSchemeSelector(a);c.startsWith("@")?t[c]={":root":{colorScheme:(u=l.palette)==null?void 0:u.mode}}:t[c.replace(/\s*&/,"")]={colorScheme:(d=l.palette)==null?void 0:d.mode}});let n={html:L3(r,e),"*, *::before, *::after":{boxSizing:"inherit"},"strong, b":{fontWeight:r.typography.fontWeightBold},body:{margin:0,...V3(r),"&::backdrop":{backgroundColor:(r.vars||r).palette.background.default}},...t};const s=(o=(i=r.components)==null?void 0:i.MuiCssBaseline)==null?void 0:o.styleOverrides;return s&&(n=[n,s]),n},kf="mui-ecs",j3=r=>{const e=W2(r,!1),t=Array.isArray(e)?e[0]:e;return!r.vars&&t&&(t.html[`:root:has(${kf})`]={colorScheme:r.palette.mode}),r.colorSchemes&&Object.entries(r.colorSchemes).forEach(([n,s])=>{var o,a;const i=r.getColorSchemeSelector(n);i.startsWith("@")?t[i]={[`:root:not(:has(.${kf}))`]:{colorScheme:(o=s.palette)==null?void 0:o.mode}}:t[i.replace(/\s*&/,"")]={[`&:not(:has(.${kf}))`]:{colorScheme:(a=s.palette)==null?void 0:a.mode}}}),e},$3=z2(j0?({theme:r,enableColorScheme:e})=>W2(r,e):({theme:r})=>j3(r));function U3(r){const e=F3({props:r,name:"MuiCssBaseline"}),{children:t,enableColorScheme:n=!1}=e;return D.jsxs(L.Fragment,{children:[j0&&D.jsx($3,{enableColorScheme:n}),!j0&&!n&&D.jsx("span",{className:kf,style:{display:"none"}}),t]})}function Bt(r){return`Minified Redux error #${r}; visit https://redux.js.org/Errors?code=${r} for the full message or use the non-minified dev environment for full errors. `}var B3=typeof Symbol=="function"&&Symbol.observable||"@@observable",_E=B3,Zy=()=>Math.random().toString(36).substring(7).split("").join("."),z3={INIT:`@@redux/INIT${Zy()}`,REPLACE:`@@redux/REPLACE${Zy()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Zy()}`},xp=z3;function iS(r){if(typeof r!="object"||r===null)return!1;let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e||Object.getPrototypeOf(r)===null}function H2(r,e,t){if(typeof r!="function")throw new Error(Bt(2));if(typeof e=="function"&&typeof t=="function"||typeof t=="function"&&typeof arguments[3]=="function")throw new Error(Bt(0));if(typeof e=="function"&&typeof t>"u"&&(t=e,e=void 0),typeof t<"u"){if(typeof t!="function")throw new Error(Bt(1));return t(H2)(r,e)}let n=r,s=e,i=new Map,o=i,a=0,l=!1;function c(){o===i&&(o=new Map,i.forEach((T,w)=>{o.set(w,T)}))}function u(){if(l)throw new Error(Bt(3));return s}function d(T){if(typeof T!="function")throw new Error(Bt(4));if(l)throw new Error(Bt(5));let w=!0;c();const y=a++;return o.set(y,T),function(){if(w){if(l)throw new Error(Bt(6));w=!1,c(),o.delete(y),i=null}}}function f(T){if(!iS(T))throw new Error(Bt(7));if(typeof T.type>"u")throw new Error(Bt(8));if(typeof T.type!="string")throw new Error(Bt(17));if(l)throw new Error(Bt(9));try{l=!0,s=n(s,T)}finally{l=!1}return(i=o).forEach(y=>{y()}),T}function p(T){if(typeof T!="function")throw new Error(Bt(10));n=T,f({type:xp.REPLACE})}function m(){const T=d;return{subscribe(w){if(typeof w!="object"||w===null)throw new Error(Bt(11));function y(){const k=w;k.next&&k.next(u())}return y(),{unsubscribe:T(y)}},[_E](){return this}}}return f({type:xp.INIT}),{dispatch:f,subscribe:d,getState:u,replaceReducer:p,[_E]:m}}function W3(r){Object.keys(r).forEach(e=>{const t=r[e];if(typeof t(void 0,{type:xp.INIT})>"u")throw new Error(Bt(12));if(typeof t(void 0,{type:xp.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Bt(13))})}function G2(r){const e=Object.keys(r),t={};for(let i=0;i<e.length;i++){const o=e[i];typeof r[o]=="function"&&(t[o]=r[o])}const n=Object.keys(t);let s;try{W3(t)}catch(i){s=i}return function(o={},a){if(s)throw s;let l=!1;const c={};for(let u=0;u<n.length;u++){const d=n[u],f=t[d],p=o[d],m=f(p,a);if(typeof m>"u")throw a&&a.type,new Error(Bt(14));c[d]=m,l=l||m!==p}return l=l||n.length!==Object.keys(o).length,l?c:o}}function bp(...r){return r.length===0?e=>e:r.length===1?r[0]:r.reduce((e,t)=>(...n)=>e(t(...n)))}function H3(...r){return e=>(t,n)=>{const s=e(t,n);let i=()=>{throw new Error(Bt(15))};const o={getState:s.getState,dispatch:(l,...c)=>i(l,...c)},a=r.map(l=>l(o));return i=bp(...a)(s.dispatch),{...s,dispatch:i}}}function G3(r){return iS(r)&&"type"in r&&typeof r.type=="string"}var q2=Symbol.for("immer-nothing"),wE=Symbol.for("immer-draftable"),Kr=Symbol.for("immer-state");function kn(r,...e){throw new Error(`[Immer] minified error nr: ${r}. Full error at: https://bit.ly/3cXEKWf`)}var Vl=Object.getPrototypeOf;function ea(r){return!!r&&!!r[Kr]}function Zs(r){var e;return r?Y2(r)||Array.isArray(r)||!!r[wE]||!!((e=r.constructor)!=null&&e[wE])||pm(r)||gm(r):!1}var q3=Object.prototype.constructor.toString();function Y2(r){if(!r||typeof r!="object")return!1;const e=Vl(r);if(e===null)return!0;const t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return t===Object?!0:typeof t=="function"&&Function.toString.call(t)===q3}function Ap(r,e){fm(r)===0?Reflect.ownKeys(r).forEach(t=>{e(t,r[t],r)}):r.forEach((t,n)=>e(n,t,r))}function fm(r){const e=r[Kr];return e?e.type_:Array.isArray(r)?1:pm(r)?2:gm(r)?3:0}function $0(r,e){return fm(r)===2?r.has(e):Object.prototype.hasOwnProperty.call(r,e)}function X2(r,e,t){const n=fm(r);n===2?r.set(e,t):n===3?r.add(t):r[e]=t}function Y3(r,e){return r===e?r!==0||1/r===1/e:r!==r&&e!==e}function pm(r){return r instanceof Map}function gm(r){return r instanceof Set}function bo(r){return r.copy_||r.base_}function U0(r,e){if(pm(r))return new Map(r);if(gm(r))return new Set(r);if(Array.isArray(r))return Array.prototype.slice.call(r);const t=Y2(r);if(e===!0||e==="class_only"&&!t){const n=Object.getOwnPropertyDescriptors(r);delete n[Kr];let s=Reflect.ownKeys(n);for(let i=0;i<s.length;i++){const o=s[i],a=n[o];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(n[o]={configurable:!0,writable:!0,enumerable:a.enumerable,value:r[o]})}return Object.create(Vl(r),n)}else{const n=Vl(r);if(n!==null&&t)return{...r};const s=Object.create(n);return Object.assign(s,r)}}function oS(r,e=!1){return mm(r)||ea(r)||!Zs(r)||(fm(r)>1&&(r.set=r.add=r.clear=r.delete=X3),Object.freeze(r),e&&Object.entries(r).forEach(([t,n])=>oS(n,!0))),r}function X3(){kn(2)}function mm(r){return Object.isFrozen(r)}var K3={};function ta(r){const e=K3[r];return e||kn(0,r),e}var Xu;function K2(){return Xu}function Q3(r,e){return{drafts_:[],parent_:r,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function SE(r,e){e&&(ta("Patches"),r.patches_=[],r.inversePatches_=[],r.patchListener_=e)}function B0(r){z0(r),r.drafts_.forEach(J3),r.drafts_=null}function z0(r){r===Xu&&(Xu=r.parent_)}function TE(r){return Xu=Q3(Xu,r)}function J3(r){const e=r[Kr];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function CE(r,e){e.unfinalizedDrafts_=e.drafts_.length;const t=e.drafts_[0];return r!==void 0&&r!==t?(t[Kr].modified_&&(B0(e),kn(4)),Zs(r)&&(r=kp(e,r),e.parent_||Ip(e,r)),e.patches_&&ta("Patches").generateReplacementPatches_(t[Kr].base_,r,e.patches_,e.inversePatches_)):r=kp(e,t,[]),B0(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),r!==q2?r:void 0}function kp(r,e,t){if(mm(e))return e;const n=e[Kr];if(!n)return Ap(e,(s,i)=>EE(r,n,e,s,i,t)),e;if(n.scope_!==r)return e;if(!n.modified_)return Ip(r,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let i=s,o=!1;n.type_===3&&(i=new Set(s),s.clear(),o=!0),Ap(i,(a,l)=>EE(r,n,s,a,l,t,o)),Ip(r,s,!1),t&&r.patches_&&ta("Patches").generatePatches_(n,t,r.patches_,r.inversePatches_)}return n.copy_}function EE(r,e,t,n,s,i,o){if(ea(s)){const a=i&&e&&e.type_!==3&&!$0(e.assigned_,n)?i.concat(n):void 0,l=kp(r,s,a);if(X2(t,n,l),ea(l))r.canAutoFreeze_=!1;else return}else o&&t.add(s);if(Zs(s)&&!mm(s)){if(!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1)return;kp(r,s),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(t,n)&&Ip(r,s)}}function Ip(r,e,t=!1){!r.parent_&&r.immer_.autoFreeze_&&r.canAutoFreeze_&&oS(e,t)}function Z3(r,e){const t=Array.isArray(r),n={type_:t?1:0,scope_:e?e.scope_:K2(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:r,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,i=aS;t&&(s=[n],i=Ku);const{revoke:o,proxy:a}=Proxy.revocable(s,i);return n.draft_=a,n.revoke_=o,a}var aS={get(r,e){if(e===Kr)return r;const t=bo(r);if(!$0(t,e))return e$(r,t,e);const n=t[e];return r.finalized_||!Zs(n)?n:n===ev(r.base_,e)?(tv(r),r.copy_[e]=H0(n,r)):n},has(r,e){return e in bo(r)},ownKeys(r){return Reflect.ownKeys(bo(r))},set(r,e,t){const n=Q2(bo(r),e);if(n!=null&&n.set)return n.set.call(r.draft_,t),!0;if(!r.modified_){const s=ev(bo(r),e),i=s==null?void 0:s[Kr];if(i&&i.base_===t)return r.copy_[e]=t,r.assigned_[e]=!1,!0;if(Y3(t,s)&&(t!==void 0||$0(r.base_,e)))return!0;tv(r),W0(r)}return r.copy_[e]===t&&(t!==void 0||e in r.copy_)||Number.isNaN(t)&&Number.isNaN(r.copy_[e])||(r.copy_[e]=t,r.assigned_[e]=!0),!0},deleteProperty(r,e){return ev(r.base_,e)!==void 0||e in r.base_?(r.assigned_[e]=!1,tv(r),W0(r)):delete r.assigned_[e],r.copy_&&delete r.copy_[e],!0},getOwnPropertyDescriptor(r,e){const t=bo(r),n=Reflect.getOwnPropertyDescriptor(t,e);return n&&{writable:!0,configurable:r.type_!==1||e!=="length",enumerable:n.enumerable,value:t[e]}},defineProperty(){kn(11)},getPrototypeOf(r){return Vl(r.base_)},setPrototypeOf(){kn(12)}},Ku={};Ap(aS,(r,e)=>{Ku[r]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Ku.deleteProperty=function(r,e){return Ku.set.call(this,r,e,void 0)};Ku.set=function(r,e,t){return aS.set.call(this,r[0],e,t,r[0])};function ev(r,e){const t=r[Kr];return(t?bo(t):r)[e]}function e$(r,e,t){var s;const n=Q2(e,t);return n?"value"in n?n.value:(s=n.get)==null?void 0:s.call(r.draft_):void 0}function Q2(r,e){if(!(e in r))return;let t=Vl(r);for(;t;){const n=Object.getOwnPropertyDescriptor(t,e);if(n)return n;t=Vl(t)}}function W0(r){r.modified_||(r.modified_=!0,r.parent_&&W0(r.parent_))}function tv(r){r.copy_||(r.copy_=U0(r.base_,r.scope_.immer_.useStrictShallowCopy_))}var t$=class{constructor(r){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if(typeof e=="function"&&typeof t!="function"){const i=t;t=e;const o=this;return function(l=i,...c){return o.produce(l,u=>t.call(this,u,...c))}}typeof t!="function"&&kn(6),n!==void 0&&typeof n!="function"&&kn(7);let s;if(Zs(e)){const i=TE(this),o=H0(e,void 0);let a=!0;try{s=t(o),a=!1}finally{a?B0(i):z0(i)}return SE(i,n),CE(s,i)}else if(!e||typeof e!="object"){if(s=t(e),s===void 0&&(s=e),s===q2&&(s=void 0),this.autoFreeze_&&oS(s,!0),n){const i=[],o=[];ta("Patches").generateReplacementPatches_(e,s,i,o),n(i,o)}return s}else kn(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e=="function")return(o,...a)=>this.produceWithPatches(o,l=>e(l,...a));let n,s;return[this.produce(e,t,(o,a)=>{n=o,s=a}),n,s]},typeof(r==null?void 0:r.autoFreeze)=="boolean"&&this.setAutoFreeze(r.autoFreeze),typeof(r==null?void 0:r.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(r.useStrictShallowCopy)}createDraft(r){Zs(r)||kn(8),ea(r)&&(r=r$(r));const e=TE(this),t=H0(r,void 0);return t[Kr].isManual_=!0,z0(e),t}finishDraft(r,e){const t=r&&r[Kr];(!t||!t.isManual_)&&kn(9);const{scope_:n}=t;return SE(n,e),CE(void 0,n)}setAutoFreeze(r){this.autoFreeze_=r}setUseStrictShallowCopy(r){this.useStrictShallowCopy_=r}applyPatches(r,e){let t;for(t=e.length-1;t>=0;t--){const s=e[t];if(s.path.length===0&&s.op==="replace"){r=s.value;break}}t>-1&&(e=e.slice(t+1));const n=ta("Patches").applyPatches_;return ea(r)?n(r,e):this.produce(r,s=>n(s,e))}};function H0(r,e){const t=pm(r)?ta("MapSet").proxyMap_(r,e):gm(r)?ta("MapSet").proxySet_(r,e):Z3(r,e);return(e?e.scope_:K2()).drafts_.push(t),t}function r$(r){return ea(r)||kn(10,r),J2(r)}function J2(r){if(!Zs(r)||mm(r))return r;const e=r[Kr];let t;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,t=U0(r,e.scope_.immer_.useStrictShallowCopy_)}else t=U0(r,!0);return Ap(t,(n,s)=>{X2(t,n,J2(s))}),e&&(e.finalized_=!1),t}var Qr=new t$,Z2=Qr.produce;Qr.produceWithPatches.bind(Qr);Qr.setAutoFreeze.bind(Qr);Qr.setUseStrictShallowCopy.bind(Qr);Qr.applyPatches.bind(Qr);Qr.createDraft.bind(Qr);Qr.finishDraft.bind(Qr);function eP(r){return({dispatch:t,getState:n})=>s=>i=>typeof i=="function"?i(t,n,r):s(i)}var n$=eP(),s$=eP,i$=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?bp:bp.apply(null,arguments)},o$=r=>r&&typeof r.match=="function";function pu(r,e){function t(...n){if(e){let s=e(...n);if(!s)throw new Error(Bs(0));return{type:r,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:r,payload:n[0]}}return t.toString=()=>`${r}`,t.type=r,t.match=n=>G3(n)&&n.type===r,t}var tP=class Kc extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Kc.prototype)}static get[Symbol.species](){return Kc}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new Kc(...e[0].concat(this)):new Kc(...e.concat(this))}};function xE(r){return Zs(r)?Z2(r,()=>{}):r}function kd(r,e,t){return r.has(e)?r.get(e):r.set(e,t(e)).get(e)}function a$(r){return typeof r=="boolean"}var l$=()=>function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:i=!0}=e??{};let o=new tP;return t&&(a$(t)?o.push(n$):o.push(s$(t.extraArgument))),o},c$="RTK_autoBatch",bE=r=>e=>{setTimeout(e,r)},u$=(r={type:"raf"})=>e=>(...t)=>{const n=e(...t);let s=!0,i=!1,o=!1;const a=new Set,l=r.type==="tick"?queueMicrotask:r.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:bE(10):r.type==="callback"?r.queueNotification:bE(r.timeout),c=()=>{o=!1,i&&(i=!1,a.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const d=()=>s&&u(),f=n.subscribe(d);return a.add(u),()=>{f(),a.delete(u)}},dispatch(u){var d;try{return s=!((d=u==null?void 0:u.meta)!=null&&d[c$]),i=!s,i&&(o||(o=!0,l(c))),n.dispatch(u)}finally{s=!0}}})},h$=r=>function(t){const{autoBatch:n=!0}=t??{};let s=new tP(r);return n&&s.push(u$(typeof n=="object"?n:void 0)),s};function d$(r){const e=l$(),{reducer:t=void 0,middleware:n,devTools:s=!0,preloadedState:i=void 0,enhancers:o=void 0}=r||{};let a;if(typeof t=="function")a=t;else if(iS(t))a=G2(t);else throw new Error(Bs(1));let l;typeof n=="function"?l=n(e):l=e();let c=bp;s&&(c=i$({trace:!1,...typeof s=="object"&&s}));const u=H3(...l),d=h$(u);let f=typeof o=="function"?o(d):d();const p=c(...f);return H2(a,i,p)}function rP(r){const e={},t=[];let n;const s={addCase(i,o){const a=typeof i=="string"?i:i.type;if(!a)throw new Error(Bs(28));if(a in e)throw new Error(Bs(29));return e[a]=o,s},addMatcher(i,o){return t.push({matcher:i,reducer:o}),s},addDefaultCase(i){return n=i,s}};return r(s),[e,t,n]}function f$(r){return typeof r=="function"}function p$(r,e){let[t,n,s]=rP(e),i;if(f$(r))i=()=>xE(r());else{const a=xE(r);i=()=>a}function o(a=i(),l){let c=[t[l.type],...n.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[s]),c.reduce((u,d)=>{if(d)if(ea(u)){const p=d(u,l);return p===void 0?u:p}else{if(Zs(u))return Z2(u,f=>d(f,l));{const f=d(u,l);if(f===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return f}}return u},a)}return o.getInitialState=i,o}var g$=(r,e)=>o$(r)?r.match(e):r(e);function m$(...r){return e=>r.some(t=>g$(t,e))}var y$="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",v$=(r=21)=>{let e="",t=r;for(;t--;)e+=y$[Math.random()*64|0];return e},_$=["name","message","stack","code"],rv=class{constructor(r,e){ad(this,"_type");this.payload=r,this.meta=e}},AE=class{constructor(r,e){ad(this,"_type");this.payload=r,this.meta=e}},w$=r=>{if(typeof r=="object"&&r!==null){const e={};for(const t of _$)typeof r[t]=="string"&&(e[t]=r[t]);return e}return{message:String(r)}},kE="External signal was aborted",lS=(()=>{function r(e,t,n){const s=pu(e+"/fulfilled",(l,c,u,d)=>({payload:l,meta:{...d||{},arg:u,requestId:c,requestStatus:"fulfilled"}})),i=pu(e+"/pending",(l,c,u)=>({payload:void 0,meta:{...u||{},arg:c,requestId:l,requestStatus:"pending"}})),o=pu(e+"/rejected",(l,c,u,d,f)=>({payload:d,error:(n&&n.serializeError||w$)(l||"Rejected"),meta:{...f||{},arg:u,requestId:c,rejectedWithValue:!!d,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"}}));function a(l,{signal:c}={}){return(u,d,f)=>{const p=n!=null&&n.idGenerator?n.idGenerator(l):v$(),m=new AbortController;let v,T;function w(C){T=C,m.abort()}c&&(c.aborted?w(kE):c.addEventListener("abort",()=>w(kE),{once:!0}));const y=async function(){var O,M;let C;try{let x=(O=n==null?void 0:n.condition)==null?void 0:O.call(n,l,{getState:d,extra:f});if(T$(x)&&(x=await x),x===!1||m.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const E=new Promise((A,P)=>{v=()=>{P({name:"AbortError",message:T||"Aborted"})},m.signal.addEventListener("abort",v)});u(i(p,l,(M=n==null?void 0:n.getPendingMeta)==null?void 0:M.call(n,{requestId:p,arg:l},{getState:d,extra:f}))),C=await Promise.race([E,Promise.resolve(t(l,{dispatch:u,getState:d,extra:f,requestId:p,signal:m.signal,abort:w,rejectWithValue:(A,P)=>new rv(A,P),fulfillWithValue:(A,P)=>new AE(A,P)})).then(A=>{if(A instanceof rv)throw A;return A instanceof AE?s(A.payload,p,l,A.meta):s(A,p,l)})])}catch(x){C=x instanceof rv?o(null,p,l,x.payload,x.meta):o(x,p,l)}finally{v&&m.signal.removeEventListener("abort",v)}return n&&!n.dispatchConditionRejection&&o.match(C)&&C.meta.condition||u(C),C}();return Object.assign(y,{abort:w,requestId:p,arg:l,unwrap(){return y.then(S$)}})}}return Object.assign(a,{pending:i,rejected:o,fulfilled:s,settled:m$(o,s),typePrefix:e})}return r.withTypes=()=>r,r})();function S$(r){if(r.meta&&r.meta.rejectedWithValue)throw r.payload;if(r.error)throw r.error;return r.payload}function T$(r){return r!==null&&typeof r=="object"&&typeof r.then=="function"}var C$=Symbol.for("rtk-slice-createasyncthunk");function E$(r,e){return`${r}/${e}`}function x$({creators:r}={}){var t;const e=(t=r==null?void 0:r.asyncThunk)==null?void 0:t[C$];return function(s){const{name:i,reducerPath:o=i}=s;if(!i)throw new Error(Bs(11));const a=(typeof s.reducers=="function"?s.reducers(A$()):s.reducers)||{},l=Object.keys(a),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(k,O){const M=typeof k=="string"?k:k.type;if(!M)throw new Error(Bs(12));if(M in c.sliceCaseReducersByType)throw new Error(Bs(13));return c.sliceCaseReducersByType[M]=O,u},addMatcher(k,O){return c.sliceMatchers.push({matcher:k,reducer:O}),u},exposeAction(k,O){return c.actionCreators[k]=O,u},exposeCaseReducer(k,O){return c.sliceCaseReducersByName[k]=O,u}};l.forEach(k=>{const O=a[k],M={reducerName:k,type:E$(i,k),createNotation:typeof s.reducers=="function"};I$(O)?R$(M,O,u,e):k$(M,O,u)});function d(){const[k={},O=[],M=void 0]=typeof s.extraReducers=="function"?rP(s.extraReducers):[s.extraReducers],x={...k,...c.sliceCaseReducersByType};return p$(s.initialState,E=>{for(let A in x)E.addCase(A,x[A]);for(let A of c.sliceMatchers)E.addMatcher(A.matcher,A.reducer);for(let A of O)E.addMatcher(A.matcher,A.reducer);M&&E.addDefaultCase(M)})}const f=k=>k,p=new Map,m=new WeakMap;let v;function T(k,O){return v||(v=d()),v(k,O)}function w(){return v||(v=d()),v.getInitialState()}function y(k,O=!1){function M(E){let A=E[k];return typeof A>"u"&&O&&(A=kd(m,M,w)),A}function x(E=f){const A=kd(p,O,()=>new WeakMap);return kd(A,E,()=>{const P={};for(const[R,_]of Object.entries(s.selectors??{}))P[R]=b$(_,E,()=>kd(m,E,w),O);return P})}return{reducerPath:k,getSelectors:x,get selectors(){return x(M)},selectSlice:M}}const C={name:i,reducer:T,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:w,...y(o),injectInto(k,{reducerPath:O,...M}={}){const x=O??o;return k.inject({reducerPath:x,reducer:T},M),{...C,...y(x,!0)}}};return C}}function b$(r,e,t,n){function s(i,...o){let a=e(i);return typeof a>"u"&&n&&(a=t()),r(a,...o)}return s.unwrapped=r,s}var nP=x$();function A$(){function r(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return r.withTypes=()=>r,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,t){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}},asyncThunk:r}}function k$({type:r,reducerName:e,createNotation:t},n,s){let i,o;if("reducer"in n){if(t&&!P$(n))throw new Error(Bs(17));i=n.reducer,o=n.prepare}else i=n;s.addCase(r,i).exposeCaseReducer(e,i).exposeAction(e,o?pu(r,o):pu(r))}function I$(r){return r._reducerDefinitionType==="asyncThunk"}function P$(r){return r._reducerDefinitionType==="reducerWithPrepare"}function R$({type:r,reducerName:e},t,n,s){if(!s)throw new Error(Bs(18));const{payloadCreator:i,fulfilled:o,pending:a,rejected:l,settled:c,options:u}=t,d=s(r,i,u);n.exposeAction(e,d),o&&n.addCase(d.fulfilled,o),a&&n.addCase(d.pending,a),l&&n.addCase(d.rejected,l),c&&n.addMatcher(d.settled,c),n.exposeCaseReducer(e,{fulfilled:o||Id,pending:a||Id,rejected:l||Id,settled:c||Id})}function Id(){}function Bs(r){return`Minified Redux Toolkit error #${r}; visit https://redux-toolkit.js.org/Errors?code=${r} for the full message or use the non-minified dev environment for full errors. `}const O$=()=>{};var IE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sP=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let s=r.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},D$=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const s=r[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=r[t++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=r[t++],o=r[t++],a=r[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=r[t++],o=r[t++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},iP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<r.length;s+=3){const i=r[s],o=s+1<r.length,a=o?r[s+1]:0,l=s+2<r.length,c=l?r[s+2]:0,u=i>>2,d=(i&3)<<4|a>>4;let f=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(f=64)),n.push(t[u],t[d],t[f],t[p])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(sP(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):D$(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<r.length;){const i=t[r.charAt(s++)],a=s<r.length?t[r.charAt(s)]:0;++s;const c=s<r.length?t[r.charAt(s)]:64;++s;const d=s<r.length?t[r.charAt(s)]:64;if(++s,i==null||a==null||c==null||d==null)throw new M$;const f=i<<2|a>>4;if(n.push(f),c!==64){const p=a<<4&240|c>>2;if(n.push(p),d!==64){const m=c<<6&192|d;n.push(m)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class M$ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const N$=function(r){const e=sP(r);return iP.encodeByteArray(e,!0)},Pp=function(r){return N$(r).replace(/\./g,"")},oP=function(r){try{return iP.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F$(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L$=()=>F$().__FIREBASE_DEFAULTS__,V$=()=>{if(typeof process>"u"||typeof IE>"u")return;const r=IE.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},j$=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&oP(r[1]);return e&&JSON.parse(e)},ym=()=>{try{return O$()||L$()||V$()||j$()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},aP=r=>{var e,t;return(t=(e=ym())==null?void 0:e.emulatorHosts)==null?void 0:t[r]},$$=r=>{const e=aP(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},lP=()=>{var r;return(r=ym())==null?void 0:r.config},cP=r=>{var e;return(e=ym())==null?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U${constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jl(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function uP(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B$(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",s=r.iat||0,i=r.sub||r.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Pp(JSON.stringify(t)),Pp(JSON.stringify(o)),""].join(".")}const gu={};function z$(){const r={prod:[],emulator:[]};for(const e of Object.keys(gu))gu[e]?r.emulator.push(e):r.prod.push(e);return r}function W$(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let PE=!1;function hP(r,e){if(typeof window>"u"||typeof document>"u"||!Jl(window.location.host)||gu[r]===e||gu[r]||PE)return;gu[r]=e;function t(f){return`__firebase__banner__${f}`}const n="__firebase__banner",i=z$().prod.length>0;function o(){const f=document.getElementById(n);f&&f.remove()}function a(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function l(f,p){f.setAttribute("width","24"),f.setAttribute("id",p),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function c(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{PE=!0,o()},f}function u(f,p){f.setAttribute("id",p),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function d(){const f=W$(n),p=t("text"),m=document.getElementById(p)||document.createElement("span"),v=t("learnmore"),T=document.getElementById(v)||document.createElement("a"),w=t("preprendIcon"),y=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const C=f.element;a(C),u(T,v);const k=c();l(y,w),C.append(y,m,T,k),document.body.appendChild(C)}i?(m.innerText="Preview backend disconnected.",y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,m.innerText="Preview backend running in this workspace."),m.setAttribute("id",p)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function H$(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(cr())}function G$(){var e;const r=(e=ym())==null?void 0:e.forceEnvironment;if(r==="node")return!0;if(r==="browser")return!1;try{return Object.prototype.toString.call(globalThis.process)==="[object process]"}catch{return!1}}function q$(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function dP(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function Y$(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function X$(){const r=cr();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function K$(){return!G$()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fP(){try{return typeof indexedDB=="object"}catch{return!1}}function pP(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(t){e(t)}})}function Q$(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J$="FirebaseError";class Wn extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=J$,Object.setPrototypeOf(this,Wn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,fa.prototype.create)}}class fa{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Z$(i,n):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Wn(s,a,n)}}function Z$(r,e){return r.replace(e6,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const e6=/\{\$([^}]+)}/g;function t6(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Xi(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const i=r[s],o=e[s];if(RE(i)&&RE(o)){if(!Xi(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function RE(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kh(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Qc(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Jc(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function r6(r,e){const t=new n6(r,e);return t.subscribe.bind(t)}class n6{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");s6(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=nv),s.error===void 0&&(s.error=nv),s.complete===void 0&&(s.complete=nv);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function s6(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function nv(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6=1e3,o6=2,a6=4*60*60*1e3,l6=.5;function OE(r,e=i6,t=o6){const n=e*Math.pow(t,r),s=Math.round(l6*n*(Math.random()-.5)*2);return Math.min(a6,n+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(r){return r&&r._delegate?r._delegate:r}class Un{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c6{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new U$;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),n=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(h6(e))try{this.getOrInitializeService({instanceIdentifier:Ao})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Ao){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ao){return this.instances.has(e)}getOptions(e=Ao){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);n===a&&o.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const i=this.instances.get(n);return i&&e(i,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:u6(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ao){return this.component?this.component.multipleInstances?e:Ao:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function u6(r){return r===Ao?void 0:r}function h6(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new c6(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Se;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Se||(Se={}));const f6={debug:Se.DEBUG,verbose:Se.VERBOSE,info:Se.INFO,warn:Se.WARN,error:Se.ERROR,silent:Se.SILENT},p6=Se.INFO,g6={[Se.DEBUG]:"log",[Se.VERBOSE]:"log",[Se.INFO]:"info",[Se.WARN]:"warn",[Se.ERROR]:"error"},m6=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),s=g6[e];if(s)console[s](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class vm{constructor(e){this.name=e,this._logLevel=p6,this._logHandler=m6,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?f6[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Se.DEBUG,...e),this._logHandler(this,Se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Se.VERBOSE,...e),this._logHandler(this,Se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Se.INFO,...e),this._logHandler(this,Se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Se.WARN,...e),this._logHandler(this,Se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Se.ERROR,...e),this._logHandler(this,Se.ERROR,...e)}}const y6=(r,e)=>e.some(t=>r instanceof t);let DE,ME;function v6(){return DE||(DE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _6(){return ME||(ME=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const gP=new WeakMap,G0=new WeakMap,mP=new WeakMap,sv=new WeakMap,cS=new WeakMap;function w6(r){const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("success",i),r.removeEventListener("error",o)},i=()=>{t($i(r.result)),s()},o=()=>{n(r.error),s()};r.addEventListener("success",i),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&gP.set(t,r)}).catch(()=>{}),cS.set(e,r),e}function S6(r){if(G0.has(r))return;const e=new Promise((t,n)=>{const s=()=>{r.removeEventListener("complete",i),r.removeEventListener("error",o),r.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",i),r.addEventListener("error",o),r.addEventListener("abort",o)});G0.set(r,e)}let q0={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return G0.get(r);if(e==="objectStoreNames")return r.objectStoreNames||mP.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return $i(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function T6(r){q0=r(q0)}function C6(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(iv(this),e,...t);return mP.set(n,e.sort?e.sort():[e]),$i(n)}:_6().includes(r)?function(...e){return r.apply(iv(this),e),$i(gP.get(this))}:function(...e){return $i(r.apply(iv(this),e))}}function E6(r){return typeof r=="function"?C6(r):(r instanceof IDBTransaction&&S6(r),y6(r,v6())?new Proxy(r,q0):r)}function $i(r){if(r instanceof IDBRequest)return w6(r);if(sv.has(r))return sv.get(r);const e=E6(r);return e!==r&&(sv.set(r,e),cS.set(e,r)),e}const iv=r=>cS.get(r);function yP(r,e,{blocked:t,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(r,e),a=$i(o);return n&&o.addEventListener("upgradeneeded",l=>{n($i(o.result),l.oldVersion,l.newVersion,$i(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const x6=["get","getKey","getAll","getAllKeys","count"],b6=["put","add","delete","clear"],ov=new Map;function NE(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(ov.get(e))return ov.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=b6.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||x6.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return ov.set(e,i),i}T6(r=>({...r,get:(e,t,n)=>NE(e,t)||r.get(e,t,n),has:(e,t)=>!!NE(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(k6(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function k6(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Y0="@firebase/app",FE="0.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei=new vm("@firebase/app"),I6="@firebase/app-compat",P6="@firebase/analytics-compat",R6="@firebase/analytics",O6="@firebase/app-check-compat",D6="@firebase/app-check",M6="@firebase/auth",N6="@firebase/auth-compat",F6="@firebase/database",L6="@firebase/data-connect",V6="@firebase/database-compat",j6="@firebase/functions",$6="@firebase/functions-compat",U6="@firebase/installations",B6="@firebase/installations-compat",z6="@firebase/messaging",W6="@firebase/messaging-compat",H6="@firebase/performance",G6="@firebase/performance-compat",q6="@firebase/remote-config",Y6="@firebase/remote-config-compat",X6="@firebase/storage",K6="@firebase/storage-compat",Q6="@firebase/firestore",J6="@firebase/ai",Z6="@firebase/firestore-compat",eU="firebase",tU="12.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0="[DEFAULT]",rU={[Y0]:"fire-core",[I6]:"fire-core-compat",[R6]:"fire-analytics",[P6]:"fire-analytics-compat",[D6]:"fire-app-check",[O6]:"fire-app-check-compat",[M6]:"fire-auth",[N6]:"fire-auth-compat",[F6]:"fire-rtdb",[L6]:"fire-data-connect",[V6]:"fire-rtdb-compat",[j6]:"fire-fn",[$6]:"fire-fn-compat",[U6]:"fire-iid",[B6]:"fire-iid-compat",[z6]:"fire-fcm",[W6]:"fire-fcm-compat",[H6]:"fire-perf",[G6]:"fire-perf-compat",[q6]:"fire-rc",[Y6]:"fire-rc-compat",[X6]:"fire-gcs",[K6]:"fire-gcs-compat",[Q6]:"fire-fst",[Z6]:"fire-fst-compat",[J6]:"fire-vertex","fire-js":"fire-js",[eU]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp=new Map,nU=new Map,K0=new Map;function LE(r,e){try{r.container.addComponent(e)}catch(t){ei.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function ps(r){const e=r.name;if(K0.has(e))return ei.debug(`There were multiple attempts to register component ${e}.`),!1;K0.set(e,r);for(const t of Rp.values())LE(t,r);for(const t of nU.values())LE(t,r);return!0}function pa(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Br(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sU={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ui=new fa("app","Firebase",sU);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iU{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Un("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ui.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zl=tU;function vP(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n={name:X0,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Ui.create("bad-app-name",{appName:String(s)});if(t||(t=lP()),!t)throw Ui.create("no-options");const i=Rp.get(s);if(i){if(Xi(t,i.options)&&Xi(n,i.config))return i;throw Ui.create("duplicate-app",{appName:s})}const o=new d6(s);for(const l of K0.values())o.addComponent(l);const a=new iU(t,n,o);return Rp.set(s,a),a}function uS(r=X0){const e=Rp.get(r);if(!e&&r===X0&&lP())return vP();if(!e)throw Ui.create("no-app",{appName:r});return e}function un(r,e,t){let n=rU[r]??r;t&&(n+=`-${t}`);const s=n.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${n}" with version "${e}":`];s&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ei.warn(o.join(" "));return}ps(new Un(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oU="firebase-heartbeat-database",aU=1,Qu="firebase-heartbeat-store";let av=null;function _P(){return av||(av=yP(oU,aU,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Qu)}catch(t){console.warn(t)}}}}).catch(r=>{throw Ui.create("idb-open",{originalErrorMessage:r.message})})),av}async function lU(r){try{const t=(await _P()).transaction(Qu),n=await t.objectStore(Qu).get(wP(r));return await t.done,n}catch(e){if(e instanceof Wn)ei.warn(e.message);else{const t=Ui.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ei.warn(t.message)}}}async function VE(r,e){try{const n=(await _P()).transaction(Qu,"readwrite");await n.objectStore(Qu).put(e,wP(r)),await n.done}catch(t){if(t instanceof Wn)ei.warn(t.message);else{const n=Ui.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ei.warn(n.message)}}}function wP(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cU=1024,uU=30;class hU{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new fU(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=jE();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>uU){const o=pU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){ei.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=jE(),{heartbeatsToSend:n,unsentEntries:s}=dU(this._heartbeatsCache.heartbeats),i=Pp(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return ei.warn(t),""}}}function jE(){return new Date().toISOString().substring(0,10)}function dU(r,e=cU){const t=[];let n=r.slice();for(const s of r){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),$E(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),$E(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class fU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return fP()?pP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await lU(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return VE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return VE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function $E(r){return Pp(JSON.stringify({version:2,heartbeats:r})).length}function pU(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gU(r){ps(new Un("platform-logger",e=>new A6(e),"PRIVATE")),ps(new Un("heartbeat",e=>new hU(e),"PRIVATE")),un(Y0,FE,r),un(Y0,FE,"esm2020"),un("fire-js","")}gU("");var UE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Bi,SP;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,E){function A(){}A.prototype=E.prototype,x.D=E.prototype,x.prototype=new A,x.prototype.constructor=x,x.C=function(P,R,_){for(var b=Array(arguments.length-2),B=2;B<arguments.length;B++)b[B-2]=arguments[B];return E.prototype[R].apply(P,b)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,E,A){A||(A=0);var P=Array(16);if(typeof E=="string")for(var R=0;16>R;++R)P[R]=E.charCodeAt(A++)|E.charCodeAt(A++)<<8|E.charCodeAt(A++)<<16|E.charCodeAt(A++)<<24;else for(R=0;16>R;++R)P[R]=E[A++]|E[A++]<<8|E[A++]<<16|E[A++]<<24;E=x.g[0],A=x.g[1],R=x.g[2];var _=x.g[3],b=E+(_^A&(R^_))+P[0]+3614090360&4294967295;E=A+(b<<7&4294967295|b>>>25),b=_+(R^E&(A^R))+P[1]+3905402710&4294967295,_=E+(b<<12&4294967295|b>>>20),b=R+(A^_&(E^A))+P[2]+606105819&4294967295,R=_+(b<<17&4294967295|b>>>15),b=A+(E^R&(_^E))+P[3]+3250441966&4294967295,A=R+(b<<22&4294967295|b>>>10),b=E+(_^A&(R^_))+P[4]+4118548399&4294967295,E=A+(b<<7&4294967295|b>>>25),b=_+(R^E&(A^R))+P[5]+1200080426&4294967295,_=E+(b<<12&4294967295|b>>>20),b=R+(A^_&(E^A))+P[6]+2821735955&4294967295,R=_+(b<<17&4294967295|b>>>15),b=A+(E^R&(_^E))+P[7]+4249261313&4294967295,A=R+(b<<22&4294967295|b>>>10),b=E+(_^A&(R^_))+P[8]+1770035416&4294967295,E=A+(b<<7&4294967295|b>>>25),b=_+(R^E&(A^R))+P[9]+2336552879&4294967295,_=E+(b<<12&4294967295|b>>>20),b=R+(A^_&(E^A))+P[10]+4294925233&4294967295,R=_+(b<<17&4294967295|b>>>15),b=A+(E^R&(_^E))+P[11]+2304563134&4294967295,A=R+(b<<22&4294967295|b>>>10),b=E+(_^A&(R^_))+P[12]+1804603682&4294967295,E=A+(b<<7&4294967295|b>>>25),b=_+(R^E&(A^R))+P[13]+4254626195&4294967295,_=E+(b<<12&4294967295|b>>>20),b=R+(A^_&(E^A))+P[14]+2792965006&4294967295,R=_+(b<<17&4294967295|b>>>15),b=A+(E^R&(_^E))+P[15]+1236535329&4294967295,A=R+(b<<22&4294967295|b>>>10),b=E+(R^_&(A^R))+P[1]+4129170786&4294967295,E=A+(b<<5&4294967295|b>>>27),b=_+(A^R&(E^A))+P[6]+3225465664&4294967295,_=E+(b<<9&4294967295|b>>>23),b=R+(E^A&(_^E))+P[11]+643717713&4294967295,R=_+(b<<14&4294967295|b>>>18),b=A+(_^E&(R^_))+P[0]+3921069994&4294967295,A=R+(b<<20&4294967295|b>>>12),b=E+(R^_&(A^R))+P[5]+3593408605&4294967295,E=A+(b<<5&4294967295|b>>>27),b=_+(A^R&(E^A))+P[10]+38016083&4294967295,_=E+(b<<9&4294967295|b>>>23),b=R+(E^A&(_^E))+P[15]+3634488961&4294967295,R=_+(b<<14&4294967295|b>>>18),b=A+(_^E&(R^_))+P[4]+3889429448&4294967295,A=R+(b<<20&4294967295|b>>>12),b=E+(R^_&(A^R))+P[9]+568446438&4294967295,E=A+(b<<5&4294967295|b>>>27),b=_+(A^R&(E^A))+P[14]+3275163606&4294967295,_=E+(b<<9&4294967295|b>>>23),b=R+(E^A&(_^E))+P[3]+4107603335&4294967295,R=_+(b<<14&4294967295|b>>>18),b=A+(_^E&(R^_))+P[8]+1163531501&4294967295,A=R+(b<<20&4294967295|b>>>12),b=E+(R^_&(A^R))+P[13]+2850285829&4294967295,E=A+(b<<5&4294967295|b>>>27),b=_+(A^R&(E^A))+P[2]+4243563512&4294967295,_=E+(b<<9&4294967295|b>>>23),b=R+(E^A&(_^E))+P[7]+1735328473&4294967295,R=_+(b<<14&4294967295|b>>>18),b=A+(_^E&(R^_))+P[12]+2368359562&4294967295,A=R+(b<<20&4294967295|b>>>12),b=E+(A^R^_)+P[5]+4294588738&4294967295,E=A+(b<<4&4294967295|b>>>28),b=_+(E^A^R)+P[8]+2272392833&4294967295,_=E+(b<<11&4294967295|b>>>21),b=R+(_^E^A)+P[11]+1839030562&4294967295,R=_+(b<<16&4294967295|b>>>16),b=A+(R^_^E)+P[14]+4259657740&4294967295,A=R+(b<<23&4294967295|b>>>9),b=E+(A^R^_)+P[1]+2763975236&4294967295,E=A+(b<<4&4294967295|b>>>28),b=_+(E^A^R)+P[4]+1272893353&4294967295,_=E+(b<<11&4294967295|b>>>21),b=R+(_^E^A)+P[7]+4139469664&4294967295,R=_+(b<<16&4294967295|b>>>16),b=A+(R^_^E)+P[10]+3200236656&4294967295,A=R+(b<<23&4294967295|b>>>9),b=E+(A^R^_)+P[13]+681279174&4294967295,E=A+(b<<4&4294967295|b>>>28),b=_+(E^A^R)+P[0]+3936430074&4294967295,_=E+(b<<11&4294967295|b>>>21),b=R+(_^E^A)+P[3]+3572445317&4294967295,R=_+(b<<16&4294967295|b>>>16),b=A+(R^_^E)+P[6]+76029189&4294967295,A=R+(b<<23&4294967295|b>>>9),b=E+(A^R^_)+P[9]+3654602809&4294967295,E=A+(b<<4&4294967295|b>>>28),b=_+(E^A^R)+P[12]+3873151461&4294967295,_=E+(b<<11&4294967295|b>>>21),b=R+(_^E^A)+P[15]+530742520&4294967295,R=_+(b<<16&4294967295|b>>>16),b=A+(R^_^E)+P[2]+3299628645&4294967295,A=R+(b<<23&4294967295|b>>>9),b=E+(R^(A|~_))+P[0]+4096336452&4294967295,E=A+(b<<6&4294967295|b>>>26),b=_+(A^(E|~R))+P[7]+1126891415&4294967295,_=E+(b<<10&4294967295|b>>>22),b=R+(E^(_|~A))+P[14]+2878612391&4294967295,R=_+(b<<15&4294967295|b>>>17),b=A+(_^(R|~E))+P[5]+4237533241&4294967295,A=R+(b<<21&4294967295|b>>>11),b=E+(R^(A|~_))+P[12]+1700485571&4294967295,E=A+(b<<6&4294967295|b>>>26),b=_+(A^(E|~R))+P[3]+2399980690&4294967295,_=E+(b<<10&4294967295|b>>>22),b=R+(E^(_|~A))+P[10]+4293915773&4294967295,R=_+(b<<15&4294967295|b>>>17),b=A+(_^(R|~E))+P[1]+2240044497&4294967295,A=R+(b<<21&4294967295|b>>>11),b=E+(R^(A|~_))+P[8]+1873313359&4294967295,E=A+(b<<6&4294967295|b>>>26),b=_+(A^(E|~R))+P[15]+4264355552&4294967295,_=E+(b<<10&4294967295|b>>>22),b=R+(E^(_|~A))+P[6]+2734768916&4294967295,R=_+(b<<15&4294967295|b>>>17),b=A+(_^(R|~E))+P[13]+1309151649&4294967295,A=R+(b<<21&4294967295|b>>>11),b=E+(R^(A|~_))+P[4]+4149444226&4294967295,E=A+(b<<6&4294967295|b>>>26),b=_+(A^(E|~R))+P[11]+3174756917&4294967295,_=E+(b<<10&4294967295|b>>>22),b=R+(E^(_|~A))+P[2]+718787259&4294967295,R=_+(b<<15&4294967295|b>>>17),b=A+(_^(R|~E))+P[9]+3951481745&4294967295,x.g[0]=x.g[0]+E&4294967295,x.g[1]=x.g[1]+(R+(b<<21&4294967295|b>>>11))&4294967295,x.g[2]=x.g[2]+R&4294967295,x.g[3]=x.g[3]+_&4294967295}n.prototype.u=function(x,E){E===void 0&&(E=x.length);for(var A=E-this.blockSize,P=this.B,R=this.h,_=0;_<E;){if(R==0)for(;_<=A;)s(this,x,_),_+=this.blockSize;if(typeof x=="string"){for(;_<E;)if(P[R++]=x.charCodeAt(_++),R==this.blockSize){s(this,P),R=0;break}}else for(;_<E;)if(P[R++]=x[_++],R==this.blockSize){s(this,P),R=0;break}}this.h=R,this.o+=E},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var E=1;E<x.length-8;++E)x[E]=0;var A=8*this.o;for(E=x.length-8;E<x.length;++E)x[E]=A&255,A/=256;for(this.u(x),x=Array(16),E=A=0;4>E;++E)for(var P=0;32>P;P+=8)x[A++]=this.g[E]>>>P&255;return x};function i(x,E){var A=a;return Object.prototype.hasOwnProperty.call(A,x)?A[x]:A[x]=E(x)}function o(x,E){this.h=E;for(var A=[],P=!0,R=x.length-1;0<=R;R--){var _=x[R]|0;P&&_==E||(A[R]=_,P=!1)}this.g=A}var a={};function l(x){return-128<=x&&128>x?i(x,function(E){return new o([E|0],0>E?-1:0)}):new o([x|0],0>x?-1:0)}function c(x){if(isNaN(x)||!isFinite(x))return d;if(0>x)return T(c(-x));for(var E=[],A=1,P=0;x>=A;P++)E[P]=x/A|0,A*=4294967296;return new o(E,0)}function u(x,E){if(x.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(x.charAt(0)=="-")return T(u(x.substring(1),E));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=c(Math.pow(E,8)),P=d,R=0;R<x.length;R+=8){var _=Math.min(8,x.length-R),b=parseInt(x.substring(R,R+_),E);8>_?(_=c(Math.pow(E,_)),P=P.j(_).add(c(b))):(P=P.j(A),P=P.add(c(b)))}return P}var d=l(0),f=l(1),p=l(16777216);r=o.prototype,r.m=function(){if(v(this))return-T(this).m();for(var x=0,E=1,A=0;A<this.g.length;A++){var P=this.i(A);x+=(0<=P?P:4294967296+P)*E,E*=4294967296}return x},r.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(m(this))return"0";if(v(this))return"-"+T(this).toString(x);for(var E=c(Math.pow(x,6)),A=this,P="";;){var R=k(A,E).g;A=w(A,R.j(E));var _=((0<A.g.length?A.g[0]:A.h)>>>0).toString(x);if(A=R,m(A))return _+P;for(;6>_.length;)_="0"+_;P=_+P}},r.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function m(x){if(x.h!=0)return!1;for(var E=0;E<x.g.length;E++)if(x.g[E]!=0)return!1;return!0}function v(x){return x.h==-1}r.l=function(x){return x=w(this,x),v(x)?-1:m(x)?0:1};function T(x){for(var E=x.g.length,A=[],P=0;P<E;P++)A[P]=~x.g[P];return new o(A,~x.h).add(f)}r.abs=function(){return v(this)?T(this):this},r.add=function(x){for(var E=Math.max(this.g.length,x.g.length),A=[],P=0,R=0;R<=E;R++){var _=P+(this.i(R)&65535)+(x.i(R)&65535),b=(_>>>16)+(this.i(R)>>>16)+(x.i(R)>>>16);P=b>>>16,_&=65535,b&=65535,A[R]=b<<16|_}return new o(A,A[A.length-1]&-2147483648?-1:0)};function w(x,E){return x.add(T(E))}r.j=function(x){if(m(this)||m(x))return d;if(v(this))return v(x)?T(this).j(T(x)):T(T(this).j(x));if(v(x))return T(this.j(T(x)));if(0>this.l(p)&&0>x.l(p))return c(this.m()*x.m());for(var E=this.g.length+x.g.length,A=[],P=0;P<2*E;P++)A[P]=0;for(P=0;P<this.g.length;P++)for(var R=0;R<x.g.length;R++){var _=this.i(P)>>>16,b=this.i(P)&65535,B=x.i(R)>>>16,te=x.i(R)&65535;A[2*P+2*R]+=b*te,y(A,2*P+2*R),A[2*P+2*R+1]+=_*te,y(A,2*P+2*R+1),A[2*P+2*R+1]+=b*B,y(A,2*P+2*R+1),A[2*P+2*R+2]+=_*B,y(A,2*P+2*R+2)}for(P=0;P<E;P++)A[P]=A[2*P+1]<<16|A[2*P];for(P=E;P<2*E;P++)A[P]=0;return new o(A,0)};function y(x,E){for(;(x[E]&65535)!=x[E];)x[E+1]+=x[E]>>>16,x[E]&=65535,E++}function C(x,E){this.g=x,this.h=E}function k(x,E){if(m(E))throw Error("division by zero");if(m(x))return new C(d,d);if(v(x))return E=k(T(x),E),new C(T(E.g),T(E.h));if(v(E))return E=k(x,T(E)),new C(T(E.g),E.h);if(30<x.g.length){if(v(x)||v(E))throw Error("slowDivide_ only works with positive integers.");for(var A=f,P=E;0>=P.l(x);)A=O(A),P=O(P);var R=M(A,1),_=M(P,1);for(P=M(P,2),A=M(A,2);!m(P);){var b=_.add(P);0>=b.l(x)&&(R=R.add(A),_=b),P=M(P,1),A=M(A,1)}return E=w(x,R.j(E)),new C(R,E)}for(R=d;0<=x.l(E);){for(A=Math.max(1,Math.floor(x.m()/E.m())),P=Math.ceil(Math.log(A)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),_=c(A),b=_.j(E);v(b)||0<b.l(x);)A-=P,_=c(A),b=_.j(E);m(_)&&(_=f),R=R.add(_),x=w(x,b)}return new C(R,x)}r.A=function(x){return k(this,x).h},r.and=function(x){for(var E=Math.max(this.g.length,x.g.length),A=[],P=0;P<E;P++)A[P]=this.i(P)&x.i(P);return new o(A,this.h&x.h)},r.or=function(x){for(var E=Math.max(this.g.length,x.g.length),A=[],P=0;P<E;P++)A[P]=this.i(P)|x.i(P);return new o(A,this.h|x.h)},r.xor=function(x){for(var E=Math.max(this.g.length,x.g.length),A=[],P=0;P<E;P++)A[P]=this.i(P)^x.i(P);return new o(A,this.h^x.h)};function O(x){for(var E=x.g.length+1,A=[],P=0;P<E;P++)A[P]=x.i(P)<<1|x.i(P-1)>>>31;return new o(A,x.h)}function M(x,E){var A=E>>5;E%=32;for(var P=x.g.length-A,R=[],_=0;_<P;_++)R[_]=0<E?x.i(_+A)>>>E|x.i(_+A+1)<<32-E:x.i(_+A);return new o(R,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,SP=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,Bi=o}).apply(typeof UE<"u"?UE:typeof self<"u"?self:typeof window<"u"?window:{});var Pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var TP,Zc,CP,If,Q0,EP,xP,bP;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,g,S){return h==Array.prototype||h==Object.prototype||(h[g]=S.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pd=="object"&&Pd];for(var g=0;g<h.length;++g){var S=h[g];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var n=t(this);function s(h,g){if(g)e:{var S=n;h=h.split(".");for(var I=0;I<h.length-1;I++){var j=h[I];if(!(j in S))break e;S=S[j]}h=h[h.length-1],I=S[h],g=g(I),g!=I&&g!=null&&e(S,h,{configurable:!0,writable:!0,value:g})}}function i(h,g){h instanceof String&&(h+="");var S=0,I=!1,j={next:function(){if(!I&&S<h.length){var z=S++;return{value:g(z,h[z]),done:!1}}return I=!0,{done:!0,value:void 0}}};return j[Symbol.iterator]=function(){return j},j}s("Array.prototype.values",function(h){return h||function(){return i(this,function(g,S){return S})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(h){var g=typeof h;return g=g!="object"?g:h?Array.isArray(h)?"array":g:"null",g=="array"||g=="object"&&typeof h.length=="number"}function c(h){var g=typeof h;return g=="object"&&h!=null||g=="function"}function u(h,g,S){return h.call.apply(h.bind,arguments)}function d(h,g,S){if(!h)throw Error();if(2<arguments.length){var I=Array.prototype.slice.call(arguments,2);return function(){var j=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(j,I),h.apply(g,j)}}return function(){return h.apply(g,arguments)}}function f(h,g,S){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:d,f.apply(null,arguments)}function p(h,g){var S=Array.prototype.slice.call(arguments,1);return function(){var I=S.slice();return I.push.apply(I,arguments),h.apply(this,I)}}function m(h,g){function S(){}S.prototype=g.prototype,h.aa=g.prototype,h.prototype=new S,h.prototype.constructor=h,h.Qb=function(I,j,z){for(var Q=Array(arguments.length-2),Be=2;Be<arguments.length;Be++)Q[Be-2]=arguments[Be];return g.prototype[j].apply(I,Q)}}function v(h){const g=h.length;if(0<g){const S=Array(g);for(let I=0;I<g;I++)S[I]=h[I];return S}return[]}function T(h,g){for(let S=1;S<arguments.length;S++){const I=arguments[S];if(l(I)){const j=h.length||0,z=I.length||0;h.length=j+z;for(let Q=0;Q<z;Q++)h[j+Q]=I[Q]}else h.push(I)}}class w{constructor(g,S){this.i=g,this.j=S,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function y(h){return/^[\s\xa0]*$/.test(h)}function C(){var h=a.navigator;return h&&(h=h.userAgent)?h:""}function k(h){return k[" "](h),h}k[" "]=function(){};var O=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function M(h,g,S){for(const I in h)g.call(S,h[I],I,h)}function x(h,g){for(const S in h)g.call(void 0,h[S],S,h)}function E(h){const g={};for(const S in h)g[S]=h[S];return g}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(h,g){let S,I;for(let j=1;j<arguments.length;j++){I=arguments[j];for(S in I)h[S]=I[S];for(let z=0;z<A.length;z++)S=A[z],Object.prototype.hasOwnProperty.call(I,S)&&(h[S]=I[S])}}function R(h){var g=1;h=h.split(":");const S=[];for(;0<g&&h.length;)S.push(h.shift()),g--;return h.length&&S.push(h.join(":")),S}function _(h){a.setTimeout(()=>{throw h},0)}function b(){var h=ce;let g=null;return h.g&&(g=h.g,h.g=h.g.next,h.g||(h.h=null),g.next=null),g}class B{constructor(){this.h=this.g=null}add(g,S){const I=te.get();I.set(g,S),this.h?this.h.next=I:this.g=I,this.h=I}}var te=new w(()=>new ue,h=>h.reset());class ue{constructor(){this.next=this.g=this.h=null}set(g,S){this.h=g,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let ge,Y=!1,ce=new B,he=()=>{const h=a.Promise.resolve(void 0);ge=()=>{h.then(Ie)}};var Ie=()=>{for(var h;h=b();){try{h.h.call(h.g)}catch(S){_(S)}var g=te;g.j(h),100>g.h&&(g.h++,h.next=g.g,g.g=h)}Y=!1};function xe(){this.s=this.s,this.C=this.C}xe.prototype.s=!1,xe.prototype.ma=function(){this.s||(this.s=!0,this.N())},xe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function De(h,g){this.type=h,this.g=this.target=g,this.defaultPrevented=!1}De.prototype.h=function(){this.defaultPrevented=!0};var vt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var h=!1,g=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const S=()=>{};a.addEventListener("test",S,g),a.removeEventListener("test",S,g)}catch{}return h}();function jt(h,g){if(De.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var S=this.type=h.type,I=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=g,g=h.relatedTarget){if(O){e:{try{k(g.nodeName);var j=!0;break e}catch{}j=!1}j||(g=null)}}else S=="mouseover"?g=h.fromElement:S=="mouseout"&&(g=h.toElement);this.relatedTarget=g,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:At[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&jt.aa.h.call(this)}}m(jt,De);var At={2:"touch",3:"pen",4:"mouse"};jt.prototype.h=function(){jt.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var kt="closure_listenable_"+(1e6*Math.random()|0),Ta=0;function Ts(h,g,S,I,j){this.listener=h,this.proxy=null,this.src=g,this.type=S,this.capture=!!I,this.ha=j,this.key=++Ta,this.da=this.fa=!1}function $t(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ca(h){this.src=h,this.g={},this.h=0}Ca.prototype.add=function(h,g,S,I,j){var z=h.toString();h=this.g[z],h||(h=this.g[z]=[],this.h++);var Q=fc(h,g,I,j);return-1<Q?(g=h[Q],S||(g.fa=!1)):(g=new Ts(g,this.src,z,!!I,j),g.fa=S,h.push(g)),g};function Ea(h,g){var S=g.type;if(S in h.g){var I=h.g[S],j=Array.prototype.indexOf.call(I,g,void 0),z;(z=0<=j)&&Array.prototype.splice.call(I,j,1),z&&($t(g),h.g[S].length==0&&(delete h.g[S],h.h--))}}function fc(h,g,S,I){for(var j=0;j<h.length;++j){var z=h[j];if(!z.da&&z.listener==g&&z.capture==!!S&&z.ha==I)return j}return-1}var xa="closure_lm_"+(1e6*Math.random()|0),ba={};function Wh(h,g,S,I,j){if(Array.isArray(g)){for(var z=0;z<g.length;z++)Wh(h,g[z],S,I,j);return null}return S=K(S),h&&h[kt]?h.K(g,S,c(I)?!!I.capture:!1,j):ny(h,g,S,!1,I,j)}function ny(h,g,S,I,j,z){if(!g)throw Error("Invalid event type");var Q=c(j)?!!j.capture:!!j,Be=Z(h);if(Be||(h[xa]=Be=new Ca(h)),S=Be.add(g,S,I,Q,z),S.proxy)return S;if(I=UT(),S.proxy=I,I.src=h,I.listener=S,h.addEventListener)vt||(j=Q),j===void 0&&(j=!1),h.addEventListener(g.toString(),I,j);else if(h.attachEvent)h.attachEvent($(g.toString()),I);else if(h.addListener&&h.removeListener)h.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return S}function UT(){function h(S){return g.call(h.src,h.listener,S)}const g=H;return h}function pc(h,g,S,I,j){if(Array.isArray(g))for(var z=0;z<g.length;z++)pc(h,g[z],S,I,j);else I=c(I)?!!I.capture:!!I,S=K(S),h&&h[kt]?(h=h.i,g=String(g).toString(),g in h.g&&(z=h.g[g],S=fc(z,S,I,j),-1<S&&($t(z[S]),Array.prototype.splice.call(z,S,1),z.length==0&&(delete h.g[g],h.h--)))):h&&(h=Z(h))&&(g=h.g[g.toString()],h=-1,g&&(h=fc(g,S,I,j)),(S=-1<h?g[h]:null)&&N(S))}function N(h){if(typeof h!="number"&&h&&!h.da){var g=h.src;if(g&&g[kt])Ea(g.i,h);else{var S=h.type,I=h.proxy;g.removeEventListener?g.removeEventListener(S,I,h.capture):g.detachEvent?g.detachEvent($(S),I):g.addListener&&g.removeListener&&g.removeListener(I),(S=Z(g))?(Ea(S,h),S.h==0&&(S.src=null,g[xa]=null)):$t(h)}}}function $(h){return h in ba?ba[h]:ba[h]="on"+h}function H(h,g){if(h.da)h=!0;else{g=new jt(g,this);var S=h.listener,I=h.ha||h.src;h.fa&&N(h),h=S.call(I,g)}return h}function Z(h){return h=h[xa],h instanceof Ca?h:null}var J="__closure_events_fn_"+(1e9*Math.random()>>>0);function K(h){return typeof h=="function"?h:(h[J]||(h[J]=function(g){return h.handleEvent(g)}),h[J])}function re(){xe.call(this),this.i=new Ca(this),this.M=this,this.F=null}m(re,xe),re.prototype[kt]=!0,re.prototype.removeEventListener=function(h,g,S,I){pc(this,h,g,S,I)};function me(h,g){var S,I=h.F;if(I)for(S=[];I;I=I.F)S.push(I);if(h=h.M,I=g.type||g,typeof g=="string")g=new De(g,h);else if(g instanceof De)g.target=g.target||h;else{var j=g;g=new De(I,h),P(g,j)}if(j=!0,S)for(var z=S.length-1;0<=z;z--){var Q=g.g=S[z];j=Pe(Q,I,!0,g)&&j}if(Q=g.g=h,j=Pe(Q,I,!0,g)&&j,j=Pe(Q,I,!1,g)&&j,S)for(z=0;z<S.length;z++)Q=g.g=S[z],j=Pe(Q,I,!1,g)&&j}re.prototype.N=function(){if(re.aa.N.call(this),this.i){var h=this.i,g;for(g in h.g){for(var S=h.g[g],I=0;I<S.length;I++)$t(S[I]);delete h.g[g],h.h--}}this.F=null},re.prototype.K=function(h,g,S,I){return this.i.add(String(h),g,!1,S,I)},re.prototype.L=function(h,g,S,I){return this.i.add(String(h),g,!0,S,I)};function Pe(h,g,S,I){if(g=h.i.g[String(g)],!g)return!0;g=g.concat();for(var j=!0,z=0;z<g.length;++z){var Q=g[z];if(Q&&!Q.da&&Q.capture==S){var Be=Q.listener,Ut=Q.ha||Q.src;Q.fa&&Ea(h.i,Q),j=Be.call(Ut,I)!==!1&&j}}return j&&!I.defaultPrevented}function ur(h,g,S){if(typeof h=="function")S&&(h=f(h,S));else if(h&&typeof h.handleEvent=="function")h=f(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(h,g||0)}function go(h){h.g=ur(()=>{h.g=null,h.i&&(h.i=!1,go(h))},h.l);const g=h.h;h.h=null,h.m.apply(null,g)}class Hn extends xe{constructor(g,S){super(),this.m=g,this.l=S,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:go(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function mo(h){xe.call(this),this.h=h,this.g={}}m(mo,xe);var Aa=[];function ka(h){M(h.g,function(g,S){this.g.hasOwnProperty(S)&&N(g)},h),h.g={}}mo.prototype.N=function(){mo.aa.N.call(this),ka(this)},mo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gc=a.JSON.stringify,Hh=a.JSON.parse,sy=class{stringify(h){return a.JSON.stringify(h,void 0)}parse(h){return a.JSON.parse(h,void 0)}};function Ia(){}Ia.prototype.h=null;function BT(h){return h.h||(h.h=h.i())}function zT(){}var mc={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function iy(){De.call(this,"d")}m(iy,De);function oy(){De.call(this,"c")}m(oy,De);var yo={},WT=null;function Gh(){return WT=WT||new re}yo.La="serverreachability";function HT(h){De.call(this,yo.La,h)}m(HT,De);function yc(h){const g=Gh();me(g,new HT(g))}yo.STAT_EVENT="statevent";function GT(h,g){De.call(this,yo.STAT_EVENT,h),this.stat=g}m(GT,De);function hr(h){const g=Gh();me(g,new GT(g,h))}yo.Ma="timingevent";function qT(h,g){De.call(this,yo.Ma,h),this.size=g}m(qT,De);function vc(h,g){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){h()},g)}function _c(){this.g=!0}_c.prototype.xa=function(){this.g=!1};function jM(h,g,S,I,j,z){h.info(function(){if(h.g)if(z)for(var Q="",Be=z.split("&"),Ut=0;Ut<Be.length;Ut++){var ke=Be[Ut].split("=");if(1<ke.length){var Qt=ke[0];ke=ke[1];var Jt=Qt.split("_");Q=2<=Jt.length&&Jt[1]=="type"?Q+(Qt+"="+ke+"&"):Q+(Qt+"=redacted&")}}else Q=null;else Q=z;return"XMLHTTP REQ ("+I+") [attempt "+j+"]: "+g+`
`+S+`
`+Q})}function $M(h,g,S,I,j,z,Q){h.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+j+"]: "+g+`
`+S+`
`+z+" "+Q})}function Pa(h,g,S,I){h.info(function(){return"XMLHTTP TEXT ("+g+"): "+BM(h,S)+(I?" "+I:"")})}function UM(h,g){h.info(function(){return"TIMEOUT: "+g})}_c.prototype.info=function(){};function BM(h,g){if(!h.g)return g;if(!g)return null;try{var S=JSON.parse(g);if(S){for(h=0;h<S.length;h++)if(Array.isArray(S[h])){var I=S[h];if(!(2>I.length)){var j=I[1];if(Array.isArray(j)&&!(1>j.length)){var z=j[0];if(z!="noop"&&z!="stop"&&z!="close")for(var Q=1;Q<j.length;Q++)j[Q]=""}}}}return gc(S)}catch{return g}}var qh={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},YT={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ay;function Yh(){}m(Yh,Ia),Yh.prototype.g=function(){return new XMLHttpRequest},Yh.prototype.i=function(){return{}},ay=new Yh;function hi(h,g,S,I){this.j=h,this.i=g,this.l=S,this.R=I||1,this.U=new mo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new XT}function XT(){this.i=null,this.g="",this.h=!1}var KT={},ly={};function cy(h,g,S){h.L=1,h.v=Jh(Cs(g)),h.m=S,h.P=!0,QT(h,null)}function QT(h,g){h.F=Date.now(),Xh(h),h.A=Cs(h.v);var S=h.A,I=h.R;Array.isArray(I)||(I=[String(I)]),hC(S.i,"t",I),h.C=0,S=h.j.J,h.h=new XT,h.g=IC(h.j,S?g:null,!h.m),0<h.O&&(h.M=new Hn(f(h.Y,h,h.g),h.O)),g=h.U,S=h.g,I=h.ca;var j="readystatechange";Array.isArray(j)||(j&&(Aa[0]=j.toString()),j=Aa);for(var z=0;z<j.length;z++){var Q=Wh(S,j[z],I||g.handleEvent,!1,g.h||g);if(!Q)break;g.g[Q.key]=Q}g=h.H?E(h.H):{},h.m?(h.u||(h.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,g)):(h.u="GET",h.g.ea(h.A,h.u,null,g)),yc(),jM(h.i,h.u,h.A,h.l,h.R,h.m)}hi.prototype.ca=function(h){h=h.target;const g=this.M;g&&Es(h)==3?g.j():this.Y(h)},hi.prototype.Y=function(h){try{if(h==this.g)e:{const Jt=Es(this.g);var g=this.g.Ba();const Da=this.g.Z();if(!(3>Jt)&&(Jt!=3||this.g&&(this.h.h||this.g.oa()||vC(this.g)))){this.J||Jt!=4||g==7||(g==8||0>=Da?yc(3):yc(2)),uy(this);var S=this.g.Z();this.X=S;t:if(JT(this)){var I=vC(this.g);h="";var j=I.length,z=Es(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){vo(this),wc(this);var Q="";break t}this.h.i=new a.TextDecoder}for(g=0;g<j;g++)this.h.h=!0,h+=this.h.i.decode(I[g],{stream:!(z&&g==j-1)});I.length=0,this.h.g+=h,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=S==200,$M(this.i,this.u,this.A,this.l,this.R,Jt,S),this.o){if(this.T&&!this.K){t:{if(this.g){var Be,Ut=this.g;if((Be=Ut.g?Ut.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(Be)){var ke=Be;break t}}ke=null}if(S=ke)Pa(this.i,this.l,S,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,hy(this,S);else{this.o=!1,this.s=3,hr(12),vo(this),wc(this);break e}}if(this.P){S=!0;let _n;for(;!this.J&&this.C<Q.length;)if(_n=zM(this,Q),_n==ly){Jt==4&&(this.s=4,hr(14),S=!1),Pa(this.i,this.l,null,"[Incomplete Response]");break}else if(_n==KT){this.s=4,hr(15),Pa(this.i,this.l,Q,"[Invalid Chunk]"),S=!1;break}else Pa(this.i,this.l,_n,null),hy(this,_n);if(JT(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jt!=4||Q.length!=0||this.h.h||(this.s=1,hr(16),S=!1),this.o=this.o&&S,!S)Pa(this.i,this.l,Q,"[Invalid Chunked Response]"),vo(this),wc(this);else if(0<Q.length&&!this.W){this.W=!0;var Qt=this.j;Qt.g==this&&Qt.ba&&!Qt.M&&(Qt.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),yy(Qt),Qt.M=!0,hr(11))}}else Pa(this.i,this.l,Q,null),hy(this,Q);Jt==4&&vo(this),this.o&&!this.J&&(Jt==4?xC(this.j,this):(this.o=!1,Xh(this)))}else oN(this.g),S==400&&0<Q.indexOf("Unknown SID")?(this.s=3,hr(12)):(this.s=0,hr(13)),vo(this),wc(this)}}}catch{}finally{}};function JT(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function zM(h,g){var S=h.C,I=g.indexOf(`
`,S);return I==-1?ly:(S=Number(g.substring(S,I)),isNaN(S)?KT:(I+=1,I+S>g.length?ly:(g=g.slice(I,I+S),h.C=I+S,g)))}hi.prototype.cancel=function(){this.J=!0,vo(this)};function Xh(h){h.S=Date.now()+h.I,ZT(h,h.I)}function ZT(h,g){if(h.B!=null)throw Error("WatchDog timer not null");h.B=vc(f(h.ba,h),g)}function uy(h){h.B&&(a.clearTimeout(h.B),h.B=null)}hi.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(UM(this.i,this.A),this.L!=2&&(yc(),hr(17)),vo(this),this.s=2,wc(this)):ZT(this,this.S-h)};function wc(h){h.j.G==0||h.J||xC(h.j,h)}function vo(h){uy(h);var g=h.M;g&&typeof g.ma=="function"&&g.ma(),h.M=null,ka(h.U),h.g&&(g=h.g,h.g=null,g.abort(),g.ma())}function hy(h,g){try{var S=h.j;if(S.G!=0&&(S.g==h||dy(S.h,h))){if(!h.K&&dy(S.h,h)&&S.G==3){try{var I=S.Da.g.parse(g)}catch{I=null}if(Array.isArray(I)&&I.length==3){var j=I;if(j[0]==0){e:if(!S.u){if(S.g)if(S.g.F+3e3<h.F)sd(S),rd(S);else break e;my(S),hr(18)}}else S.za=j[1],0<S.za-S.T&&37500>j[2]&&S.F&&S.v==0&&!S.C&&(S.C=vc(f(S.Za,S),6e3));if(1>=rC(S.h)&&S.ca){try{S.ca()}catch{}S.ca=void 0}}else wo(S,11)}else if((h.K||S.g==h)&&sd(S),!y(g))for(j=S.Da.g.parse(g),g=0;g<j.length;g++){let ke=j[g];if(S.T=ke[0],ke=ke[1],S.G==2)if(ke[0]=="c"){S.K=ke[1],S.ia=ke[2];const Qt=ke[3];Qt!=null&&(S.la=Qt,S.j.info("VER="+S.la));const Jt=ke[4];Jt!=null&&(S.Aa=Jt,S.j.info("SVER="+S.Aa));const Da=ke[5];Da!=null&&typeof Da=="number"&&0<Da&&(I=1.5*Da,S.L=I,S.j.info("backChannelRequestTimeoutMs_="+I)),I=S;const _n=h.g;if(_n){const od=_n.g?_n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(od){var z=I.h;z.g||od.indexOf("spdy")==-1&&od.indexOf("quic")==-1&&od.indexOf("h2")==-1||(z.j=z.l,z.g=new Set,z.h&&(fy(z,z.h),z.h=null))}if(I.D){const vy=_n.g?_n.g.getResponseHeader("X-HTTP-Session-Id"):null;vy&&(I.ya=vy,Ye(I.I,I.D,vy))}}S.G=3,S.l&&S.l.ua(),S.ba&&(S.R=Date.now()-h.F,S.j.info("Handshake RTT: "+S.R+"ms")),I=S;var Q=h;if(I.qa=kC(I,I.J?I.ia:null,I.W),Q.K){nC(I.h,Q);var Be=Q,Ut=I.L;Ut&&(Be.I=Ut),Be.B&&(uy(Be),Xh(Be)),I.g=Q}else CC(I);0<S.i.length&&nd(S)}else ke[0]!="stop"&&ke[0]!="close"||wo(S,7);else S.G==3&&(ke[0]=="stop"||ke[0]=="close"?ke[0]=="stop"?wo(S,7):gy(S):ke[0]!="noop"&&S.l&&S.l.ta(ke),S.v=0)}}yc(4)}catch{}}var WM=class{constructor(h,g){this.g=h,this.map=g}};function eC(h){this.l=h||10,a.PerformanceNavigationTiming?(h=a.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function tC(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function rC(h){return h.h?1:h.g?h.g.size:0}function dy(h,g){return h.h?h.h==g:h.g?h.g.has(g):!1}function fy(h,g){h.g?h.g.add(g):h.h=g}function nC(h,g){h.h&&h.h==g?h.h=null:h.g&&h.g.has(g)&&h.g.delete(g)}eC.prototype.cancel=function(){if(this.i=sC(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function sC(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let g=h.i;for(const S of h.g.values())g=g.concat(S.D);return g}return v(h.i)}function HM(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var g=[],S=h.length,I=0;I<S;I++)g.push(h[I]);return g}g=[],S=0;for(I in h)g[S++]=h[I];return g}function GM(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var g=[];h=h.length;for(var S=0;S<h;S++)g.push(S);return g}g=[],S=0;for(const I in h)g[S++]=I;return g}}}function iC(h,g){if(h.forEach&&typeof h.forEach=="function")h.forEach(g,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,g,void 0);else for(var S=GM(h),I=HM(h),j=I.length,z=0;z<j;z++)g.call(void 0,I[z],S&&S[z],h)}var oC=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function qM(h,g){if(h){h=h.split("&");for(var S=0;S<h.length;S++){var I=h[S].indexOf("="),j=null;if(0<=I){var z=h[S].substring(0,I);j=h[S].substring(I+1)}else z=h[S];g(z,j?decodeURIComponent(j.replace(/\+/g," ")):"")}}}function _o(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof _o){this.h=h.h,Kh(this,h.j),this.o=h.o,this.g=h.g,Qh(this,h.s),this.l=h.l;var g=h.i,S=new Cc;S.i=g.i,g.g&&(S.g=new Map(g.g),S.h=g.h),aC(this,S),this.m=h.m}else h&&(g=String(h).match(oC))?(this.h=!1,Kh(this,g[1]||"",!0),this.o=Sc(g[2]||""),this.g=Sc(g[3]||"",!0),Qh(this,g[4]),this.l=Sc(g[5]||"",!0),aC(this,g[6]||"",!0),this.m=Sc(g[7]||"")):(this.h=!1,this.i=new Cc(null,this.h))}_o.prototype.toString=function(){var h=[],g=this.j;g&&h.push(Tc(g,lC,!0),":");var S=this.g;return(S||g=="file")&&(h.push("//"),(g=this.o)&&h.push(Tc(g,lC,!0),"@"),h.push(encodeURIComponent(String(S)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.s,S!=null&&h.push(":",String(S))),(S=this.l)&&(this.g&&S.charAt(0)!="/"&&h.push("/"),h.push(Tc(S,S.charAt(0)=="/"?KM:XM,!0))),(S=this.i.toString())&&h.push("?",S),(S=this.m)&&h.push("#",Tc(S,JM)),h.join("")};function Cs(h){return new _o(h)}function Kh(h,g,S){h.j=S?Sc(g,!0):g,h.j&&(h.j=h.j.replace(/:$/,""))}function Qh(h,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);h.s=g}else h.s=null}function aC(h,g,S){g instanceof Cc?(h.i=g,ZM(h.i,h.h)):(S||(g=Tc(g,QM)),h.i=new Cc(g,h.h))}function Ye(h,g,S){h.i.set(g,S)}function Jh(h){return Ye(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Sc(h,g){return h?g?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Tc(h,g,S){return typeof h=="string"?(h=encodeURI(h).replace(g,YM),S&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function YM(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var lC=/[#\/\?@]/g,XM=/[#\?:]/g,KM=/[#\?]/g,QM=/[#\?@]/g,JM=/#/g;function Cc(h,g){this.h=this.g=null,this.i=h||null,this.j=!!g}function di(h){h.g||(h.g=new Map,h.h=0,h.i&&qM(h.i,function(g,S){h.add(decodeURIComponent(g.replace(/\+/g," ")),S)}))}r=Cc.prototype,r.add=function(h,g){di(this),this.i=null,h=Ra(this,h);var S=this.g.get(h);return S||this.g.set(h,S=[]),S.push(g),this.h+=1,this};function cC(h,g){di(h),g=Ra(h,g),h.g.has(g)&&(h.i=null,h.h-=h.g.get(g).length,h.g.delete(g))}function uC(h,g){return di(h),g=Ra(h,g),h.g.has(g)}r.forEach=function(h,g){di(this),this.g.forEach(function(S,I){S.forEach(function(j){h.call(g,j,I,this)},this)},this)},r.na=function(){di(this);const h=Array.from(this.g.values()),g=Array.from(this.g.keys()),S=[];for(let I=0;I<g.length;I++){const j=h[I];for(let z=0;z<j.length;z++)S.push(g[I])}return S},r.V=function(h){di(this);let g=[];if(typeof h=="string")uC(this,h)&&(g=g.concat(this.g.get(Ra(this,h))));else{h=Array.from(this.g.values());for(let S=0;S<h.length;S++)g=g.concat(h[S])}return g},r.set=function(h,g){return di(this),this.i=null,h=Ra(this,h),uC(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[g]),this.h+=1,this},r.get=function(h,g){return h?(h=this.V(h),0<h.length?String(h[0]):g):g};function hC(h,g,S){cC(h,g),0<S.length&&(h.i=null,h.g.set(Ra(h,g),v(S)),h.h+=S.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],g=Array.from(this.g.keys());for(var S=0;S<g.length;S++){var I=g[S];const z=encodeURIComponent(String(I)),Q=this.V(I);for(I=0;I<Q.length;I++){var j=z;Q[I]!==""&&(j+="="+encodeURIComponent(String(Q[I]))),h.push(j)}}return this.i=h.join("&")};function Ra(h,g){return g=String(g),h.j&&(g=g.toLowerCase()),g}function ZM(h,g){g&&!h.j&&(di(h),h.i=null,h.g.forEach(function(S,I){var j=I.toLowerCase();I!=j&&(cC(this,I),hC(this,j,S))},h)),h.j=g}function eN(h,g){const S=new _c;if(a.Image){const I=new Image;I.onload=p(fi,S,"TestLoadImage: loaded",!0,g,I),I.onerror=p(fi,S,"TestLoadImage: error",!1,g,I),I.onabort=p(fi,S,"TestLoadImage: abort",!1,g,I),I.ontimeout=p(fi,S,"TestLoadImage: timeout",!1,g,I),a.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=h}else g(!1)}function tN(h,g){const S=new _c,I=new AbortController,j=setTimeout(()=>{I.abort(),fi(S,"TestPingServer: timeout",!1,g)},1e4);fetch(h,{signal:I.signal}).then(z=>{clearTimeout(j),z.ok?fi(S,"TestPingServer: ok",!0,g):fi(S,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(j),fi(S,"TestPingServer: error",!1,g)})}function fi(h,g,S,I,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),I(S)}catch{}}function rN(){this.g=new sy}function nN(h,g,S){const I=S||"";try{iC(h,function(j,z){let Q=j;c(j)&&(Q=gc(j)),g.push(I+z+"="+encodeURIComponent(Q))})}catch(j){throw g.push(I+"type="+encodeURIComponent("_badmap")),j}}function Zh(h){this.l=h.Ub||null,this.j=h.eb||!1}m(Zh,Ia),Zh.prototype.g=function(){return new ed(this.l,this.j)},Zh.prototype.i=function(h){return function(){return h}}({});function ed(h,g){re.call(this),this.D=h,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}m(ed,re),r=ed.prototype,r.open=function(h,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=g,this.readyState=1,xc(this)},r.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(g.body=h),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ec(this)),this.readyState=0},r.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,xc(this)),this.g&&(this.readyState=3,xc(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;dC(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function dC(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}r.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var g=h.value?h.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!h.done}))&&(this.response=this.responseText+=g)}h.done?Ec(this):xc(this),this.readyState==3&&dC(this)}},r.Ra=function(h){this.g&&(this.response=this.responseText=h,Ec(this))},r.Qa=function(h){this.g&&(this.response=h,Ec(this))},r.ga=function(){this.g&&Ec(this)};function Ec(h){h.readyState=4,h.l=null,h.j=null,h.v=null,xc(h)}r.setRequestHeader=function(h,g){this.u.append(h,g)},r.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],g=this.h.entries();for(var S=g.next();!S.done;)S=S.value,h.push(S[0]+": "+S[1]),S=g.next();return h.join(`\r
`)};function xc(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(ed.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function fC(h){let g="";return M(h,function(S,I){g+=I,g+=":",g+=S,g+=`\r
`}),g}function py(h,g,S){e:{for(I in S){var I=!1;break e}I=!0}I||(S=fC(S),typeof h=="string"?S!=null&&encodeURIComponent(String(S)):Ye(h,g,S))}function ot(h){re.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}m(ot,re);var sN=/^https?$/i,iN=["POST","PUT"];r=ot.prototype,r.Ha=function(h){this.J=h},r.ea=function(h,g,S,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);g=g?g.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ay.g(),this.v=this.o?BT(this.o):BT(ay),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(g,String(h),!0),this.B=!1}catch(z){pC(this,z);return}if(h=S||"",S=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var j in I)S.set(j,I[j]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const z of I.keys())S.set(z,I.get(z));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(S.keys()).find(z=>z.toLowerCase()=="content-type"),j=a.FormData&&h instanceof a.FormData,!(0<=Array.prototype.indexOf.call(iN,g,void 0))||I||j||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[z,Q]of S)this.g.setRequestHeader(z,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{yC(this),this.u=!0,this.g.send(h),this.u=!1}catch(z){pC(this,z)}};function pC(h,g){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=g,h.m=5,gC(h),td(h)}function gC(h){h.A||(h.A=!0,me(h,"complete"),me(h,"error"))}r.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,me(this,"complete"),me(this,"abort"),td(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),td(this,!0)),ot.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?mC(this):this.bb())},r.bb=function(){mC(this)};function mC(h){if(h.h&&typeof o<"u"&&(!h.v[1]||Es(h)!=4||h.Z()!=2)){if(h.u&&Es(h)==4)ur(h.Ea,0,h);else if(me(h,"readystatechange"),Es(h)==4){h.h=!1;try{const Q=h.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var S;if(!(S=g)){var I;if(I=Q===0){var j=String(h.D).match(oC)[1]||null;!j&&a.self&&a.self.location&&(j=a.self.location.protocol.slice(0,-1)),I=!sN.test(j?j.toLowerCase():"")}S=I}if(S)me(h,"complete"),me(h,"success");else{h.m=6;try{var z=2<Es(h)?h.g.statusText:""}catch{z=""}h.l=z+" ["+h.Z()+"]",gC(h)}}finally{td(h)}}}}function td(h,g){if(h.g){yC(h);const S=h.g,I=h.v[0]?()=>{}:null;h.g=null,h.v=null,g||me(h,"ready");try{S.onreadystatechange=I}catch{}}}function yC(h){h.I&&(a.clearTimeout(h.I),h.I=null)}r.isActive=function(){return!!this.g};function Es(h){return h.g?h.g.readyState:0}r.Z=function(){try{return 2<Es(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(h){if(this.g){var g=this.g.responseText;return h&&g.indexOf(h)==0&&(g=g.substring(h.length)),Hh(g)}};function vC(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function oN(h){const g={};h=(h.g&&2<=Es(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<h.length;I++){if(y(h[I]))continue;var S=R(h[I]);const j=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const z=g[j]||[];g[j]=z,z.push(S)}x(g,function(I){return I.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function bc(h,g,S){return S&&S.internalChannelParams&&S.internalChannelParams[h]||g}function _C(h){this.Aa=0,this.i=[],this.j=new _c,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=bc("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=bc("baseRetryDelayMs",5e3,h),this.cb=bc("retryDelaySeedMs",1e4,h),this.Wa=bc("forwardChannelMaxRetries",2,h),this.wa=bc("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new eC(h&&h.concurrentRequestLimit),this.Da=new rN,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=_C.prototype,r.la=8,r.G=1,r.connect=function(h,g,S,I){hr(0),this.W=h,this.H=g||{},S&&I!==void 0&&(this.H.OSID=S,this.H.OAID=I),this.F=this.X,this.I=kC(this,null,this.W),nd(this)};function gy(h){if(wC(h),h.G==3){var g=h.U++,S=Cs(h.I);if(Ye(S,"SID",h.K),Ye(S,"RID",g),Ye(S,"TYPE","terminate"),Ac(h,S),g=new hi(h,h.j,g),g.L=2,g.v=Jh(Cs(S)),S=!1,a.navigator&&a.navigator.sendBeacon)try{S=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!S&&a.Image&&(new Image().src=g.v,S=!0),S||(g.g=IC(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Xh(g)}AC(h)}function rd(h){h.g&&(yy(h),h.g.cancel(),h.g=null)}function wC(h){rd(h),h.u&&(a.clearTimeout(h.u),h.u=null),sd(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&a.clearTimeout(h.s),h.s=null)}function nd(h){if(!tC(h.h)&&!h.s){h.s=!0;var g=h.Ga;ge||he(),Y||(ge(),Y=!0),ce.add(g,h),h.B=0}}function aN(h,g){return rC(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=g.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=vc(f(h.Ga,h,g),bC(h,h.B)),h.B++,!0)}r.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const j=new hi(this,this.j,h);let z=this.o;if(this.S&&(z?(z=E(z),P(z,this.S)):z=this.S),this.m!==null||this.O||(j.H=z,z=null),this.P)e:{for(var g=0,S=0;S<this.i.length;S++){t:{var I=this.i[S];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(g+=I,4096<g){g=S;break e}if(g===4096||S===this.i.length-1){g=S+1;break e}}g=1e3}else g=1e3;g=TC(this,j,g),S=Cs(this.I),Ye(S,"RID",h),Ye(S,"CVER",22),this.D&&Ye(S,"X-HTTP-Session-Id",this.D),Ac(this,S),z&&(this.O?g="headers="+encodeURIComponent(String(fC(z)))+"&"+g:this.m&&py(S,this.m,z)),fy(this.h,j),this.Ua&&Ye(S,"TYPE","init"),this.P?(Ye(S,"$req",g),Ye(S,"SID","null"),j.T=!0,cy(j,S,null)):cy(j,S,g),this.G=2}}else this.G==3&&(h?SC(this,h):this.i.length==0||tC(this.h)||SC(this))};function SC(h,g){var S;g?S=g.l:S=h.U++;const I=Cs(h.I);Ye(I,"SID",h.K),Ye(I,"RID",S),Ye(I,"AID",h.T),Ac(h,I),h.m&&h.o&&py(I,h.m,h.o),S=new hi(h,h.j,S,h.B+1),h.m===null&&(S.H=h.o),g&&(h.i=g.D.concat(h.i)),g=TC(h,S,1e3),S.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),fy(h.h,S),cy(S,I,g)}function Ac(h,g){h.H&&M(h.H,function(S,I){Ye(g,I,S)}),h.l&&iC({},function(S,I){Ye(g,I,S)})}function TC(h,g,S){S=Math.min(h.i.length,S);var I=h.l?f(h.l.Na,h.l,h):null;e:{var j=h.i;let z=-1;for(;;){const Q=["count="+S];z==-1?0<S?(z=j[0].g,Q.push("ofs="+z)):z=0:Q.push("ofs="+z);let Be=!0;for(let Ut=0;Ut<S;Ut++){let ke=j[Ut].g;const Qt=j[Ut].map;if(ke-=z,0>ke)z=Math.max(0,j[Ut].g-100),Be=!1;else try{nN(Qt,Q,"req"+ke+"_")}catch{I&&I(Qt)}}if(Be){I=Q.join("&");break e}}}return h=h.i.splice(0,S),g.D=h,I}function CC(h){if(!h.g&&!h.u){h.Y=1;var g=h.Fa;ge||he(),Y||(ge(),Y=!0),ce.add(g,h),h.v=0}}function my(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=vc(f(h.Fa,h),bC(h,h.v)),h.v++,!0)}r.Fa=function(){if(this.u=null,EC(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=vc(f(this.ab,this),h)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,hr(10),rd(this),EC(this))};function yy(h){h.A!=null&&(a.clearTimeout(h.A),h.A=null)}function EC(h){h.g=new hi(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var g=Cs(h.qa);Ye(g,"RID","rpc"),Ye(g,"SID",h.K),Ye(g,"AID",h.T),Ye(g,"CI",h.F?"0":"1"),!h.F&&h.ja&&Ye(g,"TO",h.ja),Ye(g,"TYPE","xmlhttp"),Ac(h,g),h.m&&h.o&&py(g,h.m,h.o),h.L&&(h.g.I=h.L);var S=h.g;h=h.ia,S.L=1,S.v=Jh(Cs(g)),S.m=null,S.P=!0,QT(S,h)}r.Za=function(){this.C!=null&&(this.C=null,rd(this),my(this),hr(19))};function sd(h){h.C!=null&&(a.clearTimeout(h.C),h.C=null)}function xC(h,g){var S=null;if(h.g==g){sd(h),yy(h),h.g=null;var I=2}else if(dy(h.h,g))S=g.D,nC(h.h,g),I=1;else return;if(h.G!=0){if(g.o)if(I==1){S=g.m?g.m.length:0,g=Date.now()-g.F;var j=h.B;I=Gh(),me(I,new qT(I,S)),nd(h)}else CC(h);else if(j=g.s,j==3||j==0&&0<g.X||!(I==1&&aN(h,g)||I==2&&my(h)))switch(S&&0<S.length&&(g=h.h,g.i=g.i.concat(S)),j){case 1:wo(h,5);break;case 4:wo(h,10);break;case 3:wo(h,6);break;default:wo(h,2)}}}function bC(h,g){let S=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(S*=2),S*g}function wo(h,g){if(h.j.info("Error code "+g),g==2){var S=f(h.fb,h),I=h.Xa;const j=!I;I=new _o(I||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Kh(I,"https"),Jh(I),j?eN(I.toString(),S):tN(I.toString(),S)}else hr(2);h.G=0,h.l&&h.l.sa(g),AC(h),wC(h)}r.fb=function(h){h?(this.j.info("Successfully pinged google.com"),hr(2)):(this.j.info("Failed to ping google.com"),hr(1))};function AC(h){if(h.G=0,h.ka=[],h.l){const g=sC(h.h);(g.length!=0||h.i.length!=0)&&(T(h.ka,g),T(h.ka,h.i),h.h.i.length=0,v(h.i),h.i.length=0),h.l.ra()}}function kC(h,g,S){var I=S instanceof _o?Cs(S):new _o(S);if(I.g!="")g&&(I.g=g+"."+I.g),Qh(I,I.s);else{var j=a.location;I=j.protocol,g=g?g+"."+j.hostname:j.hostname,j=+j.port;var z=new _o(null);I&&Kh(z,I),g&&(z.g=g),j&&Qh(z,j),S&&(z.l=S),I=z}return S=h.D,g=h.ya,S&&g&&Ye(I,S,g),Ye(I,"VER",h.la),Ac(h,I),I}function IC(h,g,S){if(g&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=h.Ca&&!h.pa?new ot(new Zh({eb:S})):new ot(h.pa),g.Ha(h.J),g}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function PC(){}r=PC.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function id(){}id.prototype.g=function(h,g){return new Vr(h,g)};function Vr(h,g){re.call(this),this.g=new _C(g),this.l=h,this.h=g&&g.messageUrlParams||null,h=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(h?h["X-WebChannel-Content-Type"]=g.messageContentType:h={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(h?h["X-WebChannel-Client-Profile"]=g.va:h={"X-WebChannel-Client-Profile":g.va}),this.g.S=h,(h=g&&g.Sb)&&!y(h)&&(this.g.m=h),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!y(g)&&(this.g.D=g,h=this.h,h!==null&&g in h&&(h=this.h,g in h&&delete h[g])),this.j=new Oa(this)}m(Vr,re),Vr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Vr.prototype.close=function(){gy(this.g)},Vr.prototype.o=function(h){var g=this.g;if(typeof h=="string"){var S={};S.__data__=h,h=S}else this.u&&(S={},S.__data__=gc(h),h=S);g.i.push(new WM(g.Ya++,h)),g.G==3&&nd(g)},Vr.prototype.N=function(){this.g.l=null,delete this.j,gy(this.g),delete this.g,Vr.aa.N.call(this)};function RC(h){iy.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var g=h.__sm__;if(g){e:{for(const S in g){h=S;break e}h=void 0}(this.i=h)&&(h=this.i,g=g!==null&&h in g?g[h]:void 0),this.data=g}else this.data=h}m(RC,iy);function OC(){oy.call(this),this.status=1}m(OC,oy);function Oa(h){this.g=h}m(Oa,PC),Oa.prototype.ua=function(){me(this.g,"a")},Oa.prototype.ta=function(h){me(this.g,new RC(h))},Oa.prototype.sa=function(h){me(this.g,new OC)},Oa.prototype.ra=function(){me(this.g,"b")},id.prototype.createWebChannel=id.prototype.g,Vr.prototype.send=Vr.prototype.o,Vr.prototype.open=Vr.prototype.m,Vr.prototype.close=Vr.prototype.close,bP=function(){return new id},xP=function(){return Gh()},EP=yo,Q0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qh.NO_ERROR=0,qh.TIMEOUT=8,qh.HTTP_ERROR=6,If=qh,YT.COMPLETE="complete",CP=YT,zT.EventType=mc,mc.OPEN="a",mc.CLOSE="b",mc.ERROR="c",mc.MESSAGE="d",re.prototype.listen=re.prototype.K,Zc=zT,ot.prototype.listenOnce=ot.prototype.L,ot.prototype.getLastError=ot.prototype.Ka,ot.prototype.getLastErrorCode=ot.prototype.Ba,ot.prototype.getStatus=ot.prototype.Z,ot.prototype.getResponseJson=ot.prototype.Oa,ot.prototype.getResponseText=ot.prototype.oa,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Ha,TP=ot}).apply(typeof Pd<"u"?Pd:typeof self<"u"?self:typeof window<"u"?window:{});const BE="@firebase/firestore",zE="4.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}sr.UNAUTHENTICATED=new sr(null),sr.GOOGLE_CREDENTIALS=new sr("google-credentials-uid"),sr.FIRST_PARTY=new sr("first-party-uid"),sr.MOCK_USER=new sr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ec="12.0.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra=new vm("@firebase/firestore");function Wa(){return ra.logLevel}function ne(r,...e){if(ra.logLevel<=Se.DEBUG){const t=e.map(hS);ra.debug(`Firestore (${ec}): ${r}`,...t)}}function ti(r,...e){if(ra.logLevel<=Se.ERROR){const t=e.map(hS);ra.error(`Firestore (${ec}): ${r}`,...t)}}function jl(r,...e){if(ra.logLevel<=Se.WARN){const t=e.map(hS);ra.warn(`Firestore (${ec}): ${r}`,...t)}}function hS(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,AP(r,n,t)}function AP(r,e,t){let n=`FIRESTORE (${ec}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw ti(n),new Error(n)}function Ne(r,e,t,n){let s="Unexpected state";typeof t=="string"?s=t:n=t,r||AP(e,s,n)}function ve(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ee extends Wn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class mU{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(sr.UNAUTHENTICATED))}shutdown(){}}class yU{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class vU{constructor(e){this.t=e,this.currentUser=sr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ne(this.o===void 0,42304);let n=this.i;const s=l=>this.i!==n?(n=this.i,t(l)):Promise.resolve();let i=new zs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new zs,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new zs)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Ne(typeof n.accessToken=="string",31837,{l:n}),new kP(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ne(e===null||typeof e=="string",2055,{h:e}),new sr(e)}}class _U{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=sr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class wU{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new _U(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(sr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class WE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class SU{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Br(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ne(this.o===void 0,3512);const n=i=>{i.error!=null&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,ne("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new WE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ne(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new WE(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TU(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const s=TU(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<t&&(n+=e.charAt(s[i]%62))}return n}}function Te(r,e){return r<e?-1:r>e?1:0}function J0(r,e){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++){const s=r.charAt(n),i=e.charAt(n);if(s!==i)return lv(s)===lv(i)?Te(s,i):lv(s)?1:-1}return Te(r.length,e.length)}const CU=55296,EU=57343;function lv(r){const e=r.charCodeAt(0);return e>=CU&&e<=EU}function $l(r,e,t){return r.length===e.length&&r.every((n,s)=>t(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE="__name__";class Xn{constructor(e,t,n){t===void 0?t=0:t>e.length&&pe(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&pe(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Xn.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Xn?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++){const i=Xn.compareSegments(e.get(s),t.get(s));if(i!==0)return i}return Te(e.length,t.length)}static compareSegments(e,t){const n=Xn.isNumericId(e),s=Xn.isNumericId(t);return n&&!s?-1:!n&&s?1:n&&s?Xn.extractNumericId(e).compare(Xn.extractNumericId(t)):J0(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Bi.fromString(e.substring(4,e.length-2))}}class He extends Xn{construct(e,t,n){return new He(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new ee(G.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(s=>s.length>0))}return new He(t)}static emptyPath(){return new He([])}}const xU=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Gt extends Xn{construct(e,t,n){return new Gt(e,t,n)}static isValidIdentifier(e){return xU.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Gt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===HE}static keyField(){return new Gt([HE])}static fromServerFormat(e){const t=[];let n="",s=0;const i=()=>{if(n.length===0)throw new ee(G.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new ee(G.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ee(G.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(n+=a,s++):(i(),s++)}if(i(),o)throw new ee(G.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Gt(t)}static emptyPath(){return new Gt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{constructor(e){this.path=e}static fromPath(e){return new de(He.fromString(e))}static fromName(e){return new de(He.fromString(e).popFirst(5))}static empty(){return new de(He.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&He.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return He.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new de(new He(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IP(r,e,t){if(!t)throw new ee(G.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function bU(r,e,t,n){if(e===!0&&n===!0)throw new ee(G.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function GE(r){if(!de.isDocumentKey(r))throw new ee(G.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function qE(r){if(de.isDocumentKey(r))throw new ee(G.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function PP(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function _m(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":pe(12329,{type:typeof r})}function Bn(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new ee(G.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=_m(r);throw new ee(G.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(r,e){const t={typeString:r};return e&&(t.value=e),t}function Ih(r,e){if(!PP(r))throw new ee(G.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const s=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const o=r[n];if(s&&typeof o!==s){t=`JSON field '${n}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){t=`Expected '${n}' field to equal '${i.value}'`;break}}if(t)throw new ee(G.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE=-62135596800,XE=1e6;class Ue{static now(){return Ue.fromMillis(Date.now())}static fromDate(e){return Ue.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*XE);return new Ue(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ee(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ee(G.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<YE)throw new ee(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ee(G.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/XE}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ue._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ih(e,Ue._jsonSchema))return new Ue(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-YE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ue._jsonSchemaVersion="firestore/timestamp/1.0",Ue._jsonSchema={type:bt("string",Ue._jsonSchemaVersion),seconds:bt("number"),nanoseconds:bt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{static fromTimestamp(e){return new ye(e)}static min(){return new ye(new Ue(0,0))}static max(){return new ye(new Ue(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=-1;function AU(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,s=ye.fromTimestamp(n===1e9?new Ue(t+1,0):new Ue(t,n));return new Ki(s,de.empty(),e)}function kU(r){return new Ki(r.readTime,r.key,Ju)}class Ki{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ki(ye.min(),de.empty(),Ju)}static max(){return new Ki(ye.max(),de.empty(),Ju)}}function IU(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=de.comparator(r.documentKey,e.documentKey),t!==0?t:Te(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PU="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class RU{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tc(r){if(r.code!==G.FAILED_PRECONDITION||r.message!==PU)throw r;ne("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(n,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):q.reject(t)}static resolve(e){return new q((t,n)=>{t(e)})}static reject(e){return new q((t,n)=>{n(e)})}static waitFor(e){return new q((t,n)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>n(l))}),o=!0,i===s&&t()})}static or(e){let t=q.resolve(!1);for(const n of e)t=t.next(s=>s?q.resolve(s):n());return t}static forEach(e,t){const n=[];return e.forEach((s,i)=>{n.push(t.call(this,s,i))}),this.waitFor(n)}static mapArray(e,t){return new q((n,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(u=>{o[c]=u,++a,a===i&&n(o)},u=>s(u))}})}static doWhile(e,t){return new q((n,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):n()};i()})}}function OU(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function rc(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>t.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}wm.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS=-1;function Sm(r){return r==null}function Op(r){return r===0&&1/r==-1/0}function DU(r){return typeof r=="number"&&Number.isInteger(r)&&!Op(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP="";function MU(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=KE(e)),e=NU(r.get(t),e);return KE(e)}function NU(r,e){let t=e;const n=r.length;for(let s=0;s<n;s++){const i=r.charAt(s);switch(i){case"\0":t+="";break;case RP:t+="";break;default:t+=i}}return t}function KE(r){return r+RP+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function ao(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function OP(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,t){this.comparator=e,this.root=t||Wt.EMPTY}insert(e,t){return new it(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Wt.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Wt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return t+n.left.size;s<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Rd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Rd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Rd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Rd(this.root,e,this.comparator,!0)}}class Rd{constructor(e,t,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Wt{constructor(e,t,n,s,i){this.key=e,this.value=t,this.color=n??Wt.RED,this.left=s??Wt.EMPTY,this.right=i??Wt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,s,i){return new Wt(e??this.key,t??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,n),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Wt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Wt.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Wt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Wt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw pe(27949);return e+(this.isRed()?0:1)}}Wt.EMPTY=null,Wt.RED=!0,Wt.BLACK=!1;Wt.EMPTY=new class{constructor(){this.size=0}get key(){throw pe(57766)}get value(){throw pe(16141)}get color(){throw pe(16727)}get left(){throw pe(29726)}get right(){throw pe(36894)}copy(e,t,n,s,i){return this}insert(e,t,n){return new Wt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new JE(this.data.getIterator())}getIteratorFrom(e){return new JE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Rt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Rt(this.comparator);return t.data=e,t}}class JE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(e){this.fields=e,e.sort(Gt.comparator)}static empty(){return new Wr([])}unionWith(e){let t=new Rt(Gt.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Wr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return $l(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new DP("Invalid base64 string: "+i):i}}(e);return new Kt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Kt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Kt.EMPTY_BYTE_STRING=new Kt("");const FU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qi(r){if(Ne(!!r,39018),typeof r=="string"){let e=0;const t=FU.exec(r);if(Ne(!!t,46558,{timestamp:r}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ht(r.seconds),nanos:ht(r.nanos)}}function ht(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Ji(r){return typeof r=="string"?Kt.fromBase64String(r):Kt.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP="server_timestamp",NP="__type__",FP="__previous_value__",LP="__local_write_time__";function pS(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[NP])==null?void 0:n.stringValue)===MP}function Tm(r){const e=r.mapValue.fields[FP];return pS(e)?Tm(e):e}function Zu(r){const e=Qi(r.mapValue.fields[LP].timestampValue);return new Ue(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(e,t,n,s,i,o,a,l,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c,this.isUsingEmulator=u}}const Dp="(default)";class eh{constructor(e,t){this.projectId=e,this.database=t||Dp}static empty(){return new eh("","")}get isDefaultDatabase(){return this.database===Dp}isEqual(e){return e instanceof eh&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP="__type__",VU="__max__",Od={mapValue:{}},jP="__vector__",Mp="value";function Zi(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?pS(r)?4:$U(r)?9007199254740991:jU(r)?10:11:pe(28295,{value:r})}function gs(r,e){if(r===e)return!0;const t=Zi(r);if(t!==Zi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Zu(r).isEqual(Zu(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Qi(s.timestampValue),a=Qi(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(s,i){return Ji(s.bytesValue).isEqual(Ji(i.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(s,i){return ht(s.geoPointValue.latitude)===ht(i.geoPointValue.latitude)&&ht(s.geoPointValue.longitude)===ht(i.geoPointValue.longitude)}(r,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ht(s.integerValue)===ht(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ht(s.doubleValue),a=ht(i.doubleValue);return o===a?Op(o)===Op(a):isNaN(o)&&isNaN(a)}return!1}(r,e);case 9:return $l(r.arrayValue.values||[],e.arrayValue.values||[],gs);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(QE(o)!==QE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!gs(o[l],a[l])))return!1;return!0}(r,e);default:return pe(52216,{left:r})}}function th(r,e){return(r.values||[]).find(t=>gs(t,e))!==void 0}function Ul(r,e){if(r===e)return 0;const t=Zi(r),n=Zi(e);if(t!==n)return Te(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Te(r.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ht(i.integerValue||i.doubleValue),l=ht(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(r,e);case 3:return ZE(r.timestampValue,e.timestampValue);case 4:return ZE(Zu(r),Zu(e));case 5:return J0(r.stringValue,e.stringValue);case 6:return function(i,o){const a=Ji(i),l=Ji(o);return a.compareTo(l)}(r.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=Te(a[c],l[c]);if(u!==0)return u}return Te(a.length,l.length)}(r.referenceValue,e.referenceValue);case 8:return function(i,o){const a=Te(ht(i.latitude),ht(o.latitude));return a!==0?a:Te(ht(i.longitude),ht(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return ex(r.arrayValue,e.arrayValue);case 10:return function(i,o){var f,p,m,v;const a=i.fields||{},l=o.fields||{},c=(f=a[Mp])==null?void 0:f.arrayValue,u=(p=l[Mp])==null?void 0:p.arrayValue,d=Te(((m=c==null?void 0:c.values)==null?void 0:m.length)||0,((v=u==null?void 0:u.values)==null?void 0:v.length)||0);return d!==0?d:ex(c,u)}(r.mapValue,e.mapValue);case 11:return function(i,o){if(i===Od.mapValue&&o===Od.mapValue)return 0;if(i===Od.mapValue)return 1;if(o===Od.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let d=0;d<l.length&&d<u.length;++d){const f=J0(l[d],u[d]);if(f!==0)return f;const p=Ul(a[l[d]],c[u[d]]);if(p!==0)return p}return Te(l.length,u.length)}(r.mapValue,e.mapValue);default:throw pe(23264,{he:t})}}function ZE(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Te(r,e);const t=Qi(r),n=Qi(e),s=Te(t.seconds,n.seconds);return s!==0?s:Te(t.nanos,n.nanos)}function ex(r,e){const t=r.values||[],n=e.values||[];for(let s=0;s<t.length&&s<n.length;++s){const i=Ul(t[s],n[s]);if(i)return i}return Te(t.length,n.length)}function Bl(r){return Z0(r)}function Z0(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Qi(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Ji(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return de.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",s=!0;for(const i of t.values||[])s?s=!1:n+=",",n+=Z0(i);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${Z0(t.fields[o])}`;return s+"}"}(r.mapValue):pe(61005,{value:r})}function Pf(r){switch(Zi(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Tm(r);return e?16+Pf(e):16;case 5:return 2*r.stringValue.length;case 6:return Ji(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((s,i)=>s+Pf(i),0)}(r.arrayValue);case 10:case 11:return function(n){let s=0;return ao(n.fields,(i,o)=>{s+=i.length+Pf(o)}),s}(r.mapValue);default:throw pe(13486,{value:r})}}function tx(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function e_(r){return!!r&&"integerValue"in r}function gS(r){return!!r&&"arrayValue"in r}function rx(r){return!!r&&"nullValue"in r}function nx(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Rf(r){return!!r&&"mapValue"in r}function jU(r){var t,n;return((n=(((t=r==null?void 0:r.mapValue)==null?void 0:t.fields)||{})[VP])==null?void 0:n.stringValue)===jP}function mu(r){if(r.geoPointValue)return{geoPointValue:{...r.geoPointValue}};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:{...r.timestampValue}};if(r.mapValue){const e={mapValue:{fields:{}}};return ao(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=mu(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mu(r.arrayValue.values[t]);return e}return{...r}}function $U(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===VU}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e){this.value=e}static empty(){return new kr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Rf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mu(t)}setAll(e){let t=Gt.emptyPath(),n={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,n,s),n={},s=[],t=a.popLast()}o?n[a.lastSegment()]=mu(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,s)}delete(e){const t=this.field(e.popLast());Rf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return gs(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=t.mapValue.fields[e.get(n)];Rf(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,n){ao(t,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new kr(mu(this.value))}}function $P(r){const e=[];return ao(r.fields,(t,n)=>{const s=new Gt([t]);if(Rf(n)){const i=$P(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Wr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,t,n,s,i,o,a){this.key=e,this.documentType=t,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new or(e,0,ye.min(),ye.min(),ye.min(),kr.empty(),0)}static newFoundDocument(e,t,n,s){return new or(e,1,t,ye.min(),n,s,0)}static newNoDocument(e,t){return new or(e,2,t,ye.min(),ye.min(),kr.empty(),0)}static newUnknownDocument(e,t){return new or(e,3,t,ye.min(),ye.min(),kr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ye.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ye.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof or&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new or(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e,t){this.position=e,this.inclusive=t}}function sx(r,e,t){let n=0;for(let s=0;s<r.position.length;s++){const i=e[s],o=r.position[s];if(i.field.isKeyField()?n=de.comparator(de.fromName(o.referenceValue),t.key):n=Ul(o,t.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function ix(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!gs(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,t="asc"){this.field=e,this.dir=t}}function UU(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UP{}class xt extends UP{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new zU(e,t,n):t==="array-contains"?new GU(e,n):t==="in"?new qU(e,n):t==="not-in"?new YU(e,n):t==="array-contains-any"?new XU(e,n):new xt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new WU(e,n):new HU(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ul(t,this.value)):t!==null&&Zi(this.value)===Zi(t)&&this.matchesComparison(Ul(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zn extends UP{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new zn(e,t)}matches(e){return BP(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function BP(r){return r.op==="and"}function zP(r){return BU(r)&&BP(r)}function BU(r){for(const e of r.filters)if(e instanceof zn)return!1;return!0}function t_(r){if(r instanceof xt)return r.field.canonicalString()+r.op.toString()+Bl(r.value);if(zP(r))return r.filters.map(e=>t_(e)).join(",");{const e=r.filters.map(t=>t_(t)).join(",");return`${r.op}(${e})`}}function WP(r,e){return r instanceof xt?function(n,s){return s instanceof xt&&n.op===s.op&&n.field.isEqual(s.field)&&gs(n.value,s.value)}(r,e):r instanceof zn?function(n,s){return s instanceof zn&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,o,a)=>i&&WP(o,s.filters[a]),!0):!1}(r,e):void pe(19439)}function HP(r){return r instanceof xt?function(t){return`${t.field.canonicalString()} ${t.op} ${Bl(t.value)}`}(r):r instanceof zn?function(t){return t.op.toString()+" {"+t.getFilters().map(HP).join(" ,")+"}"}(r):"Filter"}class zU extends xt{constructor(e,t,n){super(e,t,n),this.key=de.fromName(n.referenceValue)}matches(e){const t=de.comparator(e.key,this.key);return this.matchesComparison(t)}}class WU extends xt{constructor(e,t){super(e,"in",t),this.keys=GP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class HU extends xt{constructor(e,t){super(e,"not-in",t),this.keys=GP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function GP(r,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map(n=>de.fromName(n.referenceValue))}class GU extends xt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return gS(t)&&th(t.arrayValue,this.value)}}class qU extends xt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&th(this.value.arrayValue,t)}}class YU extends xt{constructor(e,t){super(e,"not-in",t)}matches(e){if(th(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!th(this.value.arrayValue,t)}}class XU extends xt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!gS(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>th(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{constructor(e,t=null,n=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function ox(r,e=null,t=[],n=[],s=null,i=null,o=null){return new KU(r,e,t,n,s,i,o)}function mS(r){const e=ve(r);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>t_(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),Sm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Bl(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Bl(n)).join(",")),e.Te=t}return e.Te}function yS(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!UU(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!WP(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!ix(r.startAt,e.startAt)&&ix(r.endAt,e.endAt)}function r_(r){return de.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,t=null,n=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function QU(r,e,t,n,s,i,o,a){return new nc(r,e,t,n,s,i,o,a)}function vS(r){return new nc(r)}function ax(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function qP(r){return r.collectionGroup!==null}function yu(r){const e=ve(r);if(e.Ie===null){e.Ie=[];const t=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),t.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Rt(Gt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new rh(i,n))}),t.has(Gt.keyField().canonicalString())||e.Ie.push(new rh(Gt.keyField(),n))}return e.Ie}function ls(r){const e=ve(r);return e.Ee||(e.Ee=JU(e,yu(r))),e.Ee}function JU(r,e){if(r.limitType==="F")return ox(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new rh(s.field,i)});const t=r.endAt?new Np(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Np(r.startAt.position,r.startAt.inclusive):null;return ox(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function n_(r,e){const t=r.filters.concat([e]);return new nc(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function s_(r,e,t){return new nc(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Cm(r,e){return yS(ls(r),ls(e))&&r.limitType===e.limitType}function YP(r){return`${mS(ls(r))}|lt:${r.limitType}`}function Ha(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(s=>HP(s)).join(", ")}]`),Sm(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(s=>Bl(s)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(s=>Bl(s)).join(",")),`Target(${n})`}(ls(r))}; limitType=${r.limitType})`}function Em(r,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):de.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(r,e)&&function(n,s){for(const i of yu(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(r,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(r,e)&&function(n,s){return!(n.startAt&&!function(o,a,l){const c=sx(o,a,l);return o.inclusive?c<=0:c<0}(n.startAt,yu(n),s)||n.endAt&&!function(o,a,l){const c=sx(o,a,l);return o.inclusive?c>=0:c>0}(n.endAt,yu(n),s))}(r,e)}function ZU(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function XP(r){return(e,t)=>{let n=!1;for(const s of yu(r)){const i=eB(s,e,t);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function eB(r,e,t){const n=r.field.isKeyField()?de.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Ul(l,c):pe(42886)}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return pe(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[t]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ao(this.inner,(t,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return OP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tB=new it(de.comparator);function ri(){return tB}const KP=new it(de.comparator);function eu(...r){let e=KP;for(const t of r)e=e.insert(t.key,t);return e}function QP(r){let e=KP;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Mo(){return vu()}function JP(){return vu()}function vu(){return new ga(r=>r.toString(),(r,e)=>r.isEqual(e))}const rB=new it(de.comparator),nB=new Rt(de.comparator);function Ce(...r){let e=nB;for(const t of r)e=e.add(t);return e}const sB=new Rt(Te);function iB(){return sB}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _S(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Op(e)?"-0":e}}function ZP(r){return{integerValue:""+r}}function eR(r,e){return DU(e)?ZP(e):_S(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(){this._=void 0}}function oB(r,e,t){return r instanceof nh?function(s,i){const o={fields:{[NP]:{stringValue:MP},[LP]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&pS(i)&&(i=Tm(i)),i&&(o.fields[FP]=i),{mapValue:o}}(t,e):r instanceof sh?rR(r,e):r instanceof ih?nR(r,e):function(s,i){const o=tR(s,i),a=lx(o)+lx(s.Ae);return e_(o)&&e_(s.Ae)?ZP(a):_S(s.serializer,a)}(r,e)}function aB(r,e,t){return r instanceof sh?rR(r,e):r instanceof ih?nR(r,e):t}function tR(r,e){return r instanceof oh?function(n){return e_(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class nh extends xm{}class sh extends xm{constructor(e){super(),this.elements=e}}function rR(r,e){const t=sR(e);for(const n of r.elements)t.some(s=>gs(s,n))||t.push(n);return{arrayValue:{values:t}}}class ih extends xm{constructor(e){super(),this.elements=e}}function nR(r,e){let t=sR(e);for(const n of r.elements)t=t.filter(s=>!gs(s,n));return{arrayValue:{values:t}}}class oh extends xm{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function lx(r){return ht(r.integerValue||r.doubleValue)}function sR(r){return gS(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e,t){this.field=e,this.transform=t}}function lB(r,e){return r.field.isEqual(e.field)&&function(n,s){return n instanceof sh&&s instanceof sh||n instanceof ih&&s instanceof ih?$l(n.elements,s.elements,gs):n instanceof oh&&s instanceof oh?gs(n.Ae,s.Ae):n instanceof nh&&s instanceof nh}(r.transform,e.transform)}class cB{constructor(e,t){this.version=e,this.transformResults=t}}class hn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hn}static exists(e){return new hn(void 0,e)}static updateTime(e){return new hn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Of(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class bm{}function oR(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new wS(r.key,hn.none()):new Ph(r.key,r.data,hn.none());{const t=r.data,n=kr.empty();let s=new Rt(Gt.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new lo(r.key,n,new Wr(s.toArray()),hn.none())}}function uB(r,e,t){r instanceof Ph?function(s,i,o){const a=s.value.clone(),l=ux(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(r,e,t):r instanceof lo?function(s,i,o){if(!Of(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=ux(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(aR(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(r,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function _u(r,e,t,n){return r instanceof Ph?function(i,o,a,l){if(!Of(i.precondition,o))return a;const c=i.value.clone(),u=hx(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(r,e,t,n):r instanceof lo?function(i,o,a,l){if(!Of(i.precondition,o))return a;const c=hx(i.fieldTransforms,l,o),u=o.data;return u.setAll(aR(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(r,e,t,n):function(i,o,a){return Of(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(r,e,t)}function hB(r,e){let t=null;for(const n of r.fieldTransforms){const s=e.data.field(n.field),i=tR(n.transform,s||null);i!=null&&(t===null&&(t=kr.empty()),t.set(n.field,i))}return t||null}function cx(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&$l(n,s,(i,o)=>lB(i,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Ph extends bm{constructor(e,t,n,s=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class lo extends bm{constructor(e,t,n,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function aR(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function ux(r,e,t){const n=new Map;Ne(r.length===t.length,32656,{Re:t.length,Ve:r.length});for(let s=0;s<t.length;s++){const i=r[s],o=i.transform,a=e.data.field(i.field);n.set(i.field,aB(o,a,t[s]))}return n}function hx(r,e,t){const n=new Map;for(const s of r){const i=s.transform,o=t.data.field(s.field);n.set(s.field,oB(i,o,e))}return n}class wS extends bm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dB extends bm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fB{constructor(e,t,n,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&uB(i,e,n[s])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=_u(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=_u(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=JP();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=oR(o,a);l!==null&&n.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(ye.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ce())}isEqual(e){return this.batchId===e.batchId&&$l(this.mutations,e.mutations,(t,n)=>cx(t,n))&&$l(this.baseMutations,e.baseMutations,(t,n)=>cx(t,n))}}class SS{constructor(e,t,n,s){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=s}static from(e,t,n){Ne(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let s=function(){return rB}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new SS(e,t,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pB{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gB{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wt,Ee;function mB(r){switch(r){case G.OK:return pe(64938);case G.CANCELLED:case G.UNKNOWN:case G.DEADLINE_EXCEEDED:case G.RESOURCE_EXHAUSTED:case G.INTERNAL:case G.UNAVAILABLE:case G.UNAUTHENTICATED:return!1;case G.INVALID_ARGUMENT:case G.NOT_FOUND:case G.ALREADY_EXISTS:case G.PERMISSION_DENIED:case G.FAILED_PRECONDITION:case G.ABORTED:case G.OUT_OF_RANGE:case G.UNIMPLEMENTED:case G.DATA_LOSS:return!0;default:return pe(15467,{code:r})}}function lR(r){if(r===void 0)return ti("GRPC error has no .code"),G.UNKNOWN;switch(r){case wt.OK:return G.OK;case wt.CANCELLED:return G.CANCELLED;case wt.UNKNOWN:return G.UNKNOWN;case wt.DEADLINE_EXCEEDED:return G.DEADLINE_EXCEEDED;case wt.RESOURCE_EXHAUSTED:return G.RESOURCE_EXHAUSTED;case wt.INTERNAL:return G.INTERNAL;case wt.UNAVAILABLE:return G.UNAVAILABLE;case wt.UNAUTHENTICATED:return G.UNAUTHENTICATED;case wt.INVALID_ARGUMENT:return G.INVALID_ARGUMENT;case wt.NOT_FOUND:return G.NOT_FOUND;case wt.ALREADY_EXISTS:return G.ALREADY_EXISTS;case wt.PERMISSION_DENIED:return G.PERMISSION_DENIED;case wt.FAILED_PRECONDITION:return G.FAILED_PRECONDITION;case wt.ABORTED:return G.ABORTED;case wt.OUT_OF_RANGE:return G.OUT_OF_RANGE;case wt.UNIMPLEMENTED:return G.UNIMPLEMENTED;case wt.DATA_LOSS:return G.DATA_LOSS;default:return pe(39323,{code:r})}}(Ee=wt||(wt={}))[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yB(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vB=new Bi([4294967295,4294967295],0);function dx(r){const e=yB().encode(r),t=new SP;return t.update(e),new Uint8Array(t.digest())}function fx(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Bi([t,n],0),new Bi([s,i],0)]}class TS{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new tu(`Invalid padding: ${t}`);if(n<0)throw new tu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new tu(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new tu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Bi.fromNumber(this.ge)}ye(e,t,n){let s=e.add(t.multiply(Bi.fromNumber(n)));return s.compare(vB)===1&&(s=new Bi([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=dx(e),[n,s]=fx(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);if(!this.we(o))return!1}return!0}static create(e,t,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new TS(i,s,t);return n.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const t=dx(e),[n,s]=fx(t);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,s,i);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class tu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,t,n,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const s=new Map;return s.set(e,Rh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Am(ye.min(),s,new it(Te),ri(),Ce())}}class Rh{constructor(e,t,n,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Rh(n,t,Ce(),Ce(),Ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,t,n,s){this.be=e,this.removedTargetIds=t,this.key=n,this.De=s}}class cR{constructor(e,t){this.targetId=e,this.Ce=t}}class uR{constructor(e,t,n=Kt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=s}}class px{constructor(){this.ve=0,this.Fe=gx(),this.Me=Kt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ce(),t=Ce(),n=Ce();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:n=n.add(s);break;default:pe(38017,{changeType:i})}}),new Rh(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=gx()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ne(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class _B{constructor(e){this.Ge=e,this.ze=new Map,this.je=ri(),this.Je=Dd(),this.He=Dd(),this.Ye=new it(Te)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:pe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((n,s)=>{this.rt(s)&&t(s)})}st(e){const t=e.targetId,n=e.Ce.count,s=this.ot(t);if(s){const i=s.target;if(r_(i))if(n===0){const o=new de(i.path);this.et(t,o,or.newNoDocument(o,ye.min()))}else Ne(n===1,20013,{expectedCount:n});else{const o=this._t(t);if(o!==n){const a=this.ut(e),l=a?this.ct(a,e,o):1;if(l!==0){this.it(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,c)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Ji(n).toUint8Array()}catch(l){if(l instanceof DP)return jl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new TS(o,s,i)}catch(l){return jl(l instanceof tu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.ge===0?null:a}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let s=0;return n.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(t,i,null),s++)}),s}Tt(e){const t=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&r_(a.target)){const l=new de(a.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,or.newNoDocument(l,e))}i.Be&&(t.set(o,i.ke()),i.qe())}});let n=Ce();this.He.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.ot(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(n=n.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Am(e,t,this.Ye,this.je,n);return this.je=ri(),this.Je=Dd(),this.He=Dd(),this.Ye=new it(Te),s}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new px,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Rt(Te),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Rt(Te),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ne("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new px),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Dd(){return new it(de.comparator)}function gx(){return new it(de.comparator)}const wB={asc:"ASCENDING",desc:"DESCENDING"},SB={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TB={and:"AND",or:"OR"};class CB{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function i_(r,e){return r.useProto3Json||Sm(e)?e:{value:e}}function Fp(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hR(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function EB(r,e){return Fp(r,e.toTimestamp())}function cs(r){return Ne(!!r,49232),ye.fromTimestamp(function(t){const n=Qi(t);return new Ue(n.seconds,n.nanos)}(r))}function CS(r,e){return o_(r,e).canonicalString()}function o_(r,e){const t=function(s){return new He(["projects",s.projectId,"databases",s.database])}(r).child("documents");return e===void 0?t:t.child(e)}function dR(r){const e=He.fromString(r);return Ne(yR(e),10190,{key:e.toString()}),e}function a_(r,e){return CS(r.databaseId,e.path)}function cv(r,e){const t=dR(e);if(t.get(1)!==r.databaseId.projectId)throw new ee(G.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new ee(G.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new de(pR(t))}function fR(r,e){return CS(r.databaseId,e)}function xB(r){const e=dR(r);return e.length===4?He.emptyPath():pR(e)}function l_(r){return new He(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function pR(r){return Ne(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function mx(r,e,t){return{name:a_(r,e),fields:t.value.mapValue.fields}}function bB(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:pe(39313,{state:c})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(Ne(u===void 0||typeof u=="string",58123),Kt.fromBase64String(u||"")):(Ne(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Kt.fromUint8Array(u||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?G.UNKNOWN:lR(c.code);return new ee(u,c.message||"")}(o);t=new uR(n,s,i,a||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=cv(r,n.document.name),i=cs(n.document.updateTime),o=n.document.createTime?cs(n.document.createTime):ye.min(),a=new kr({mapValue:{fields:n.document.fields}}),l=or.newFoundDocument(s,i,o,a),c=n.targetIds||[],u=n.removedTargetIds||[];t=new Df(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=cv(r,n.document),i=n.readTime?cs(n.readTime):ye.min(),o=or.newNoDocument(s,i),a=n.removedTargetIds||[];t=new Df([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=cv(r,n.document),i=n.removedTargetIds||[];t=new Df([],i,s,null)}else{if(!("filter"in e))return pe(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new gB(s,i),a=n.targetId;t=new cR(a,o)}}return t}function AB(r,e){let t;if(e instanceof Ph)t={update:mx(r,e.key,e.value)};else if(e instanceof wS)t={delete:a_(r,e.key)};else if(e instanceof lo)t={update:mx(r,e.key,e.data),updateMask:FB(e.fieldMask)};else{if(!(e instanceof dB))return pe(16599,{Vt:e.type});t={verify:a_(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const a=o.transform;if(a instanceof nh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof sh)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof ih)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof oh)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw pe(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:EB(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:pe(27497)}(r,e.precondition)),t}function kB(r,e){return r&&r.length>0?(Ne(e!==void 0,14353),r.map(t=>function(s,i){let o=s.updateTime?cs(s.updateTime):cs(i);return o.isEqual(ye.min())&&(o=cs(i)),new cB(o,s.transformResults||[])}(t,e))):[]}function IB(r,e){return{documents:[fR(r,e.path)]}}function PB(r,e){const t={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=fR(r,s);const i=function(c){if(c.length!==0)return mR(zn.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(f){return{field:Ga(f.field),direction:DB(f.dir)}}(u))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=i_(r,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ft:t,parent:s}}function RB(r){let e=xB(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let s=null;if(n>0){Ne(n===1,65062);const u=t.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];t.where&&(i=function(d){const f=gR(d);return f instanceof zn&&zP(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(f=>function(m){return new rh(qa(m.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(m.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,Sm(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(d){const f=!!d.before,p=d.values||[];return new Np(p,f)}(t.startAt));let c=null;return t.endAt&&(c=function(d){const f=!d.before,p=d.values||[];return new Np(p,f)}(t.endAt)),QU(e,s,o,i,a,"F",l,c)}function OB(r,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pe(28987,{purpose:s})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function gR(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=qa(t.unaryFilter.field);return xt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=qa(t.unaryFilter.field);return xt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=qa(t.unaryFilter.field);return xt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=qa(t.unaryFilter.field);return xt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return pe(61313);default:return pe(60726)}}(r):r.fieldFilter!==void 0?function(t){return xt.create(qa(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return pe(58110);default:return pe(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return zn.create(t.compositeFilter.filters.map(n=>gR(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return pe(1026)}}(t.compositeFilter.op))}(r):pe(30097,{filter:r})}function DB(r){return wB[r]}function MB(r){return SB[r]}function NB(r){return TB[r]}function Ga(r){return{fieldPath:r.canonicalString()}}function qa(r){return Gt.fromServerFormat(r.fieldPath)}function mR(r){return r instanceof xt?function(t){if(t.op==="=="){if(nx(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NAN"}};if(rx(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(nx(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NOT_NAN"}};if(rx(t.value))return{unaryFilter:{field:Ga(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ga(t.field),op:MB(t.op),value:t.value}}}(r):r instanceof zn?function(t){const n=t.getFilters().map(s=>mR(s));return n.length===1?n[0]:{compositeFilter:{op:NB(t.op),filters:n}}}(r):pe(54877,{filter:r})}function FB(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function yR(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,t,n,s,i=ye.min(),o=ye.min(),a=Kt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Ri(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ri(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LB{constructor(e){this.yt=e}}function VB(r){const e=RB({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?s_(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jB{constructor(){this.Cn=new $B}addToCollectionParentIndex(e,t){return this.Cn.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(Ki.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(Ki.min())}updateCollectionGroup(e,t,n){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class $B{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t]||new Rt(He.comparator),i=!s.has(n);return this.index[t]=s.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),s=this.index[t];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Rt(He.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vR=41943040;class Er{static withCacheSize(e){return new Er(e,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Er.DEFAULT_COLLECTION_PERCENTILE=10,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Er.DEFAULT=new Er(vR,Er.DEFAULT_COLLECTION_PERCENTILE,Er.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Er.DISABLED=new Er(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new zl(0)}static cr(){return new zl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vx="LruGarbageCollector",UB=1048576;function _x([r,e],[t,n]){const s=Te(r,t);return s===0?Te(e,n):s}class BB{constructor(e){this.Ir=e,this.buffer=new Rt(_x),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();_x(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class zB{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ne(vx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){rc(t)?ne(vx,"Ignoring IndexedDB error during garbage collection: ",t):await tc(t)}await this.Vr(3e5)})}}class WB{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return q.resolve(wm.ce);const n=new BB(t);return this.mr.forEachTarget(e,s=>n.Ar(s.sequenceNumber)).next(()=>this.mr.pr(e,s=>n.Ar(s))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ne("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(yx)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yx):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,s,i,o,a,l,c;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(ne("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(e,s))).next(d=>(n=d,a=Date.now(),this.removeTargets(e,n,t))).next(d=>(i=d,l=Date.now(),this.removeOrphanedDocuments(e,n))).next(d=>(c=Date.now(),Wa()<=Se.DEBUG&&ne("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(l-a)+`ms
	Removed ${d} documents in `+(c-l)+`ms
Total Duration: ${c-u}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:d})))}}function HB(r,e){return new WB(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GB{constructor(){this.changes=new ga(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,or.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?q.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qB{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YB{constructor(e,t,n,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(n!==null&&_u(n.mutation,s,Wr.empty(),Ue.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Ce()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Ce()){const s=Mo();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,n).next(i=>{let o=eu();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Mo();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Ce()))}populateOverlays(e,t,n){const s=[];return n.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,n,s){let i=ri();const o=vu(),a=function(){return vu()}();return t.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof lo)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),_u(u.mutation,c,u.mutation.getFieldMask(),Ue.now())):o.set(c.key,Wr.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>a.set(c,new qB(u,o.get(c)??null))),a))}recalculateAndSaveOverlays(e,t){const n=vu();let s=new it((o,a)=>o-a),i=Ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let u=n.get(l)||Wr.empty();u=a.applyToLocalView(c,u),n.set(l,u);const d=(s.get(a.batchId)||Ce()).add(l);s=s.insert(a.batchId,d)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,d=JP();u.forEach(f=>{if(!i.has(f)){const p=oR(t.get(f),n.get(f));p!==null&&d.set(f,p),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return q.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,s){return function(o){return de.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):qP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,s):this.getDocumentsMatchingCollectionQuery(e,t,n,s)}getNextDocuments(e,t,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,s-i.size):q.resolve(Mo());let a=Ju,l=i;return o.next(c=>q.forEach(c,(u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(u)?q.resolve():this.remoteDocumentCache.getEntry(e,u).next(f=>{l=l.insert(u,f)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Ce())).next(u=>({batchId:a,changes:QP(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new de(t)).next(n=>{let s=eu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,n,s){const i=t.collectionGroup;let o=eu();return this.indexManager.getCollectionParents(e,i).next(a=>q.forEach(a,l=>{const c=function(d,f){return new nc(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(u=>{u.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,s))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,or.newInvalidDocument(u)))});let a=eu();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&_u(u.mutation,c,Wr.empty(),Ue.now()),Em(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XB{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return q.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:cs(s.createTime)}}(t)),q.resolve()}getNamedQuery(e,t){return q.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(s){return{name:s.name,query:VB(s.bundledQuery),readTime:cs(s.readTime)}}(t)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KB{constructor(){this.overlays=new it(de.comparator),this.qr=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Mo();return q.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((s,i)=>{this.St(e,t,i)}),q.resolve()}removeOverlaysForBatchId(e,t,n){const s=this.qr.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(n)),q.resolve()}getOverlaysForCollection(e,t,n){const s=Mo(),i=t.length+1,o=new de(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return q.resolve(s)}getOverlaysForCollectionGroup(e,t,n,s){let i=new it((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>n){let u=i.get(c.largestBatchId);u===null&&(u=Mo(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=Mo(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return q.resolve(a)}St(e,t,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(n.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new pB(t,n));let i=this.qr.get(t);i===void 0&&(i=Ce(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QB{constructor(){this.sessionToken=Kt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(){this.Qr=new Rt(Nt.$r),this.Ur=new Rt(Nt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new Nt(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Gr(new Nt(e,t))}zr(e,t){e.forEach(n=>this.removeReference(n,t))}jr(e){const t=new de(new He([])),n=new Nt(t,e),s=new Nt(t,e+1),i=[];return this.Ur.forEachInRange([n,s],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new de(new He([])),n=new Nt(t,e),s=new Nt(t,e+1);let i=Ce();return this.Ur.forEachInRange([n,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new Nt(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Nt{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return de.comparator(e.key,t.key)||Te(e.Yr,t.Yr)}static Kr(e,t){return Te(e.Yr,t.Yr)||de.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JB{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Rt(Nt.$r)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,s){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new fB(i,t,n,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Nt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,t){return q.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,s=this.ei(n),i=s<0?0:s;return q.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?fS:this.tr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Nt(t,0),s=new Nt(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,s],o=>{const a=this.Xr(o.Yr);i.push(a)}),q.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Rt(Te);return t.forEach(s=>{const i=new Nt(s,0),o=new Nt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],a=>{n=n.add(a.Yr)})}),q.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,s=n.length+1;let i=n;de.isDocumentKey(i)||(i=i.child(""));const o=new Nt(new de(i),0);let a=new Rt(Te);return this.Zr.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.Yr)),!0)},o),q.resolve(this.ti(a))}ti(e){const t=[];return e.forEach(n=>{const s=this.Xr(n);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Ne(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return q.forEach(t.mutations,s=>{const i=new Nt(s.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new Nt(t,0),s=this.Zr.firstAfterOrEqual(n);return q.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZB{constructor(e){this.ri=e,this.docs=function(){return new it(de.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,s=this.docs.get(n),i=s?s.size:0,o=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return q.resolve(n?n.document.mutableCopy():or.newInvalidDocument(t))}getEntries(e,t){let n=ri();return t.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():or.newInvalidDocument(s))}),q.resolve(n)}getDocumentsMatchingQuery(e,t,n,s){let i=ri();const o=t.path,a=new de(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||IU(kU(u),n)<=0||(s.has(u.key)||Em(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return q.resolve(i)}getAllFromCollectionGroup(e,t,n,s){pe(9500)}ii(e,t){return q.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new e9(this)}getSize(e){return q.resolve(this.size)}}class e9 extends GB{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(n)}),q.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t9{constructor(e){this.persistence=e,this.si=new ga(t=>mS(t),yS),this.lastRemoteSnapshotVersion=ye.min(),this.highestTargetId=0,this.oi=0,this._i=new ES,this.targetCount=0,this.ai=zl.ur()}forEachTarget(e,t){return this.si.forEach((n,s)=>t(s)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),q.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new zl(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.Pr(t),q.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,n){let s=0;const i=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=t&&n.get(a.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),q.waitFor(i).next(()=>s)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return q.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),q.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),q.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return q.resolve(n)}containsKey(e,t){return q.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e,t){this.ui={},this.overlays={},this.ci=new wm(0),this.li=!1,this.li=!0,this.hi=new QB,this.referenceDelegate=e(this),this.Pi=new t9(this),this.indexManager=new jB,this.remoteDocumentCache=function(s){return new ZB(s)}(n=>this.referenceDelegate.Ti(n)),this.serializer=new LB(t),this.Ii=new XB(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new KB,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new JB(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){ne("MemoryPersistence","Starting transaction:",e);const s=new r9(this.ci.next());return this.referenceDelegate.Ei(),n(s).next(i=>this.referenceDelegate.di(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ai(e,t){return q.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class r9 extends RU{constructor(e){super(),this.currentSequenceNumber=e}}class xS{constructor(e){this.persistence=e,this.Ri=new ES,this.Vi=null}static mi(e){return new xS(e)}get fi(){if(this.Vi)return this.Vi;throw pe(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),q.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),q.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(s=>this.fi.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.fi.add(i.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.fi,n=>{const s=de.fromPath(n);return this.gi(e,s).next(i=>{i||t.removeEntry(s,ye.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(n=>{n?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return q.or([()=>q.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Lp{constructor(e,t){this.persistence=e,this.pi=new ga(n=>MU(n.path),(n,s)=>n.isEqual(s)),this.garbageCollector=HB(this,t)}static mi(e,t){return new Lp(e,t)}Ei(){}di(e){return q.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(s=>n+s))}wr(e){let t=0;return this.pr(e,n=>{t++}).next(()=>t)}pr(e,t){return q.forEach(this.pi,(n,s)=>this.br(e,n,s).next(i=>i?q.resolve():t(s)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ii(e,o=>this.br(e,o,t).next(a=>{a||(n++,i.removeEntry(o,ye.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),q.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),q.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Pf(e.data.value)),t}br(e,t,n){return q.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return q.resolve(s!==void 0&&s>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e,t,n,s){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=s}static As(e,t){let n=Ce(),s=Ce();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new bS(e,t.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n9{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return K$()?8:OU(cr())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,s){const i={result:null};return this.ys(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,t,s,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new n9;return this.Ss(e,t,o).next(a=>{if(i.result=a,this.Vs)return this.bs(e,t,o,a.size)})}).next(()=>i.result)}bs(e,t,n,s){return n.documentReadCount<this.fs?(Wa()<=Se.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",Ha(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),q.resolve()):(Wa()<=Se.DEBUG&&ne("QueryEngine","Query:",Ha(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.gs*s?(Wa()<=Se.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",Ha(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ls(t))):q.resolve())}ys(e,t){if(ax(t))return q.resolve(null);let n=ls(t);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=s_(t,null,"F"),n=ls(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=Ce(...i);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.Ds(t,a);return this.Cs(t,c,o,l.readTime)?this.ys(e,s_(t,null,"F")):this.vs(e,c,t,l)}))})))}ws(e,t,n,s){return ax(t)||s.isEqual(ye.min())?q.resolve(null):this.ps.getDocuments(e,n).next(i=>{const o=this.Ds(t,i);return this.Cs(t,o,n,s)?q.resolve(null):(Wa()<=Se.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ha(t)),this.vs(e,o,t,AU(s,Ju)).next(a=>a))})}Ds(e,t){let n=new Rt(XP(e));return t.forEach((s,i)=>{Em(e,i)&&(n=n.add(i))}),n}Cs(e,t,n,s){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ss(e,t,n){return Wa()<=Se.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",Ha(t)),this.ps.getDocumentsMatchingQuery(e,t,Ki.min(),n)}vs(e,t,n,s){return this.ps.getDocumentsMatchingQuery(e,n,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="LocalStore",i9=3e8;class o9{constructor(e,t,n,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new it(Te),this.xs=new ga(i=>mS(i),yS),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YB(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function a9(r,e,t,n){return new o9(r,e,t,n)}async function wR(r,e){const t=ve(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let s;return t.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,t.Bs(e),t.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],a=[];let l=Ce();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(n,l).next(c=>({Ls:c,removedBatchIds:o,addedBatchIds:a}))})})}function l9(r,e){const t=ve(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=t.Ns.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const d=c.batch,f=d.keys();let p=q.resolve();return f.forEach(m=>{p=p.next(()=>u.getEntry(l,m)).next(v=>{const T=c.docVersions.get(m);Ne(T!==null,48541),v.version.compareTo(T)<0&&(d.applyToRemoteDocument(v,c),v.isValidDocument()&&(v.setReadTime(c.commitVersion),u.addEntry(v)))})}),p.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(t,n,e,i).next(()=>i.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let l=Ce();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(n,s))})}function SR(r){const e=ve(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function c9(r,e){const t=ve(r),n=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const a=[];e.targetChanges.forEach((u,d)=>{const f=s.get(d);if(!f)return;a.push(t.Pi.removeMatchingKeys(i,u.removedDocuments,d).next(()=>t.Pi.addMatchingKeys(i,u.addedDocuments,d)));let p=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?p=p.withResumeToken(Kt.EMPTY_BYTE_STRING,ye.min()).withLastLimboFreeSnapshotVersion(ye.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(d,p),function(v,T,w){return v.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=i9?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(f,p,u)&&a.push(t.Pi.updateTargetData(i,p))});let l=ri(),c=Ce();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(u9(i,o,e.documentUpdates).next(u=>{l=u.ks,c=u.qs})),!n.isEqual(ye.min())){const u=t.Pi.getLastRemoteSnapshotVersion(i).next(d=>t.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n));a.push(u)}return q.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.Ms=s,i))}function u9(r,e,t){let n=Ce(),s=Ce();return t.forEach(i=>n=n.add(i)),e.getEntries(r,n).next(i=>{let o=ri();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(ye.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):ne(AS,"Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{ks:o,qs:s}})}function h9(r,e){const t=ve(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=fS),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function d9(r,e){const t=ve(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return t.Pi.getTargetData(n,e).next(i=>i?(s=i,q.resolve(s)):t.Pi.allocateTargetId(n).next(o=>(s=new Ri(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Pi.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=t.Ms.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(n.targetId,n),t.xs.set(e,n.targetId)),n})}async function c_(r,e,t){const n=ve(r),s=n.Ms.get(e),i=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!rc(o))throw o;ne(AS,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(s.target)}function wx(r,e,t){const n=ve(r);let s=ye.min(),i=Ce();return n.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const d=ve(l),f=d.xs.get(u);return f!==void 0?q.resolve(d.Ms.get(f)):d.Pi.getTargetData(c,u)}(n,o,ls(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>n.Fs.getDocumentsMatchingQuery(o,e,t?s:ye.min(),t?i:Ce())).next(a=>(f9(n,ZU(e),a),{documents:a,Qs:i})))}function f9(r,e,t){let n=r.Os.get(e)||ye.min();t.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),r.Os.set(e,n)}class Sx{constructor(){this.activeTargetIds=iB()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class p9{constructor(){this.Mo=new Sx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Sx,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx="ConnectivityMonitor";class Cx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ne(Tx,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ne(Tx,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Md=null;function u_(){return Md===null?Md=function(){return 268435456+Math.round(2147483648*Math.random())}():Md++,"0x"+Md.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv="RestConnection",m9={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class y9{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${s}`,this.Wo=this.databaseId.database===Dp?`project_id=${n}`:`project_id=${n}&database_id=${s}`}Go(e,t,n,s,i){const o=u_(),a=this.zo(e,t.toUriEncodedString());ne(uv,`Sending RPC '${e}' ${o}:`,a,n);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,s,i);const{host:c}=new URL(a),u=Jl(c);return this.Jo(e,a,l,n,u).then(d=>(ne(uv,`Received RPC '${e}' ${o}: `,d),d),d=>{throw jl(uv,`RPC '${e}' ${o} failed with error: `,d,"url: ",a,"request:",n),d})}Ho(e,t,n,s,i,o){return this.Go(e,t,n,s,i)}jo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ec}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((s,i)=>e[i]=s),n&&n.headers.forEach((s,i)=>e[i]=s)}zo(e,t){const n=m9[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v9{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tr="WebChannelConnection";class _9 extends y9{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,s,i){const o=u_();return new Promise((a,l)=>{const c=new TP;c.setWithCredentials(!0),c.listenOnce(CP.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case If.NO_ERROR:const d=c.getResponseJson();ne(tr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(d)),a(d);break;case If.TIMEOUT:ne(tr,`RPC '${e}' ${o} timed out`),l(new ee(G.DEADLINE_EXCEEDED,"Request time out"));break;case If.HTTP_ERROR:const f=c.getStatus();if(ne(tr,`RPC '${e}' ${o} failed with status:`,f,"response text:",c.getResponseText()),f>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);const m=p==null?void 0:p.error;if(m&&m.status&&m.message){const v=function(w){const y=w.toLowerCase().replace(/_/g,"-");return Object.values(G).indexOf(y)>=0?y:G.UNKNOWN}(m.status);l(new ee(v,m.message))}else l(new ee(G.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ee(G.UNAVAILABLE,"Connection failed."));break;default:pe(9055,{l_:e,streamId:o,h_:c.getLastErrorCode(),P_:c.getLastError()})}}finally{ne(tr,`RPC '${e}' ${o} completed.`)}});const u=JSON.stringify(s);ne(tr,`RPC '${e}' ${o} sending request:`,s),c.send(t,"POST",u,n,15)})}T_(e,t,n){const s=u_(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=bP(),a=xP(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,t,n),l.encodeInitMessageHeaders=!0;const u=i.join("");ne(tr,`Creating RPC '${e}' stream ${s}: ${u}`,l);const d=o.createWebChannel(u,l);this.I_(d);let f=!1,p=!1;const m=new v9({Yo:T=>{p?ne(tr,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(f||(ne(tr,`Opening RPC '${e}' stream ${s} transport.`),d.open(),f=!0),ne(tr,`RPC '${e}' stream ${s} sending:`,T),d.send(T))},Zo:()=>d.close()}),v=(T,w,y)=>{T.listen(w,C=>{try{y(C)}catch(k){setTimeout(()=>{throw k},0)}})};return v(d,Zc.EventType.OPEN,()=>{p||(ne(tr,`RPC '${e}' stream ${s} transport opened.`),m.o_())}),v(d,Zc.EventType.CLOSE,()=>{p||(p=!0,ne(tr,`RPC '${e}' stream ${s} transport closed`),m.a_(),this.E_(d))}),v(d,Zc.EventType.ERROR,T=>{p||(p=!0,jl(tr,`RPC '${e}' stream ${s} transport errored. Name:`,T.name,"Message:",T.message),m.a_(new ee(G.UNAVAILABLE,"The operation could not be completed")))}),v(d,Zc.EventType.MESSAGE,T=>{var w;if(!p){const y=T.data[0];Ne(!!y,16349);const C=y,k=(C==null?void 0:C.error)||((w=C[0])==null?void 0:w.error);if(k){ne(tr,`RPC '${e}' stream ${s} received error:`,k);const O=k.status;let M=function(A){const P=wt[A];if(P!==void 0)return lR(P)}(O),x=k.message;M===void 0&&(M=G.INTERNAL,x="Unknown error status: "+O+" with message "+k.message),p=!0,m.a_(new ee(M,x)),d.close()}else ne(tr,`RPC '${e}' stream ${s} received:`,y),m.u_(y)}}),v(a,EP.STAT_EVENT,T=>{T.stat===Q0.PROXY?ne(tr,`RPC '${e}' stream ${s} detected buffering proxy`):T.stat===Q0.NOPROXY&&ne(tr,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{m.__()},0),m}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function hv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function km(r){return new CB(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,t,n=1e3,s=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=s,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-n);s>0&&ne("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex="PersistentStream";class CR{constructor(e,t,n,s,i,o,a,l){this.Mi=e,this.S_=n,this.b_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new TR(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===G.RESOURCE_EXHAUSTED?(ti(t.toString()),ti("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===G.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.D_===t&&this.G_(n,s)},n=>{e(()=>{const s=new ee(G.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(s)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(s=>{n(()=>this.z_(s))}),this.stream.onMessage(s=>{n(()=>++this.F_==1?this.J_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ne(Ex,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(ne(Ex,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class w9 extends CR{constructor(e,t,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,s,o),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=bB(this.serializer,e),n=function(i){if(!("targetChange"in i))return ye.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ye.min():o.readTime?cs(o.readTime):ye.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=l_(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=r_(l)?{documents:IB(i,l)}:{query:PB(i,l).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=hR(i,o.resumeToken);const c=i_(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(ye.min())>0){a.readTime=Fp(i,o.snapshotVersion.toTimestamp());const c=i_(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const n=OB(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=l_(this.serializer),t.removeTarget=e,this.q_(t)}}class S9 extends CR{constructor(e,t,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,s,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ne(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ne(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ne(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=kB(e.writeResults,e.commitTime),n=cs(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=l_(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>AB(this.serializer,n))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T9{}class C9 extends T9{constructor(e,t,n,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ee(G.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,o_(t,n),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ee(G.UNKNOWN,i.toString())})}Ho(e,t,n,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,o_(t,n),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===G.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ee(G.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class E9{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ti(t),this.aa=!1):ne("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na="RemoteStore";class x9{constructor(e,t,n,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{n.enqueueAndForget(async()=>{ma(this)&&(ne(na,"Restarting streams for network reachability change."),await async function(l){const c=ve(l);c.Ea.add(4),await Oh(c),c.Ra.set("Unknown"),c.Ea.delete(4),await Im(c)}(this))})}),this.Ra=new E9(n,s)}}async function Im(r){if(ma(r))for(const e of r.da)await e(!0)}async function Oh(r){for(const e of r.da)await e(!1)}function ER(r,e){const t=ve(r);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),RS(t)?PS(t):sc(t).O_()&&IS(t,e))}function kS(r,e){const t=ve(r),n=sc(t);t.Ia.delete(e),n.O_()&&xR(t,e),t.Ia.size===0&&(n.O_()?n.L_():ma(t)&&t.Ra.set("Unknown"))}function IS(r,e){if(r.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ye.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}sc(r).Y_(e)}function xR(r,e){r.Va.Ue(e),sc(r).Z_(e)}function PS(r){r.Va=new _B({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),At:e=>r.Ia.get(e)||null,ht:()=>r.datastore.serializer.databaseId}),sc(r).start(),r.Ra.ua()}function RS(r){return ma(r)&&!sc(r).x_()&&r.Ia.size>0}function ma(r){return ve(r).Ea.size===0}function bR(r){r.Va=void 0}async function b9(r){r.Ra.set("Online")}async function A9(r){r.Ia.forEach((e,t)=>{IS(r,e)})}async function k9(r,e){bR(r),RS(r)?(r.Ra.ha(e),PS(r)):r.Ra.set("Unknown")}async function I9(r,e,t){if(r.Ra.set("Online"),e instanceof uR&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))}(r,e)}catch(n){ne(na,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Vp(r,n)}else if(e instanceof Df?r.Va.Ze(e):e instanceof cR?r.Va.st(e):r.Va.tt(e),!t.isEqual(ye.min()))try{const n=await SR(r.localStore);t.compareTo(n)>=0&&await function(i,o){const a=i.Va.Tt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.Ia.get(c);u&&i.Ia.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.Ia.get(l);if(!u)return;i.Ia.set(l,u.withResumeToken(Kt.EMPTY_BYTE_STRING,u.snapshotVersion)),xR(i,l);const d=new Ri(u.target,l,c,u.sequenceNumber);IS(i,d)}),i.remoteSyncer.applyRemoteEvent(a)}(r,t)}catch(n){ne(na,"Failed to raise snapshot:",n),await Vp(r,n)}}async function Vp(r,e,t){if(!rc(e))throw e;r.Ea.add(1),await Oh(r),r.Ra.set("Offline"),t||(t=()=>SR(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{ne(na,"Retrying IndexedDB access"),await t(),r.Ea.delete(1),await Im(r)})}function AR(r,e){return e().catch(t=>Vp(r,t,e))}async function Pm(r){const e=ve(r),t=eo(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:fS;for(;P9(e);)try{const s=await h9(e.localStore,n);if(s===null){e.Ta.length===0&&t.L_();break}n=s.batchId,R9(e,s)}catch(s){await Vp(e,s)}kR(e)&&IR(e)}function P9(r){return ma(r)&&r.Ta.length<10}function R9(r,e){r.Ta.push(e);const t=eo(r);t.O_()&&t.X_&&t.ea(e.mutations)}function kR(r){return ma(r)&&!eo(r).x_()&&r.Ta.length>0}function IR(r){eo(r).start()}async function O9(r){eo(r).ra()}async function D9(r){const e=eo(r);for(const t of r.Ta)e.ea(t.mutations)}async function M9(r,e,t){const n=r.Ta.shift(),s=SS.from(n,e,t);await AR(r,()=>r.remoteSyncer.applySuccessfulWrite(s)),await Pm(r)}async function N9(r,e){e&&eo(r).X_&&await async function(n,s){if(function(o){return mB(o)&&o!==G.ABORTED}(s.code)){const i=n.Ta.shift();eo(n).B_(),await AR(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Pm(n)}}(r,e),kR(r)&&IR(r)}async function xx(r,e){const t=ve(r);t.asyncQueue.verifyOperationInProgress(),ne(na,"RemoteStore received new credentials");const n=ma(t);t.Ea.add(3),await Oh(t),n&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Im(t)}async function F9(r,e){const t=ve(r);e?(t.Ea.delete(2),await Im(t)):e||(t.Ea.add(2),await Oh(t),t.Ra.set("Unknown"))}function sc(r){return r.ma||(r.ma=function(t,n,s){const i=ve(t);return i.sa(),new w9(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(r.datastore,r.asyncQueue,{Xo:b9.bind(null,r),t_:A9.bind(null,r),r_:k9.bind(null,r),H_:I9.bind(null,r)}),r.da.push(async e=>{e?(r.ma.B_(),RS(r)?PS(r):r.Ra.set("Unknown")):(await r.ma.stop(),bR(r))})),r.ma}function eo(r){return r.fa||(r.fa=function(t,n,s){const i=ve(t);return i.sa(),new S9(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(r.datastore,r.asyncQueue,{Xo:()=>Promise.resolve(),t_:O9.bind(null,r),r_:N9.bind(null,r),ta:D9.bind(null,r),na:M9.bind(null,r)}),r.da.push(async e=>{e?(r.fa.B_(),await Pm(r)):(await r.fa.stop(),r.Ta.length>0&&(ne(na,`Stopping write stream with ${r.Ta.length} pending writes`),r.Ta=[]))})),r.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,t,n,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new zs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,s,i){const o=Date.now()+n,a=new OS(e,t,o,s,i);return a.start(n),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ee(G.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function DS(r,e){if(ti("AsyncQueue",`${e}: ${r}`),rc(r))return new ee(G.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wl{static emptySet(e){return new wl(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||de.comparator(t.key,n.key):(t,n)=>de.comparator(t.key,n.key),this.keyedMap=eu(),this.sortedSet=new it(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof wl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new wl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(){this.ga=new it(de.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):pe(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class Wl{constructor(e,t,n,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Wl(e,t,wl.emptySet(t),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==n[s].type||!t[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L9{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class V9{constructor(){this.queries=Ax(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const s=ve(t),i=s.queries;s.queries=Ax(),i.forEach((o,a)=>{for(const l of a.Sa)l.onError(n)})})(this,new ee(G.ABORTED,"Firestore shutting down"))}}function Ax(){return new ga(r=>YP(r),Cm)}async function PR(r,e){const t=ve(r);let n=3;const s=e.query;let i=t.queries.get(s);i?!i.ba()&&e.Da()&&(n=2):(i=new L9,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await t.onListen(s,!0);break;case 1:i.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=DS(o,`Initialization of query '${Ha(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.Sa.push(e),e.va(t.onlineState),i.wa&&e.Fa(i.wa)&&MS(t)}async function RR(r,e){const t=ve(r),n=e.query;let s=3;const i=t.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?s=e.Da()?0:1:!i.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function j9(r,e){const t=ve(r);let n=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.Sa)a.Fa(s)&&(n=!0);o.wa=s}}n&&MS(t)}function $9(r,e,t){const n=ve(r),s=n.queries.get(e);if(s)for(const i of s.Sa)i.onError(t);n.queries.delete(e)}function MS(r){r.Ca.forEach(e=>{e.next()})}var h_,kx;(kx=h_||(h_={})).Ma="default",kx.Cache="cache";class OR{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Wl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const n=t!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Wl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==h_.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(e){this.key=e}}class MR{constructor(e){this.key=e}}class U9{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ce(),this.mutatedKeys=Ce(),this.eu=XP(e),this.tu=new wl(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new bx,s=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,d)=>{const f=s.get(u),p=Em(this.query,d)?d:null,m=!!f&&this.mutatedKeys.has(f.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let T=!1;f&&p?f.data.isEqual(p.data)?m!==v&&(n.track({type:3,doc:p}),T=!0):this.su(f,p)||(n.track({type:2,doc:p}),T=!0,(l&&this.eu(p,l)>0||c&&this.eu(p,c)<0)&&(a=!0)):!f&&p?(n.track({type:0,doc:p}),T=!0):f&&!p&&(n.track({type:1,doc:f}),T=!0,(l||c)&&(a=!0)),T&&(p?(o=o.add(p),i=v?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),n.track({type:1,doc:u})}return{tu:o,iu:n,Cs:a,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((u,d)=>function(p,m){const v=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe(20277,{Rt:T})}};return v(p)-v(m)}(u.type,d.type)||this.eu(u.doc,d.doc)),this.ou(n),s=s??!1;const a=t&&!s?this._u():[],l=this.Xa.size===0&&this.current&&!s?1:0,c=l!==this.Za;return this.Za=l,o.length!==0||c?{snapshot:new Wl(this.query,e.tu,i,o,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new bx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ce(),this.tu.forEach(n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))});const t=[];return e.forEach(n=>{this.Xa.has(n)||t.push(new MR(n))}),this.Xa.forEach(n=>{e.has(n)||t.push(new DR(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Ce();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Wl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const NS="SyncEngine";class B9{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class z9{constructor(e){this.key=e,this.hu=!1}}class W9{constructor(e,t,n,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ga(a=>YP(a),Cm),this.Iu=new Map,this.Eu=new Set,this.du=new it(de.comparator),this.Au=new Map,this.Ru=new ES,this.Vu={},this.mu=new Map,this.fu=zl.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function H9(r,e,t=!0){const n=$R(r);let s;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await NR(n,e,t,!0),s}async function G9(r,e){const t=$R(r);await NR(t,e,!0,!1)}async function NR(r,e,t,n){const s=await d9(r.localStore,ls(e)),i=s.targetId,o=r.sharedClientState.addLocalQueryTarget(i,t);let a;return n&&(a=await q9(r,e,i,o==="current",s.resumeToken)),r.isPrimaryClient&&t&&ER(r.remoteStore,s),a}async function q9(r,e,t,n,s){r.pu=(d,f,p)=>async function(v,T,w,y){let C=T.view.ru(w);C.Cs&&(C=await wx(v.localStore,T.query,!1).then(({documents:x})=>T.view.ru(x,C)));const k=y&&y.targetChanges.get(T.targetId),O=y&&y.targetMismatches.get(T.targetId)!=null,M=T.view.applyChanges(C,v.isPrimaryClient,k,O);return Px(v,T.targetId,M.au),M.snapshot}(r,d,f,p);const i=await wx(r.localStore,e,!0),o=new U9(e,i.Qs),a=o.ru(i.documents),l=Rh.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",s),c=o.applyChanges(a,r.isPrimaryClient,l);Px(r,t,c.au);const u=new B9(e,t,o);return r.Tu.set(e,u),r.Iu.has(t)?r.Iu.get(t).push(e):r.Iu.set(t,[e]),c.snapshot}async function Y9(r,e,t){const n=ve(r),s=n.Tu.get(e),i=n.Iu.get(s.targetId);if(i.length>1)return n.Iu.set(s.targetId,i.filter(o=>!Cm(o,e))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await c_(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),t&&kS(n.remoteStore,s.targetId),d_(n,s.targetId)}).catch(tc)):(d_(n,s.targetId),await c_(n.localStore,s.targetId,!0))}async function X9(r,e){const t=ve(r),n=t.Tu.get(e),s=t.Iu.get(n.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),kS(t.remoteStore,n.targetId))}async function K9(r,e,t){const n=nz(r);try{const s=await function(o,a){const l=ve(o),c=Ue.now(),u=a.reduce((p,m)=>p.add(m.key),Ce());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let m=ri(),v=Ce();return l.Ns.getEntries(p,u).next(T=>{m=T,m.forEach((w,y)=>{y.isValidDocument()||(v=v.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,m)).next(T=>{d=T;const w=[];for(const y of a){const C=hB(y,d.get(y.key).overlayedDocument);C!=null&&w.push(new lo(y.key,C,$P(C.value.mapValue),hn.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,w,a)}).next(T=>{f=T;const w=T.applyToLocalDocumentSet(d,v);return l.documentOverlayCache.saveOverlays(p,T.batchId,w)})}).then(()=>({batchId:f.batchId,changes:QP(d)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.Vu[o.currentUser.toKey()];c||(c=new it(Te)),c=c.insert(a,l),o.Vu[o.currentUser.toKey()]=c}(n,s.batchId,t),await Dh(n,s.changes),await Pm(n.remoteStore)}catch(s){const i=DS(s,"Failed to persist write");t.reject(i)}}async function FR(r,e){const t=ve(r);try{const n=await c9(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Au.get(i);o&&(Ne(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?Ne(o.hu,14607):s.removedDocuments.size>0&&(Ne(o.hu,42227),o.hu=!1))}),await Dh(t,n,e)}catch(n){await tc(n)}}function Ix(r,e,t){const n=ve(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const s=[];n.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=ve(o);l.onlineState=a;let c=!1;l.queries.forEach((u,d)=>{for(const f of d.Sa)f.va(a)&&(c=!0)}),c&&MS(l)}(n.eventManager,e),s.length&&n.Pu.H_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Q9(r,e,t){const n=ve(r);n.sharedClientState.updateQueryState(e,"rejected",t);const s=n.Au.get(e),i=s&&s.key;if(i){let o=new it(de.comparator);o=o.insert(i,or.newNoDocument(i,ye.min()));const a=Ce().add(i),l=new Am(ye.min(),new Map,new it(Te),o,a);await FR(n,l),n.du=n.du.remove(i),n.Au.delete(e),FS(n)}else await c_(n.localStore,e,!1).then(()=>d_(n,e,t)).catch(tc)}async function J9(r,e){const t=ve(r),n=e.batch.batchId;try{const s=await l9(t.localStore,e);VR(t,n,null),LR(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await Dh(t,s)}catch(s){await tc(s)}}async function Z9(r,e,t){const n=ve(r);try{const s=await function(o,a){const l=ve(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(Ne(d!==null,37113),u=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);VR(n,e,t),LR(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await Dh(n,s)}catch(s){await tc(s)}}function LR(r,e){(r.mu.get(e)||[]).forEach(t=>{t.resolve()}),r.mu.delete(e)}function VR(r,e,t){const n=ve(r);let s=n.Vu[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),n.Vu[n.currentUser.toKey()]=s}}function d_(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Iu.get(e))r.Tu.delete(n),t&&r.Pu.yu(n,t);r.Iu.delete(e),r.isPrimaryClient&&r.Ru.jr(e).forEach(n=>{r.Ru.containsKey(n)||jR(r,n)})}function jR(r,e){r.Eu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(kS(r.remoteStore,t),r.du=r.du.remove(e),r.Au.delete(t),FS(r))}function Px(r,e,t){for(const n of t)n instanceof DR?(r.Ru.addReference(n.key,e),ez(r,n)):n instanceof MR?(ne(NS,"Document no longer in limbo: "+n.key),r.Ru.removeReference(n.key,e),r.Ru.containsKey(n.key)||jR(r,n.key)):pe(19791,{wu:n})}function ez(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Eu.has(n)||(ne(NS,"New document in limbo: "+t),r.Eu.add(n),FS(r))}function FS(r){for(;r.Eu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Eu.values().next().value;r.Eu.delete(e);const t=new de(He.fromString(e)),n=r.fu.next();r.Au.set(n,new z9(t)),r.du=r.du.insert(t,n),ER(r.remoteStore,new Ri(ls(vS(t.path)),n,"TargetPurposeLimboResolution",wm.ce))}}async function Dh(r,e,t){const n=ve(r),s=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach((a,l)=>{o.push(n.pu(l,e,t).then(c=>{var u;if((c||t)&&n.isPrimaryClient){const d=c?!c.fromCache:(u=t==null?void 0:t.targetChanges.get(l.targetId))==null?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,d?"current":"not-current")}if(c){s.push(c);const d=bS.As(l.targetId,c);i.push(d)}}))}),await Promise.all(o),n.Pu.H_(s),await async function(l,c){const u=ve(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>q.forEach(c,f=>q.forEach(f.Es,p=>u.persistence.referenceDelegate.addReference(d,f.targetId,p)).next(()=>q.forEach(f.ds,p=>u.persistence.referenceDelegate.removeReference(d,f.targetId,p)))))}catch(d){if(!rc(d))throw d;ne(AS,"Failed to update sequence numbers: "+d)}for(const d of c){const f=d.targetId;if(!d.fromCache){const p=u.Ms.get(f),m=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(m);u.Ms=u.Ms.insert(f,v)}}}(n.localStore,i))}async function tz(r,e){const t=ve(r);if(!t.currentUser.isEqual(e)){ne(NS,"User change. New user:",e.toKey());const n=await wR(t.localStore,e);t.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(l=>{l.reject(new ee(G.CANCELLED,o))})}),i.mu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Dh(t,n.Ls)}}function rz(r,e){const t=ve(r),n=t.Au.get(e);if(n&&n.hu)return Ce().add(n.key);{let s=Ce();const i=t.Iu.get(e);if(!i)return s;for(const o of i){const a=t.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function $R(r){const e=ve(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=FR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Q9.bind(null,e),e.Pu.H_=j9.bind(null,e.eventManager),e.Pu.yu=$9.bind(null,e.eventManager),e}function nz(r){const e=ve(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=J9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Z9.bind(null,e),e}class jp{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=km(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return a9(this.persistence,new s9,e.initialUser,this.serializer)}Cu(e){return new _R(xS.mi,this.serializer)}Du(e){return new p9}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jp.provider={build:()=>new jp};class sz extends jp{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ne(this.persistence.referenceDelegate instanceof Lp,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new zB(n,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Er.withCacheSize(this.cacheSizeBytes):Er.DEFAULT;return new _R(n=>Lp.mi(n,t),this.serializer)}}class f_{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Ix(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=tz.bind(null,this.syncEngine),await F9(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new V9}()}createDatastore(e){const t=km(e.databaseInfo.databaseId),n=function(i){return new _9(i)}(e.databaseInfo);return function(i,o,a,l){return new C9(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,s,i,o,a){return new x9(n,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Ix(this.syncEngine,t,0),function(){return Cx.v()?new Cx:new g9}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,u){const d=new W9(s,i,o,a,l,c);return u&&(d.gu=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=ve(s);ne(na,"RemoteStore shutting down."),i.Ea.add(5),await Oh(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}f_.provider={build:()=>new f_};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ti("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to="FirestoreClient";class iz{constructor(e,t,n,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=s,this.user=sr.UNAUTHENTICATED,this.clientId=dS.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{ne(to,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(ne(to,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new zs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=DS(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function dv(r,e){r.asyncQueue.verifyOperationInProgress(),ne(to,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async s=>{n.isEqual(s)||(await wR(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function Rx(r,e){r.asyncQueue.verifyOperationInProgress();const t=await oz(r);ne(to,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>xx(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,s)=>xx(e.remoteStore,s)),r._onlineComponents=e}async function oz(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){ne(to,"Using user provided OfflineComponentProvider");try{await dv(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===G.FAILED_PRECONDITION||s.code===G.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;jl("Error using user provided cache. Falling back to memory cache: "+t),await dv(r,new jp)}}else ne(to,"Using default OfflineComponentProvider"),await dv(r,new sz(void 0));return r._offlineComponents}async function BR(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(ne(to,"Using user provided OnlineComponentProvider"),await Rx(r,r._uninitializedComponentsProvider._online)):(ne(to,"Using default OnlineComponentProvider"),await Rx(r,new f_))),r._onlineComponents}function az(r){return BR(r).then(e=>e.syncEngine)}async function zR(r){const e=await BR(r),t=e.eventManager;return t.onListen=H9.bind(null,e.syncEngine),t.onUnlisten=Y9.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=G9.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=X9.bind(null,e.syncEngine),t}function lz(r,e,t={}){const n=new zs;return r.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new UR({next:f=>{u.Nu(),o.enqueueAndForget(()=>RR(i,d));const p=f.docs.has(a);!p&&f.fromCache?c.reject(new ee(G.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&f.fromCache&&l&&l.source==="server"?c.reject(new ee(G.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new OR(vS(a.path),u,{includeMetadataChanges:!0,qa:!0});return PR(i,d)}(await zR(r),r.asyncQueue,e,t,n)),n.promise}function cz(r,e,t={}){const n=new zs;return r.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new UR({next:f=>{u.Nu(),o.enqueueAndForget(()=>RR(i,d)),f.fromCache&&l.source==="server"?c.reject(new ee(G.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new OR(a,u,{includeMetadataChanges:!0,qa:!0});return PR(i,d)}(await zR(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WR(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR="firestore.googleapis.com",Dx=!0;class Mx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ee(G.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=HR,this.ssl=Dx}else this.host=e.host,this.ssl=e.ssl??Dx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vR;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<UB)throw new ee(G.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}bU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=WR(e.experimentalLongPollingOptions??{}),function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new ee(G.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new ee(G.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new ee(G.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Rm{constructor(e,t,n,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ee(G.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ee(G.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new mU;switch(n.type){case"firstParty":return new wU(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new ee(G.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=Ox.get(t);n&&(ne("ComponentProvider","Removing Datastore"),Ox.delete(t),n.terminate())}(this),Promise.resolve()}}function uz(r,e,t,n={}){var c;r=Bn(r,Rm);const s=Jl(e),i=r._getSettings(),o={...i,emulatorOptions:r._getEmulatorOptions()},a=`${e}:${t}`;s&&(uP(`https://${a}`),hP("Firestore",!0)),i.host!==HR&&i.host!==a&&jl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:a,ssl:s,emulatorOptions:n};if(!Xi(l,o)&&(r._setSettings(l),n.mockUserToken)){let u,d;if(typeof n.mockUserToken=="string")u=n.mockUserToken,d=sr.MOCK_USER;else{u=B$(n.mockUserToken,(c=r._app)==null?void 0:c.options.projectId);const f=n.mockUserToken.sub||n.mockUserToken.user_id;if(!f)throw new ee(G.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new sr(f)}r._authCredentials=new yU(new kP(u,d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ya(this.firestore,e,this._query)}}class pt{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new pt(this.firestore,e,this._key)}toJSON(){return{type:pt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(Ih(t,pt._jsonSchema))return new pt(e,n||null,new de(He.fromString(t.referencePath)))}}pt._jsonSchemaVersion="firestore/documentReference/1.0",pt._jsonSchema={type:bt("string",pt._jsonSchemaVersion),referencePath:bt("string")};class zi extends ya{constructor(e,t,n){super(e,t,vS(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new pt(this.firestore,null,new de(e))}withConverter(e){return new zi(this.firestore,e,this._path)}}function Mf(r,e,...t){if(r=ut(r),IP("collection","path",e),r instanceof Rm){const n=He.fromString(e,...t);return qE(n),new zi(r,null,n)}{if(!(r instanceof pt||r instanceof zi))throw new ee(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(He.fromString(e,...t));return qE(n),new zi(r.firestore,null,n)}}function ah(r,e,...t){if(r=ut(r),arguments.length===1&&(e=dS.newId()),IP("doc","path",e),r instanceof Rm){const n=He.fromString(e,...t);return GE(n),new pt(r,null,new de(n))}{if(!(r instanceof pt||r instanceof zi))throw new ee(G.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(He.fromString(e,...t));return GE(n),new pt(r.firestore,r instanceof zi?r.converter:null,new de(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx="AsyncQueue";class Fx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new TR(this,"async_queue_retry"),this._c=()=>{const n=hv();n&&ne(Nx,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const t=hv();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=hv();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new zs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!rc(e))throw e;ne(Nx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(n=>{throw this.nc=n,this.rc=!1,ti("INTERNAL UNHANDLED ERROR: ",Lx(n)),n}).then(n=>(this.rc=!1,n))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=OS.createAndSchedule(this,e,t,n,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&pe(47125,{Pc:Lx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Lx(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}class va extends Rm{constructor(e,t,n,s){super(e,t,n,s),this.type="firestore",this._queue=new Fx,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fx(e),this._firestoreClient=void 0,await e}}}function hz(r,e){const t=typeof r=="object"?r:uS(),n=typeof r=="string"?r:Dp,s=pa(t,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=$$("firestore");i&&uz(s,...i)}return s}function LS(r){if(r._terminated)throw new ee(G.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||dz(r),r._firestoreClient}function dz(r){var n,s,i;const e=r._freezeSettings(),t=function(a,l,c,u){return new LU(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,WR(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)}(r._databaseId,((n=r._app)==null?void 0:n.options.appId)||"",r._persistenceKey,e);r._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(r._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),r._firestoreClient=new iz(r._authCredentials,r._appCheckCredentials,r._queue,t,r._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this._byteString=e}static fromBase64String(e){try{return new on(Kt.fromBase64String(e))}catch(t){throw new ee(G.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new on(Kt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:on._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ih(e,on._jsonSchema))return on.fromBase64String(e.bytes)}}on._jsonSchemaVersion="firestore/bytes/1.0",on._jsonSchema={type:bt("string",on._jsonSchemaVersion),bytes:bt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Om{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ee(G.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Gt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ee(G.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ee(G.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:us._jsonSchemaVersion}}static fromJSON(e){if(Ih(e,us._jsonSchema))return new us(e.latitude,e.longitude)}}us._jsonSchemaVersion="firestore/geoPoint/1.0",us._jsonSchema={type:bt("string",us._jsonSchemaVersion),latitude:bt("number"),longitude:bt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:hs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ih(e,hs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new hs(e.vectorValues);throw new ee(G.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}hs._jsonSchemaVersion="firestore/vectorValue/1.0",hs._jsonSchema={type:bt("string",hs._jsonSchemaVersion),vectorValues:bt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fz=/^__.*__$/;class pz{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new lo(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ph(e,this.data,t,this.fieldTransforms)}}class GR{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new lo(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function qR(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe(40011,{Ac:r})}}class VS{constructor(e,t,n,s,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new VS({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return $p(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(qR(this.Ac)&&fz.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class gz{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||km(e)}Cc(e,t,n,s=!1){return new VS({Ac:e,methodName:t,Dc:n,path:Gt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Dm(r){const e=r._freezeSettings(),t=km(r._databaseId);return new gz(r._databaseId,!!e.ignoreUndefinedProperties,t)}function YR(r,e,t,n,s,i={}){const o=r.Cc(i.merge||i.mergeFields?2:0,e,t,s);US("Data must be an object, but it was:",o,n);const a=XR(n,o);let l,c;if(i.merge)l=new Wr(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const d of i.mergeFields){const f=p_(e,d,t);if(!o.contains(f))throw new ee(G.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);QR(u,f)||u.push(f)}l=new Wr(u),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new pz(new kr(a),l,c)}class Mm extends Mh{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Mm}}class jS extends Mh{_toFieldTransform(e){return new iR(e.path,new nh)}isEqual(e){return e instanceof jS}}class $S extends Mh{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new oh(e.serializer,eR(e.serializer,this.Fc));return new iR(e.path,t)}isEqual(e){return e instanceof $S&&this.Fc===e.Fc}}function mz(r,e,t,n){const s=r.Cc(1,e,t);US("Data must be an object, but it was:",s,n);const i=[],o=kr.empty();ao(n,(l,c)=>{const u=BS(e,l,t);c=ut(c);const d=s.yc(u);if(c instanceof Mm)i.push(u);else{const f=Nh(c,d);f!=null&&(i.push(u),o.set(u,f))}});const a=new Wr(i);return new GR(o,a,s.fieldTransforms)}function yz(r,e,t,n,s,i){const o=r.Cc(1,e,t),a=[p_(e,n,t)],l=[s];if(i.length%2!=0)throw new ee(G.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(p_(e,i[f])),l.push(i[f+1]);const c=[],u=kr.empty();for(let f=a.length-1;f>=0;--f)if(!QR(c,a[f])){const p=a[f];let m=l[f];m=ut(m);const v=o.yc(p);if(m instanceof Mm)c.push(p);else{const T=Nh(m,v);T!=null&&(c.push(p),u.set(p,T))}}const d=new Wr(c);return new GR(u,d,o.fieldTransforms)}function vz(r,e,t,n=!1){return Nh(t,r.Cc(n?4:3,e))}function Nh(r,e){if(KR(r=ut(r)))return US("Unsupported field value:",e,r),XR(r,e);if(r instanceof Mh)return function(n,s){if(!qR(s.Ac))throw s.Sc(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(n,s){const i=[];let o=0;for(const a of n){let l=Nh(a,s.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(r,e)}return function(n,s){if((n=ut(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return eR(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Ue.fromDate(n);return{timestampValue:Fp(s.serializer,i)}}if(n instanceof Ue){const i=new Ue(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Fp(s.serializer,i)}}if(n instanceof us)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof on)return{bytesValue:hR(s.serializer,n._byteString)};if(n instanceof pt){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:CS(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof hs)return function(o,a){return{mapValue:{fields:{[VP]:{stringValue:jP},[Mp]:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Sc("VectorValues must only contain numeric values.");return _S(a.serializer,c)})}}}}}}(n,s);throw s.Sc(`Unsupported field value: ${_m(n)}`)}(r,e)}function XR(r,e){const t={};return OP(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ao(r,(n,s)=>{const i=Nh(s,e.mc(n));i!=null&&(t[n]=i)}),{mapValue:{fields:t}}}function KR(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Ue||r instanceof us||r instanceof on||r instanceof pt||r instanceof Mh||r instanceof hs)}function US(r,e,t){if(!KR(t)||!PP(t)){const n=_m(t);throw n==="an object"?e.Sc(r+" a custom object"):e.Sc(r+" "+n)}}function p_(r,e,t){if((e=ut(e))instanceof Om)return e._internalPath;if(typeof e=="string")return BS(r,e);throw $p("Field path arguments must be of type string or ",r,!1,void 0,t)}const _z=new RegExp("[~\\*/\\[\\]]");function BS(r,e,t){if(e.search(_z)>=0)throw $p(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Om(...e.split("."))._internalPath}catch{throw $p(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function $p(r,e,t,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${n}`),o&&(l+=` in document ${s}`),l+=")"),new ee(G.INVALID_ARGUMENT,a+r+l)}function QR(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e,t,n,s,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new wz(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Nm("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class wz extends JR{data(){return super.data()}}function Nm(r,e){return typeof e=="string"?BS(r,e):e instanceof Om?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sz(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new ee(G.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zS{}class ZR extends zS{}function g_(r,e,...t){let n=[];e instanceof zS&&n.push(e),n=n.concat(t),function(i){const o=i.filter(l=>l instanceof WS).length,a=i.filter(l=>l instanceof Fm).length;if(o>1||o>0&&a>0)throw new ee(G.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)r=s._apply(r);return r}class Fm extends ZR{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Fm(e,t,n)}_apply(e){const t=this._parse(e);return tO(e._query,t),new ya(e.firestore,e.converter,n_(e._query,t))}_parse(e){const t=Dm(e.firestore);return function(i,o,a,l,c,u,d){let f;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new ee(G.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){jx(d,u);const m=[];for(const v of d)m.push(Vx(l,i,v));f={arrayValue:{values:m}}}else f=Vx(l,i,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||jx(d,u),f=vz(a,o,d,u==="in"||u==="not-in");return xt.create(c,u,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function eO(r,e,t){const n=e,s=Nm("where",r);return Fm._create(s,n,t)}class WS extends zS{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new WS(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:zn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)tO(o,l),o=n_(o,l)}(e._query,t),new ya(e.firestore,e.converter,n_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class HS extends ZR{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new HS(e,t)}_apply(e){const t=function(s,i,o){if(s.startAt!==null)throw new ee(G.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ee(G.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rh(i,o)}(e._query,this._field,this._direction);return new ya(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new nc(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function Nf(r,e="asc"){const t=e,n=Nm("orderBy",r);return HS._create(n,t)}function Vx(r,e,t){if(typeof(t=ut(t))=="string"){if(t==="")throw new ee(G.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!qP(e)&&t.indexOf("/")!==-1)throw new ee(G.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(He.fromString(t));if(!de.isDocumentKey(n))throw new ee(G.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return tx(r,new de(n))}if(t instanceof pt)return tx(r,t._key);throw new ee(G.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_m(t)}.`)}function jx(r,e){if(!Array.isArray(r)||r.length===0)throw new ee(G.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tO(r,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(r.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new ee(G.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ee(G.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Tz{convertValue(e,t="none"){switch(Zi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ht(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ji(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw pe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ao(e,(s,i)=>{n[s]=this.convertValue(i,t)}),n}convertVectorValue(e){var n,s,i;const t=(i=(s=(n=e.fields)==null?void 0:n[Mp].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ht(o.doubleValue));return new hs(t)}convertGeoPoint(e){return new us(ht(e.latitude),ht(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Tm(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Zu(e));default:return null}}convertTimestamp(e){const t=Qi(e);return new Ue(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=He.fromString(e);Ne(yR(n),9688,{name:e});const s=new eh(n.get(1),n.get(3)),i=new de(n.popFirst(5));return s.isEqual(t)||ti(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(r,e,t){let n;return n=r?r.toFirestore(e):e,n}class ru{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Wo extends JR{constructor(e,t,n,s,i,o){super(e,t,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ff(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Nm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ee(G.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Wo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Wo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Wo._jsonSchema={type:bt("string",Wo._jsonSchemaVersion),bundleSource:bt("string","DocumentSnapshot"),bundleName:bt("string"),bundle:bt("string")};class Ff extends Wo{data(e={}){return super.data(e)}}class Sl{constructor(e,t,n,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new ru(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Ff(this._firestore,this._userDataWriter,n.key,n,new ru(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ee(G.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Ff(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ru(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Ff(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ru(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:Cz(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ee(G.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Sl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=dS.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(t.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Cz(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nO(r){r=Bn(r,pt);const e=Bn(r.firestore,va);return lz(LS(e),r._key).then(t=>kz(e,r,t))}Sl._jsonSchemaVersion="firestore/querySnapshot/1.0",Sl._jsonSchema={type:bt("string",Sl._jsonSchemaVersion),bundleSource:bt("string","QuerySnapshot"),bundleName:bt("string"),bundle:bt("string")};class sO extends Tz{constructor(e){super(),this.firestore=e}convertBytes(e){return new on(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new pt(this.firestore,null,t)}}function m_(r){r=Bn(r,ya);const e=Bn(r.firestore,va),t=LS(e),n=new sO(e);return Sz(r._query),cz(t,r._query).then(s=>new Sl(e,n,r,s))}function Ez(r,e,t){r=Bn(r,pt);const n=Bn(r.firestore,va),s=rO(r.converter,e);return Lm(n,[YR(Dm(n),"setDoc",r._key,s,r.converter!==null,t).toMutation(r._key,hn.none())])}function xz(r,e,t,...n){r=Bn(r,pt);const s=Bn(r.firestore,va),i=Dm(s);let o;return o=typeof(e=ut(e))=="string"||e instanceof Om?yz(i,"updateDoc",r._key,e,t,n):mz(i,"updateDoc",r._key,e),Lm(s,[o.toMutation(r._key,hn.exists(!0))])}function bz(r){return Lm(Bn(r.firestore,va),[new wS(r._key,hn.none())])}function Az(r,e){const t=Bn(r.firestore,va),n=ah(r),s=rO(r.converter,e);return Lm(t,[YR(Dm(r.firestore),"addDoc",n._key,s,r.converter!==null,{}).toMutation(n._key,hn.exists(!1))]).then(()=>n)}function Lm(r,e){return function(n,s){const i=new zs;return n.asyncQueue.enqueueAndForget(async()=>K9(await az(n),s,i)),i.promise}(LS(r),e)}function kz(r,e,t){const n=t.docs.get(e._key),s=new sO(r);return new Wo(r,s,e._key,n,new ru(t.hasPendingWrites,t.fromCache),e.converter)}function fv(){return new jS("serverTimestamp")}function Iz(r){return new $S("increment",r)}(function(e,t=!0){(function(s){ec=s})(Zl),ps(new Un("firestore",(n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),a=new va(new vU(n.getProvider("auth-internal")),new SU(o,n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ee(G.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new eh(c.options.projectId,u)}(o,s),o);return i={useFetchStreams:t,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),un(BE,zE,e),un(BE,zE,"esm2020")})();var Pz="firebase",Rz="12.1.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */un(Pz,Rz,"app");function iO(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Oz=iO,oO=new fa("auth","Firebase",iO());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Up=new vm("@firebase/auth");function Dz(r,...e){Up.logLevel<=Se.WARN&&Up.warn(`Auth (${Zl}): ${r}`,...e)}function Lf(r,...e){Up.logLevel<=Se.ERROR&&Up.error(`Auth (${Zl}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(r,...e){throw qS(r,...e)}function Vn(r,...e){return qS(r,...e)}function GS(r,e,t){const n={...Oz(),[e]:t};return new fa("auth","Firebase",n).create(e,{appName:r.name})}function Ws(r){return GS(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Mz(r,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&pn(r,"argument-error"),GS(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function qS(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return oO.create(r,...e)}function fe(r,e,...t){if(!r)throw qS(e,...t)}function Fs(r){const e="INTERNAL ASSERTION FAILED: "+r;throw Lf(e),new Error(e)}function ni(r,e){r||Fs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y_(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.href)||""}function Nz(){return $x()==="http:"||$x()==="https:"}function $x(){var r;return typeof self<"u"&&((r=self.location)==null?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fz(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Nz()||dP()||"connection"in navigator)?navigator.onLine:!0}function Lz(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t){this.shortDelay=e,this.longDelay=t,ni(t>e,"Short delay should be less than long delay!"),this.isMobile=H$()||Y$()}get(){return Fz()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS(r,e){ni(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vz={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jz=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],$z=new Fh(3e4,6e4);function co(r,e){return r.tenantId&&!e.tenantId?{...e,tenantId:r.tenantId}:e}async function uo(r,e,t,n,s={}){return lO(r,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const a=kh({key:r.config.apiKey,...o}).slice(1),l=await r._getAdditionalHeaders();l["Content-Type"]="application/json",r.languageCode&&(l["X-Firebase-Locale"]=r.languageCode);const c={method:e,headers:l,...i};return q$()||(c.referrerPolicy="no-referrer"),r.emulatorConfig&&Jl(r.emulatorConfig.host)&&(c.credentials="include"),aO.fetch()(await cO(r,r.config.apiHost,t,a),c)})}async function lO(r,e,t){r._canInitEmulator=!1;const n={...Vz,...e};try{const s=new Bz(r),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Nd(r,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Nd(r,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Nd(r,"email-already-in-use",o);if(l==="USER_DISABLED")throw Nd(r,"user-disabled",o);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw GS(r,u,c);pn(r,u)}}catch(s){if(s instanceof Wn)throw s;pn(r,"network-request-failed",{message:String(s)})}}async function Lh(r,e,t,n,s={}){const i=await uo(r,e,t,n,s);return"mfaPendingCredential"in i&&pn(r,"multi-factor-auth-required",{_serverResponse:i}),i}async function cO(r,e,t,n){const s=`${e}${t}?${n}`,i=r,o=i.config.emulator?YS(r.config,s):`${r.config.apiScheme}://${s}`;return jz.includes(t)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function Uz(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Bz{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Vn(this.auth,"network-request-failed")),$z.get())})}}function Nd(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=Vn(r,e,n);return s.customData._tokenResponse=t,s}function Ux(r){return r!==void 0&&r.enterprise!==void 0}class zz{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Uz(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Wz(r,e){return uo(r,"GET","/v2/recaptchaConfig",co(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hz(r,e){return uo(r,"POST","/v1/accounts:delete",e)}async function Bp(r,e){return uo(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Gz(r,e=!1){const t=ut(r),n=await t.getIdToken(e),s=XS(n);fe(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:wu(pv(s.auth_time)),issuedAtTime:wu(pv(s.iat)),expirationTime:wu(pv(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function pv(r){return Number(r)*1e3}function XS(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return Lf("JWT malformed, contained fewer than 3 sections"),null;try{const s=oP(t);return s?JSON.parse(s):(Lf("Failed to decode base64 JWT payload"),null)}catch(s){return Lf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Bx(r){const e=XS(r);return fe(e,"internal-error"),fe(typeof e.exp<"u","internal-error"),fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lh(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Wn&&qz(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function qz({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yz{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=wu(this.lastLoginAt),this.creationTime=wu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zp(r){var d;const e=r.auth,t=await r.getIdToken(),n=await lh(r,Bp(e,{idToken:t}));fe(n==null?void 0:n.users.length,e,"internal-error");const s=n.users[0];r._notifyReloadListener(s);const i=(d=s.providerUserInfo)!=null&&d.length?uO(s.providerUserInfo):[],o=Kz(r.providerData,i),a=r.isAnonymous,l=!(r.email&&s.passwordHash)&&!(o!=null&&o.length),c=a?l:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new v_(s.createdAt,s.lastLoginAt),isAnonymous:c};Object.assign(r,u)}async function Xz(r){const e=ut(r);await zp(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Kz(r,e){return[...r.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function uO(r){return r.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qz(r,e){const t=await lO(r,{},async()=>{const n=kh({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=r.config,o=await cO(r,s,"/v1/token",`key=${i}`),a=await r._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:a,body:n};return r.emulatorConfig&&Jl(r.emulatorConfig.host)&&(l.credentials="include"),aO.fetch()(o,l)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Jz(r,e){return uo(r,"POST","/v2/accounts:revokeToken",co(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fe(e.idToken,"internal-error"),fe(typeof e.idToken<"u","internal-error"),fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Bx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){fe(e.length!==0,"internal-error");const t=Bx(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:i}=await Qz(e,t);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:i}=t,o=new Tl;return n&&(fe(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(fe(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(fe(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Tl,this.toJSON())}_performRefresh(){return Fs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gi(r,e){fe(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class Dn{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new Yz(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new v_(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await lh(this,this.stsTokenManager.getToken(this.auth,e));return fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Gz(this,e)}reload(){return Xz(this)}_assign(e){this!==e&&(fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Dn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await zp(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Br(this.auth.app))return Promise.reject(Ws(this.auth));const e=await this.getIdToken();return await lh(this,Hz(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,i=t.phoneNumber??void 0,o=t.photoURL??void 0,a=t.tenantId??void 0,l=t._redirectEventId??void 0,c=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:d,emailVerified:f,isAnonymous:p,providerData:m,stsTokenManager:v}=t;fe(d&&v,e,"internal-error");const T=Tl.fromJSON(this.name,v);fe(typeof d=="string",e,"internal-error"),gi(n,e.name),gi(s,e.name),fe(typeof f=="boolean",e,"internal-error"),fe(typeof p=="boolean",e,"internal-error"),gi(i,e.name),gi(o,e.name),gi(a,e.name),gi(l,e.name),gi(c,e.name),gi(u,e.name);const w=new Dn({uid:d,auth:e,email:s,emailVerified:f,displayName:n,isAnonymous:p,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:T,createdAt:c,lastLoginAt:u});return m&&Array.isArray(m)&&(w.providerData=m.map(y=>({...y}))),l&&(w._redirectEventId=l),w}static async _fromIdTokenResponse(e,t,n=!1){const s=new Tl;s.updateFromServerResponse(t);const i=new Dn({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await zp(i),i}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];fe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?uO(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Tl;a.updateFromIdToken(n);const l=new Dn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new v_(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zx=new Map;function Ls(r){ni(r instanceof Function,"Expected a class definition");let e=zx.get(r);return e?(ni(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,zx.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}hO.type="NONE";const Wx=hO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vf(r,e,t){return`firebase:${r}:${e}:${t}`}class Cl{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=Vf(this.userKey,s.apiKey,i),this.fullPersistenceKey=Vf("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Bp(this.auth,{idToken:e}).catch(()=>{});return t?Dn._fromGetAccountInfoResponse(this.auth,t,e):null}return Dn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Cl(Ls(Wx),e,n);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||Ls(Wx);const o=Vf(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){let d;if(typeof u=="string"){const f=await Bp(e,{idToken:u}).catch(()=>{});if(!f)break;d=await Dn._fromGetAccountInfoResponse(e,f,u)}else d=Dn._fromJSON(e,u);c!==i&&(a=d),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Cl(i,e,n):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Cl(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hx(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(gO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(dO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(yO(e))return"Blackberry";if(vO(e))return"Webos";if(fO(e))return"Safari";if((e.includes("chrome/")||pO(e))&&!e.includes("edge/"))return"Chrome";if(mO(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function dO(r=cr()){return/firefox\//i.test(r)}function fO(r=cr()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function pO(r=cr()){return/crios\//i.test(r)}function gO(r=cr()){return/iemobile/i.test(r)}function mO(r=cr()){return/android/i.test(r)}function yO(r=cr()){return/blackberry/i.test(r)}function vO(r=cr()){return/webos/i.test(r)}function KS(r=cr()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function Zz(r=cr()){var e;return KS(r)&&!!((e=window.navigator)!=null&&e.standalone)}function e8(){return X$()&&document.documentMode===10}function _O(r=cr()){return KS(r)||mO(r)||vO(r)||yO(r)||/windows phone/i.test(r)||gO(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wO(r,e=[]){let t;switch(r){case"Browser":t=Hx(cr());break;case"Worker":t=`${Hx(cr())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Zl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r8(r,e={}){return uo(r,"GET","/v2/passwordPolicy",co(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n8=6;class s8{constructor(e){var n;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??n8,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((n=e.allowedNonAlphanumericCharacters)==null?void 0:n.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i8{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Gx(this),this.idTokenSubscription=new Gx(this),this.beforeStateQueue=new t8(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=oO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ls(t)),this._initializationPromise=this.queue(async()=>{var n,s,i;if(!this._deleted&&(this.persistenceManager=await Cl.create(this,e),(n=this._resolvePersistenceManagerAvailable)==null||n.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Bp(this,{idToken:e}),n=await Dn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Br(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=n==null?void 0:n._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(n=l.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await zp(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Lz()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Br(this.app))return Promise.reject(Ws(this));const t=e?ut(e):null;return t&&fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Br(this.app)?Promise.reject(Ws(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Br(this.app)?Promise.reject(Ws(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ls(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await r8(this),t=new s8(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new fa("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await Jz(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ls(e)||this._popupRedirectResolver;fe(t,this,"argument-error"),this.redirectPersistenceManager=await Cl.create(this,[Ls(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)==null?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(fe(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,n,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wO(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){var t;if(Br(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&Dz(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function ho(r){return ut(r)}class Gx{constructor(e){this.auth=e,this.observer=null,this.addObserver=r6(t=>this.observer=t)}get next(){return fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function o8(r){Vm=r}function SO(r){return Vm.loadJS(r)}function a8(){return Vm.recaptchaEnterpriseScript}function l8(){return Vm.gapiScript}function c8(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class u8{constructor(){this.enterprise=new h8}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class h8{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const d8="recaptcha-enterprise",TO="NO_RECAPTCHA";class f8{constructor(e){this.type=d8,this.auth=ho(e)}async verify(e="verify",t=!1){async function n(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{Wz(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new zz(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;Ux(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(TO)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new u8().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{n(this.auth).then(a=>{if(!t&&Ux(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=a8();l.length!==0&&(l+=a),SO(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function qx(r,e,t,n=!1,s=!1){const i=new f8(r);let o;if(s)o=TO;else try{o=await i.verify(t)}catch{o=await i.verify(t,!0)}const a={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const l=a.phoneEnrollmentInfo.phoneNumber,c=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const l=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return n?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function __(r,e,t,n,s){var i;if((i=r._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await qx(r,e,t,t==="getOobCode");return n(r,o)}else return n(r,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await qx(r,e,t,t==="getOobCode");return n(r,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p8(r,e){const t=pa(r,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Xi(i,e??{}))return s;pn(s,"already-initialized")}return t.initialize({options:e})}function g8(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Ls);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function m8(r,e,t){const n=ho(r);fe(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=CO(e),{host:o,port:a}=y8(e),l=a===null?"":`:${a}`,c={url:`${i}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){fe(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),fe(Xi(c,n.config.emulator)&&Xi(u,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=c,n.emulatorConfig=u,n.settings.appVerificationDisabledForTesting=!0,Jl(o)?(uP(`${i}//${o}${l}`),hP("Auth",!0)):v8()}function CO(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function y8(r){const e=CO(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:Yx(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:Yx(o)}}}function Yx(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function v8(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Fs("not implemented")}_getIdTokenResponse(e){return Fs("not implemented")}_linkToIdToken(e,t){return Fs("not implemented")}_getReauthenticationResolver(e){return Fs("not implemented")}}async function _8(r,e){return uo(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w8(r,e){return Lh(r,"POST","/v1/accounts:signInWithPassword",co(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S8(r,e){return Lh(r,"POST","/v1/accounts:signInWithEmailLink",co(r,e))}async function T8(r,e){return Lh(r,"POST","/v1/accounts:signInWithEmailLink",co(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch extends QS{constructor(e,t,n,s=null){super("password",n),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new ch(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new ch(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return __(e,t,"signInWithPassword",w8);case"emailLink":return S8(e,{email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return __(e,n,"signUpPassword",_8);case"emailLink":return T8(e,{idToken:t,email:this._email,oobCode:this._password});default:pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function El(r,e){return Lh(r,"POST","/v1/accounts:signInWithIdp",co(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C8="http://localhost";class sa extends QS{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new sa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):pn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...i}=t;if(!n||!s)return null;const o=new sa(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return El(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,El(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,El(e,t)}buildRequest(){const e={requestUri:C8,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=kh(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E8(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function x8(r){const e=Qc(Jc(r)).link,t=e?Qc(Jc(e)).deep_link_id:null,n=Qc(Jc(r)).deep_link_id;return(n?Qc(Jc(n)).link:null)||n||t||e||r}class JS{constructor(e){const t=Qc(Jc(e)),n=t.apiKey??null,s=t.oobCode??null,i=E8(t.mode??null);fe(n&&s&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=x8(e);try{return new JS(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(){this.providerId=ic.PROVIDER_ID}static credential(e,t){return ch._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=JS.parseLink(t);return fe(n,"argument-error"),ch._fromEmailAndCode(e,n.code,n.tenantId)}}ic.PROVIDER_ID="password";ic.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ic.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh extends ZS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci extends Vh{constructor(){super("facebook.com")}static credential(e){return sa._fromParams({providerId:Ci.PROVIDER_ID,signInMethod:Ci.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ci.credentialFromTaggedObject(e)}static credentialFromError(e){return Ci.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ci.credential(e.oauthAccessToken)}catch{return null}}}Ci.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ci.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds extends Vh{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return sa._fromParams({providerId:Ds.PROVIDER_ID,signInMethod:Ds.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ds.credentialFromTaggedObject(e)}static credentialFromError(e){return Ds.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Ds.credential(t,n)}catch{return null}}}Ds.GOOGLE_SIGN_IN_METHOD="google.com";Ds.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei extends Vh{constructor(){super("github.com")}static credential(e){return sa._fromParams({providerId:Ei.PROVIDER_ID,signInMethod:Ei.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ei.credentialFromTaggedObject(e)}static credentialFromError(e){return Ei.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ei.credential(e.oauthAccessToken)}catch{return null}}}Ei.GITHUB_SIGN_IN_METHOD="github.com";Ei.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi extends Vh{constructor(){super("twitter.com")}static credential(e,t){return sa._fromParams({providerId:xi.PROVIDER_ID,signInMethod:xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return xi.credentialFromTaggedObject(e)}static credentialFromError(e){return xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return xi.credential(t,n)}catch{return null}}}xi.TWITTER_SIGN_IN_METHOD="twitter.com";xi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b8(r,e){return Lh(r,"POST","/v1/accounts:signUp",co(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const i=await Dn._fromIdTokenResponse(e,n,s),o=Xx(n);return new ia({user:i,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=Xx(n);return new ia({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function Xx(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp extends Wn{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,Wp.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new Wp(e,t,n,s)}}function EO(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Wp._fromErrorAndOperation(r,i,e,n):i})}async function A8(r,e,t=!1){const n=await lh(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return ia._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k8(r,e,t=!1){const{auth:n}=r;if(Br(n.app))return Promise.reject(Ws(n));const s="reauthenticate";try{const i=await lh(r,EO(n,s,e,r),t);fe(i.idToken,n,"internal-error");const o=XS(i.idToken);fe(o,n,"internal-error");const{sub:a}=o;return fe(r.uid===a,n,"user-mismatch"),ia._forOperation(r,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&pn(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xO(r,e,t=!1){if(Br(r.app))return Promise.reject(Ws(r));const n="signIn",s=await EO(r,n,e),i=await ia._fromIdTokenResponse(r,n,s);return t||await r._updateCurrentUser(i.user),i}async function I8(r,e){return xO(ho(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bO(r){const e=ho(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function P8(r,e,t){if(Br(r.app))return Promise.reject(Ws(r));const n=ho(r),o=await __(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",b8).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&bO(r),l}),a=await ia._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(a.user),a}function R8(r,e,t){return Br(r.app)?Promise.reject(Ws(r)):I8(ut(r),ic.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&bO(r),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O8(r,e){return ut(r).setPersistence(e)}function D8(r,e,t,n){return ut(r).onIdTokenChanged(e,t,n)}function M8(r,e,t){return ut(r).beforeAuthStateChanged(e,t)}function N8(r,e,t,n){return ut(r).onAuthStateChanged(e,t,n)}function F8(r){return ut(r).signOut()}const Hp="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Hp,"1"),this.storage.removeItem(Hp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L8=1e3,V8=10;class kO extends AO{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_O(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);e8()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,V8):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},L8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}kO.type="LOCAL";const IO=kO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO extends AO{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}PO.type="SESSION";const RO=PO;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j8(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new jm(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await j8(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}jm.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $8{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=eT("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(d){const f=d;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ds(){return window}function U8(r){ds().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OO(){return typeof ds().WorkerGlobalScope<"u"&&typeof ds().importScripts=="function"}async function B8(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function z8(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)==null?void 0:r.controller)||null}function W8(){return OO()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO="firebaseLocalStorageDb",H8=1,Gp="firebaseLocalStorage",MO="fbase_key";class jh{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $m(r,e){return r.transaction([Gp],e?"readwrite":"readonly").objectStore(Gp)}function G8(){const r=indexedDB.deleteDatabase(DO);return new jh(r).toPromise()}function w_(){const r=indexedDB.open(DO,H8);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(Gp,{keyPath:MO})}catch(s){t(s)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(Gp)?e(n):(n.close(),await G8(),e(await w_()))})})}async function Kx(r,e,t){const n=$m(r,!0).put({[MO]:e,value:t});return new jh(n).toPromise()}async function q8(r,e){const t=$m(r,!1).get(e),n=await new jh(t).toPromise();return n===void 0?null:n.value}function Qx(r,e){const t=$m(r,!0).delete(e);return new jh(t).toPromise()}const Y8=800,X8=3;class NO{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await w_(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>X8)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return OO()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=jm._getInstance(W8()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,n;if(this.activeServiceWorker=await B8(),!this.activeServiceWorker)return;this.sender=new $8(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(n=e[0])!=null&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||z8()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await w_();return await Kx(e,Hp,"1"),await Qx(e,Hp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Kx(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>q8(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Qx(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=$m(s,!1).getAll();return new jh(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Y8)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}NO.type="LOCAL";const K8=NO;new Fh(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FO(r,e){return e?Ls(e):(fe(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tT extends QS{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return El(e,this._buildIdpRequest())}_linkToIdToken(e,t){return El(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return El(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Q8(r){return xO(r.auth,new tT(r),r.bypassAuthState)}function J8(r){const{auth:e,user:t}=r;return fe(t,e,"internal-error"),k8(t,new tT(r),r.bypassAuthState)}async function Z8(r){const{auth:e,user:t}=r;return fe(t,e,"internal-error"),A8(t,new tT(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO{constructor(e,t,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Q8;case"linkViaPopup":case"linkViaRedirect":return Z8;case"reauthViaPopup":case"reauthViaRedirect":return J8;default:pn(this.auth,"internal-error")}}resolve(e){ni(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ni(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eW=new Fh(2e3,1e4);async function tW(r,e,t){if(Br(r.app))return Promise.reject(Vn(r,"operation-not-supported-in-this-environment"));const n=ho(r);Mz(r,e,ZS);const s=FO(n,t);return new No(n,"signInViaPopup",e,s).executeNotNull()}class No extends LO{constructor(e,t,n,s,i){super(e,t,s,i),this.provider=n,this.authWindow=null,this.pollId=null,No.currentPopupAction&&No.currentPopupAction.cancel(),No.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fe(e,this.auth,"internal-error"),e}async onExecution(){ni(this.filter.length===1,"Popup operations only handle one event");const e=eT();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Vn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Vn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,No.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if((n=(t=this.authWindow)==null?void 0:t.window)!=null&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,eW.get())};e()}}No.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rW="pendingRedirect",jf=new Map;class nW extends LO{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=jf.get(this.auth._key());if(!e){try{const n=await sW(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}jf.set(this.auth._key(),e)}return this.bypassAuthState||jf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sW(r,e){const t=aW(e),n=oW(r);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}function iW(r,e){jf.set(r._key(),e)}function oW(r){return Ls(r._redirectPersistence)}function aW(r){return Vf(rW,r.config.apiKey,r.name)}async function lW(r,e,t=!1){if(Br(r.app))return Promise.reject(Ws(r));const n=ho(r),s=FO(n,e),o=await new nW(n,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cW=10*60*1e3;class uW{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hW(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!VO(e)){const s=((n=e.error.code)==null?void 0:n.split("auth/")[1])||"internal-error";t.onError(Vn(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=cW&&this.cachedEventUids.clear(),this.cachedEventUids.has(Jx(e))}saveEventToCache(e){this.cachedEventUids.add(Jx(e)),this.lastProcessedEventTime=Date.now()}}function Jx(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function VO({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function hW(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return VO(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dW(r,e={}){return uo(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fW=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pW=/^https?/;async function gW(r){if(r.config.emulator)return;const{authorizedDomains:e}=await dW(r);for(const t of e)try{if(mW(t))return}catch{}pn(r,"unauthorized-domain")}function mW(r){const e=y_(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return o.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!pW.test(t))return!1;if(fW.test(r))return n===r;const s=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yW=new Fh(3e4,6e4);function Zx(){const r=ds().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function vW(r){return new Promise((e,t)=>{var s,i,o;function n(){Zx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Zx(),t(Vn(r,"network-request-failed"))},timeout:yW.get()})}if((i=(s=ds().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=ds().gapi)!=null&&o.load)n();else{const a=c8("iframefcb");return ds()[a]=()=>{gapi.load?n():t(Vn(r,"network-request-failed"))},SO(`${l8()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw $f=null,e})}let $f=null;function _W(r){return $f=$f||vW(r),$f}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wW=new Fh(5e3,15e3),SW="__/auth/iframe",TW="emulator/auth/iframe",CW={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EW=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xW(r){const e=r.config;fe(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?YS(e,TW):`https://${r.config.authDomain}/${SW}`,n={apiKey:e.apiKey,appName:r.name,v:Zl},s=EW.get(r.config.apiHost);s&&(n.eid=s);const i=r._getFrameworks();return i.length&&(n.fw=i.join(",")),`${t}?${kh(n).slice(1)}`}async function bW(r){const e=await _W(r),t=ds().gapi;return fe(t,r,"internal-error"),e.open({where:document.body,url:xW(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:CW,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=Vn(r,"network-request-failed"),a=ds().setTimeout(()=>{i(o)},wW.get());function l(){ds().clearTimeout(a),s(n)}n.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AW={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},kW=500,IW=600,PW="_blank",RW="http://localhost";class eb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function OW(r,e,t,n=kW,s=IW){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let a="";const l={...AW,width:n.toString(),height:s.toString(),top:i,left:o},c=cr().toLowerCase();t&&(a=pO(c)?PW:t),dO(c)&&(e=e||RW,l.scrollbars="yes");const u=Object.entries(l).reduce((f,[p,m])=>`${f}${p}=${m},`,"");if(Zz(c)&&a!=="_self")return DW(e||"",a),new eb(null);const d=window.open(e||"",a,u);fe(d,r,"popup-blocked");try{d.focus()}catch{}return new eb(d)}function DW(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MW="__/auth/handler",NW="emulator/auth/handler",FW=encodeURIComponent("fac");async function tb(r,e,t,n,s,i){fe(r.config.authDomain,r,"auth-domain-config-required"),fe(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:Zl,eventId:s};if(e instanceof ZS){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",t6(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(e instanceof Vh){const u=e.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}r.tenantId&&(o.tid=r.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await r._getAppCheckToken(),c=l?`#${FW}=${encodeURIComponent(l)}`:"";return`${LW(r)}?${kh(a).slice(1)}${c}`}function LW({config:r}){return r.emulator?YS(r,NW):`https://${r.authDomain}/${MW}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv="webStorageSupport";class VW{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=RO,this._completeRedirectFn=lW,this._overrideRedirectResult=iW}async _openPopup(e,t,n,s){var o;ni((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await tb(e,t,n,y_(),s);return OW(e,i,eT())}async _openRedirect(e,t,n,s){await this._originValidation(e);const i=await tb(e,t,n,y_(),s);return U8(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(ni(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await bW(e),n=new uW(e);return t.register("authEvent",s=>(fe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(gv,{type:gv},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[gv];i!==void 0&&t(!!i),pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=gW(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _O()||fO()||KS()}}const jW=VW;var rb="@firebase/auth",nb="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $W{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UW(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function BW(r){ps(new Un("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;fe(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:o,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wO(r)},c=new i8(n,s,i,l);return g8(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ps(new Un("auth-internal",e=>{const t=ho(e.getProvider("auth").getImmediate());return(n=>new $W(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),un(rb,nb,UW(r)),un(rb,nb,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zW=5*60,WW=cP("authIdTokenMaxAge")||zW;let sb=null;const HW=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>WW)return;const s=t==null?void 0:t.token;sb!==s&&(sb=s,await fetch(r,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function GW(r=uS()){const e=pa(r,"auth");if(e.isInitialized())return e.getImmediate();const t=p8(r,{popupRedirectResolver:jW,persistence:[K8,IO,RO]}),n=cP("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=HW(i.toString());M8(t,o,()=>o(t.currentUser)),D8(t,a=>o(a))}}const s=aP("auth");return s&&m8(t,`http://${s}`),t}function qW(){var r;return((r=document.getElementsByTagName("head"))==null?void 0:r[0])??document}o8({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=s=>{const i=Vn("internal-error");i.customData=s,t(i)},n.type="text/javascript",n.charset="UTF-8",qW().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});BW("Browser");const jO="@firebase/installations",rT="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $O=1e4,UO=`w:${rT}`,BO="FIS_v2",YW="https://firebaseinstallations.googleapis.com/v1",XW=60*60*1e3,KW="installations",QW="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JW={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},oa=new fa(KW,QW,JW);function zO(r){return r instanceof Wn&&r.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WO({projectId:r}){return`${YW}/projects/${r}/installations`}function HO(r){return{token:r.token,requestStatus:2,expiresIn:e7(r.expiresIn),creationTime:Date.now()}}async function GO(r,e){const n=(await e.json()).error;return oa.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function qO({apiKey:r}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":r})}function ZW(r,{refreshToken:e}){const t=qO(r);return t.append("Authorization",t7(e)),t}async function YO(r){const e=await r();return e.status>=500&&e.status<600?r():e}function e7(r){return Number(r.replace("s","000"))}function t7(r){return`${BO} ${r}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r7({appConfig:r,heartbeatServiceProvider:e},{fid:t}){const n=WO(r),s=qO(r),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={fid:t,authVersion:BO,appId:r.appId,sdkVersion:UO},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await YO(()=>fetch(n,a));if(l.ok){const c=await l.json();return{fid:c.fid||t,registrationStatus:2,refreshToken:c.refreshToken,authToken:HO(c.authToken)}}else throw await GO("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XO(r){return new Promise(e=>{setTimeout(e,r)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n7(r){return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s7=/^[cdef][\w-]{21}$/,S_="";function i7(){try{const r=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(r),r[0]=112+r[0]%16;const t=o7(r);return s7.test(t)?t:S_}catch{return S_}}function o7(r){return n7(r).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(r){return`${r.appName}!${r.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KO=new Map;function QO(r,e){const t=Um(r);JO(t,e),a7(t,e)}function JO(r,e){const t=KO.get(r);if(t)for(const n of t)n(e)}function a7(r,e){const t=l7();t&&t.postMessage({key:r,fid:e}),c7()}let Fo=null;function l7(){return!Fo&&"BroadcastChannel"in self&&(Fo=new BroadcastChannel("[Firebase] FID Change"),Fo.onmessage=r=>{JO(r.data.key,r.data.fid)}),Fo}function c7(){KO.size===0&&Fo&&(Fo.close(),Fo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u7="firebase-installations-database",h7=1,aa="firebase-installations-store";let mv=null;function nT(){return mv||(mv=yP(u7,h7,{upgrade:(r,e)=>{switch(e){case 0:r.createObjectStore(aa)}}})),mv}async function qp(r,e){const t=Um(r),s=(await nT()).transaction(aa,"readwrite"),i=s.objectStore(aa),o=await i.get(t);return await i.put(e,t),await s.done,(!o||o.fid!==e.fid)&&QO(r,e.fid),e}async function ZO(r){const e=Um(r),n=(await nT()).transaction(aa,"readwrite");await n.objectStore(aa).delete(e),await n.done}async function Bm(r,e){const t=Um(r),s=(await nT()).transaction(aa,"readwrite"),i=s.objectStore(aa),o=await i.get(t),a=e(o);return a===void 0?await i.delete(t):await i.put(a,t),await s.done,a&&(!o||o.fid!==a.fid)&&QO(r,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sT(r){let e;const t=await Bm(r.appConfig,n=>{const s=d7(n),i=f7(r,s);return e=i.registrationPromise,i.installationEntry});return t.fid===S_?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function d7(r){const e=r||{fid:i7(),registrationStatus:0};return eD(e)}function f7(r,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(oa.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=p7(r,t);return{installationEntry:t,registrationPromise:n}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:g7(r)}:{installationEntry:e}}async function p7(r,e){try{const t=await r7(r,e);return qp(r.appConfig,t)}catch(t){throw zO(t)&&t.customData.serverCode===409?await ZO(r.appConfig):await qp(r.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function g7(r){let e=await ib(r.appConfig);for(;e.registrationStatus===1;)await XO(100),e=await ib(r.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:n}=await sT(r);return n||t}return e}function ib(r){return Bm(r,e=>{if(!e)throw oa.create("installation-not-found");return eD(e)})}function eD(r){return m7(r)?{fid:r.fid,registrationStatus:0}:r}function m7(r){return r.registrationStatus===1&&r.registrationTime+$O<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y7({appConfig:r,heartbeatServiceProvider:e},t){const n=v7(r,t),s=ZW(r,t),i=e.getImmediate({optional:!0});if(i){const c=await i.getHeartbeatsHeader();c&&s.append("x-firebase-client",c)}const o={installation:{sdkVersion:UO,appId:r.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await YO(()=>fetch(n,a));if(l.ok){const c=await l.json();return HO(c)}else throw await GO("Generate Auth Token",l)}function v7(r,{fid:e}){return`${WO(r)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iT(r,e=!1){let t;const n=await Bm(r.appConfig,i=>{if(!tD(i))throw oa.create("not-registered");const o=i.authToken;if(!e&&S7(o))return i;if(o.requestStatus===1)return t=_7(r,e),i;{if(!navigator.onLine)throw oa.create("app-offline");const a=C7(i);return t=w7(r,a),a}});return t?await t:n.authToken}async function _7(r,e){let t=await ob(r.appConfig);for(;t.authToken.requestStatus===1;)await XO(100),t=await ob(r.appConfig);const n=t.authToken;return n.requestStatus===0?iT(r,e):n}function ob(r){return Bm(r,e=>{if(!tD(e))throw oa.create("not-registered");const t=e.authToken;return E7(t)?{...e,authToken:{requestStatus:0}}:e})}async function w7(r,e){try{const t=await y7(r,e),n={...e,authToken:t};return await qp(r.appConfig,n),t}catch(t){if(zO(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await ZO(r.appConfig);else{const n={...e,authToken:{requestStatus:0}};await qp(r.appConfig,n)}throw t}}function tD(r){return r!==void 0&&r.registrationStatus===2}function S7(r){return r.requestStatus===2&&!T7(r)}function T7(r){const e=Date.now();return e<r.creationTime||r.creationTime+r.expiresIn<e+XW}function C7(r){const e={requestStatus:1,requestTime:Date.now()};return{...r,authToken:e}}function E7(r){return r.requestStatus===1&&r.requestTime+$O<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x7(r){const e=r,{installationEntry:t,registrationPromise:n}=await sT(e);return n?n.catch(console.error):iT(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b7(r,e=!1){const t=r;return await A7(t),(await iT(t,e)).token}async function A7(r){const{registrationPromise:e}=await sT(r);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k7(r){if(!r||!r.options)throw yv("App Configuration");if(!r.name)throw yv("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!r.options[t])throw yv(t);return{appName:r.name,projectId:r.options.projectId,apiKey:r.options.apiKey,appId:r.options.appId}}function yv(r){return oa.create("missing-app-config-values",{valueName:r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD="installations",I7="installations-internal",P7=r=>{const e=r.getProvider("app").getImmediate(),t=k7(e),n=pa(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:n,_delete:()=>Promise.resolve()}},R7=r=>{const e=r.getProvider("app").getImmediate(),t=pa(e,rD).getImmediate();return{getId:()=>x7(t),getToken:s=>b7(t,s)}};function O7(){ps(new Un(rD,P7,"PUBLIC")),ps(new Un(I7,R7,"PRIVATE"))}O7();un(jO,rT);un(jO,rT,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="analytics",D7="firebase_id",M7="origin",N7=60*1e3,F7="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",oT="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vr=new vm("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L7={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Yr=new fa("analytics","Analytics",L7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V7(r){if(!r.startsWith(oT)){const e=Yr.create("invalid-gtag-resource",{gtagURL:r});return vr.warn(e.message),""}return r}function nD(r){return Promise.all(r.map(e=>e.catch(t=>t)))}function j7(r,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(r,e)),t}function $7(r,e){const t=j7("firebase-js-sdk-policy",{createScriptURL:V7}),n=document.createElement("script"),s=`${oT}?l=${r}&id=${e}`;n.src=t?t==null?void 0:t.createScriptURL(s):s,n.async=!0,document.head.appendChild(n)}function U7(r){let e=[];return Array.isArray(window[r])?e=window[r]:window[r]=e,e}async function B7(r,e,t,n,s,i){const o=n[s];try{if(o)await e[o];else{const l=(await nD(t)).find(c=>c.measurementId===s);l&&await e[l.appId]}}catch(a){vr.error(a)}r("config",s,i)}async function z7(r,e,t,n,s){try{let i=[];if(s&&s.send_to){let o=s.send_to;Array.isArray(o)||(o=[o]);const a=await nD(t);for(const l of o){const c=a.find(d=>d.measurementId===l),u=c&&e[c.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),r("event",n,s||{})}catch(i){vr.error(i)}}function W7(r,e,t,n){async function s(i,...o){try{if(i==="event"){const[a,l]=o;await z7(r,e,t,a,l)}else if(i==="config"){const[a,l]=o;await B7(r,e,t,n,a,l)}else if(i==="consent"){const[a,l]=o;r("consent",a,l)}else if(i==="get"){const[a,l,c]=o;r("get",a,l,c)}else if(i==="set"){const[a]=o;r("set",a)}else r(i,...o)}catch(a){vr.error(a)}}return s}function H7(r,e,t,n,s){let i=function(...o){window[n].push(arguments)};return window[s]&&typeof window[s]=="function"&&(i=window[s]),window[s]=W7(i,r,e,t),{gtagCore:i,wrappedGtag:window[s]}}function G7(r){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(oT)&&t.src.includes(r))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q7=30,Y7=1e3;class X7{constructor(e={},t=Y7){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const sD=new X7;function K7(r){return new Headers({Accept:"application/json","x-goog-api-key":r})}async function Q7(r){var o;const{appId:e,apiKey:t}=r,n={method:"GET",headers:K7(t)},s=F7.replace("{app-id}",e),i=await fetch(s,n);if(i.status!==200&&i.status!==304){let a="";try{const l=await i.json();(o=l.error)!=null&&o.message&&(a=l.error.message)}catch{}throw Yr.create("config-fetch-failed",{httpStatus:i.status,responseMessage:a})}return i.json()}async function J7(r,e=sD,t){const{appId:n,apiKey:s,measurementId:i}=r.options;if(!n)throw Yr.create("no-app-id");if(!s){if(i)return{measurementId:i,appId:n};throw Yr.create("no-api-key")}const o=e.getThrottleMetadata(n)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new tH;return setTimeout(async()=>{a.abort()},N7),iD({appId:n,apiKey:s,measurementId:i},o,a,e)}async function iD(r,{throttleEndTimeMillis:e,backoffCount:t},n,s=sD){var a;const{appId:i,measurementId:o}=r;try{await Z7(n,e)}catch(l){if(o)return vr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:o};throw l}try{const l=await Q7(r);return s.deleteThrottleMetadata(i),l}catch(l){const c=l;if(!eH(c)){if(s.deleteThrottleMetadata(i),o)return vr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:i,measurementId:o};throw l}const u=Number((a=c==null?void 0:c.customData)==null?void 0:a.httpStatus)===503?OE(t,s.intervalMillis,q7):OE(t,s.intervalMillis),d={throttleEndTimeMillis:Date.now()+u,backoffCount:t+1};return s.setThrottleMetadata(i,d),vr.debug(`Calling attemptFetch again in ${u} millis`),iD(r,d,n,s)}}function Z7(r,e){return new Promise((t,n)=>{const s=Math.max(e-Date.now(),0),i=setTimeout(t,s);r.addEventListener(()=>{clearTimeout(i),n(Yr.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function eH(r){if(!(r instanceof Wn)||!r.customData)return!1;const e=Number(r.customData.httpStatus);return e===429||e===500||e===503||e===504}class tH{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function rH(r,e,t,n,s){if(s&&s.global){r("event",t,n);return}else{const i=await e,o={...n,send_to:i};r("event",t,o)}}async function nH(r,e){const t=await r;window[`ga-disable-${t}`]=!1}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sH(){if(fP())try{await pP()}catch(r){return vr.warn(Yr.create("indexeddb-unavailable",{errorInfo:r==null?void 0:r.toString()}).message),!1}else return vr.warn(Yr.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function iH(r,e,t,n,s,i,o){const a=J7(r);a.then(f=>{t[f.measurementId]=f.appId,r.options.measurementId&&f.measurementId!==r.options.measurementId&&vr.warn(`The measurement ID in the local Firebase config (${r.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>vr.error(f)),e.push(a);const l=sH().then(f=>{if(f)return n.getId()}),[c,u]=await Promise.all([a,l]);G7(i)||$7(i,c.measurementId),s("js",new Date);const d=(o==null?void 0:o.config)??{};return d[M7]="firebase",d.update=!0,u!=null&&(d[D7]=u),s("config",c.measurementId,d),c.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oH{constructor(e){this.app=e}_delete(){return delete xl[this.app.options.appId],Promise.resolve()}}let xl={},ab=[];const lb={};let vv="dataLayer",aH="gtag",cb,oD,ub=!1;function lH(){const r=[];if(dP()&&r.push("This is a browser extension environment."),Q$()||r.push("Cookies are not available."),r.length>0){const e=r.map((n,s)=>`(${s+1}) ${n}`).join(" "),t=Yr.create("invalid-analytics-context",{errorInfo:e});vr.warn(t.message)}}function cH(r,e,t){lH();const n=r.options.appId;if(!n)throw Yr.create("no-app-id");if(!r.options.apiKey)if(r.options.measurementId)vr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${r.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Yr.create("no-api-key");if(xl[n]!=null)throw Yr.create("already-exists",{id:n});if(!ub){U7(vv);const{wrappedGtag:i,gtagCore:o}=H7(xl,ab,lb,vv,aH);oD=i,cb=o,ub=!0}return xl[n]=iH(r,ab,lb,e,cb,vv,t),new oH(r)}function uH(r=uS()){r=ut(r);const e=pa(r,Yp);return e.isInitialized()?e.getImmediate():hH(r)}function hH(r,e={}){const t=pa(r,Yp);if(t.isInitialized()){const s=t.getImmediate();if(Xi(e,t.getOptions()))return s;throw Yr.create("already-initialized")}return t.initialize({options:e})}function dH(r,e){r=ut(r),nH(xl[r.app.options.appId]).catch(t=>vr.error(t))}function se(r,e,t,n){r=ut(r),rH(oD,xl[r.app.options.appId],e,t,n).catch(s=>vr.error(s))}const hb="@firebase/analytics",db="0.10.18";function fH(){ps(new Un(Yp,(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return cH(n,s,t)},"PUBLIC")),ps(new Un("analytics-internal",r,"PRIVATE")),un(hb,db),un(hb,db,"esm2020");function r(e){try{const t=e.getProvider(Yp).getImmediate();return{logEvent:(n,s,i)=>se(t,n,s,i)}}catch(t){throw Yr.create("interop-component-reg-failed",{reason:t})}}}fH();const pH={apiKey:"AIzaSyBkuFw4YLzftL0bOyE-6OQKn7tu8QP-aAY",authDomain:"course-work-91588.firebaseapp.com",projectId:"course-work-91588",storageBucket:"course-work-91588.firebasestorage.app",messagingSenderId:"805694174237",appId:"1:805694174237:web:50d3bf250dcffcf5e982f4",measurementId:"G-YTY5P4ZTCK"},aT=vP(pH),Ya=GW(aT),aD=new Ds;aD.setCustomParameters({prompt:"select_account"});const bi=hz(aT),ie=uH(aT);dH(ie);let Tn=null,T_=!1,Fd=null;function lD(){return T_?Promise.resolve():Fd||(Fd=new Promise(async(r,e)=>{try{const n=await(await fetch("/photoeditor/wasm/filters.js")).text(),s=document.createElement("script");s.textContent=n,document.head.appendChild(s);let i=0;for(;!window.createFiltersModule&&i<100;)await new Promise(o=>setTimeout(o,50)),i++;if(!window.createFiltersModule)throw new Error("createFiltersModule not found");Tn=await window.createFiltersModule({locateFile:o=>o.endsWith(".wasm")?"/photoeditor/wasm/filters.wasm":o});try{delete window.createFiltersModule}catch{window.createFiltersModule=void 0}T_=!0,r()}catch(t){e(t)}}),Fd)}async function fb(r,e,t){if(T_||await lD(),!Tn)throw new Error("WebAssembly module not initialized");const n=new ImageData(new Uint8ClampedArray(e.data),e.width,e.height);try{const s=n.data.length,i=Tn._malloc(s);if(Tn.HEAPU8.set(n.data,i),r==="curves"&&Array.isArray(t)&&t.length===256){const a=Tn._malloc(256);for(let l=0;l<256;l++)Tn.HEAPU8[a+l]=t[l];Tn.ccall("processImageDataWithCurves",null,["number","number","number","number"],[i,n.width,n.height,a]),Tn._free(a)}else{const a=typeof t=="number"?t:0;Tn.ccall("processImageData",null,["string","number","number","number","number"],[r,i,n.width,n.height,a])}const o=Tn.HEAPU8.subarray(i,i+s);return n.data.set(o),Tn._free(i),n}catch(s){throw s}}const gH=r=>Object.entries(r).some(([e,t])=>e==="curves"?Array.isArray(t)&&t.length===256&&!t.every((n,s)=>n===s):typeof t=="number"&&t!==0),cD=async(r,e)=>{se(ie,"apply_all_filters",{filters:e});let t=new ImageData(new Uint8ClampedArray(r.data),r.width,r.height);for(const[n,s]of Object.entries(e))s!==0&&s!==null&&s!==void 0&&(se(ie,"apply_filter",{filter:n,value:s}),n==="curves"&&Array.isArray(s)&&s.length===256?(se(ie,"apply_curves_filter",{curves:s}),t=await fb("curves",t,s)):typeof s=="number"&&s!==0&&(se(ie,"apply_numeric_filter",{filter:n,value:s}),t=await fb(n,t,s)));return se(ie,"filters_applied",{filters:e}),t},mH=(r,e)=>{if(!e)return!1;if(Array.isArray(r.curves)&&Array.isArray(e.curves)){if(r.curves.length!==e.curves.length)return!1;for(let n=0;n<r.curves.length;n++)if(r.curves[n]!==e.curves[n])return!1}else if(!!r.curves!=!!e.curves)return!1;const t=["brightness","contrast","saturation","blur","sharpen","hue","hslSaturation","lightness"];for(const n of t)if(r[n]!==e[n])return!1;return!0};function F(r,e,t){return(e=function(n){var s=function(i,o){if(typeof i!="object"||!i)return i;var a=i[Symbol.toPrimitive];if(a!==void 0){var l=a.call(i,o);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)}(n,"string");return typeof s=="symbol"?s:s+""}(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function pb(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(r,s).enumerable})),t.push.apply(t,n)}return t}function V(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?pb(Object(t),!0).forEach(function(n){F(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):pb(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function Ze(r,e){if(r==null)return{};var t,n,s=function(o,a){if(o==null)return{};var l={};for(var c in o)if({}.hasOwnProperty.call(o,c)){if(a.indexOf(c)>=0)continue;l[c]=o[c]}return l}(r,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(r);for(n=0;n<i.length;n++)t=i[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(r,t)&&(s[t]=r[t])}return s}function Ss(r,e){return e||(e=r.slice(0)),Object.freeze(Object.defineProperties(r,{raw:{value:Object.freeze(e)}}))}let gb=class{constructor(){F(this,"browserShadowBlurConstant",1),F(this,"DPI",96),F(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),F(this,"perfLimitSizeTotal",2097152),F(this,"maxCacheSideLimit",4096),F(this,"minCacheSideLimit",256),F(this,"disableStyleCopyPaste",!1),F(this,"enableGLFiltering",!0),F(this,"textureSize",4096),F(this,"forceGLPutImageData",!1),F(this,"cachesBoundsOfCurve",!1),F(this,"fontPaths",{}),F(this,"NUM_FRACTION_DIGITS",4)}};const Ae=new class extends gb{constructor(r){super(),this.configure(r)}configure(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,r)}addFonts(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=V(V({},this.fontPaths),r)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(r=>{delete this.fontPaths[r]})}clearFonts(){this.fontPaths={}}restoreDefaults(r){const e=new gb,t=(r==null?void 0:r.reduce((n,s)=>(n[s]=e[s],n),{}))||e;this.configure(t)}},ro=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[r]("fabric",...t)};class ns extends Error{constructor(e,t){super("fabric: ".concat(e),t)}}class yH extends ns{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}}class vH{}class _H extends vH{testPrecision(e,t){const n="precision ".concat(t,` float;
void main(){}`),s=e.createShader(e.FRAGMENT_SHADER);return!!s&&(e.shaderSource(s,n),e.compileShader(s),!!e.getShaderParameter(s,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(t,n)),t.getExtension("WEBGL_lose_context").loseContext(),ro("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}}const wH={};let mb;const ms=()=>mb||(mb={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new _H,dispose(){},copyPasteData:wH}),oc=()=>ms().document,zm=()=>ms().window,uD=()=>{var r;return Math.max((r=Ae.devicePixelRatio)!==null&&r!==void 0?r:zm().devicePixelRatio,1)},Su=new class{constructor(){F(this,"charWidthsCache",{}),F(this,"boundsOfCurveCache",{})}getFontCache(r){let{fontFamily:e,fontStyle:t,fontWeight:n}=r;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const s=this.charWidthsCache[e],i="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return s[i]||(s[i]={}),s[i]}clearFontCache(r){(r=(r||"").toLowerCase())?this.charWidthsCache[r]&&delete this.charWidthsCache[r]:this.charWidthsCache={}}limitDimsByArea(r){const{perfLimitSizeTotal:e}=Ae,t=Math.sqrt(e*r);return[Math.floor(t),Math.floor(e/t)]}},C_="6.7.1";function Uf(){}const $h=Math.PI/2,Xp=2*Math.PI,lT=Math.PI/180,_r=Object.freeze([1,0,0,1,0,0]),cT=16,mi=.4477152502,_e="center",Me="left",Dr="top",E_="bottom",dt="right",Mr="none",uT=/\r?\n/,hD="moving",Wm="scaling",dD="rotating",hT="rotate",fD="skewing",uh="resizing",SH="modifyPoly",TH="modifyPath",Kp="changed",Hm="scale",Lr="scaleX",gn="scaleY",ac="skewX",lc="skewY",Ot="fill",Nr="stroke",Qp="modified",$a="json",_v="svg",oe=new class{constructor(){this[$a]=new Map,this[_v]=new Map}has(r){return this[$a].has(r)}getClass(r){const e=this[$a].get(r);if(!e)throw new ns("No class registered for ".concat(r));return e}setClass(r,e){e?this[$a].set(e,r):(this[$a].set(r.type,r),this[$a].set(r.type.toLowerCase(),r))}getSVGClass(r){return this[_v].get(r)}setSVGClass(r,e){this[_v].set(e??r.type.toLowerCase(),r)}},Jp=new class extends Array{remove(r){const e=this.indexOf(r);e>-1&&this.splice(e,1)}cancelAll(){const r=this.splice(0);return r.forEach(e=>e.abort()),r}cancelByCanvas(r){if(!r)return[];const e=this.filter(t=>{var n;return t.target===r||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===r});return e.forEach(t=>t.abort()),e}cancelByTarget(r){if(!r)return[];const e=this.filter(t=>t.target===r);return e.forEach(t=>t.abort()),e}};class CH{constructor(){F(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[s,i]=n;this.on(s,i)}),()=>this.off(e);if(t){const n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){const n=[];return Object.entries(e).forEach(s=>{let[i,o]=s;n.push(this.once(i,o))}),()=>n.forEach(s=>s())}if(t){const n=this.on(e,function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];t.call(this,...i),n()});return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const n=this.__eventListeners[e],s=n.indexOf(t);s>-1&&n.splice(s,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[s,i]=n;this._removeEventListener(s,i)}):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;const s=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(s)for(let i=0;i<s.length;i++)s[i].call(this,t||{})}}const Xa=(r,e)=>{const t=r.indexOf(e);return t!==-1&&r.splice(t,1),r},si=r=>{if(r===0)return 1;switch(Math.abs(r)/$h){case 1:case 3:return 0;case 2:return-1}return Math.cos(r)},ii=r=>{if(r===0)return 0;const e=r/$h,t=Math.sign(r);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(r)};class U{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new U(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new U(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new U(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new U(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new U(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new U(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new U(this.x/e.x,this.y/e.y)}scalarDivide(e){return new U(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new U(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new U(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new U(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new U(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dT;const n=ii(e),s=si(e),i=this.subtract(t);return new U(i.x*s-i.y*n,i.x*n+i.y*s).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new U(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}}const dT=new U(0,0),Bf=r=>!!r&&Array.isArray(r._objects);function pD(r){class e extends r{constructor(){super(...arguments),F(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];const o=this._objects.push(...s);return s.forEach(a=>this._onObjectAdded(a)),o}insertAt(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];return this._objects.splice(n,0,...i),i.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){const n=this._objects,s=[];for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return o.forEach(l=>{const c=n.indexOf(l);c!==-1&&(n.splice(c,1),s.push(l),this._onObjectRemoved(l))}),s}forEachObject(n){this.getObjects().forEach((s,i,o)=>n(s,i,o))}getObjects(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return s.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...s))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,s){return!!this._objects.includes(n)||!!s&&this._objects.some(i=>i instanceof e&&i.contains(n,!0))}complexity(){return this._objects.reduce((n,s)=>n+=s.complexity?s.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(Xa(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(Xa(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==0){const o=this.findNewLowerIndex(n,i,s);return Xa(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,s){if(!n)return!1;const i=this._objects.indexOf(n);if(i!==this._objects.length-1){const o=this.findNewUpperIndex(n,i,s);return Xa(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,s){return n!==this._objects[s]&&(Xa(this._objects,n),this._objects.splice(s,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,s,i){let o;if(i){o=s;for(let a=s-1;a>=0;--a)if(n.isOverlapping(this._objects[a])){o=a;break}}else o=s-1;return o}findNewUpperIndex(n,s,i){let o;if(i){o=s;for(let a=s+1;a<this._objects.length;++a)if(n.isOverlapping(this._objects[a])){o=a;break}}else o=s+1;return o}collectObjects(n){let{left:s,top:i,width:o,height:a}=n,{includeIntersecting:l=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c=[],u=new U(s,i),d=u.add(new U(o,a));for(let f=this._objects.length-1;f>=0;f--){const p=this._objects[f];p.selectable&&p.visible&&(l&&p.intersectsWithRect(u,d)||p.isContainedWithinRect(u,d)||l&&p.containsPoint(u)||l&&p.containsPoint(d))&&c.push(p)}return c}}return e}class gD extends CH{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}}function zf(r){return zm().requestAnimationFrame(r)}function EH(r){return zm().cancelAnimationFrame(r)}let xH=0;const no=()=>xH++,oi=()=>{const r=oc().createElement("canvas");if(!r||r.getContext===void 0)throw new ns("Failed to create `canvas` element");return r},bH=()=>oc().createElement("img"),mn=r=>{const e=oi();return e.width=r.width,e.height=r.height,e},mD=(r,e,t)=>r.toDataURL("image/".concat(e),t),yD=(r,e,t)=>new Promise((n,s)=>{r.toBlob(n,"image/".concat(e),t)}),gt=r=>r*lT,ai=r=>r/lT,AH=r=>r.every((e,t)=>e===_r[t]),xr=(r,e,t)=>new U(r).transform(e,t),Mn=r=>{const e=1/(r[0]*r[3]-r[1]*r[2]),t=[e*r[3],-e*r[1],-e*r[2],e*r[0],0,0],{x:n,y:s}=new U(r[4],r[5]).transform(t,!0);return t[4]=-n,t[5]=-s,t},qt=(r,e,t)=>[r[0]*e[0]+r[2]*e[1],r[1]*e[0]+r[3]*e[1],r[0]*e[2]+r[2]*e[3],r[1]*e[2]+r[3]*e[3],t?0:r[0]*e[4]+r[2]*e[5]+r[4],t?0:r[1]*e[4]+r[3]*e[5]+r[5]],fT=(r,e)=>r.reduceRight((t,n)=>n&&t?qt(n,t,e):n||t,void 0)||_r.concat(),vD=r=>{let[e,t]=r;return Math.atan2(t,e)},Zp=r=>{const e=vD(r),t=Math.pow(r[0],2)+Math.pow(r[1],2),n=Math.sqrt(t),s=(r[0]*r[3]-r[2]*r[1])/n,i=Math.atan2(r[0]*r[2]+r[1]*r[3],t);return{angle:ai(e),scaleX:n,scaleY:s,skewX:ai(i),skewY:0,translateX:r[4]||0,translateY:r[5]||0}},Uh=function(r){return[1,0,0,1,r,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function cc(){let{angle:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=gt(r),s=si(n),i=ii(n);return[s,i,-i,s,e?e-(s*e-i*t):0,t?t-(i*e+s*t):0]}const pT=function(r){return[r,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:r,0,0]},_D=r=>Math.tan(gt(r)),wD=r=>[1,0,_D(r),1,0,0],SD=r=>[1,_D(r),0,1,0,0],Gm=r=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:s=!1,skewX:i=0,skewY:o=0}=r,a=pT(n?-e:e,s?-t:t);return i&&(a=qt(a,wD(i),!0)),o&&(a=qt(a,SD(o),!0)),a},kH=r=>{const{translateX:e=0,translateY:t=0,angle:n=0}=r;let s=Uh(e,t);n&&(s=qt(s,cc({angle:n})));const i=Gm(r);return AH(i)||(s=qt(s,i)),s},Wf=function(r){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,s){if(e&&e.aborted)return s(new yH("loadImage"));const i=bH();let o;e&&(o=function(l){i.src="",s(l)},e.addEventListener("abort",o,{once:!0}));const a=function(){i.onload=i.onerror=null,o&&(e==null||e.removeEventListener("abort",o)),n(i)};r?(i.onload=a,i.onerror=function(){o&&(e==null||e.removeEventListener("abort",o)),s(new ns("Error loading ".concat(i.src)))},t&&(i.crossOrigin=t),i.src=r):a()})},hh=function(r){let{signal:e,reviver:t=Uf}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,s)=>{const i=[];e&&e.addEventListener("abort",s,{once:!0}),Promise.all(r.map(o=>oe.getClass(o.type).fromObject(o,{signal:e}).then(a=>(t(o,a),i.push(a),a)))).then(n).catch(o=>{i.forEach(a=>{a.dispose&&a.dispose()}),s(o)}).finally(()=>{e&&e.removeEventListener("abort",s)})})},qm=function(r){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,n)=>{const s=[];e&&e.addEventListener("abort",n,{once:!0});const i=Object.values(r).map(a=>a&&a.type&&oe.has(a.type)?hh([a],{signal:e}).then(l=>{let[c]=l;return s.push(c),c}):a),o=Object.keys(r);Promise.all(i).then(a=>a.reduce((l,c,u)=>(l[o[u]]=c,l),{})).then(t).catch(a=>{s.forEach(l=>{l.dispose&&l.dispose()}),n(a)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},uc=function(r){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in r&&(e[t]=r[t]),e),{})},gT=(r,e)=>Object.keys(r).reduce((t,n)=>(e(r[n],n,r)&&(t[n]=r[n]),t),{}),Ge=(r,e)=>parseFloat(Number(r).toFixed(e)),dh=r=>"matrix("+r.map(e=>Ge(e,Ae.NUM_FRACTION_DIGITS)).join(" ")+")",an=r=>!!r&&r.toLive!==void 0,yb=r=>!!r&&typeof r.toObject=="function",vb=r=>!!r&&r.offsetX!==void 0&&"source"in r,ko=r=>!!r&&"multiSelectionStacking"in r;function TD(r){const e=r&&In(r);let t=0,n=0;if(!r||!e)return{left:t,top:n};let s=r;const i=e.documentElement,o=e.body||{scrollLeft:0,scrollTop:0};for(;s&&(s.parentNode||s.host)&&(s=s.parentNode||s.host,s===e?(t=o.scrollLeft||i.scrollLeft||0,n=o.scrollTop||i.scrollTop||0):(t+=s.scrollLeft||0,n+=s.scrollTop||0),s.nodeType!==1||s.style.position!=="fixed"););return{left:t,top:n}}const In=r=>r.ownerDocument||null,CD=r=>{var e;return((e=r.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},ED=function(r,e,t){let{width:n,height:s}=t,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;r.width=n,r.height=s,i>1&&(r.setAttribute("width",(n*i).toString()),r.setAttribute("height",(s*i).toString()),e.scale(i,i))},x_=(r,e)=>{let{width:t,height:n}=e;t&&(r.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(r.style.height=typeof n=="number"?"".concat(n,"px"):n)};function _b(r){return r.onselectstart!==void 0&&(r.onselectstart=()=>!1),r.style.userSelect=Mr,r}class xD{constructor(e){F(this,"_originalCanvasStyle",void 0),F(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(n=e)&&n.getContext!==void 0?e:e&&oc().getElementById(e)||oi();var n;if(t.hasAttribute("data-fabric"))throw new ns("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e;const{el:s}=this.lower;s.classList.remove("lower-canvas"),s.removeAttribute("data-fabric"),s.setAttribute("width","".concat(t)),s.setAttribute("height","".concat(n)),s.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:n,ctx:s}=this.lower;ED(n,s,e,t)}setCSSDimensions(e){x_(this.lower.el,e)}calcOffset(){return function(e){var t;const n=e&&In(e),s={left:0,top:0};if(!n)return s;const i=((t=CD(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};s.left+=parseInt(i.borderLeftWidth,10)||0,s.top+=parseInt(i.borderTopWidth,10)||0,s.left+=parseInt(i.paddingLeft,10)||0,s.top+=parseInt(i.paddingTop,10)||0;let o={left:0,top:0};const a=n.documentElement;e.getBoundingClientRect!==void 0&&(o=e.getBoundingClientRect());const l=TD(e);return{left:o.left+l.left-(a.clientLeft||0)+s.left,top:o.top+l.top-(a.clientTop||0)+s.top}}(this.lower.el)}dispose(){ms().dispose(this.lower.el),delete this.lower}}const IH={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[..._r]};class Bh extends pD(gD){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return Bh.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new xD(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const i=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),i}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(ro("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?uD():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const s=V({width:this.width,height:this.height},e);this.elements.setDimensions(s,this.getRetinaScaling()),this.hasLostContext=!0,this.width=s.width,this.height=s.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const n=e,s=[...this.viewportTransform],i=xr(e,Mn(s));s[0]=t,s[3]=t;const o=xr(i,s);s[4]+=n.x-o.x,s[5]+=n.y-o.y,this.setViewportTransform(s)}setZoom(e){this.zoomToPoint(new U(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new U(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=zf(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,n=Mn(this.viewportTransform),s=xr({x:0,y:0},n),i=xr({x:e,y:t},n),o=s.min(i),a=s.max(i);return this.vptCoords={tl:o,tr:new U(a.x,o.y),bl:new U(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(EH(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const n=this.viewportTransform,s=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),s&&(s._set("canvas",this),s.shouldCache(),s._transformDone=!0,s.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,s)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,s=t.length;n<s;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){const n=this["".concat(t,"Color")],s=this["".concat(t,"Image")],i=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!n&&!s)return;const a=an(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?n.toLive(e):n,o&&e.transform(...i),a){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);const l=n.gradientTransform||n.patternTransform;l&&e.transform(...l)}e.fill(),e.restore()}if(s){e.save();const{skipOffscreen:l}=this;this.skipOffscreen=o,o&&e.transform(...i),s.render(e),this.skipOffscreen=l,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new U(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new U(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new U(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new U(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new U(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return xr(this.getCenterPoint(),Mn(this.viewportTransform))}_centerObject(e,t){e.setXY(t,_e,_e),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const n=this.clipPath,s=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return V(V(V({version:C_},uc(this,t)),{},{objects:this._objects.filter(i=>!i.excludeFromExport).map(i=>this._toObject(i,e,t))},this.__serializeBgOverlay(e,t)),s?{clipPath:s}:null)}_toObject(e,t,n){let s;this.includeDefaultValues||(s=e.includeDefaultValues,e.includeDefaultValues=!1);const i=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!s),i}__serializeBgOverlay(e,t){const n={},s=this.backgroundImage,i=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return an(o)?o.excludeFromExport||(n.background=o.toObject(t)):o&&(n.background=o),an(a)?a.excludeFromExport||(n.overlay=a.toObject(t)):a&&(n.overlay=a),s&&!s.excludeFromExport&&(n.backgroundImage=this._toObject(s,e,t)),i&&!i.excludeFromExport&&(n.overlayImage=this._toObject(i,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const n=t.width||"".concat(this.width),s=t.height||"".concat(this.height),i=Ae.NUM_FRACTION_DIGITS,o=t.viewBox;let a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){const l=this.viewportTransform;a='viewBox="'.concat(Ge(-l[4]/l[0],i)," ").concat(Ge(-l[5]/l[3],i)," ").concat(Ge(this.width/l[0],i)," ").concat(Ge(this.height/l[3],i),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',s,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",C_,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(no()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(an(t)){const n=this["".concat(e,"Vpt")],s=this.viewportTransform,i={isType:()=>!1,width:this.width/(n?s[0]:1),height:this.height/(n?s[3]:1)};return t.toSVG(i,{additionalTransform:n?dh(s):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},n=Ae.fontPaths;this._objects.forEach(function i(o){e.push(o),Bf(o)&&o._objects.forEach(i)}),e.forEach(i=>{if(!(o=i)||typeof o._renderText!="function")return;var o;const{styles:a,fontFamily:l}=i;!t[l]&&n[l]&&(t[l]=!0,a&&Object.values(a).forEach(c=>{Object.values(c).forEach(u=>{let{fontFamily:d=""}=u;!t[d]&&n[d]&&(t[d]=!0)})}))});const s=Object.keys(t).map(i=>`		@font-face {
			font-family: '`.concat(i,`';
			src: url('`).concat(n[i],`');
		}
`)).join("");return s?`	<style type="text/css"><![CDATA[
`.concat(s,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,t)})}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){const s=this[t];s&&!s.excludeFromExport&&s.toSVG&&e.push(s.toSVG(n))}_setSVGBgOverlayColor(e,t){const n=this["".concat(t,"Color")];if(n)if(an(n)){const s=n.repeat||"",i=this.width,o=this.height,a=this["".concat(t,"Vpt")]?dh(Mn(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(i/2,",").concat(o/2,')" x="').concat(n.offsetX-i/2,'" y="').concat(n.offsetY-o/2,'" width="').concat(s!=="repeat-y"&&s!=="no-repeat"||!vb(n)?i:n.source.width,'" height="').concat(s!=="repeat-x"&&s!=="no-repeat"||!vb(n)?o:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new ns("`json` is undefined"));const s=typeof e=="string"?JSON.parse(e):e,{objects:i=[],backgroundImage:o,background:a,overlayImage:l,overlay:c,clipPath:u}=s,d=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([hh(i,{reviver:t,signal:n}),qm({backgroundImage:o,backgroundColor:a,overlayImage:l,overlayColor:c,clipPath:u},{signal:n})]).then(f=>{let[p,m]=f;return this.clear(),this.add(...p),this.set(s),this.set(m),this.renderOnAddRemove=d,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=mn(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,o=s*(i?this.getRetinaScaling():1);return mD(this.toCanvasElement(o,e),t,n)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:n=1,multiplier:s=1,enableRetinaScaling:i=!1}=e,o=s*(i?this.getRetinaScaling():1);return yD(this.toCanvasElement(o,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:s,top:i,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(t||this.width)*e,l=(n||this.height)*e,c=this.getZoom(),u=this.width,d=this.height,f=this.skipControlsDrawing,p=c*e,m=this.viewportTransform,v=[p,0,0,p,(m[4]-(s||0))*e,(m[5]-(i||0))*e],T=this.enableRetinaScaling,w=mn({width:a,height:l}),y=o?this._objects.filter(C=>o(C)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=v,this.width=a,this.height=l,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(w.getContext("2d"),y),this.viewportTransform=m,this.width=u,this.height=d,this.calcViewportBoundaries(),this.enableRetinaScaling=T,this.skipControlsDrawing=f,w}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Jp.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}}F(Bh,"ownDefaults",IH);const PH=["touchstart","touchmove","touchend"],RH=r=>{const e=TD(r.target),t=function(n){const s=n.changedTouches;return s&&s[0]?s[0]:n}(r);return new U(t.clientX+e.left,t.clientY+e.top)},b_=r=>PH.includes(r.type)||r.pointerType==="touch",wb=r=>{r.preventDefault(),r.stopPropagation()},Hs=r=>{let e=0,t=0,n=0,s=0;for(let i=0,o=r.length;i<o;i++){const{x:a,y:l}=r[i];(a>n||!i)&&(n=a),(a<e||!i)&&(e=a),(l>s||!i)&&(s=l),(l<t||!i)&&(t=l)}return{left:e,top:t,width:n-e,height:s-t}},OH=["translateX","translateY","scaleX","scaleY"],DH=(r,e)=>eg(r,qt(e,r.calcOwnMatrix())),eg=(r,e)=>{const t=Zp(e),{translateX:n,translateY:s,scaleX:i,scaleY:o}=t,a=Ze(t,OH),l=new U(n,s);r.flipX=!1,r.flipY=!1,Object.assign(r,a),r.set({scaleX:i,scaleY:o}),r.setPositionByOrigin(l,_e,_e)},MH=r=>{r.scaleX=1,r.scaleY=1,r.skewX=0,r.skewY=0,r.flipX=!1,r.flipY=!1,r.rotate(0)},bD=r=>({scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,angle:r.angle,left:r.left,flipX:r.flipX,flipY:r.flipY,top:r.top}),mT=(r,e,t)=>{const n=r/2,s=e/2,i=[new U(-n,-s),new U(n,-s),new U(-n,s),new U(n,s)].map(a=>a.transform(t)),o=Hs(i);return new U(o.width,o.height)},Ym=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_r;return qt(Mn(arguments.length>1&&arguments[1]!==void 0?arguments[1]:_r),r)},bl=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_r,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_r;return r.transform(Ym(e,t))},NH=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_r,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_r;return r.transform(Ym(e,t),!0)},FH=(r,e,t)=>{const n=Ym(e,t);return eg(r,qt(n,r.calcOwnMatrix())),n},AD=(r,e)=>{var t;const{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(r),V(V({},e),{},{target:n})),n.fire(r,e)},LH={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Ct=r=>typeof r=="string"?LH[r]:r-.5,tg="not-allowed";function kD(r){return Ct(r.originX)===Ct(_e)&&Ct(r.originY)===Ct(_e)}function Sb(r){return .5-Ct(r)}const jn=(r,e)=>r[e],ID=(r,e,t,n)=>({e:r,transform:e,pointer:new U(t,n)});function PD(r,e){const t=r.getTotalAngle()+ai(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function yT(r,e,t,n,s){var i;let{target:o,corner:a}=r;const l=o.controls[a],c=((i=o.canvas)===null||i===void 0?void 0:i.getZoom())||1,u=o.padding/c,d=function(f,p,m,v){const T=f.getRelativeCenterPoint(),w=m!==void 0&&v!==void 0?f.translateToGivenOrigin(T,_e,_e,m,v):new U(f.left,f.top);return(f.angle?p.rotate(-gt(f.angle),T):p).subtract(w)}(o,new U(n,s),e,t);return d.x>=u&&(d.x-=u),d.x<=-u&&(d.x+=u),d.y>=u&&(d.y-=u),d.y<=u&&(d.y+=u),d.x-=l.offsetX,d.y-=l.offsetY,d}const VH=(r,e,t,n)=>{const{target:s,offsetX:i,offsetY:o}=e,a=t-i,l=n-o,c=!jn(s,"lockMovementX")&&s.left!==a,u=!jn(s,"lockMovementY")&&s.top!==l;return c&&s.set(Me,a),u&&s.set(Dr,l),(c||u)&&AD(hD,ID(r,e,t,n)),c||u},Tb={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},wv=(r,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+6*(e-r)*t:t<.5?e:t<2/3?r+(e-r)*(2/3-t)*6:r),Cb=(r,e,t,n)=>{r/=255,e/=255,t/=255;const s=Math.max(r,e,t),i=Math.min(r,e,t);let o,a;const l=(s+i)/2;if(s===i)o=a=0;else{const c=s-i;switch(a=l>.5?c/(2-s-i):c/(s+i),s){case r:o=(e-t)/c+(e<t?6:0);break;case e:o=(t-r)/c+2;break;case t:o=(r-e)/c+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*l),n]},Eb=function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(r)/(r.endsWith("%")?100:1)},Ld=r=>Math.min(Math.round(r),255).toString(16).toUpperCase().padStart(2,"0"),xb=r=>{let[e,t,n,s=1]=r;const i=Math.round(.3*e+.59*t+.11*n);return[i,i,i,s]};class Ve{constructor(e){if(F(this,"isUnrecognised",!1),e)if(e instanceof Ve)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,n,s,i=1]=e;this.setSource([t,n,s,i])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in Tb&&(e=Tb[e]),e==="transparent"?[255,255,255,0]:Ve.sourceFromHex(e)||Ve.sourceFromRgb(e)||Ve.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,n]=Cb(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){const[e,t,n,s]=Cb(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(s,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,n,s]=this.getSource();return"".concat(Ld(e)).concat(Ld(t)).concat(Ld(n)).concat(Ld(Math.round(255*s)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(xb(this.getSource())),this}toBlackWhite(e){const[t,,,n]=xb(this.getSource()),s=t<(e||127)?0:255;return this.setSource([s,s,s,n]),this}overlayWith(e){e instanceof Ve||(e=new Ve(e));const t=this.getSource(),n=e.getSource(),[s,i,o]=t.map((a,l)=>Math.round(.5*a+.5*n[l]));return this.setSource([s,i,o,t[3]]),this}static fromRgb(e){return Ve.fromRgba(e)}static fromRgba(e){return new Ve(Ve.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[n,s,i]=t.slice(1,4).map(o=>{const a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a});return[n,s,i,Eb(t[4])]}}static fromHsl(e){return Ve.fromHsla(e)}static fromHsla(e){return new Ve(Ve.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const n=(Ve.parseAngletoDegrees(t[1])%360+360)%360/360,s=parseFloat(t[2])/100,i=parseFloat(t[3])/100;let o,a,l;if(s===0)o=a=l=i;else{const c=i<=.5?i*(s+1):i+s-i*s,u=2*i-c;o=wv(u,c,n+1/3),a=wv(u,c,n),l=wv(u,c,n-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*l),Eb(t[4])]}static fromHex(e){return new Ve(Ve.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let n;n=t.length<=4?t.split("").map(l=>l+l):t.match(/.{2}/g);const[s,i,o,a=255]=n.map(l=>parseInt(l,16));return[s,i,o,a/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),n=parseFloat(t);return t.includes("rad")?ai(n):t.includes("turn")?360*n:n}}const Al=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:cT;const t=/\D{0,2}$/.exec(r),n=parseFloat(r),s=Ae.DPI;switch(t==null?void 0:t[0]){case"mm":return n*s/25.4;case"cm":return n*s/2.54;case"in":return n*s;case"pt":return n*s/72;case"pc":return n*s/72*12;case"em":return n*e;default:return n}},jH=r=>{const[e,t]=r.trim().split(" "),[n,s]=(i=e)&&i!==Mr?[i.slice(1,4),i.slice(5,8)]:i===Mr?[i,i]:["Mid","Mid"];var i;return{meetOrSlice:t||"meet",alignX:n,alignY:s}},fh=function(r,e){let t,n,s=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const i=new Ve(e),o=i.getAlpha();t=i.toRgb(),o!==1&&(n=o.toString())}else t="none";return s?"".concat(r,": ").concat(t,"; ").concat(n?"".concat(r,"-opacity: ").concat(n,"; "):""):"".concat(r,'="').concat(t,'" ').concat(n?"".concat(r,'-opacity="').concat(n,'" '):"")};class RD{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):Mr,i=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",d=e?"":this.getSvgFilter(),f=fh(Ot,this.fill);return[fh(Nr,this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",i,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",l,"; ",f,"fill-rule: ",t,"; ","opacity: ",c,";",d,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e?this.calcTransformMatrix():this.calcOwnMatrix(),s='transform="'.concat(dh(n));return"".concat(s).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),i=e.indexOf("COMMON_PARTS");return e[i]=s,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:s,additionalTransform:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=t?"":'style="'.concat(this.getSvgStyles(),'" '),a=s?'style="'.concat(this.getSvgFilter(),'" '):"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,d=this.stroke,f=this.fill,p=this.shadow,m=[],v=e.indexOf("COMMON_PARTS");let T;l&&(l.clipPathId="CLIPPATH_".concat(no()),T='<clipPath id="'.concat(l.clipPathId,`" >
`).concat(l.toClipPathSVG(n),`</clipPath>
`)),u&&m.push("<g ",a,this.getSvgCommons(),` >
`),m.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);const w=[o,c,t?"":this.addPaintOrder()," ",i?'transform="'.concat(i,'" '):""].join("");return e[v]=w,an(f)&&m.push(f.toSVG(this)),an(d)&&m.push(d.toSVG(this)),p&&m.push(p.toSVG(this)),l&&m.push(T),m.push(e.join("")),m.push(`</g>
`),u&&m.push(`</g>
`),n?n(m.join("")):m.join("")}addPaintOrder(){return this.paintFirst!==Ot?' paint-order="'.concat(this.paintFirst,'" '):""}}function Xm(r){return new RegExp("^("+r.join("|")+")\\b","i")}const la="textDecorationThickness",OD=["fontSize","fontWeight","fontFamily","fontStyle"],DD=["underline","overline","linethrough"],MD=[...OD,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],ND=[...MD,...DD,"textBackgroundColor","direction",la],$H=[...OD,...DD,Nr,"strokeWidth",Ot,"deltaY","textBackgroundColor",la],UH={_reNewline:uT,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Me,fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Me,pathAlign:"baseline",charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.28167,overline:-.81333},_fontSizeMult:1.13,[la]:66.667},rs="justify",rg="justify-left",Tu="justify-right",Cu="justify-center";var bb,Ab,kb;const Nn=String.raw(bb||(bb=Ss(["[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?"],["[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?"]))),Sv=String.raw(Ab||(Ab=Ss(["(?:s*,?s+|s*,s*)"],["(?:\\s*,?\\s+|\\s*,\\s*)"]))),BH=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Nn+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Nn+"))?\\s+(.*)"),zH={cx:Me,x:Me,r:"radius",cy:Dr,y:Dr,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing","text-decoration-thickness":la},Tv="font-size",Cv="clip-path";Xm(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);Xm(["symbol","image","marker","pattern","view","svg"]);const Ib=Xm(["symbol","g","a","svg","clipPath","defs"]);new RegExp(String.raw(kb||(kb=Ss(["^s*(",")","(",")","(",")","(",")s*$"],["^\\s*(",")","(",")","(",")","(",")\\s*$"])),Nn,Sv,Nn,Sv,Nn,Sv,Nn));const WH=new U(1,0),FD=new U,LD=(r,e)=>r.rotate(e),A_=(r,e)=>new U(e).subtract(r),k_=r=>r.distanceFrom(FD),I_=(r,e)=>Math.atan2(Eu(r,e),GH(r,e)),HH=r=>I_(WH,r),vT=r=>r.eq(FD)?r:r.scalarDivide(k_(r)),VD=function(r){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return vT(new U(-r.y,r.x).scalarMultiply(e?1:-1))},Eu=(r,e)=>r.x*e.y-r.y*e.x,GH=(r,e)=>r.x*e.x+r.y*e.y,Pb=(r,e,t)=>{if(r.eq(e)||r.eq(t))return!0;const n=Eu(e,t),s=Eu(e,r),i=Eu(t,r);return n>=0?s>=0&&i<=0:!(s<=0&&i>=0)},Rb="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",Ob=new RegExp("(?:\\s|^)"+Rb+Rb+"("+Nn+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class Gs{constructor(e){const t=typeof e=="string"?Gs.parseShadow(e):e;Object.assign(this,Gs.ownDefaults,t),this.id=no()}static parseShadow(e){const t=e.trim(),[,n=0,s=0,i=0]=(Ob.exec(t)||[]).map(o=>parseFloat(o)||0);return{color:(t.replace(Ob,"")||"rgb(0,0,0)").trim(),offsetX:n,offsetY:s,blur:i}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=LD(new U(this.offsetX,this.offsetY),gt(-e.angle)),n=new Ve(this.color);let s=40,i=40;return e.width&&e.height&&(s=100*Ge((Math.abs(t.x)+this.blur)/e.width,Ae.NUM_FRACTION_DIGITS)+20,i=100*Ge((Math.abs(t.y)+this.blur)/e.height,Ae.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(i,'%" height="').concat(100+2*i,'%" x="-').concat(s,'%" width="').concat(100+2*s,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Ge(this.blur?this.blur/2:0,Ae.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Ge(t.x,Ae.NUM_FRACTION_DIGITS),'" dy="').concat(Ge(t.y,Ae.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=Gs.ownDefaults;return this.includeDefaultValues?e:gT(e,(n,s)=>n!==t[s])}static async fromObject(e){return new this(e)}}F(Gs,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),F(Gs,"type","shadow"),oe.setClass(Gs,"shadow");const Hl=(r,e,t)=>Math.max(r,Math.min(e,t)),qH=[Dr,Me,Lr,gn,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",ac,lc],ci=[Ot,Nr,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],YH={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Me,originY:Dr,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Ot,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},XH=(r,e,t,n)=>-t*Math.cos(r/n*$h)+t+e,KH=()=>!1;class _T{constructor(e){let{startValue:t,byValue:n,duration:s=500,delay:i=0,easing:o=XH,onStart:a=Uf,onChange:l=Uf,onComplete:c=Uf,abort:u=KH,target:d}=e;F(this,"_state","pending"),F(this,"durationProgress",0),F(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=s,this.delay=i,this.easing=o,this._onStart=a,this._onChange=l,this._onComplete=c,this._abort=u,this.target=d,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>zf(e),this.delay):zf(e)}tick(e){const t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;const{value:s,valueProgress:i}=this.calculate(n);this.value=Object.freeze(s),this.valueProgress=i,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),zf(this.tick)))}register(){Jp.push(this)}unregister(){Jp.remove(this)}abort(){this._state="aborted",this.unregister()}}const QH=["startValue","endValue"];class JH extends _T{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(V(V({},Ze(e,QH)),{},{startValue:t,byValue:n-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const ZH=["startValue","endValue"];class eG extends _T{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(V(V({},Ze(e,ZH)),{},{startValue:t,byValue:n.map((s,i)=>s-t[i])}))}calculate(e){const t=this.startValue.map((n,s)=>this.easing(e,n,this.byValue[s],this.duration,s));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const tG=["startValue","endValue","easing","onChange","onComplete","abort"],rG=(r,e,t,n)=>e+t*(1-Math.cos(r/n*$h)),Ev=r=>r&&((e,t,n)=>r(new Ve(e).toRgba(),t,n));class nG extends _T{constructor(e){let{startValue:t,endValue:n,easing:s=rG,onChange:i,onComplete:o,abort:a}=e,l=Ze(e,tG);const c=new Ve(t).getSource(),u=new Ve(n).getSource();super(V(V({},l),{},{startValue:c,byValue:u.map((d,f)=>d-c[f]),easing:s,onChange:Ev(i),onComplete:Ev(o),abort:Ev(a)}))}calculate(e){const[t,n,s,i]=this.startValue.map((a,l)=>this.easing(e,a,this.byValue[l],this.duration,l)),o=[...[t,n,s].map(Math.round),Hl(0,i,1)];return{value:o,valueProgress:o.map((a,l)=>this.byValue[l]!==0?Math.abs((a-this.startValue[l])/this.byValue[l]):0).find(a=>a!==0)||0}}}function jD(r){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(r)?new eG(r):new JH(r);return e.start(),e}function sG(r){const e=new nG(r);return e.start(),e}class et{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter(s=>!this.includes(s))),this}static isPointContained(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(s||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(s||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{const i=A_(t,n),o=A_(t,e).divide(i);return s?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){const n=new U(e).setX(Math.min(e.x-1,...t.map(i=>i.x)));let s=0;for(let i=0;i<t.length;i++){const o=this.intersectSegmentSegment(t[i],t[(i+1)%t.length],e,n);if(o.includes(e))return!0;s+=+(o.status==="Intersection")}return s%2==1}static intersectLineLine(e,t,n,s){let i=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=t.x-e.x,l=t.y-e.y,c=s.x-n.x,u=s.y-n.y,d=e.x-n.x,f=e.y-n.y,p=c*f-u*d,m=a*f-l*d,v=u*a-c*l;if(v!==0){const T=p/v,w=m/v;return(i||0<=T&&T<=1)&&(o||0<=w&&w<=1)?new et("Intersection").append(new U(e.x+T*a,e.y+T*l)):new et}if(p===0||m===0){const T=i||o||et.isPointContained(e,n,s)||et.isPointContained(t,n,s)||et.isPointContained(n,e,t)||et.isPointContained(s,e,t);return new et(T?"Coincident":void 0)}return new et("Parallel")}static intersectSegmentLine(e,t,n,s){return et.intersectLineLine(e,t,n,s,!1,!0)}static intersectSegmentSegment(e,t,n,s){return et.intersectLineLine(e,t,n,s,!1,!1)}static intersectLinePolygon(e,t,n){let s=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const i=new et,o=n.length;for(let a,l,c,u=0;u<o;u++){if(a=n[u],l=n[(u+1)%o],c=et.intersectLineLine(e,t,a,l,s,!1),c.status==="Coincident")return c;i.append(...c.points)}return i.points.length>0&&(i.status="Intersection"),i}static intersectSegmentPolygon(e,t,n){return et.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){const n=new et,s=e.length,i=[];for(let o=0;o<s;o++){const a=e[o],l=e[(o+1)%s],c=et.intersectSegmentPolygon(a,l,t);c.status==="Coincident"?(i.push(c),n.append(a,l)):n.append(...c.points)}return i.length>0&&i.length===e.length?new et("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){const s=t.min(n),i=t.max(n),o=new U(i.x,s.y),a=new U(s.x,i.y);return et.intersectPolygonPolygon(e,[s,o,i,a])}}class iG extends gD{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?xr(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=xr(e,Mn(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new U(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:n,bl:s}=this.aCoords||(this.aCoords=this.calcACoords()),i=[e,t,n,s];if(this.group){const o=this.group.calcTransformMatrix();return i.map(a=>xr(a,o))}return i}intersectsWithRect(e,t){return et.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=et.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:n,top:s,width:i,height:o}=this.getBoundingRect();return n>=e.x&&n+i<=t.x&&s>=e.y&&s+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return et.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return Hs(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(Lr,e),this._set(gn,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?ai(vD(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||_r.concat()}calcACoords(){const e=cc({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),s=Uh(t,n),i=qt(s,e),o=this._getTransformedDimensions(),a=o.x/2,l=o.y/2;return{tl:xr({x:-a,y:-l},i),tr:xr({x:a,y:-l},i),bl:xr({x:-a,y:l},i),br:xr({x:a,y:l},i)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Ct(this.originX),Ct(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const n=this.transformMatrixKey(e),s=this.matrixCache;return s&&s.key.every((i,o)=>i===n[o])?s.value:(this.group&&(t=qt(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const n=this.getRelativeCenterPoint(),s={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},i=kH(s);return this.ownMatrixCache={key:e,value:i},i}_getNonTransformedDimensions(){return new U(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=V({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth;let s=n,i=0;this.strokeUniform&&(s=0,i=n);const o=t.width+s,a=t.height+s;let l;return l=t.skewX===0&&t.skewY===0?new U(o*t.scaleX,a*t.scaleY):mT(o,a,Gm(t)),l.scalarAdd(i)}translateToGivenOrigin(e,t,n,s,i){let o=e.x,a=e.y;const l=Ct(s)-Ct(t),c=Ct(i)-Ct(n);if(l||c){const u=this._getTransformedDimensions();o+=l*u.x,a+=c*u.y}return new U(o,a)}translateToCenterPoint(e,t,n){if(t===_e&&n===_e)return e;const s=this.translateToGivenOrigin(e,t,n,_e,_e);return this.angle?s.rotate(gt(this.angle),e):s}translateToOriginPoint(e,t,n){const s=this.translateToGivenOrigin(e,_e,_e,t,n);return this.angle?s.rotate(gt(this.angle),e):s}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?xr(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new U(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){const s=this.translateToCenterPoint(e,t,n),i=this.translateToOriginPoint(s,this.originX,this.originY);this.set({left:i.x,top:i.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Me,Dr)}}const oG=["type"],aG=["extraParam"];let ks=class Hf extends iG{static getDefaults(){return Hf.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){ro("warn","Setting type has no effect",e)}constructor(e){super(),F(this,"_cacheContext",null),Object.assign(this,Hf.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=oi(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,n=e.height,s=Ae.maxCacheSideLimit,i=Ae.minCacheSideLimit;if(t<=s&&n<=s&&t*n<=Ae.perfLimitSizeTotal)return t<i&&(e.width=i),n<i&&(e.height=i),e;const o=t/n,[a,l]=Su.limitDimsByArea(o),c=Hl(i,a,s),u=Hl(i,l,s);return t>c&&(e.zoomX/=t/c,e.width=c,e.capped=!0),n>u&&(e.zoomY/=n/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,s=t.y*e.y/this.scaleY;return{width:Math.ceil(n+2),height:Math.ceil(s+2),zoomX:e.x,zoomY:e.y,x:n,y:s}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:n,height:s,zoomX:i,zoomY:o,x:a,y:l}=this._limitCacheSize(this._getCacheCanvasDimensions()),c=n!==e.width||s!==e.height,u=this.zoomX!==i||this.zoomY!==o;if(!e||!t)return!1;if(c||u){n!==e.width||s!==e.height?(e.width=n,e.height=s):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const d=a/2,f=l/2;return this.cacheTranslationX=Math.round(e.width/2-d)+d,this.cacheTranslationY=Math.round(e.height/2-f)+f,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(i,o),this.zoomX=i,this.zoomY=o,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}getObjectScaling(){if(!this.group)return new U(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Zp(this.calcTransformMatrix());return new U(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==Lr&&e!==gn||(t=this._constrainScale(t)),e===Lr&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof Gs||(t=new Gs(t));const n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:i}=this,{width:o,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:n,cacheTranslationX:s,cacheTranslationY:i,width:o,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===Nr&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,n){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(n,0,0),e.restore()}drawObject(e,t,n){const s=this.fill,i=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,n),this.fill=s,this.stroke=i}createClipPathLayer(e,t){const n=mn(t),s=n.getContext("2d");if(s.translate(t.cacheTranslationX,t.cacheTranslationY),s.scale(t.zoomX,t.zoomY),e._cacheCanvas=n,t.parentClipPaths.forEach(i=>{i.transform(s)}),t.parentClipPaths.push(e),e.absolutePositioned){const i=Mn(this.calcTransformMatrix());s.transform(i[0],i[1],i[2],i[3],i[4],i[5])}return e.transform(s),e.drawObject(s,!0,t),n}_drawClipPath(e,t,n){if(!t)return;t._transformDone=!0;const s=this.createClipPathLayer(t,n);this.drawClipPathOnCache(e,t,s)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,n=this._cacheContext;return!(!t||!n||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&n&&!e&&(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,t.width,t.height),n.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,an(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(an(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,n=this.canvas,s=this.getCanvasRetinaScaling(),[i,,,o]=(n==null?void 0:n.viewportTransform)||_r,a=i*s,l=o*s,c=t.nonScaling?new U(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Ae.browserShadowBlurConstant*(a+l)*(c.x+c.y)/4,e.shadowOffsetX=t.offsetX*a*c.x,e.shadowOffsetY=t.offsetY*l*c.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!an(t))return{offsetX:0,offsetY:0};const n=t.gradientTransform||t.patternTransform,s=-this.width/2+t.offsetX||0,i=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,s,i):e.transform(1,0,0,1,s,i),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:s,offsetY:i}}_renderPaintInOrder(e){this.paintFirst===Nr?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;const s=this._limitCacheSize(this._getCacheCanvasDimensions()),i=this.getCanvasRetinaScaling(),o=s.x/this.scaleX/i,a=s.y/this.scaleY/i,l=mn({width:Math.ceil(o),height:Math.ceil(a)}),c=l.getContext("2d");c&&(c.beginPath(),c.moveTo(0,0),c.lineTo(o,0),c.lineTo(o,a),c.lineTo(0,a),c.closePath(),c.translate(o/2,a/2),c.scale(s.zoomX/this.scaleX/i,s.zoomY/this.scaleY/i),this._applyPatternGradientTransform(c,t),c.fillStyle=t.toLive(e),c.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(i*this.scaleX/s.zoomX,i*this.scaleY/s.zoomY),e.strokeStyle=(n=c.createPattern(l,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new U(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(oe.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=bD(this),n=this.group,s=this.shadow,i=Math.abs,o=e.enableRetinaScaling?uD():1,a=(e.multiplier||1)*o,l=e.canvasProvider||(y=>new Bh(y,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&MH(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&FH(this,this.getViewportTransform()),this.setCoords();const c=oi(),u=this.getBoundingRect(),d=this.shadow,f=new U;if(d){const y=d.blur,C=d.nonScaling?new U(1,1):this.getObjectScaling();f.x=2*Math.round(i(d.offsetX)+y)*i(C.x),f.y=2*Math.round(i(d.offsetY)+y)*i(C.y)}const p=u.width+f.x,m=u.height+f.y;c.width=Math.ceil(p),c.height=Math.ceil(m);const v=l(c);e.format==="jpeg"&&(v.backgroundColor="#fff"),this.setPositionByOrigin(new U(v.width/2,v.height/2),_e,_e);const T=this.canvas;v._objects=[this],this.set("canvas",v),this.setCoords();const w=v.toCanvasElement(a||1,e);return this.set("canvas",T),this.shadow=s,n&&(this.group=n),this.set(t),this.setCoords(),v._objects=[],v.destroy(),w}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return mD(this.toCanvasElement(e),e.format||"png",e.quality||1)}toBlob(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return yD(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:n,originY:s}=this;if(t){const{x:i,y:o}=this.getRelativeCenterPoint();this.originX=_e,this.originY=_e,this.left=i,this.top=o}if(this.set("angle",e),t){const{x:i,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,s);this.left=i,this.top=o,this.originX=n,this.originY=s}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Jp.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&ms().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((n,s)=>{let[i,o]=s;return n[i]=this._animate(i,o,t),n},{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.split("."),i=this.constructor.colorProperties.includes(s[s.length-1]),{abort:o,startValue:a,onChange:l,onComplete:c}=n,u=V(V({},n),{},{target:this,startValue:a??s.reduce((d,f)=>d[f],this),endValue:t,abort:o==null?void 0:o.bind(this),onChange:(d,f,p)=>{s.reduce((m,v,T)=>(T===s.length-1&&(m[v]=d),m[v]),this),l&&l(d,f,p)},onComplete:(d,f,p)=>{this.setCoords(),c&&c(d,f,p)}});return i?sG(u):jD(u)}isDescendantOf(e){const{parent:t,group:n}=this;return t===e||n===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),n=e.getAncestors();if(t.length===0&&n.length>0&&this===n[n.length-1])return{fork:[],otherFork:[e,...n.slice(0,n.length-1)],common:[this]};for(let s,i=0;i<t.length;i++){if(s=t[i],s===e)return{fork:[this,...t.slice(0,i)],otherFork:[],common:t.slice(i)};for(let o=0;o<n.length;o++){if(this===n[o])return{fork:[],otherFork:[e,...n.slice(0,o)],common:[this,...t]};if(s===n[o])return{fork:[this,...t.slice(0,i)],otherFork:[e,...n.slice(0,o)],common:t.slice(i)}}}return{fork:[this,...t],otherFork:[e,...n],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const n=t.common[0]||this.canvas;if(!n)return;const s=t.fork.pop(),i=t.otherFork.pop(),o=n._objects.indexOf(s),a=n._objects.indexOf(i);return o>-1&&o>a}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(Hf.customProperties,this.constructor.customProperties||[]);let t;const n=Ae.NUM_FRACTION_DIGITS,{clipPath:s,fill:i,stroke:o,shadow:a,strokeDashArray:l,left:c,top:u,originX:d,originY:f,width:p,height:m,strokeWidth:v,strokeLineCap:T,strokeDashOffset:w,strokeLineJoin:y,strokeUniform:C,strokeMiterLimit:k,scaleX:O,scaleY:M,angle:x,flipX:E,flipY:A,opacity:P,visible:R,backgroundColor:_,fillRule:b,paintFirst:B,globalCompositeOperation:te,skewX:ue,skewY:ge}=this;s&&!s.excludeFromExport&&(t=s.toObject(e.concat("inverted","absolutePositioned")));const Y=he=>Ge(he,n),ce=V(V({},uc(this,e)),{},{type:this.constructor.type,version:C_,originX:d,originY:f,left:Y(c),top:Y(u),width:Y(p),height:Y(m),fill:yb(i)?i.toObject():i,stroke:yb(o)?o.toObject():o,strokeWidth:Y(v),strokeDashArray:l&&l.concat(),strokeLineCap:T,strokeDashOffset:w,strokeLineJoin:y,strokeUniform:C,strokeMiterLimit:Y(k),scaleX:Y(O),scaleY:Y(M),angle:Y(x),flipX:E,flipY:A,opacity:Y(P),shadow:a&&a.toObject(),visible:R,backgroundColor:_,fillRule:b,paintFirst:B,globalCompositeOperation:te,skewX:Y(ue),skewY:Y(ge)},t?{clipPath:t}:null);return this.includeDefaultValues?ce:this._removeDefaultValues(ce)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return gT(e,(s,i)=>{if(i===Me||i===Dr||i==="type")return!0;const o=n[i];return s!==o&&!(Array.isArray(s)&&Array.isArray(o)&&s.length===0&&o.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=Ze(e,oG),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:s}=n,i=Ze(n,aG);return qm(t,i).then(o=>s?(delete o[s],new this(t[s],o)):new this(o))}static fromObject(e,t){return this._fromObject(e,t)}};F(ks,"stateProperties",qH),F(ks,"cacheProperties",ci),F(ks,"ownDefaults",YH),F(ks,"type","FabricObject"),F(ks,"colorProperties",[Ot,Nr,"backgroundColor"]),F(ks,"customProperties",[]),oe.setClass(ks),oe.setClass(ks,"object");const hc=(r,e,t)=>(n,s,i,o)=>{const a=e(n,s,i,o);return a&&AD(r,V(V({},ID(n,s,i,o)),t)),a};function dc(r){return(e,t,n,s)=>{const{target:i,originX:o,originY:a}=t,l=i.getRelativeCenterPoint(),c=i.translateToOriginPoint(l,o,a),u=r(e,t,n,s);return i.setPositionByOrigin(c,t.originX,t.originY),u}}const Db=hc(uh,dc((r,e,t,n)=>{const s=yT(e,e.originX,e.originY,t,n);if(Ct(e.originX)===Ct(_e)||Ct(e.originX)===Ct(dt)&&s.x<0||Ct(e.originX)===Ct(Me)&&s.x>0){const{target:i}=e,o=i.strokeWidth/(i.strokeUniform?i.scaleX:1),a=kD(e)?2:1,l=i.width,c=Math.abs(s.x*a/i.scaleX)-o;return i.set("width",Math.max(c,1)),l!==i.width}return!1}));function lG(r,e,t,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,o=this.sizeY||n.cornerSize||s.cornerSize,a=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,l=a?Nr:Ot,c=!a&&(n.cornerStrokeColor||s.cornerStrokeColor);let u,d=e,f=t;r.save(),r.fillStyle=n.cornerColor||s.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",i>o?(u=i,r.scale(1,o/i),f=t*i/o):o>i?(u=o,r.scale(i/o,1),d=e*o/i):u=i,r.beginPath(),r.arc(d,f,u/2,0,Xp,!1),r[l](),c&&r.stroke(),r.restore()}function cG(r,e,t,n,s){n=n||{};const i=this.sizeX||n.cornerSize||s.cornerSize,o=this.sizeY||n.cornerSize||s.cornerSize,a=n.transparentCorners!==void 0?n.transparentCorners:s.transparentCorners,l=a?Nr:Ot,c=!a&&(n.cornerStrokeColor||s.cornerStrokeColor),u=i/2,d=o/2;r.save(),r.fillStyle=n.cornerColor||s.cornerColor||"",r.strokeStyle=n.cornerStrokeColor||s.cornerStrokeColor||"",r.translate(e,t);const f=s.getTotalAngle();r.rotate(gt(f)),r["".concat(l,"Rect")](-u,-d,i,o),c&&r.strokeRect(-u,-d,i,o),r.restore()}class Cn{constructor(e){F(this,"visible",!0),F(this,"actionName",Hm),F(this,"angle",0),F(this,"x",0),F(this,"y",0),F(this,"offsetX",0),F(this,"offsetY",0),F(this,"sizeX",0),F(this,"sizeY",0),F(this,"touchSizeX",0),F(this,"touchSizeY",0),F(this,"cursorStyle","crosshair"),F(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,s){var i;let{tl:o,tr:a,br:l,bl:c}=s;return((i=t.canvas)===null||i===void 0?void 0:i.getActiveObject())===t&&t.isControlVisible(e)&&et.isPointInPolygon(n,[o,a,l,c])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,s;return(n=(s=e._controlsVisibility)===null||s===void 0?void 0:s[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,s){return new U(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,s,i,o){const a=fT([Uh(n,s),cc({angle:e}),pT((i?this.touchSizeX:this.sizeX)||t,(i?this.touchSizeY:this.sizeY)||t)]);return{tl:new U(-.5,-.5).transform(a),tr:new U(.5,-.5).transform(a),br:new U(.5,.5).transform(a),bl:new U(-.5,.5).transform(a)}}render(e,t,n,s,i){((s=s||{}).cornerStyle||i.cornerStyle)==="circle"?lG.call(this,e,t,n,s,i):cG.call(this,e,t,n,s,i)}}const uG=(r,e,t)=>t.lockRotation?tg:e.cursorStyle,hG=hc(dD,dc((r,e,t,n)=>{let{target:s,ex:i,ey:o,theta:a,originX:l,originY:c}=e;const u=s.translateToOriginPoint(s.getRelativeCenterPoint(),l,c);if(jn(s,"lockRotation"))return!1;const d=Math.atan2(o-u.y,i-u.x),f=Math.atan2(n-u.y,t-u.x);let p=ai(f-d+a);if(s.snapAngle&&s.snapAngle>0){const v=s.snapAngle,T=s.snapThreshold||v,w=Math.ceil(p/v)*v,y=Math.floor(p/v)*v;Math.abs(p-y)<T?p=y:Math.abs(p-w)<T&&(p=w)}p<0&&(p=360+p),p%=360;const m=s.angle!==p;return s.angle=p,m}));function $D(r,e){const t=e.canvas,n=r[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function UD(r,e,t){const n=jn(r,"lockScalingX"),s=jn(r,"lockScalingY");if(n&&s||!e&&(n||s)&&t||n&&e==="x"||s&&e==="y")return!0;const{width:i,height:o,strokeWidth:a}=r;return i===0&&a===0&&e!=="y"||o===0&&a===0&&e!=="x"}const dG=["e","se","s","sw","w","nw","n","ne","e"],nu=(r,e,t)=>{const n=$D(r,t);if(UD(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return tg;const s=PD(t,e);return"".concat(dG[s],"-resize")};function wT(r,e,t,n){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const i=e.target,o=s.by,a=$D(r,i);let l,c,u,d,f,p;if(UD(i,o,a))return!1;if(e.gestureScale)c=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(l=yT(e,e.originX,e.originY,t,n),f=o!=="y"?Math.sign(l.x||e.signX||1):1,p=o!=="x"?Math.sign(l.y||e.signY||1):1,e.signX||(e.signX=f),e.signY||(e.signY=p),jn(i,"lockScalingFlip")&&(e.signX!==f||e.signY!==p))return!1;if(d=i._getTransformedDimensions(),a&&!o){const T=Math.abs(l.x)+Math.abs(l.y),{original:w}=e,y=T/(Math.abs(d.x*w.scaleX/i.scaleX)+Math.abs(d.y*w.scaleY/i.scaleY));c=w.scaleX*y,u=w.scaleY*y}else c=Math.abs(l.x*i.scaleX/d.x),u=Math.abs(l.y*i.scaleY/d.y);kD(e)&&(c*=2,u*=2),e.signX!==f&&o!=="y"&&(e.originX=Sb(e.originX),c*=-1,e.signX=f),e.signY!==p&&o!=="x"&&(e.originY=Sb(e.originY),u*=-1,e.signY=p)}const m=i.scaleX,v=i.scaleY;return o?(o==="x"&&i.set(Lr,c),o==="y"&&i.set(gn,u)):(!jn(i,"lockScalingX")&&i.set(Lr,c),!jn(i,"lockScalingY")&&i.set(gn,u)),m!==i.scaleX||v!==i.scaleY}const Vd=hc(Wm,dc((r,e,t,n)=>wT(r,e,t,n))),fG=hc(Wm,dc((r,e,t,n)=>wT(r,e,t,n,{by:"x"}))),pG=hc(Wm,dc((r,e,t,n)=>wT(r,e,t,n,{by:"y"}))),gG=["target","ex","ey","skewingSide"],xv={x:{counterAxis:"y",scale:Lr,skew:ac,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:gn,skew:lc,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},mG=["ns","nesw","ew","nwse"],yG=(r,e,t)=>{if(e.x!==0&&jn(t,"lockSkewingY")||e.y!==0&&jn(t,"lockSkewingX"))return tg;const n=PD(t,e)%4;return"".concat(mG[n],"-resize")};function BD(r,e,t,n,s){const{target:i}=t,{counterAxis:o,origin:a,lockSkewing:l,skew:c,flip:u}=xv[r];if(jn(i,l))return!1;const{origin:d,flip:f}=xv[o],p=Ct(t[d])*(i[f]?-1:1),m=-Math.sign(p)*(i[u]?-1:1),v=.5*-((i[c]===0&&yT(t,_e,_e,n,s)[r]>0||i[c]>0?1:-1)*m)+.5;return hc(fD,dc((w,y,C,k)=>function(O,M,x){let{target:E,ex:A,ey:P,skewingSide:R}=M,_=Ze(M,gG);const{skew:b}=xv[O],B=x.subtract(new U(A,P)).divide(new U(E.scaleX,E.scaleY))[O],te=E[b],ue=_[b],ge=Math.tan(gt(ue)),Y=O==="y"?E._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:E._getTransformedDimensions({scaleX:1,scaleY:1}).y,ce=2*B*R/Math.max(Y,1)+ge,he=ai(Math.atan(ce));E.set(b,he);const Ie=te!==E[b];if(Ie&&O==="y"){const{skewX:xe,scaleX:De}=E,vt=E._getTransformedDimensions({skewY:te}),jt=E._getTransformedDimensions(),At=xe!==0?vt.x/jt.x:1;At!==1&&E.set(Lr,At*De)}return Ie}(r,y,new U(C,k))))(e,V(V({},t),{},{[a]:v,skewingSide:m}),n,s)}const vG=(r,e,t,n)=>BD("x",r,e,t,n),_G=(r,e,t,n)=>BD("y",r,e,t,n);function Km(r,e){return r[e.canvas.altActionKey]}const jd=(r,e,t)=>{const n=Km(r,t);return e.x===0?n?ac:gn:e.y===0?n?lc:Lr:""},ll=(r,e,t)=>Km(r,t)?yG(0,e,t):nu(r,e,t),Mb=(r,e,t,n)=>Km(r,e.target)?_G(r,e,t,n):fG(r,e,t,n),Nb=(r,e,t,n)=>Km(r,e.target)?vG(r,e,t,n):pG(r,e,t,n),zD=()=>({ml:new Cn({x:-.5,y:0,cursorStyleHandler:ll,actionHandler:Mb,getActionName:jd}),mr:new Cn({x:.5,y:0,cursorStyleHandler:ll,actionHandler:Mb,getActionName:jd}),mb:new Cn({x:0,y:.5,cursorStyleHandler:ll,actionHandler:Nb,getActionName:jd}),mt:new Cn({x:0,y:-.5,cursorStyleHandler:ll,actionHandler:Nb,getActionName:jd}),tl:new Cn({x:-.5,y:-.5,cursorStyleHandler:nu,actionHandler:Vd}),tr:new Cn({x:.5,y:-.5,cursorStyleHandler:nu,actionHandler:Vd}),bl:new Cn({x:-.5,y:.5,cursorStyleHandler:nu,actionHandler:Vd}),br:new Cn({x:.5,y:.5,cursorStyleHandler:nu,actionHandler:Vd}),mtr:new Cn({x:0,y:-.5,actionHandler:hG,cursorStyleHandler:uG,offsetY:-40,withConnection:!0,actionName:hT})}),wG=()=>({mr:new Cn({x:.5,y:0,actionHandler:Db,cursorStyleHandler:ll,actionName:uh}),ml:new Cn({x:-.5,y:0,actionHandler:Db,cursorStyleHandler:ll,actionName:uh})}),SG=()=>V(V({},zD()),wG());class ph extends ks{static getDefaults(){return V(V({},super.getDefaults()),ph.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),ph.ownDefaults),this.setOptions(e)}static createControls(){return{controls:zD()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,n=t.target,s=t.action;if(this===n&&s&&s.startsWith(Hm))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const n=Object.entries(this.oCoords);for(let s=n.length-1;s>=0;s--){const[i,o]=n[s],a=this.controls[i];if(a.shouldActivate(i,this,e,t?o.touchCorner:o.corner))return this.__corner=i,{key:i,control:a,coord:this.oCoords[i]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),n=Uh(t.x,t.y),s=cc({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),i=qt(n,s),o=qt(e,i),a=qt(o,[1/e[0],0,0,1/e[3],0,0]),l=this.group?Zp(this.calcTransformMatrix()):void 0;l&&(l.scaleX=Math.abs(l.scaleX),l.scaleY=Math.abs(l.scaleY));const c=this._calculateCurrentDimensions(l),u={};return this.forEachControl((d,f)=>{const p=d.positionHandler(c,a,this,d);u[f]=Object.assign(p,this._calcCornerCoords(d,p))}),u}_calcCornerCoords(e,t){const n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),s=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/s[0],1/s[3]),e.rotate(gt(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=V({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=s.borderColor,this._setLineDash(e,s.borderDashArray),this.strokeBorders(e,t),s.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:n,hasControls:s}=this,i=V({hasBorders:n,hasControls:s},t),o=this.getViewportTransform(),a=i.hasBorders,l=i.hasControls,c=qt(o,this.calcTransformMatrix()),u=Zp(c);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(gt(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,t),l&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let s;if(n&&n.forActiveSelection||this.group){const i=mT(this.width,this.height,Gm(t)),o=this.isStrokeAccountedForInDimensions()?dT:(this.strokeUniform?new U().scalarAdd(this.canvas?this.canvas.getZoom():1):new U(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);s=i.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else s=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,s,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl((s,i)=>{s.withConnection&&s.getVisibility(this,i)&&(n=!0,e.moveTo(s.x*t.x,s.y*t.y),e.lineTo(s.x*t.x+s.offsetX,s.y*t.y+s.offsetY))}),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const n=this.getCanvasRetinaScaling(),{cornerStrokeColor:s,cornerDashArray:i,cornerColor:o}=this,a=V({cornerStrokeColor:s,cornerDashArray:i,cornerColor:o},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl((l,c)=>{if(l.getVisibility(this,c)){const u=this.oCoords[c];l.render(e,u.x,u.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[n,s]=t;return this.setControlVisible(n,s)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);const s=this.width+4,i=this.height+4;return t.clearRect(-s/2,-i/2,s,i),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function WD(r,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))})}),r}F(ph,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class ar extends ph{}WD(ar,[RD]),oe.setClass(ar),oe.setClass(ar,"object");const TG=(r,e,t,n)=>{const s=2*(n=Math.round(n))+1,{data:i}=r.getImageData(e-n,t-n,s,s);for(let o=3;o<i.length;o+=4)if(i[o]>0)return!1;return!0};class HD{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new U(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new U(1/this.options.scaleX,1/this.options.scaleY):new U(1,1)}createSideVector(e,t){const n=A_(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new U(e);return t.y+=t.x*Math.tan(gt(this.options.skewY)),t.x+=t.y*Math.tan(gt(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const CG=new U;class kl extends HD{static getOrthogonalRotationFactor(e,t){const n=t?I_(e,t):HH(e);return Math.abs(n)<$h?-1:1}constructor(e,t,n,s){super(s),F(this,"AB",void 0),F(this,"AC",void 0),F(this,"alpha",void 0),F(this,"bisector",void 0),this.A=new U(e),this.B=new U(t),this.C=new U(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=I_(this.AB,this.AC),this.bisector=vT(LD(this.AB.eq(CG)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t),i=VD(s),o=kl.getOrthogonalRotationFactor(i,this.bisector);return this.scaleUnitVector(i,n*o)}projectBevel(){const e=[];return(this.alpha%Xp==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),s=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),i=this.options.strokeUniform?k_(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return k_(s)/this.strokeProjectionMagnitude<=i&&e.push(this.applySkew(this.A.add(s))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const n=[],s=new U(kl.getOrthogonalRotationFactor(this.bisector),kl.getOrthogonalRotationFactor(new U(this.bisector.y,this.bisector.x)));return[new U(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s),new U(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(s)].forEach(i=>{Pb(i,e,t)&&n.push(this.A.add(i))}),n}projectRoundWithSkew(e,t){const n=[],{skewX:s,skewY:i,scaleX:o,scaleY:a,strokeUniform:l}=this.options,c=new U(Math.tan(gt(s)),Math.tan(gt(i))),u=this.strokeProjectionMagnitude,d=l?u/a/Math.sqrt(1/a**2+1/o**2*c.y**2):u/Math.sqrt(1+c.y**2),f=new U(Math.sqrt(Math.max(u**2-d**2,0)),d),p=l?u/Math.sqrt(1+c.x**2*(1/a)**2/(1/o+1/o*c.x*c.y)**2):u/Math.sqrt(1+c.x**2/(1+c.x*c.y)**2),m=new U(p,Math.sqrt(Math.max(u**2-p**2,0)));return[m,m.scalarMultiply(-1),f,f.scalarMultiply(-1)].map(v=>this.applySkew(l?v.multiply(this.strokeUniformScalar):v)).forEach(v=>{Pb(v,e,t)&&n.push(this.applySkew(this.A).add(v))}),n}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%Xp==0,n=this.applySkew(this.A),s=e[t?0:2].subtract(n),i=e[t?1:0].subtract(n),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Eu(s,o)>0,l=a?s:i,c=a?i:s;return this.isSkewed()?e.push(...this.projectRoundWithSkew(l,c)):e.push(...this.projectRoundNoSkew(l,c)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class Fb extends HD{constructor(e,t,n){super(n),this.A=new U(e),this.T=new U(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const s=this.createSideVector(e,t);return this.scaleUnitVector(VD(s),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new U(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new kl(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new U(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(vT(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),s=this.A.add(n);e.push(s.add(t),s.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const EG=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const n=[];if(r.length===0)return n;const s=r.reduce((i,o)=>(i[i.length-1].eq(o)||i.push(new U(o)),i),[new U(r[0])]);if(s.length===1)t=!0;else if(!t){const i=s[0],o=((a,l)=>{for(let c=a.length-1;c>=0;c--)if(l(a[c],c,a))return c;return-1})(s,a=>!a.eq(i));s.splice(o+1)}return s.forEach((i,o,a)=>{let l,c;o===0?(c=a[1],l=t?i:a[a.length-1]):o===a.length-1?(l=a[o-1],c=t?i:a[0]):(l=a[o-1],c=a[o+1]),t&&a.length===1?n.push(...new Fb(i,i,e).project()):!t||o!==0&&o!==a.length-1?n.push(...new kl(i,l,c,e).project()):n.push(...new Fb(i,o===0?c:l,e).project())}),n},ST=r=>{const e={};return Object.keys(r).forEach(t=>{e[t]={},Object.keys(r[t]).forEach(n=>{e[t][n]=V({},r[t][n])})}),e},xG=r=>r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let jc;const TT=r=>{if(jc||jc||(jc="Intl"in zm()&&"Segmenter"in Intl&&new Intl.Segmenter(void 0,{granularity:"grapheme"})),jc){const e=jc.segment(r);return Array.from(e).map(t=>{let{segment:n}=t;return n})}return bG(r)},bG=r=>{const e=[];for(let t,n=0;n<r.length;n++)(t=AG(r,n))!==!1&&e.push(t);return e},AG=(r,e)=>{const t=r.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return r.charAt(e);if(55296<=t&&t<=56319){if(r.length<=e+1)throw"High surrogate without following low surrogate";const s=r.charCodeAt(e+1);if(56320>s||s>57343)throw"High surrogate without following low surrogate";return r.charAt(e)+r.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const n=r.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1},CT=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return r.fill!==e.fill||r.stroke!==e.stroke||r.strokeWidth!==e.strokeWidth||r.fontSize!==e.fontSize||r.fontFamily!==e.fontFamily||r.fontWeight!==e.fontWeight||r.fontStyle!==e.fontStyle||r.textDecorationThickness!==e.textDecorationThickness||r.textBackgroundColor!==e.textBackgroundColor||r.deltaY!==e.deltaY||t&&(r.overline!==e.overline||r.underline!==e.underline||r.linethrough!==e.linethrough)},kG=(r,e)=>{const t=e.split(`
`),n=[];let s=-1,i={};r=ST(r);for(let o=0;o<t.length;o++){const a=TT(t[o]);if(r[o])for(let l=0;l<a.length;l++){s++;const c=r[o][l];c&&Object.keys(c).length>0&&(CT(i,c,!0)?n.push({start:s,end:s+1,style:c}):n[n.length-1].end++),i=c||{}}else s+=a.length,i={}}return n},IG=(r,e)=>{if(!Array.isArray(r))return ST(r);const t=e.split(uT),n={};let s=-1,i=0;for(let o=0;o<t.length;o++){const a=TT(t[o]);for(let l=0;l<a.length;l++)s++,r[i]&&r[i].start<=s&&s<r[i].end&&(n[o]=n[o]||{},n[o][l]=V({},r[i].style),s===r[i].end-1&&i++)}return n},fo=["display","transform",Ot,"fill-opacity","fill-rule","opacity",Nr,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Lb(r,e){const t=r.nodeName,n=r.getAttribute("class"),s=r.getAttribute("id"),i="(?![a-zA-Z\\-]+)";let o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),s&&e.length&&(o=new RegExp("#"+s+i,"i"),e=e.replace(o,"")),n&&e.length){const a=n.split(" ");for(let l=a.length;l--;)o=new RegExp("\\."+a[l]+i,"i"),e=e.replace(o,"")}return e.length===0}function PG(r,e){let t=!0;const n=Lb(r,e.pop());return n&&e.length&&(t=function(s,i){let o,a=!0;for(;s.parentElement&&s.parentElement.nodeType===1&&i.length;)a&&(o=i.pop()),a=Lb(s=s.parentElement,o);return i.length===0}(r,e)),n&&t&&e.length===0}const RG=r=>{var e;return(e=zH[r])!==null&&e!==void 0?e:r},OG=new RegExp("(".concat(Nn,")"),"gi"),DG=r=>r.replace(OG," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var Vb,jb,$b,Ub,Bb,zb,Wb;const mr="(".concat(Nn,")"),MG=String.raw(Vb||(Vb=Ss(["(skewX)(",")"],["(skewX)\\(","\\)"])),mr),NG=String.raw(jb||(jb=Ss(["(skewY)(",")"],["(skewY)\\(","\\)"])),mr),FG=String.raw($b||($b=Ss(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),mr,mr,mr),LG=String.raw(Ub||(Ub=Ss(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),mr,mr),VG=String.raw(Bb||(Bb=Ss(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),mr,mr),jG=String.raw(zb||(zb=Ss(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),mr,mr,mr,mr,mr,mr),ET="(?:".concat(jG,"|").concat(VG,"|").concat(FG,"|").concat(LG,"|").concat(MG,"|").concat(NG,")"),$G="(?:".concat(ET,"*)"),UG=String.raw(Wb||(Wb=Ss(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),$G),BG=new RegExp(UG),zG=new RegExp(ET),WG=new RegExp(ET,"g");function P_(r){const e=[];if(!(r=DG(r).replace(/\s*([()])\s*/gi,"$1"))||r&&!BG.test(r))return[..._r];for(const t of r.matchAll(WG)){const n=zG.exec(t[0]);if(!n)continue;let s=_r;const i=n.filter(m=>!!m),[,o,...a]=i,[l,c,u,d,f,p]=a.map(m=>parseFloat(m));switch(o){case"translate":s=Uh(l,c);break;case hT:s=cc({angle:l},{x:c,y:u});break;case Hm:s=pT(l,c);break;case ac:s=wD(l);break;case lc:s=SD(l);break;case"matrix":s=[l,c,u,d,f,p]}e.push(s)}return fT(e)}function HG(r,e,t,n){const s=Array.isArray(e);let i,o=e;if(r!==Ot&&r!==Nr||e!==Mr){if(r==="strokeUniform")return e==="non-scaling-stroke";if(r==="strokeDashArray")o=e===Mr?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(r==="transformMatrix")o=t&&t.transformMatrix?qt(t.transformMatrix,P_(e)):P_(e);else if(r==="visible")o=e!==Mr&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(r==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(r==="textAnchor")o=e==="start"?Me:e==="end"?dt:_e;else if(r==="charSpacing"||r===la)i=Al(e,n)/n*1e3;else if(r==="paintFirst"){const a=e.indexOf(Ot),l=e.indexOf(Nr);o=Ot,(a>-1&&l>-1&&l<a||a===-1&&l>-1)&&(o=Nr)}else{if(r==="href"||r==="xlink:href"||r==="font"||r==="id")return e;if(r==="imageSmoothing")return e==="optimizeQuality";i=s?e.map(Al):Al(e,n)}}else o="";return!s&&isNaN(i)?o:i}function GG(r,e){const t=r.match(BH);if(!t)return;const n=t[1],s=t[3],i=t[4],o=t[5],a=t[6];n&&(e.fontStyle=n),s&&(e.fontWeight=isNaN(parseFloat(s))?s:parseFloat(s)),i&&(e.fontSize=Al(i)),a&&(e.fontFamily=a),o&&(e.lineHeight=o==="normal"?1:o)}function qG(r,e){r.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[n,s]=t.split(":");e[n.trim().toLowerCase()]=s.trim()})}function YG(r){const e={},t=r.getAttribute("style");return t&&(typeof t=="string"?qG(t,e):function(n,s){Object.entries(n).forEach(i=>{let[o,a]=i;a!==void 0&&(s[o.toLowerCase()]=a)})}(t,e)),e}const XG={stroke:"strokeOpacity",fill:"fillOpacity"};function ui(r,e,t){if(!r)return{};let n,s={},i=cT;r.parentNode&&Ib.test(r.parentNode.nodeName)&&(s=ui(r.parentElement,e,t),s.fontSize&&(n=i=Al(s.fontSize)));const o=V(V(V({},e.reduce((c,u)=>{const d=r.getAttribute(u);return d&&(c[u]=d),c},{})),function(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d={};for(const f in u)PG(c,f.split(" "))&&(d=V(V({},d),u[f]));return d}(r,t)),YG(r));o[Cv]&&r.setAttribute(Cv,o[Cv]),o[Tv]&&(n=Al(o[Tv],i),o[Tv]="".concat(n));const a={};for(const c in o){const u=RG(c),d=HG(u,o[c],s,n);a[u]=d}a&&a.font&&GG(a.font,a);const l=V(V({},s),a);return Ib.test(r.nodeName)?l:function(c){const u=ar.getDefaults();return Object.entries(XG).forEach(d=>{let[f,p]=d;if(c[p]===void 0||c[f]==="")return;if(c[f]===void 0){if(!u[f])return;c[f]=u[f]}if(c[f].indexOf("url(")===0)return;const m=new Ve(c[f]);c[f]=m.setAlpha(Ge(m.getAlpha()*c[p],2)).toRgba()}),c}(l)}const KG=["left","top","width","height","visible"],GD=["rx","ry"];class es extends ar{static getDefaults(){return V(V({},super.getDefaults()),es.ownDefaults)}constructor(e){super(),Object.assign(this,es.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:n}=this,s=-t/2,i=-n/2,o=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,n/2):0,l=o!==0||a!==0;e.beginPath(),e.moveTo(s+o,i),e.lineTo(s+t-o,i),l&&e.bezierCurveTo(s+t-mi*o,i,s+t,i+mi*a,s+t,i+a),e.lineTo(s+t,i+n-a),l&&e.bezierCurveTo(s+t,i+n-mi*a,s+t-mi*o,i+n,s+t-o,i+n),e.lineTo(s+o,i+n),l&&e.bezierCurveTo(s+mi*o,i+n,s,i+n-mi*a,s,i+n-a),e.lineTo(s,i+a),l&&e.bezierCurveTo(s,i+mi*a,s+mi*o,i,s+o,i),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...GD,...e])}_toSVG(){const{width:e,height:t,rx:n,ry:s}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(s,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,n){const s=ui(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:o=0,width:a=0,height:l=0,visible:c=!0}=s,u=Ze(s,KG);return new this(V(V(V({},t),u),{},{left:i,top:o,width:a,height:l,visible:!!(c&&a&&l)}))}}F(es,"type","Rect"),F(es,"cacheProperties",[...ci,...GD]),F(es,"ownDefaults",{rx:0,ry:0}),F(es,"ATTRIBUTE_NAMES",[...fo,"x","y","rx","ry","width","height"]),oe.setClass(es),oe.setSVGClass(es);const Vs="initialization",ng="added",xT="removed",sg="imperative",qD=(r,e)=>{const{strokeUniform:t,strokeWidth:n,width:s,height:i,group:o}=e,a=o&&o!==r?Ym(o.calcTransformMatrix(),r.calcTransformMatrix()):null,l=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),c=!e.isStrokeAccountedForInDimensions(),u=t&&c?NH(new U(n,n),void 0,r.calcTransformMatrix()):dT,d=!t&&c?n:0,f=mT(s+d,i+d,fT([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[l.subtract(f),l.add(f)]};class Qm{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:n,strategy:s}=e;return t===Vs||t===sg||!!n&&s!==n}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==Vs&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:n,target:s}=t;if(n===sg&&t.overrides)return t.overrides;if(e.length===0)return;const{left:i,top:o,width:a,height:l}=Hs(e.map(d=>qD(s,d)).reduce((d,f)=>d.concat(f),[])),c=new U(a,l),u=new U(i,o).add(c.scalarDivide(2));if(n===Vs){const d=this.getInitialSize(t,{size:c,center:u});return{center:u,relativeCorrection:new U(0,0),size:d}}return{center:u.transform(s.calcOwnMatrix()),size:c}}}F(Qm,"type","strategy");class R_ extends Qm{shouldPerformLayout(e){return!0}}F(R_,"type","fit-content"),oe.setClass(R_);const QG=["strategy"],JG=["target","strategy","bubbles","prevStrategy"],YD="layoutManager";class gh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new R_;F(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=V(V({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:n}=t;return[Qp,hD,uh,dD,Wm,fD,Kp,SH,TH].map(s=>e.on(s,i=>this.performLayout(s===Qp?{type:"object_modified",trigger:s,e:i,target:n}:{type:"object_modifying",trigger:s,e:i,target:n})))}subscribe(e,t){this.unsubscribe(e,t);const n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:n}=e,{canvas:s}=t;if(n===Vs||n===ng?this.subscribeTargets(e):n===xT&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),s&&s.fire("object:layout:before",{target:t,context:e}),n===sg&&e.deep){const i=Ze(e,QG);t.forEachObject(o=>o.layoutManager&&o.layoutManager.performLayout(V(V({},i),{},{bubbles:!1,target:o})))}}getLayoutResult(e){const{target:t,strategy:n,type:s}=e,i=n.calcLayoutResult(e,t.getObjects());if(!i)return;const o=s===Vs?new U:t.getRelativeCenterPoint(),{center:a,correction:l=new U,relativeCorrection:c=new U}=i,u=o.subtract(a).add(l).transform(s===Vs?_r:Mn(t.calcOwnMatrix()),!0).add(c);return{result:i,prevCenter:o,nextCenter:a,offset:u}}commitLayout(e,t){const{target:n}=e,{result:{size:s},nextCenter:i}=t;var o,a;n.set({width:s.x,height:s.y}),this.layoutObjects(e,t),e.type===Vs?n.set({left:(o=e.x)!==null&&o!==void 0?o:i.x+s.x*Ct(n.originX),top:(a=e.y)!==null&&a!==void 0?a:i.y+s.y*Ct(n.originY)}):(n.setPositionByOrigin(i,_e,_e),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){const{target:n}=e;n.forEachObject(s=>{s.group===n&&this.layoutObject(e,t,s)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:s}=t;n.set({left:n.left+s.x,top:n.top+s.y})}onAfterLayout(e,t){const{target:n,strategy:s,bubbles:i,prevStrategy:o}=e,a=Ze(e,JG),{canvas:l}=n;n.fire("layout:after",{context:e,result:t}),l&&l.fire("object:layout:after",{context:e,result:t,target:n});const c=n.parent;i&&c!=null&&c.layoutManager&&((a.path||(a.path=[])).push(n),c.layoutManager.performLayout(V(V({},a),{},{target:c}))),n.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(n=>n())),e.clear()}toObject(){return{type:YD,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}oe.setClass(gh,YD);const ZG=["type","objects","layoutManager"];class eq extends gh{performLayout(){}}class Ho extends pD(ar){static getDefaults(){return V(V({},super.getDefaults()),Ho.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),F(this,"_activeObjects",[]),F(this,"__objectSelectionTracker",void 0),F(this,"__objectSelectionDisposer",void 0),Object.assign(this,Ho.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var n;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(s=>{this.enterGroup(s,!1)}),this.layoutManager=(n=t.layoutManager)!==null&&n!==void 0?n:new gh,this.layoutManager.performLayout({type:Vs,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(ro("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(ro("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,n,s)=>this.canEnterGroup(t)&&s.indexOf(t)===n)}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const s=this._filterObjectsBeforeEnteringGroup(t),i=super.add(...s);return this._onAfterObjectsChange(ng,s),i}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];const i=this._filterObjectsBeforeEnteringGroup(n),o=super.insertAt(e,...i);return this._onAfterObjectsChange(ng,i),o}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(xT,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach(s=>{s._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t;const s=this._activeObjects;if(e)s.push(n),this._set("dirty",!0);else if(s.length>0){const i=s.indexOf(n);i>-1&&(s.splice(i,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&eg(e,qt(Mn(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(eg(e,qt(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){const e=ar.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,n){this._renderBackground(e);for(let i=0;i<this._objects.length;i++){var s;const o=this._objects[i];(s=this.canvas)!==null&&s!==void 0&&s.preserveObjectStacking&&o.group!==this?(e.save(),e.transform(...Mn(this.calcTransformMatrix())),o.render(e),e.restore()):o.group===this&&o.render(e)}this._drawClipPath(e,this.clipPath,n)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(V({target:this,type:sg},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const n=this.includeDefaultValues;return this._objects.filter(function(s){return!s.excludeFromExport}).map(function(s){const i=s.includeDefaultValues;s.includeDefaultValues=n;const o=s[e||"toObject"](t);return s.includeDefaultValues=i,o})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return V(V(V({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=es.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';const s=t.join("");return e?e(s):s}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let s=0;s<this._objects.length;s++)t.push("		",this._objects[s].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let s=0;s<this._objects.length;s++)t.push("	",this._objects[s].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:n,objects:s=[],layoutManager:i}=e,o=Ze(e,ZG);return Promise.all([hh(s,t),qm(o,t)]).then(a=>{let[l,c]=a;const u=new this(l,V(V(V({},o),c),{},{layoutManager:new eq}));if(i){const d=oe.getClass(i.type),f=oe.getClass(i.strategy);u.layoutManager=new d(new f)}else u.layoutManager=new gh;return u.layoutManager.subscribeTargets({type:Vs,target:u,targets:u.getObjects()}),u.setCoords(),u})}}F(Ho,"type","Group"),F(Ho,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),oe.setClass(Ho);const tq=(r,e)=>Math.min(e.width/r.width,e.height/r.height),rq=(r,e)=>Math.max(e.width/r.width,e.height/r.height),O_="\\s*,?\\s*",$c="".concat(O_,"(").concat(Nn,")"),nq="".concat($c).concat($c).concat($c).concat(O_,"([01])").concat(O_,"([01])").concat($c).concat($c),sq={m:"l",M:"L"},iq=(r,e,t,n,s,i,o,a,l,c,u)=>{const d=si(r),f=ii(r),p=si(e),m=ii(e),v=t*s*p-n*i*m+o,T=n*s*p+t*i*m+a;return["C",c+l*(-t*s*f-n*i*d),u+l*(-n*s*f+t*i*d),v+l*(t*s*m+n*i*p),T+l*(n*s*m-t*i*p),v,T]},Hb=(r,e,t,n)=>{const s=Math.atan2(e,r),i=Math.atan2(n,t);return i>=s?i-s:2*Math.PI-(s-i)};function Gb(r,e,t,n,s,i,o,a){let l;if(Ae.cachesBoundsOfCurve&&(l=[...arguments].join(),Su.boundsOfCurveCache[l]))return Su.boundsOfCurveCache[l];const c=Math.sqrt,u=Math.abs,d=[],f=[[0,0],[0,0]];let p=6*r-12*t+6*s,m=-3*r+9*t-9*s+3*o,v=3*t-3*r;for(let k=0;k<2;++k){if(k>0&&(p=6*e-12*n+6*i,m=-3*e+9*n-9*i+3*a,v=3*n-3*e),u(m)<1e-12){if(u(p)<1e-12)continue;const A=-v/p;0<A&&A<1&&d.push(A);continue}const O=p*p-4*v*m;if(O<0)continue;const M=c(O),x=(-p+M)/(2*m);0<x&&x<1&&d.push(x);const E=(-p-M)/(2*m);0<E&&E<1&&d.push(E)}let T=d.length;const w=T,y=XD(r,e,t,n,s,i,o,a);for(;T--;){const{x:k,y:O}=y(d[T]);f[0][T]=k,f[1][T]=O}f[0][w]=r,f[1][w]=e,f[0][w+1]=o,f[1][w+1]=a;const C=[new U(Math.min(...f[0]),Math.min(...f[1])),new U(Math.max(...f[0]),Math.max(...f[1]))];return Ae.cachesBoundsOfCurve&&(Su.boundsOfCurveCache[l]=C),C}const oq=(r,e,t)=>{let[n,s,i,o,a,l,c,u]=t;const d=((f,p,m,v,T,w,y)=>{if(m===0||v===0)return[];let C=0,k=0,O=0;const M=Math.PI,x=y*lT,E=ii(x),A=si(x),P=.5*(-A*f-E*p),R=.5*(-A*p+E*f),_=m**2,b=v**2,B=R**2,te=P**2,ue=_*b-_*B-b*te;let ge=Math.abs(m),Y=Math.abs(v);if(ue<0){const $t=Math.sqrt(1-ue/(_*b));ge*=$t,Y*=$t}else O=(T===w?-1:1)*Math.sqrt(ue/(_*B+b*te));const ce=O*ge*R/Y,he=-O*Y*P/ge,Ie=A*ce-E*he+.5*f,xe=E*ce+A*he+.5*p;let De=Hb(1,0,(P-ce)/ge,(R-he)/Y),vt=Hb((P-ce)/ge,(R-he)/Y,(-P-ce)/ge,(-R-he)/Y);w===0&&vt>0?vt-=2*M:w===1&&vt<0&&(vt+=2*M);const jt=Math.ceil(Math.abs(vt/M*2)),At=[],kt=vt/jt,Ta=8/3*Math.sin(kt/4)*Math.sin(kt/4)/Math.sin(kt/2);let Ts=De+kt;for(let $t=0;$t<jt;$t++)At[$t]=iq(De,Ts,A,E,ge,Y,Ie,xe,Ta,C,k),C=At[$t][5],k=At[$t][6],De=Ts,Ts+=kt;return At})(c-r,u-e,s,i,a,l,o);for(let f=0,p=d.length;f<p;f++)d[f][1]+=r,d[f][2]+=e,d[f][3]+=r,d[f][4]+=e,d[f][5]+=r,d[f][6]+=e;return d},aq=r=>{let e=0,t=0,n=0,s=0;const i=[];let o,a=0,l=0;for(const c of r){const u=[...c];let d;switch(u[0]){case"l":u[1]+=e,u[2]+=t;case"L":e=u[1],t=u[2],d=["L",e,t];break;case"h":u[1]+=e;case"H":e=u[1],d=["L",e,t];break;case"v":u[1]+=t;case"V":t=u[1],d=["L",e,t];break;case"m":u[1]+=e,u[2]+=t;case"M":e=u[1],t=u[2],n=u[1],s=u[2],d=["M",e,t];break;case"c":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t,u[5]+=e,u[6]+=t;case"C":a=u[3],l=u[4],e=u[5],t=u[6],d=["C",u[1],u[2],a,l,e,t];break;case"s":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"S":o==="C"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[3],t=u[4],d=["C",a,l,u[1],u[2],e,t],a=d[3],l=d[4];break;case"q":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"Q":a=u[1],l=u[2],e=u[3],t=u[4],d=["Q",a,l,e,t];break;case"t":u[1]+=e,u[2]+=t;case"T":o==="Q"?(a=2*e-a,l=2*t-l):(a=e,l=t),e=u[1],t=u[2],d=["Q",a,l,e,t];break;case"a":u[6]+=e,u[7]+=t;case"A":oq(e,t,u).forEach(f=>i.push(f)),e=u[6],t=u[7];break;case"z":case"Z":e=n,t=s,d=["Z"]}d?(i.push(d),o=d[0]):o=""}return i},ig=(r,e,t,n)=>Math.sqrt((t-r)**2+(n-e)**2),XD=(r,e,t,n,s,i,o,a)=>l=>{const c=l**3,u=(p=>3*p**2*(1-p))(l),d=(p=>3*p*(1-p)**2)(l),f=(p=>(1-p)**3)(l);return new U(o*c+s*u+t*d+r*f,a*c+i*u+n*d+e*f)},KD=r=>r**2,QD=r=>2*r*(1-r),JD=r=>(1-r)**2,lq=(r,e,t,n,s,i,o,a)=>l=>{const c=KD(l),u=QD(l),d=JD(l),f=3*(d*(t-r)+u*(s-t)+c*(o-s)),p=3*(d*(n-e)+u*(i-n)+c*(a-i));return Math.atan2(p,f)},cq=(r,e,t,n,s,i)=>o=>{const a=KD(o),l=QD(o),c=JD(o);return new U(s*a+t*l+r*c,i*a+n*l+e*c)},uq=(r,e,t,n,s,i)=>o=>{const a=1-o,l=2*(a*(t-r)+o*(s-t)),c=2*(a*(n-e)+o*(i-n));return Math.atan2(c,l)},qb=(r,e,t)=>{let n=new U(e,t),s=0;for(let i=1;i<=100;i+=1){const o=r(i/100);s+=ig(n.x,n.y,o.x,o.y),n=o}return s},hq=(r,e)=>{let t,n=0,s=0,i={x:r.x,y:r.y},o=V({},i),a=.01,l=0;const c=r.iterator,u=r.angleFinder;for(;s<e&&a>1e-4;)o=c(n),l=n,t=ig(i.x,i.y,o.x,o.y),t+s>e?(n-=a,a/=2):(i=o,n+=a,s+=t);return V(V({},o),{},{angle:u(l)})},ZD=r=>{let e,t,n=0,s=0,i=0,o=0,a=0;const l=[];for(const c of r){const u={x:s,y:i,command:c[0],length:0};switch(c[0]){case"M":t=u,t.x=o=s=c[1],t.y=a=i=c[2];break;case"L":t=u,t.length=ig(s,i,c[1],c[2]),s=c[1],i=c[2];break;case"C":e=XD(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),t=u,t.iterator=e,t.angleFinder=lq(s,i,c[1],c[2],c[3],c[4],c[5],c[6]),t.length=qb(e,s,i),s=c[5],i=c[6];break;case"Q":e=cq(s,i,c[1],c[2],c[3],c[4]),t=u,t.iterator=e,t.angleFinder=uq(s,i,c[1],c[2],c[3],c[4]),t.length=qb(e,s,i),s=c[3],i=c[4];break;case"Z":t=u,t.destX=o,t.destY=a,t.length=ig(s,i,o,a),s=o,i=a}n+=t.length,l.push(t)}return l.push({length:n,x:s,y:i}),l},dq=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ZD(r),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;const s=t[n],i=e/s.length,o=r[n];switch(s.command){case"M":return{x:s.x,y:s.y,angle:0};case"Z":return V(V({},new U(s.x,s.y).lerp(new U(s.destX,s.destY),i)),{},{angle:Math.atan2(s.destY-s.y,s.destX-s.x)});case"L":return V(V({},new U(s.x,s.y).lerp(new U(o[1],o[2]),i)),{},{angle:Math.atan2(o[2]-s.y,o[1]-s.x)});case"C":case"Q":return hq(s,e)}},fq=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),Yb=new RegExp(nq,"g"),pq=new RegExp(Nn,"gi"),gq={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},mq=r=>{var e;const t=[],n=(e=r.match(fq))!==null&&e!==void 0?e:[];for(const s of n){const i=s[0];if(i==="z"||i==="Z"){t.push([i]);continue}const o=gq[i.toLowerCase()];let a=[];if(i==="a"||i==="A"){Yb.lastIndex=0;for(let l=null;l=Yb.exec(s);)a.push(...l.slice(1))}else a=s.match(pq)||[];for(let l=0;l<a.length;l+=o){const c=new Array(o),u=sq[i];c[0]=l>0&&u?u:i;for(let d=0;d<o;d++)c[d+1]=parseFloat(a[l+d]);t.push(c)}}return t},yq=(r,e)=>r.map(t=>t.map((n,s)=>s===0||e===void 0?n:Ge(n,e)).join(" ")).join(" ");function D_(r,e){const t=r.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(n=>{let[s,i]=n;return t.setProperty(s,i)}))}class vq extends xD{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),F(this,"upper",void 0),F(this,"container",void 0);const{el:s}=this.lower,i=this.createUpperCanvas();this.upper={el:i,ctx:i.getContext("2d")},this.applyCanvasStyle(s,{allowTouchScrolling:t}),this.applyCanvasStyle(i,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const o=this.createContainerElement();o.classList.add(n),s.parentNode&&s.parentNode.replaceChild(o,s),o.append(s,i),this.container=o}createUpperCanvas(){const{el:e}=this.lower,t=oi();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=oc().createElement("div");return e.setAttribute("data-fabric","wrapper"),D_(e,{position:"relative"}),_b(e),e}applyCanvasStyle(e,t){const{styles:n,allowTouchScrolling:s}=t;D_(e,V(V({},n),{},{"touch-action":s?"manipulation":Mr})),_b(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:n,ctx:s}=this.upper;ED(n,s,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),x_(this.upper.el,e),x_(this.container,e)}cleanupDOM(e){const t=this.container,{el:n}=this.lower,{el:s}=this.upper;super.cleanupDOM(e),t.removeChild(s),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),ms().dispose(this.upper.el),delete this.upper,delete this.container}}class Jm extends Bh{constructor(){super(...arguments),F(this,"targets",[]),F(this,"_hoveredTargets",[]),F(this,"_objectsToRender",void 0),F(this,"_currentTransform",null),F(this,"_groupSelector",null),F(this,"contextTopDirty",!1)}static getDefaults(){return V(V({},super.getDefaults()),Jm.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new vq(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){const s=this.targetFindTolerance,i=this.pixelFindContext;this.clearContext(i),i.save(),i.translate(-t+s,-n+s),i.transform(...this.viewportTransform);const o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(i),e.selectionBackgroundColor=o,i.restore();const a=Math.round(s*this.getRetinaScaling());return TG(i,a,a,a)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(n=>!!n&&e[n]===!0):e[t])}_shouldClearSelection(e,t){const n=this.getActiveObjects(),s=this._activeObject;return!!(!t||t&&s&&n.length>1&&n.indexOf(t)===-1&&s!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&s&&s!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let s;return t===Hm||t===Lr||t===gn||t===uh?s=this.centeredScaling||e.centeredScaling:t===hT&&(s=this.centeredRotation||e.centeredRotation),s?!n:n}_getOriginFromCorner(e,t){const n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=dt:["mr","tr","br"].includes(t)&&(n.x=Me),["tl","mt","tr"].includes(t)?n.y=E_:["bl","mb","br"].includes(t)&&(n.y=Dr)),n}_setupCurrentTransform(e,t,n){var s;const i=t.group?bl(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:a}=t.getActiveControl()||{},l=n&&a?(s=a.getActionHandler(e,t,a))===null||s===void 0?void 0:s.bind(a):VH,c=((p,m,v,T)=>{if(!m||!p)return"drag";const w=T.controls[m];return w.getActionName(v,w,T)})(n,o,e,t),u=e[this.centeredKey],d=this._shouldCenterTransform(t,c,u)?{x:_e,y:_e}:this._getOriginFromCorner(t,o),f={target:t,action:c,actionHandler:l,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:i.x-t.left,offsetY:i.y-t.top,originX:d.x,originY:d.y,ex:i.x,ey:i.y,lastX:i.x,lastY:i.y,theta:gt(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:u,original:V(V({},bD(t)),{},{originX:d.x,originY:d.y})};this._currentTransform=f,this.fire("before:transform",{e,transform:f})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:n,deltaX:s,deltaY:i}=this._groupSelector,o=new U(t,n).transform(this.viewportTransform),a=new U(t+s,n+i).transform(this.viewportTransform),l=this.selectionLineWidth/2;let c=Math.min(o.x,a.x),u=Math.min(o.y,a.y),d=Math.max(o.x,a.x),f=Math.max(o.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(c,u,d-c,f-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,c+=l,u+=l,d-=l,f-=l,ar.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(c,u,d-c,f-u))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),n=this._activeObject,s=this.getActiveObjects();if(this.targets=[],n&&s.length>=1){if(n.findControl(t,b_(e))||s.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){const i=this.targets;this.targets=[];const o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==n?(this.targets=i,n):o}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords();const s=this.getZoom(),i=e.padding/s;if(i){const[o,a,l,c]=n,u=Math.atan2(a.y-o.y,a.x-o.x),d=si(u)*i,f=ii(u)*i,p=d+f,m=d-f;n=[new U(o.x-m,o.y-p),new U(a.x+p,a.y-m),new U(l.x+m,l.y+p),new U(c.x-p,c.y+m)]}return et.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,bl(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){const s=e[n];if(this._checkTarget(s,t)){if(Bf(s)&&s.subTargetCheck){const i=this._searchPossibleTargets(s._objects,t);i&&this.targets.push(i)}return s}}}searchPossibleTargets(e,t){const n=this._searchPossibleTargets(e,t);if(n&&Bf(n)&&n.interactive&&this.targets[0]){const s=this.targets;for(let i=s.length-1;i>0;i--){const o=s[i];if(!Bf(o)||!o.interactive)return o}return s[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const n=this.upperCanvasEl,s=n.getBoundingClientRect();let i=RH(e),o=s.width||0,a=s.height||0;o&&a||(Dr in s&&E_ in s&&(a=Math.abs(s.top-s.bottom)),dt in s&&Me in s&&(o=Math.abs(s.right-s.left))),this.calcOffset(),i.x=i.x-this._offset.left,i.y=i.y-this._offset.top,t||(i=bl(i,void 0,this.viewportTransform));const l=this.getRetinaScaling();l!==1&&(i.x/=l,i.y/=l);const c=o===0||a===0?new U(1,1):new U(n.width/o,n.height/a);return i.multiply(c)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=oi(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return ko(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,s=!1;const i=this.getActiveObjects(),o=[],a=[];e.forEach(l=>{i.includes(l)||(n=!0,l.fire("deselected",{e:t,target:l}),a.push(l))}),i.forEach(l=>{e.includes(l)||(n=!0,l.fire("selected",{e:t,target:l}),o.push(l))}),e.length>0&&i.length>0?(s=!0,n&&this.fire("selection:updated",{e:t,selected:o,deselected:a})):i.length>0?(s=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(s=!0,this.fire("selection:cleared",{e:t,deselected:a})),s&&(this._objectsToRender=void 0)}setActiveObject(e,t){const n=this.getActiveObjects(),s=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),s}_setActiveObject(e,t){const n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,ko(e)&&n!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),ko(n)&&n===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});const s=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),s}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,n=t.target,s={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",s),n.fire(Qp,s))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;ko(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){const s=this._realizeGroupTransformOnObject(e),i=super._toObject(e,t,n);return e.set(s),i}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&ko(t)&&this._activeObject===t){const n=uc(e,["angle","flipX","flipY",Me,Lr,gn,ac,lc,Dr]);return DH(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){const s=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(s)}}F(Jm,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class _q{constructor(e){F(this,"targets",[]),F(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:s}=e.getActiveObject()||{};s&&s.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Xa(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const wq=["target","oldTarget","fireCanvas","e"],jr={passive:!1},Ua=(r,e)=>{const t=r.getViewportPoint(e),n=r.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},yi=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.addEventListener(...t)},tn=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return r.removeEventListener(...t)},Sq={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class M_ extends Jm{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),F(this,"_isClick",void 0),F(this,"textEditingManager",new _q(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(yi,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const n=this.upperCanvasEl,s=this._getEventPrefix();e(CD(n),"resize",this._onResize),e(n,s+"down",this._onMouseDown),e(n,"".concat(s,"move"),this._onMouseMove,jr),e(n,"".concat(s,"out"),this._onMouseOut),e(n,"".concat(s,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"click",this._onClick),e(n,"dblclick",this._onClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,jr)}removeListeners(){this.addOrRemove(tn,"remove");const e=this._getEventPrefix(),t=In(this.upperCanvasEl);tn(t,"".concat(e,"up"),this._onMouseUp),tn(t,"touchend",this._onTouchEnd,jr),tn(t,"".concat(e,"move"),this._onMouseMove,jr),tn(t,"touchmove",this._onMouseMove,jr),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,n=V({e},Ua(this,e));this.fire("mouse:out",V(V({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",V({},n)),this._hoveredTargets.forEach(s=>{this.fire("mouse:out",V(V({},n),{},{target:s})),s&&s.fire("mouseout",V({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",V({e},Ua(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void yi(this.upperCanvasEl,"drag",this._onDragProgress)}wb(e)}_renderDragEffects(e,t,n){let s=!1;const i=this._dropTarget;i&&i!==t&&i!==n&&(i.clearContextTop(),s=!0),t==null||t.clearContextTop(),n!==t&&(n==null||n.clearContextTop());const o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),s=!0),n&&(o.save(),n.transform(o),n.renderDropTargetEffect(e),o.restore(),s=!0),o.restore(),s&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==Mr,n=t?this._activeObject:void 0,s={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};tn(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",s),this._dragSource&&this._dragSource.fire("dragend",s),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:n,targets:s}=this.findDragTargets(e),i=this._dragSource,o={e,target:n,subTargets:s,dragSource:i,canDrop:!1,dropTarget:void 0};let a;this.fire(t,o),this._fireEnterLeaveEvents(n,o),n&&(n.canDrop(e)&&(a=n),n.fire(t,o));for(let l=0;l<s.length;l++){const c=s[l];c.canDrop(e)&&(a=c),c.fire(t,o)}this._renderDragEffects(e,i,a),this._dropTarget=a}_onDragEnter(e){const{target:t,targets:n}=this.findDragTargets(e),s={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",s),this._fireEnterLeaveEvents(t,s)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:n}=this.findDragTargets(e),s=this._basicEventHandler("drop:before",V({e,target:t,subTargets:n,dragSource:this._dragSource},Ua(this,e)));s.didDrop=!1,s.dropTarget=void 0,this._basicEventHandler("drop",s),this.fire("drop:after",s)}_onContextMenu(e){const t=this.findTarget(e),n=this.targets||[],s=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&wb(e),this._basicEventHandler("contextmenu",s),!1}_onClick(e){const t=e.detail;t>3||t<2||(this._cacheTransformEventData(e),t==2&&e.type==="dblclick"&&this._handleEvent(e,"dblclick"),t==3&&this._handleEvent(e,"tripleclick"),this._resetTransformEventData())}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const n=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||n&&this._target===n)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const s=this.upperCanvasEl,i=this._getEventPrefix(),o=In(s);yi(o,"touchend",this._onTouchEnd,jr),t&&yi(o,"touchmove",this._onMouseMove,jr),tn(s,"".concat(i,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();tn(t,"".concat(n,"move"),this._onMouseMove,jr);const s=In(t);yi(s,"".concat(n,"up"),this._onMouseUp),yi(s,"".concat(n,"move"),this._onMouseMove,jr)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),n=In(this.upperCanvasEl);tn(n,"touchend",this._onTouchEnd,jr),tn(n,"touchmove",this._onMouseMove,jr),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{yi(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){const s=In(this.upperCanvasEl);tn(s,"".concat(n,"up"),this._onMouseUp),tn(s,"".concat(n,"move"),this._onMouseMove,jr),yi(t,"".concat(n,"move"),this._onMouseMove,jr)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const n=this._currentTransform,s=this._isClick,i=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,l,c=!1;if(n&&(this._finalizeCurrentTransform(e),c=n.actionPerformed),!s){const u=i===this._activeObject;this.handleSelection(e),c||(c=this._shouldRender(i)||!u&&i===this._activeObject)}if(i){const u=i.findControl(this.getViewportPoint(e),b_(e)),{key:d,control:f}=u||{};if(l=d,i.selectable&&i!==this._activeObject&&i.activeOn==="up")this.setActiveObject(i,e),c=!0;else if(f){const p=f.getMouseUpHandler(e,i,f);p&&(a=this.getScenePoint(e),p.call(f,e,n,a.x,a.y))}i.isMoving=!1}if(n&&(n.target!==i||n.corner!==l)){const u=n.target&&n.target.controls[n.corner],d=u&&u.getMouseUpHandler(e,n.target,u);a=a||this.getScenePoint(e),d&&d.call(u,e,n,a.x,a.y)}this._setCursorFromEvent(e,i),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,i&&(i.__corner=void 0),c?this.requestRenderAll():s||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:n,subTargets:s=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let i=0;i<s.length;i++)s[i]!==n&&s[i].fire(e,t);return t}_handleEvent(e,t,n){const s=this._target,i=this.targets||[],o=V(V(V({e,target:s,subTargets:i},Ua(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{}),t==="down:before"||t==="down"?n:{});this.fire("mouse:".concat(t),o),s&&s.fire("mouse".concat(t),o);for(let a=0;a<i.length;a++)i[a]!==s&&i[a].fire("mouse".concat(t),o)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down",{alreadySelected:!1})}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,n=!!t&&t===this._activeObject;const{button:s}=e;if(s)return(this.fireMiddleClick&&s===1||this.fireRightClick&&s===2)&&this._handleEvent(e,"down",{alreadySelected:n}),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let i=this._shouldRender(t),o=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,o=!0,i=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const a=this.getScenePoint(e);this._groupSelector={x:a.x,y:a.y,deltaY:0,deltaX:0}}if(n=!!t&&t===this._activeObject,t){t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const a=t.findControl(this.getViewportPoint(e),b_(e));if(t===this._activeObject&&(a||!o)){this._setupCurrentTransform(e,t,n);const l=a?a.control:void 0,c=this.getScenePoint(e),u=l&&l.getMouseDownHandler(e,t,l);u&&u.call(l,e,this._currentTransform,c.x,c.y)}}i&&(this._objectsToRender=void 0),this._handleEvent(e,"down",{alreadySelected:n}),i&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=bl(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const n=this._hoveredTarget,s=this._hoveredTargets,i=this.targets,o=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("mouse",{e,target:i[a],oldTarget:s[a]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const n=this._draggedoverTarget,s=this._hoveredTargets,i=this.targets,o=Math.max(s.length,i.length);this.fireSyntheticInOutEvents("drag",V(V({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",V(V({},t),{},{target:i[a],oldTarget:s[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:s,fireCanvas:i,e:o}=t,a=Ze(t,wq);const{targetIn:l,targetOut:c,canvasIn:u,canvasOut:d}=Sq[e],f=s!==n;if(s&&f){const p=V(V({},a),{},{e:o,target:s,nextTarget:n},Ua(this,o));i&&this.fire(d,p),s.fire(c,p)}if(n&&f){const p=V(V({},a),{},{e:o,target:n,previousTarget:s},Ua(this,o));i&&this.fire(u,p),n.fire(l,p)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),n=this._currentTransform,s=n.target,i=s.group?bl(t,void 0,s.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,i),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){const{action:s,actionHandler:i,target:o}=t,a=!!i&&i(e,t,n.x,n.y);a&&o.setCoords(),s==="drag"&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor;const s=ko(this._activeObject)?this._activeObject:null,i=(!s||t.group!==s)&&t.findControl(this.getViewportPoint(e));if(i){const o=i.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(o=>{n=o.hoverCursor||n}),this.setCursor(n)}handleMultiSelection(e,t){const n=this._activeObject,s=ko(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||s)&&(s||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(s){const i=n.getObjects();if(t===n){const o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(i,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(i,e)}else{n.isEditing&&n.exitEditing();const i=new(oe.getClass("ActiveSelection"))([],{canvas:this});i.multiSelectAdd(n,t),this._hoveredTarget=i,this._setActiveObject(i,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:n,deltaX:s,deltaY:i}=this._groupSelector,o=new U(t,n),a=o.add(new U(s,i)),l=o.min(a),c=o.max(a).subtract(l),u=this.collectObjects({left:l.x,top:l.y,width:c.x,height:c.y},{includeIntersecting:!this.selectionFullyContained}),d=o.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter(f=>!f.onSelect({e})).reverse():u;if(d.length===1)this.setActiveObject(d[0],e);else if(d.length>1){const f=oe.getClass("ActiveSelection");this.setActiveObject(new f(d,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const eM={x1:0,y1:0,x2:0,y2:0},Tq=V(V({},eM),{},{r1:0,r2:0}),cl=(r,e)=>isNaN(r)&&typeof e=="number"?e:r,Cq=/^(\d+\.\d+)%|(\d+)%$/;function tM(r){return r&&Cq.test(r)}function rM(r,e){const t=typeof r=="number"?r:typeof r=="string"?parseFloat(r)/(tM(r)?100:1):NaN;return Hl(0,cl(t,e),1)}const Eq=/\s*;\s*/,xq=/\s*:\s*/;function bq(r,e){let t,n;const s=r.getAttribute("style");if(s){const o=s.split(Eq);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){const[l,c]=o[a].split(xq).map(u=>u.trim());l==="stop-color"?t=c:l==="stop-opacity"&&(n=c)}}const i=new Ve(t||r.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:rM(r.getAttribute("offset"),0),color:i.toRgb(),opacity:cl(parseFloat(n||r.getAttribute("stop-opacity")||""),1)*i.getAlpha()*e}}function Aq(r,e){const t=[],n=r.getElementsByTagName("stop"),s=rM(e,1);for(let i=n.length;i--;)t.push(bq(n[i],s));return t}function nM(r){return r.nodeName==="linearGradient"||r.nodeName==="LINEARGRADIENT"?"linear":"radial"}function sM(r){return r.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Sn(r,e){return r.getAttribute(e)}function kq(r,e){return function(t,n){let s,{width:i,height:o,gradientUnits:a}=n;return Object.keys(t).reduce((l,c)=>{const u=t[c];return u==="Infinity"?s=1:u==="-Infinity"?s=0:(s=typeof u=="string"?parseFloat(u):u,typeof u=="string"&&tM(u)&&(s*=.01,a==="pixels"&&(c!=="x1"&&c!=="x2"&&c!=="r2"||(s*=i),c!=="y1"&&c!=="y2"||(s*=o)))),l[c]=s,l},{})}(nM(r)==="linear"?function(t){return{x1:Sn(t,"x1")||0,y1:Sn(t,"y1")||0,x2:Sn(t,"x2")||"100%",y2:Sn(t,"y2")||0}}(r):function(t){return{x1:Sn(t,"fx")||Sn(t,"cx")||"50%",y1:Sn(t,"fy")||Sn(t,"cy")||"50%",r1:0,x2:Sn(t,"cx")||"50%",y2:Sn(t,"cy")||"50%",r2:Sn(t,"r")||"50%"}}(r),V(V({},e),{},{gradientUnits:sM(r)}))}class $d{constructor(e){const{type:t="linear",gradientUnits:n="pixels",coords:s={},colorStops:i=[],offsetX:o=0,offsetY:a=0,gradientTransform:l,id:c}=e||{};Object.assign(this,{type:t,gradientUnits:n,coords:V(V({},t==="radial"?Tq:eM),s),colorStops:i,offsetX:o,offsetY:a,gradientTransform:l,id:c?"".concat(c,"_").concat(no()):no()})}addColorStop(e){for(const t in e){const n=new Ve(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return V(V({},uc(this,e)),{},{type:this.type,coords:V({},this.coords),colorStops:this.colorStops.map(t=>V({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=[],s=this.gradientTransform?this.gradientTransform.concat():_r.concat(),i=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(d=>V({},d)).sort((d,f)=>d.offset-f.offset);let a=-this.offsetX,l=-this.offsetY;var c;i==="objectBoundingBox"?(a/=e.width,l/=e.height):(a+=e.width/2,l+=e.height/2),(c=e)&&typeof c._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,l-=e.pathOffset.y),s[4]-=a,s[5]-=l;const u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(i,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(dh(s),'"'),""].join(" ");if(this.type==="linear"){const{x1:d,y1:f,x2:p,y2:m}=this.coords;n.push("<linearGradient ",u,' x1="',d,'" y1="',f,'" x2="',p,'" y2="',m,`">
`)}else if(this.type==="radial"){const{x1:d,y1:f,x2:p,y2:m,r1:v,r2:T}=this.coords,w=v>T;n.push("<radialGradient ",u,' cx="',w?d:p,'" cy="',w?f:m,'" r="',w?v:T,'" fx="',w?p:d,'" fy="',w?m:f,`">
`),w&&(o.reverse(),o.forEach(C=>{C.offset=1-C.offset}));const y=Math.min(v,T);if(y>0){const C=y/Math.max(v,T);o.forEach(k=>{k.offset+=C*(1-k.offset)})}}return o.forEach(d=>{let{color:f,offset:p,opacity:m}=d;n.push("<stop ",'offset="',100*p+"%",'" style="stop-color:',f,m!==void 0?";stop-opacity: "+m:";",`"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){const{x1:t,y1:n,x2:s,y2:i,r1:o,r2:a}=this.coords,l=this.type==="linear"?e.createLinearGradient(t,n,s,i):e.createRadialGradient(t,n,o,s,i,a);return this.colorStops.forEach(c=>{let{color:u,opacity:d,offset:f}=c;l.addColorStop(f,d!==void 0?new Ve(u).setAlpha(d).toRgba():u)}),l}static async fromObject(e){const{colorStops:t,gradientTransform:n}=e;return new this(V(V({},e),{},{colorStops:t?t.map(s=>V({},s)):void 0,gradientTransform:n?[...n]:void 0}))}static fromElement(e,t,n){const s=sM(e),i=t._findCenterFromElement();return new this(V({id:e.getAttribute("id")||void 0,type:nM(e),coords:kq(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:Aq(e,n.opacity),gradientUnits:s,gradientTransform:P_(e.getAttribute("gradientTransform")||"")},s==="pixels"?{offsetX:t.width/2-i.x,offsetY:t.height/2-i.y}:{offsetX:0,offsetY:0}))}}F($d,"type","Gradient"),oe.setClass($d,"gradient"),oe.setClass($d,"linear"),oe.setClass($d,"radial");const Iq=["type","source","patternTransform"];class bv{get type(){return"pattern"}set type(e){ro("warn","Setting type has no effect",e)}constructor(e){F(this,"repeat","repeat"),F(this,"offsetX",0),F(this,"offsetY",0),F(this,"crossOrigin",""),this.id=no(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:n}=this;return V(V({},uc(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:Ge(this.offsetX,Ae.NUM_FRACTION_DIGITS),offsetY:Ge(this.offsetY,Ae.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e;const{source:s,repeat:i,id:o}=this,a=cl(this.offsetX/t,0),l=cl(this.offsetY/n,0),c=i==="repeat-y"||i==="no-repeat"?1+Math.abs(a||0):cl(s.width/t,0),u=i==="repeat-x"||i==="no-repeat"?1+Math.abs(l||0):cl(s.height/n,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(l,'" width="').concat(c,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(s.width,'" height="').concat(s.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:n,source:s,patternTransform:i}=e,o=Ze(e,Iq);const a=await Wf(s,V(V({},t),{},{crossOrigin:o.crossOrigin}));return new this(V(V({},o),{},{patternTransform:i&&i.slice(0),source:a}))}}F(bv,"type","Pattern"),oe.setClass(bv),oe.setClass(bv,"pattern");const Pq=["path","left","top"],Rq=["d"];class Io extends ar{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:s,top:i}=t,o=Ze(t,Pq);super(),Object.assign(this,Io.ownDefaults),this.setOptions(o),this._setPath(e||[],!0),typeof s=="number"&&this.set(Me,s),typeof i=="number"&&this.set(Dr,i)}_setPath(e,t){this.path=aq(Array.isArray(e)?e:mq(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new U(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(const s of this.path)switch(s[0]){case"L":e.lineTo(s[1]+t,s[2]+n);break;case"M":e.moveTo(s[1]+t,s[2]+n);break;case"C":e.bezierCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n,s[5]+t,s[6]+n);break;case"Q":e.quadraticCurveTo(s[1]+t,s[2]+n,s[3]+t,s[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return V(V({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=yq(this.path,Ae.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Ae.NUM_FRACTION_DIGITS;return" translate(".concat(Ge(-this.pathOffset.x,e),", ").concat(Ge(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:n,pathOffset:s}=this._calcDimensions();this.set({width:t,height:n,pathOffset:s}),e&&this.setPositionByOrigin(s,_e,_e)}_calcBoundsFromPath(){const e=[];let t=0,n=0,s=0,i=0;for(const o of this.path)switch(o[0]){case"L":s=o[1],i=o[2],e.push({x:t,y:n},{x:s,y:i});break;case"M":s=o[1],i=o[2],t=s,n=i;break;case"C":e.push(...Gb(s,i,o[1],o[2],o[3],o[4],o[5],o[6])),s=o[5],i=o[6];break;case"Q":e.push(...Gb(s,i,o[1],o[2],o[1],o[2],o[3],o[4])),s=o[3],i=o[4];break;case"Z":s=t,i=n}return Hs(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return V(V({},e),{},{pathOffset:new U(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,n){const s=ui(e,this.ATTRIBUTE_NAMES,n),{d:i}=s;return new this(i,V(V(V({},Ze(s,Rq)),t),{},{left:void 0,top:void 0}))}}F(Io,"type","Path"),F(Io,"cacheProperties",[...ci,"path","fillRule"]),F(Io,"ATTRIBUTE_NAMES",[...fo,"d"]),oe.setClass(Io),oe.setSVGClass(Io);const Oq=["left","top","radius"],iM=["radius","startAngle","endAngle","counterClockwise"];class Rs extends ar{static getDefaults(){return V(V({},super.getDefaults()),Rs.ownDefaults)}constructor(e){super(),Object.assign(this,Rs.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,gt(this.startAngle),gt(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(Lr)}getRadiusY(){return this.get("radius")*this.get(gn)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...iM,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,n=gt(this.startAngle),s=gt(this.endAngle),i=si(n)*t,o=ii(n)*t,a=si(s)*t,l=ii(s)*t,c=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(i," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(c," ").concat(u," ").concat(a," ").concat(l,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,n){const s=ui(e,this.ATTRIBUTE_NAMES,n),{left:i=0,top:o=0,radius:a=0}=s;return new this(V(V({},Ze(s,Oq)),{},{radius:a,left:i-a,top:o-a}))}static fromObject(e){return super._fromObject(e)}}F(Rs,"type","Circle"),F(Rs,"cacheProperties",[...ci,...iM]),F(Rs,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),F(Rs,"ATTRIBUTE_NAMES",["cx","cy","r",...fo]),oe.setClass(Rs),oe.setSVGClass(Rs);const Dq=["x1","y1","x2","y2"],Mq=["x1","y1","x2","y2"],N_=["x1","x2","y1","y2"];class Po extends ar{constructor(){let[e,t,n,s]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,Po.ownDefaults),this.setOptions(i),this.x1=e,this.x2=n,this.y1=t,this.y2=s,this._setWidthHeight();const{left:o,top:a}=i;typeof o=="number"&&this.set(Me,o),typeof a=="number"&&this.set(Dr,a)}_setWidthHeight(){const{x1:e,y1:t,x2:n,y2:s}=this;this.width=Math.abs(n-e),this.height=Math.abs(s-t);const{left:i,top:o,width:a,height:l}=Hs([{x:e,y:t},{x:n,y:s}]),c=new U(i+a/2,o+l/2);this.setPositionByOrigin(c,_e,_e)}_set(e,t){return super._set(e,t),N_.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const n=e.strokeStyle;var s;an(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(s=this.stroke)!==null&&s!==void 0?s:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new U((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return V(V({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:n,y2:s,width:i,height:o}=this,a=e<=t?-1:1,l=n<=s?-1:1;return{x1:a*i/2,x2:a*-i/2,y1:l*o/2,y2:l*-o/2}}_toSVG(){const{x1:e,x2:t,y1:n,y2:s}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(s,`" />
`)]}static async fromElement(e,t,n){const s=ui(e,this.ATTRIBUTE_NAMES,n),{x1:i=0,y1:o=0,x2:a=0,y2:l=0}=s;return new this([i,o,a,l],Ze(s,Dq))}static fromObject(e){let{x1:t,y1:n,x2:s,y2:i}=e,o=Ze(e,Mq);return this._fromObject(V(V({},o),{},{points:[t,n,s,i]}),{extraParam:"points"})}}F(Po,"type","Line"),F(Po,"cacheProperties",[...ci,...N_]),F(Po,"ATTRIBUTE_NAMES",fo.concat(N_)),oe.setClass(Po),oe.setSVGClass(Po);class Lo extends ar{static getDefaults(){return V(V({},super.getDefaults()),Lo.ownDefaults)}constructor(e){super(),Object.assign(this,Lo.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}F(Lo,"type","Triangle"),F(Lo,"ownDefaults",{width:100,height:100}),oe.setClass(Lo),oe.setSVGClass(Lo);const oM=["rx","ry"];class Os extends ar{static getDefaults(){return V(V({},super.getDefaults()),Os.ownDefaults)}constructor(e){super(),Object.assign(this,Os.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(Lr)}getRy(){return this.get("ry")*this.get(gn)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...oM,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Xp,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,n){const s=ui(e,this.ATTRIBUTE_NAMES,n);return s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,new this(s)}}function Nq(r){if(!r)return[];const e=r.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}F(Os,"type","Ellipse"),F(Os,"cacheProperties",[...ci,...oM]),F(Os,"ownDefaults",{rx:0,ry:0}),F(Os,"ATTRIBUTE_NAMES",[...fo,"cx","cy","rx","ry"]),oe.setClass(Os),oe.setSVGClass(Os);const Fq=["left","top"],aM={exactBoundingBox:!1};class bn extends ar{static getDefaults(){return V(V({},super.getDefaults()),bn.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),F(this,"strokeDiff",void 0),Object.assign(this,bn.ownDefaults),this.setOptions(t),this.points=e;const{left:n,top:s}=t;this.initialized=!0,this.setBoundingBox(!0),typeof n=="number"&&this.set(Me,n),typeof s=="number"&&this.set(Dr,s)}isOpen(){return!0}_projectStrokeOnPoints(e){return EG(this.points,e,this.isOpen())}_calcDimensions(e){e=V({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(c=>c.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new U,strokeOffset:new U,strokeDiff:new U};const n=Hs(t),s=Gm(V(V({},e),{},{scaleX:1,scaleY:1})),i=Hs(this.points.map(c=>xr(c,s,!0))),o=new U(this.scaleX,this.scaleY);let a=n.left+n.width/2,l=n.top+n.height/2;return this.exactBoundingBox&&(a-=l*Math.tan(gt(this.skewX)),l-=a*Math.tan(gt(this.skewY))),V(V({},n),{},{pathOffset:new U(a,l),strokeOffset:new U(i.left,i.top).subtract(new U(n.left,n.top)).multiply(o),strokeDiff:new U(n.width,n.height).subtract(new U(i.width,i.height)).multiply(o)})}_findCenterFromElement(){const e=Hs(this.points);return new U(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:n,width:s,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}=this._calcDimensions();this.set({width:s,height:i,pathOffset:o,strokeOffset:a,strokeDiff:l}),e&&this.setPositionByOrigin(new U(t+s/2,n+i/2),_e,_e)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new U(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var t,n;const{width:a,height:l}=this._calcDimensions(e);o=new U((t=e.width)!==null&&t!==void 0?t:a,(n=e.height)!==null&&n!==void 0?n:l)}else{var s,i;o=new U((s=e.width)!==null&&s!==void 0?s:this.width,(i=e.height)!==null&&i!==void 0?i:this.height)}return o.multiply(new U(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const n=this.initialized&&this[e]!==t,s=super._set(e,t);return this.exactBoundingBox&&n&&((e===Lr||e===gn)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),s}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return V(V({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:n,y:s}=t;return{x:n,y:s}})})}_toSVG(){const e=[],t=this.pathOffset.x,n=this.pathOffset.y,s=Ae.NUM_FRACTION_DIGITS;for(let i=0,o=this.points.length;i<o;i++)e.push(Ge(this.points[i].x-t,s),",",Ge(this.points[i].y-n,s)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,n=this.pathOffset.x,s=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-s);for(let i=0;i<t;i++){const o=this.points[i];e.lineTo(o.x-n,o.y-s)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,n){return new this(Nq(e.getAttribute("points")),V(V({},Ze(ui(e,this.ATTRIBUTE_NAMES,n),Fq)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}F(bn,"ownDefaults",aM),F(bn,"type","Polyline"),F(bn,"layoutProperties",[ac,lc,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),F(bn,"cacheProperties",[...ci,"points"]),F(bn,"ATTRIBUTE_NAMES",[...fo]),oe.setClass(bn),oe.setSVGClass(bn);class Ud extends bn{isOpen(){return!1}}F(Ud,"ownDefaults",aM),F(Ud,"type","Polygon"),oe.setClass(Ud),oe.setSVGClass(Ud);class lM extends ar{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const n in t)for(const s in t[n])for(const i in t[n][s])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const n=t===void 0?this.styles:{0:this.styles[t]};for(const s in n)for(const i in n[s])if(n[s][i][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let n,s,i=0,o=!0,a=0;for(const l in t){n=0;for(const c in t[l]){const u=t[l][c]||{};i++,u[e]!==void 0?(s?u[e]!==s&&(o=!1):s=u[e],u[e]===this[e]&&delete u[e]):o=!1,Object.keys(u).length!==0?n++:delete t[l][c]}n===0&&delete t[l]}for(let l=0;l<this._textLines.length;l++)a+=this._textLines[l].length;o&&i===a&&(this[e]=s,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let n,s,i;for(s in t){for(i in n=t[s],n)delete n[i][e],Object.keys(n[i]).length===0&&delete n[i];Object.keys(n).length===0&&delete t[s]}}_extendStyles(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);const i=gT(V(V({},this._getStyleDeclaration(n,s)),t),o=>o!==void 0);this._setStyleDeclaration(n,s,i)}getSelectionStyles(e,t,n){const s=[];for(let i=e;i<(t||e);i++)s.push(this.getStyleAtPosition(i,n));return s}getStyleAtPosition(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,s):this._getStyleDeclaration(n,s)}setSelectionStyles(e,t,n){for(let s=t;s<(n||t);s++)this._extendStyles(s,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;const s=this.styles&&this.styles[e];return s&&(n=s[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return V(V({},uc(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}F(lM,"_styleProperties",$H);const Lq=/  +/g,Vq=/"/g;function Av(r,e,t,n,s){return"		".concat(function(i,o){let{left:a,top:l,width:c,height:u}=o,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ae.NUM_FRACTION_DIGITS;const f=fh(Ot,i,!1),[p,m,v,T]=[a,l,c,u].map(w=>Ge(w,d));return"<rect ".concat(f,' x="').concat(p,'" y="').concat(m,'" width="').concat(v,'" height="').concat(T,'"></rect>')}(r,{left:e,top:t,width:n,height:s}),`
`)}const jq=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let kv;class fr extends lM{static getDefaults(){return V(V({},super.getDefaults()),fr.ownDefaults)}constructor(e,t){super(),F(this,"__charBounds",[]),Object.assign(this,fr.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=ZD(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(rs)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,s,i,o,a;for(let l=0,c=this._textLines.length;l<c;l++)if((this.textAlign===rs||l!==c-1&&!this.isEndOfWrapping(l))&&(s=0,i=this._textLines[l],t=this.getLineWidth(l),t<this.width&&(a=this.textLines[l].match(this._reSpacesAndTabs)))){n=a.length,e=(this.width-t)/n;for(let u=0;u<=i.length;u++)o=this.__charBounds[l][u],this._reSpaceAndTab.test(i[u])?(o.width+=e,o.kernedWidth+=e,o.left+=s,s+=e):o.left+=s}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const n=t?this._unwrappedTextLines:this._textLines;let s;for(s=0;s<n.length;s++){if(e<=n[s].length)return{lineIndex:s,charIndex:e};e-=n[s].length+this.missingNewlineOffset(s,t)}return{lineIndex:s-1,charIndex:n[s-1].length<e?n[s-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===Nr?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case _e:e.textBaseline="middle";break;case"ascender":e.textBaseline=Dr;break;case"descender":e.textBaseline=E_}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){const s=this.getLineWidth(t);s>e&&(e=s)}return e}_renderTextLine(e,t,n,s,i,o){this._renderChars(e,t,n,s,i,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,n=this._getLeftOffset();let s=this._getTopOffset();for(let i=0,o=this._textLines.length;i<o;i++){const a=this.getHeightOfLine(i);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",i)){s+=a;continue}const l=this._textLines[i].length,c=this._getLineLeftOffset(i);let u,d,f=0,p=0,m=this.getValueOfPropertyAt(i,0,"textBackgroundColor");for(let v=0;v<l;v++){const T=this.__charBounds[i][v];d=this.getValueOfPropertyAt(i,v,"textBackgroundColor"),this.path?(e.save(),e.translate(T.renderLeft,T.renderTop),e.rotate(T.angle),e.fillStyle=d,d&&e.fillRect(-T.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),T.width,a/this.lineHeight),e.restore()):d!==m?(u=n+c+p,this.direction==="rtl"&&(u=this.width-u-f),e.fillStyle=m,m&&e.fillRect(u,s,f,a/this.lineHeight),p=T.left,f=T.width,m=d):f+=T.kernedWidth}d&&!this.path&&(u=n+c+p,this.direction==="rtl"&&(u=this.width-u-f),e.fillStyle=d,e.fillRect(u,s,f,a/this.lineHeight)),s+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,s){const i=Su.getFontCache(t),o=this._getFontDeclaration(t),a=n+e,l=n&&o===this._getFontDeclaration(s),c=t.fontSize/this.CACHE_FONT_SIZE;let u,d,f,p;if(n&&i[n]!==void 0&&(f=i[n]),i[e]!==void 0&&(p=u=i[e]),l&&i[a]!==void 0&&(d=i[a],p=d-f),u===void 0||f===void 0||d===void 0){const m=function(){return kv||(kv=mn({width:0,height:0}).getContext("2d")),kv}();this._setTextStyles(m,t,!0),u===void 0&&(p=u=m.measureText(e).width,i[e]=u),f===void 0&&l&&n&&(f=m.measureText(n).width,i[n]=f),l&&d===void 0&&(d=m.measureText(a).width,i[a]=d,p=d-f)}return{width:u*c,kernedWidth:p*c}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,s=0;const i=this.pathSide===dt,o=this.path,a=this._textLines[e],l=a.length,c=new Array(l);this.__charBounds[e]=c;for(let u=0;u<l;u++){const d=a[u];n=this._getGraphemeBox(d,e,u,t),c[u]=n,s+=n.kernedWidth,t=d}if(c[l]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let u=0;const d=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case Me:u=i?d-s:0;break;case _e:u=(d-s)/2;break;case dt:u=i?0:d-s}u+=this.pathStartOffset*(i?-1:1);for(let f=i?l-1:0;i?f>=0:f<l;i?f--:f++)n=c[f],u>d?u%=d:u<0&&(u+=d),this._setGraphemeOnPath(u,n),u+=n.kernedWidth}return{width:s,numOfSpaces:0}}_setGraphemeOnPath(e,t){const n=e+t.kernedWidth/2,s=this.path,i=dq(s.path,n,s.segmentsInfo);t.renderLeft=i.x-s.pathOffset.x,t.renderTop=i.y-s.pathOffset.y,t.angle=i.angle+(this.pathSide===dt?Math.PI:0)}_getGraphemeBox(e,t,n,s,i){const o=this.getCompleteStyleDeclaration(t,n),a=s?this.getCompleteStyleDeclaration(t,n-1):{},l=this._measureChar(e,o,s,a);let c,u=l.kernedWidth,d=l.width;this.charSpacing!==0&&(c=this._getWidthOfCharSpacing(),d+=c,u+=c);const f={width:d,left:0,height:o.fontSize,kernedWidth:u,deltaY:o.deltaY};if(n>0&&!i){const p=this.__charBounds[t][n-1];f.left=p.left+p.width+l.kernedWidth-l.width}return f}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let n=1,s=this._textLines[e].length;n<s;n++)t=Math.max(this.getHeightOfChar(e,n),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let n=0,s=this._textLines.length;n<s;n++)e=this.getHeightOfLine(n),t+=n===s-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0;const s=this._getLeftOffset(),i=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++){const l=this.getHeightOfLine(o),c=l/this.lineHeight,u=this._getLineLeftOffset(o);this._renderTextLine(t,e,this._textLines[o],s+u,i+n+c,o),n+=l}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Ot))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,s,i,o){const a=this.getHeightOfLine(o),l=this.textAlign.includes(rs),c=this.path,u=!l&&this.charSpacing===0&&this.isEmptyStyles(o)&&!c,d=this.direction==="ltr",f=this.direction==="ltr"?1:-1,p=t.direction;let m,v,T,w,y,C="",k=0;if(t.save(),p!==this.direction&&(t.canvas.setAttribute("dir",d?"ltr":"rtl"),t.direction=d?"ltr":"rtl",t.textAlign=d?Me:dt),i-=a*this._fontSizeFraction/this.lineHeight,u)return this._renderChar(e,t,o,0,n.join(""),s,i),void t.restore();for(let O=0,M=n.length-1;O<=M;O++)w=O===M||this.charSpacing||c,C+=n[O],T=this.__charBounds[o][O],k===0?(s+=f*(T.kernedWidth-T.width),k+=T.width):k+=T.kernedWidth,l&&!w&&this._reSpaceAndTab.test(n[O])&&(w=!0),w||(m=m||this.getCompleteStyleDeclaration(o,O),v=this.getCompleteStyleDeclaration(o,O+1),w=CT(m,v,!1)),w&&(c?(t.save(),t.translate(T.renderLeft,T.renderTop),t.rotate(T.angle),this._renderChar(e,t,o,O,C,-k/2,0),t.restore()):(y=s,this._renderChar(e,t,o,O,C,y,i)),C="",m=v,s+=f*k,k=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,n=this.height+this.strokeWidth,s=mn({width:t,height:n}),i=s.getContext("2d");return s.width=t,s.height=n,i.beginPath(),i.moveTo(0,0),i.lineTo(t,0),i.lineTo(t,n),i.lineTo(0,n),i.closePath(),i.translate(t/2,n/2),i.fillStyle=e.toLive(i),this._applyPatternGradientTransform(i,e),i.fill(),i.createPattern(s,"no-repeat")}handleFiller(e,t,n){let s,i;return an(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(s=-this.width/2,i=-this.height/2,e.translate(s,i),e[t]=this._applyPatternGradientTransformText(n),{offsetX:s,offsetY:i}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:s}=t;return e.lineWidth=s,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,s,i,o,a){const l=this._getStyleDeclaration(n,s),c=this.getCompleteStyleDeclaration(n,s),u=e==="fillText"&&c.fill,d=e==="strokeText"&&c.stroke&&c.strokeWidth;if(d||u){if(t.save(),t.font=this._getFontDeclaration(c),l.textBackgroundColor&&this._removeShadow(t),l.deltaY&&(a+=l.deltaY),u){const f=this._setFillStyles(t,c);t.fillText(i,o-f.offsetX,a-f.offsetY)}if(d){const f=this._setStrokeStyles(t,c);t.strokeText(i,o-f.offsetX,a-f.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){const s=this.get2DCursorLocation(e,!0),i=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),o=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),a={fontSize:i*n.size,deltaY:o+i*n.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),n=this.width-t,s=this.textAlign,i=this.direction,o=this.isEndOfWrapping(e);let a=0;return s===rs||s===Cu&&!o||s===Tu&&!o||s===rg&&!o?0:(s===_e&&(a=n/2),s===dt&&(a=n),s===Cu&&(a=n/2),s===Tu&&(a=n),i==="rtl"&&(s===dt||s===rs||s===Tu?a=0:s===Me||s===rg?a=-n:s!==_e&&s!==Cu||(a=-n/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var s;return(s=this._getStyleDeclaration(e,t)[n])!==null&&s!==void 0?s:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset();const s=this._getLeftOffset(),i=this.path,o=this._getWidthOfCharSpacing(),a=t==="linethrough"?.5:t==="overline"?1:0,l=this.offsets[t];for(let c=0,u=this._textLines.length;c<u;c++){const d=this.getHeightOfLine(c);if(!this[t]&&!this.styleHas(t,c)){n+=d;continue}const f=this._textLines[c],p=d/this.lineHeight,m=this._getLineLeftOffset(c);let v=0,T=0,w=this.getValueOfPropertyAt(c,0,t),y=this.getValueOfPropertyAt(c,0,Ot),C=this.getValueOfPropertyAt(c,0,la),k=w,O=y,M=C;const x=n+p*(1-this._fontSizeFraction);let E=this.getHeightOfChar(c,0),A=this.getValueOfPropertyAt(c,0,"deltaY");for(let _=0,b=f.length;_<b;_++){const B=this.__charBounds[c][_];k=this.getValueOfPropertyAt(c,_,t),O=this.getValueOfPropertyAt(c,_,Ot),M=this.getValueOfPropertyAt(c,_,la);const te=this.getHeightOfChar(c,_),ue=this.getValueOfPropertyAt(c,_,"deltaY");if(i&&k&&O){const ge=this.fontSize*M/1e3;e.save(),e.fillStyle=y,e.translate(B.renderLeft,B.renderTop),e.rotate(B.angle),e.fillRect(-B.kernedWidth/2,l*te+ue-a*ge,B.kernedWidth,ge),e.restore()}else if((k!==w||O!==y||te!==E||M!==C||ue!==A)&&T>0){const ge=this.fontSize*C/1e3;let Y=s+m+v;this.direction==="rtl"&&(Y=this.width-Y-T),w&&y&&C&&(e.fillStyle=y,e.fillRect(Y,x+l*E+A-a*ge,T,ge)),v=B.left,T=B.width,w=k,C=M,y=O,E=te,A=ue}else T+=B.kernedWidth}let P=s+m+v;this.direction==="rtl"&&(P=this.width-P-T),e.fillStyle=O;const R=this.fontSize*M/1e3;k&&O&&M&&e.fillRect(P,x+l*E+A-a*R,T-o,R),n+=d}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:s=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;const o=e.includes("'")||e.includes('"')||e.includes(",")||fr.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(i?this.CACHE_FONT_SIZE:s,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return TT(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),n=new Array(t.length),s=[`
`];let i=[];for(let o=0;o<t.length;o++)n[o]=this.graphemeSplit(t[o]),i=i.concat(n[o],s);return i.pop(),{_unwrappedLines:n,lines:t,graphemeText:i,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return V(V({},super.toObject([...ND,...e])),{},{styles:kG(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:n}=this.constructor;super.set(e,t);let s=!1,i=!1;if(typeof e=="object")for(const o in e)o==="path"&&this.setPathInfo(),s=s||n.includes(o),i=i||o==="path";else s=n.includes(e),i=e==="path";return i&&this.setPathInfo(),s&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,n){const s=ui(e,fr.ATTRIBUTE_NAMES,n),i=V(V({},t),s),{textAnchor:o=Me,textDecoration:a="",dx:l=0,dy:c=0,top:u=0,left:d=0,fontSize:f=cT,strokeWidth:p=1}=i,m=Ze(i,jq),v=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),V({left:d+l,top:u+c,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:f},m)),T=v.getScaledHeight()/v.height,w=((v.height+v.strokeWidth)*v.lineHeight-v.height)*T,y=v.getScaledHeight()+w;let C=0;return o===_e&&(C=v.getScaledWidth()/2),o===dt&&(C=v.getScaledWidth()),v.set({left:v.left-C,top:v.top-(y-v.fontSize*(.07+v._fontSizeFraction))/v.lineHeight,strokeWidth:p}),v}static fromObject(e){return this._fromObject(V(V({},e),{},{styles:IG(e.styles||{},e.text)}),{extraParam:"text"})}}F(fr,"textLayoutProperties",MD),F(fr,"cacheProperties",[...ci,...ND]),F(fr,"ownDefaults",UH),F(fr,"type","Text"),F(fr,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),F(fr,"ATTRIBUTE_NAMES",fo.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),WD(fr,[class extends RD{_toSVG(){const r=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(r.textTop,r.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(r){const e=this._createBaseSVGMarkup(this._toSVG(),{reviver:r,noStyle:!0,withShadow:!0}),t=this.path;return t?e+t._createBaseSVGMarkup(t._toSVG(),{reviver:r,withShadow:!0,additionalTransform:dh(this.calcOwnMatrix())}):e}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(r){let{textBgRects:e,textSpans:t}=r;const n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ','font-family="'.concat(this.fontFamily.replace(Vq,"'"),'" '),'font-size="'.concat(this.fontSize,'" '),this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(r,e){const t=[],n=[];let s,i=r;this.backgroundColor&&n.push(...Av(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)s=this._getLineLeftOffset(o),this.direction==="rtl"&&(s+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(n,o,e+s,i),this._setSVGTextLineText(t,o,e+s,i),i+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:n}}_createTextCharSpan(r,e,t,n,s){const i=Ae.NUM_FRACTION_DIGITS,o=this.getSvgSpanStyles(e,r!==r.trim()||!!r.match(Lq)),a=o?'style="'.concat(o,'"'):"",l=e.deltaY,c=l?' dy="'.concat(Ge(l,i),'" '):"",{angle:u,renderLeft:d,renderTop:f,width:p}=s;let m="";if(d!==void 0){const v=p/2;u&&(m=' rotate="'.concat(Ge(ai(u),i),'"'));const T=cc({angle:ai(u)});T[4]=d,T[5]=f;const w=new U(-v,0).transform(T);t=w.x,n=w.y}return'<tspan x="'.concat(Ge(t,i),'" y="').concat(Ge(n,i),'" ').concat(c).concat(m).concat(a,">").concat(xG(r),"</tspan>")}_setSVGTextLineText(r,e,t,n){const s=this.getHeightOfLine(e),i=this.textAlign.includes(rs),o=this._textLines[e];let a,l,c,u,d,f="",p=0;n+=s*(1-this._fontSizeFraction)/this.lineHeight;for(let m=0,v=o.length-1;m<=v;m++)d=m===v||this.charSpacing||this.path,f+=o[m],c=this.__charBounds[e][m],p===0?(t+=c.kernedWidth-c.width,p+=c.width):p+=c.kernedWidth,i&&!d&&this._reSpaceAndTab.test(o[m])&&(d=!0),d||(a=a||this.getCompleteStyleDeclaration(e,m),l=this.getCompleteStyleDeclaration(e,m+1),d=CT(a,l,!0)),d&&(u=this._getStyleDeclaration(e,m),r.push(this._createTextCharSpan(f,u,t,n,c)),f="",a=l,this.direction==="rtl"?t-=p:t+=p,p=0)}_setSVGTextLineBg(r,e,t,n){const s=this._textLines[e],i=this.getHeightOfLine(e)/this.lineHeight;let o,a=0,l=0,c=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<s.length;u++){const{left:d,width:f,kernedWidth:p}=this.__charBounds[e][u];o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),o!==c?(c&&r.push(...Av(c,t+l,n,a,i)),l=d,a=f,c=o):a+=p}o&&r.push(...Av(c,t+l,n,a,i))}_getSVGLineTopOffset(r){let e,t=0;for(e=0;e<r;e++)t+=this.getHeightOfLine(e);const n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(r){return"".concat(super.getSvgStyles(r)," text-decoration-thickness: ").concat(Ge(this.textDecorationThickness*this.getObjectScaling().y/10,Ae.NUM_FRACTION_DIGITS),"%; white-space: pre;")}getSvgSpanStyles(r,e){const{fontFamily:t,strokeWidth:n,stroke:s,fill:i,fontSize:o,fontStyle:a,fontWeight:l,deltaY:c,textDecorationThickness:u,linethrough:d,overline:f,underline:p}=r,m=this.getSvgTextDecoration({underline:p??this.underline,overline:f??this.overline,linethrough:d??this.linethrough}),v=u||this.textDecorationThickness;return[s?fh(Nr,s):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",l?"font-weight: ".concat(l,"; "):"",m?"text-decoration: ".concat(m,"; text-decoration-thickness: ").concat(Ge(v*this.getObjectScaling().y/10,Ae.NUM_FRACTION_DIGITS),"%; "):"",i?fh(Ot,i):"",c?"baseline-shift: ".concat(-c,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(r){return["overline","underline","line-through"].filter(e=>r[e.replace("-","")]).join(" ")}}]),oe.setClass(fr),oe.setSVGClass(fr);class $q{constructor(e){F(this,"target",void 0),F(this,"__mouseDownInPlace",!1),F(this,"__dragStartFired",!1),F(this,"__isDraggingOver",!1),F(this,"__dragStartSelection",void 0),F(this,"__dragImageDisposer",void 0),F(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:s,selectionEnd:i}=t;const o=this.target,a=o.canvas,l=new U(o.flipX?-1:1,o.flipY?-1:1),c=o._getCursorBoundaries(s),u=new U(c.left+c.leftOffset,c.top+c.topOffset).multiply(l).transform(o.calcTransformMatrix()),d=a.getScenePoint(e).subtract(u),f=o.getCanvasRetinaScaling(),p=o.getBoundingRect(),m=u.subtract(new U(p.left,p.top)),v=a.viewportTransform,T=m.add(d).transform(v,!0),w=o.backgroundColor,y=ST(o.styles);o.backgroundColor="";const C={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(C,0,s),o.setSelectionStyles(C,i,o.text.length),o.dirty=!0;const k=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=w,o.styles=y,o.dirty=!0,D_(k,{position:"fixed",left:"".concat(-k.width,"px"),border:Mr,width:"".concat(k.width/f,"px"),height:"".concat(k.height/f,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{k.remove()},In(e.target||this.target.hiddenTextarea).body.appendChild(k),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(k,T.x,T.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,n=this.isActive();if(n&&e.dataTransfer){const s=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},i=t._text.slice(s.selectionStart,s.selectionEnd).join(""),o=V({text:t.text,value:i},s);e.dataTransfer.setData("text/plain",i),e.dataTransfer.setData("application/fabric",JSON.stringify({value:i,styles:t.getSelectionStyles(s.selectionStart,s.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:n}=e,s=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let i=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(i&&!s){const o=this.target,a=o.canvas;let l=o.getSelectionStartFromPointer(n);const{styles:c}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},u=i[Math.max(0,i.length-1)],d=0;if(this.__dragStartSelection){const f=this.__dragStartSelection.selectionStart,p=this.__dragStartSelection.selectionEnd;l>f&&l<=p?l=f:l>p&&(l-=p-f),o.removeChars(f,p),delete this.__dragStartSelection}o._reNewline.test(u)&&(o._reNewline.test(o._text[l])||l===o._text.length)&&(i=i.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(i,c,l),a.setActiveObject(o),o.enterEditing(n),o.selectionStart=Math.min(l+d,o._text.length),o.selectionEnd=Math.min(o.selectionStart+i.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire(Kp,{index:l+d,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;const s=this.target,i=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,l=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||Mr;l===Mr?(s.selectionStart=o,s.selectionEnd=a,s._updateTextarea(),s.hiddenTextarea.focus()):(s.clearContextTop(),l==="move"&&(s.removeChars(o,a),s.selectionStart=s.selectionEnd=o,s.hiddenTextarea&&(s.hiddenTextarea.value=s.text),s._updateTextarea(),s.fire(Kp,{index:o,action:"dragend"}),i.fire("text:changed",{target:s}),i.requestRenderAll()),s.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Xb=/[ \n\.,;!\?\-]/;class Uq extends fr{constructor(){super(...arguments),F(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:s,onComplete:i}=e;return jD({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:s,onComplete:i,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}cmdAll(){this.selectAll(),this.renderCursorOrSelection()}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){const n=this._text;let s=e>0&&this._reSpace.test(n[e])&&(t===-1||!uT.test(n[e-1]))?e-1:e,i=n[s];for(;s>0&&s<n.length&&!Xb.test(i);)s+=t,i=n[s];return t===-1&&Xb.test(i)&&s++,s}selectWord(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const n=this.searchWordBoundary(e,-1),s=Math.max(n,this.searchWordBoundary(e,1));this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){var t;e=(t=e)!==null&&t!==void 0?t:this.selectionStart;const n=this.findLineBoundaryLeft(e),s=this.findLineBoundaryRight(e);this.selectionStart=n,this.selectionEnd=s,this._fireSelectionChanged(),this._updateTextarea()}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;In(t).activeElement!==t&&t.focus();const n=this.getSelectionStartFromPointer(e),s=this.selectionStart,i=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&s!==i||s!==n&&i!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===s&&this.selectionEnd===i||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){const s=n.slice(0,e),i=this.graphemeSplit(s).length;if(e===t)return{selectionStart:i,selectionEnd:i};const o=n.slice(e,t);return{selectionStart:i,selectionEnd:i+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,n){const s=n.slice(0,e).join("").length;return e===t?{selectionStart:s,selectionEnd:s}:{selectionStart:s,selectionEnd:s+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex,o=this.getValueOfPropertyAt(s,i,"fontSize")*this.lineHeight,a=t.leftOffset,l=this.getCanvasRetinaScaling(),c=this.canvas.upperCanvasEl,u=c.width/l,d=c.height/l,f=u-o,p=d-o,m=new U(t.left+a,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new U(c.clientWidth/u,c.clientHeight/d));return m.x<0&&(m.x=0),m.x>f&&(m.x=f),m.y<0&&(m.y=0),m.y>p&&(m.y=p),m.x+=this.canvas._offset.left,m.y+=this.canvas._offset.top,{left:"".concat(m.x,"px"),top:"".concat(m.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(Qp),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:n,charIndex:s}=this.get2DCursorLocation(e,!0),{lineIndex:i,charIndex:o}=this.get2DCursorLocation(t,!0);if(n!==i){if(this.styles[n])for(let a=s;a<this._unwrappedTextLines[n].length;a++)delete this.styles[n][a];if(this.styles[i])for(let a=o;a<this._unwrappedTextLines[i].length;a++){const l=this.styles[i][a];l&&(this.styles[n]||(this.styles[n]={}),this.styles[n][s+a-o]=l)}for(let a=n+1;a<=i;a++)delete this.styles[a];this.shiftLineStyles(i,n-i)}else if(this.styles[n]){const a=this.styles[n],l=o-s;for(let c=s;c<o;c++)delete a[c];for(const c in this.styles[n]){const u=parseInt(c,10);u>=o&&(a[u-l]=a[c],delete a[c])}}}shiftLineStyles(e,t){const n=Object.assign({},this.styles);for(const s in this.styles){const i=parseInt(s,10);i>e&&(this.styles[i+t]=n[i],n[i-t]||delete this.styles[i])}}insertNewlineStyleObject(e,t,n,s){const i={},o=this._unwrappedTextLines[e].length,a=o===t;let l=!1;n||(n=1),this.shiftLineStyles(e,n);const c=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const d in this.styles[e]){const f=parseInt(d,10);f>=t&&(l=!0,i[f-t]=this.styles[e][d],a&&t===0||delete this.styles[e][d])}let u=!1;for(l&&!a&&(this.styles[e+n]=i,u=!0),(u||o>t)&&n--;n>0;)s&&s[n-1]?this.styles[e+n]={0:V({},s[n-1])}:c?this.styles[e+n]={0:V({},c)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,s){this.styles||(this.styles={});const i=this.styles[e],o=i?V({},i):{};n||(n=1);for(const l in o){const c=parseInt(l,10);c>=t&&(i[c+n]=o[c],o[c-n]||delete i[c])}if(this._forceClearCache=!0,s){for(;n--;)Object.keys(s[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=V({},s[n]));return}if(!i)return;const a=i[t?t-1:1];for(;a&&n--;)this.styles[e][t+n]=V({},a)}insertNewStyleBlock(e,t,n){const s=this.get2DCursorLocation(t,!0),i=[0];let o,a=0;for(let l=0;l<e.length;l++)e[l]===`
`?(a++,i[a]=0):i[a]++;for(i[0]>0&&(this.insertCharStyleObject(s.lineIndex,s.charIndex,i[0],n),n=n&&n.slice(i[0]+1)),a&&this.insertNewlineStyleObject(s.lineIndex,s.charIndex+i[0],a),o=1;o<a;o++)i[o]>0?this.insertCharStyleObject(s.lineIndex+o,0,i[o],n):n&&this.styles[s.lineIndex+o]&&n[0]&&(this.styles[s.lineIndex+o][0]=n[0]),n=n&&n.slice(i[o]+1);i[o]>0&&this.insertCharStyleObject(s.lineIndex+o,0,i[o],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;s>n&&this.removeStyleFromTo(n,s);const i=this.graphemeSplit(e);this.insertNewStyleBlock(i,n,t),this._text=[...this._text.slice(0,n),...i,...this._text.slice(s)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=Me:this._selectionDirection===dt&&(this._selectionDirection=Me,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===dt?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=dt:this._selectionDirection===Me&&(this._selectionDirection=dt,this.selectionStart=t),this.selectionEnd=n)}}class Bq extends Uq{initHiddenTextarea(){const e=this.canvas&&In(this.canvas.getElement())||oc(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(o=>{let[a,l]=o;return t.setAttribute(a,l)});const{top:n,left:s,fontSize:i}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(s,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(i,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[a,l]=o;return t.addEventListener(a,this[l].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste,{value:n,selectionStart:s,selectionEnd:i}=this.hiddenTextarea;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const o=()=>{this.updateFromTextArea(),this.fire(Kp),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void o();const a=this._splitTextIntoLines(n).graphemeText,l=this._text.length,c=a.length,u=this.selectionStart,d=this.selectionEnd,f=u!==d;let p,m,v,T,w=c-l;const y=this.fromStringToGraphemeSelection(s,i,n),C=u>y.selectionStart;f?(m=this._text.slice(u,d),w+=d-u):c<l&&(m=C?this._text.slice(d+w,d):this._text.slice(u,u-w));const k=a.slice(y.selectionEnd-w,y.selectionEnd);if(m&&m.length&&(k.length&&(p=this.getSelectionStyles(u,u+1,!1),p=k.map(()=>p[0])),f?(v=u,T=d):C?(v=d-m.length,T=d):(v=d,T=d+m.length),this.removeStyleFromTo(v,T)),k.length){const{copyPasteData:O}=ms();t&&k.join("")===O.copiedText&&!Ae.disableStyleCopyPaste&&(p=O.copiedTextStyle),this.insertNewStyleBlock(k,u,p)}o()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:n,selectionEnd:s}=t;this.compositionStart=n,this.compositionEnd=s,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=ms();e.copiedText=this.getSelectedText(),Ae.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,s=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],s+=n.left+n.width),s}getDownCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;const o=s.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i+1,a);return this._textLines[i].slice(o).length+l+1+this.missingNewlineOffset(i)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const n=this._getSelectionForOffset(e,t),s=this.get2DCursorLocation(n),i=s.lineIndex;if(i===0||e.metaKey||e.keyCode===33)return-n;const o=s.charIndex,a=this._getWidthBeforeCursor(i,o),l=this._getIndexOnLine(i-1,a),c=this._textLines[i].slice(0,o),u=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+l-c.length+(1-u)}_getIndexOnLine(e,t){const n=this._textLines[e];let s,i,o=this._getLineLeftOffset(e),a=0;for(let l=0,c=n.length;l<c;l++)if(s=this.__charBounds[e][l].width,o+=s,o>t){i=!0;const u=o-s,d=o,f=Math.abs(u-t);a=Math.abs(d-t)<f?l:l-1;break}return i||(a=n.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===dt);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){const s=this.text.length;this.selectionStart=Hl(0,this.selectionStart,s),this.selectionEnd=Hl(0,this.selectionEnd,s),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===Me?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let s;if(e.altKey)s=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;s=this["findLineBoundary".concat(n)](this[t])}return s!==void 0&&this[t]!==s&&(this[t]=s,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Me,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===dt&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Me,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Me&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=dt,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=dt,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const Kb=r=>!!r.button;class zq extends Bq{constructor(){super(...arguments),F(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("mousetripleclick",this.tripleClickHandler),this.draggableTextDelegate=new $q(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}doubleClickHandler(e){this.isEditing&&(this.selectWord(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}tripleClickHandler(e){this.isEditing&&(this.selectLine(this.getSelectionStartFromPointer(e.e)),this.renderCursorOrSelection())}_mouseDownHandler(e){let{e:t,alreadySelected:n}=e;this.canvas&&this.editable&&!Kb(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),n&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()),this.selected||(this.selected=n||this.isEditing)))}mouseUpHandler(e){let{e:t,transform:n}=e;const s=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const i=this.canvas._activeObject;if(i&&i!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||Kb(t)||s||this.selected&&!this.getActiveControl()&&(this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection())}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),n=this.selectionStart,s=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,s,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(Mn(this.calcTransformMatrix())).add(new U(-this._getLeftOffset(),-this._getTopOffset()));let n=0,s=0,i=0;for(let c=0;c<this._textLines.length&&n<=t.y;c++)n+=this.getHeightOfLine(c),i=c,c>0&&(s+=this._textLines[c-1].length+this.missingNewlineOffset(c-1));let o=Math.abs(this._getLineLeftOffset(i));const a=this._textLines[i].length,l=this.__charBounds[i];for(let c=0;c<a;c++){const u=o+l[c].kernedWidth;if(t.x<=u){Math.abs(t.x-u)<=Math.abs(t.x-o)&&s++;break}o=u,s++}return Math.min(this.flipX?a-s:s,this._text.length)}}const Bd="moveCursorUp",zd="moveCursorDown",Wd="moveCursorLeft",Hd="moveCursorRight",Gd="exitEditing",Qb=(r,e)=>{const t=e.getRetinaScaling();r.setTransform(t,0,0,t,0,0);const n=e.viewportTransform;r.transform(n[0],n[1],n[2],n[3],n[4],n[5])},Wq=V({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Gd,27:Gd,33:Bd,34:zd,35:Hd,36:Wd,37:Wd,38:Bd,39:Hd,40:zd},keysMapRtl:{9:Gd,27:Gd,33:Bd,34:zd,35:Wd,36:Hd,37:Hd,38:Bd,39:Wd,40:zd},ctrlKeysMapDown:{65:"cmdAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class js extends zq{static getDefaults(){return V(V({},super.getDefaults()),js.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,V(V({},js.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof M_&&this.canvas.textEditingManager.remove(this),t instanceof M_&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing||!this.canvas)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries(),n=this.findAncestorsWithClipPath(),s=n.length>0;let i,o=e;if(s){i=mn(e.canvas),o=i.getContext("2d"),Qb(o,this.canvas);const a=this.calcTransformMatrix();o.transform(a[0],a[1],a[2],a[3],a[4],a[5])}if(this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(o,t):this.renderCursor(o,t),s)for(const a of n){const l=a.clipPath,c=mn(e.canvas),u=c.getContext("2d");if(Qb(u,this.canvas),!l.absolutePositioned){const d=a.calcTransformMatrix();u.transform(d[0],d[1],d[2],d[3],d[4],d[5])}l.transform(u),l.drawObject(u,!0,{}),this.drawClipPathOnCache(o,l,c)}s&&(e.setTransform(1,0,0,1,0,0),e.drawImage(i,0,0)),this.canvas.contextTopDirty=!0,e.restore()}findAncestorsWithClipPath(){const e=[];let t=this;for(;t;)t.clipPath&&e.push(t),t=t.parent;return e}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const n=this._getLeftOffset(),s=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e,t);return{left:n,top:s,leftOffset:i.left,topOffset:i.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0;const{charIndex:s,lineIndex:i}=this.get2DCursorLocation(e);for(let c=0;c<i;c++)t+=this.getHeightOfLine(c);const o=this._getLineLeftOffset(i),a=this.__charBounds[i][s];a&&(n=a.left),this.charSpacing!==0&&s===this._textLines[i].length&&(n-=this._getWidthOfCharSpacing());const l={top:t,left:o+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===dt||this.textAlign===rs||this.textAlign===Tu?l.left*=-1:this.textAlign===Me||this.textAlign===rg?l.left=o-(n>0?n:0):this.textAlign!==_e&&this.textAlign!==Cu||(l.left=o-(n>0?n:0))),l}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const n=this.get2DCursorLocation(e),s=n.lineIndex,i=n.charIndex>0?n.charIndex-1:0,o=this.getValueOfPropertyAt(s,i,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/a,c=this.getValueOfPropertyAt(s,i,"deltaY"),u=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-o*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(s,i,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-l/2,top:u+t.top+c,width:l,height:o}}_renderCursor(e,t,n){const{color:s,opacity:i,left:o,top:a,width:l,height:c}=this.getCursorRenderingData(n,t);e.fillStyle=s,e.globalAlpha=i,e.fillRect(o,a,l,c)}renderSelection(e,t){const n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){const s=t.selectionStart,i=t.selectionEnd,o=this.textAlign.includes(rs),a=this.get2DCursorLocation(s),l=this.get2DCursorLocation(i),c=a.lineIndex,u=l.lineIndex,d=a.charIndex<0?0:a.charIndex,f=l.charIndex<0?0:l.charIndex;for(let p=c;p<=u;p++){const m=this._getLineLeftOffset(p)||0;let v=this.getHeightOfLine(p),T=0,w=0,y=0;if(p===c&&(w=this.__charBounds[c][d].left),p>=c&&p<u)y=o&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===u)if(f===0)y=this.__charBounds[u][f].left;else{const x=this._getWidthOfCharSpacing();y=this.__charBounds[u][f-1].left+this.__charBounds[u][f-1].width-x}T=v,(this.lineHeight<1||p===u&&this.lineHeight>1)&&(v/=this.lineHeight);let C=n.left+m+w,k=v,O=0;const M=y-w;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",k=1,O=v):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===dt||this.textAlign===rs||this.textAlign===Tu?C=this.width-C-M:this.textAlign===Me||this.textAlign===rg?C=n.left+m-y:this.textAlign!==_e&&this.textAlign!==Cu||(C=n.left+m-y)),e.fillRect(C,n.top+n.topOffset+O,M,k),n.topOffset+=T}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Ot)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}F(js,"ownDefaults",Wq),F(js,"type","IText"),oe.setClass(js),oe.setClass(js,"i-text");class Vo extends js{static getDefaults(){return V(V({},super.getDefaults()),Vo.ownDefaults)}constructor(e,t){super(e,V(V({},Vo.ownDefaults),t))}static createControls(){return{controls:SG()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(rs)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,s=0;const i={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[s]===`
`&&o>0?(n=0,s++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[s])&&o>0&&(n++,s++),i[o]={line:t,offset:n},s+=e.graphemeLines[o].length,n+=e.graphemeLines[o].length;return i}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,s=e+1,i=!1;const o=this._styleMap[e],a=this._styleMap[e+1];o&&(e=o.line,n=o.offset),a&&(s=a.line,i=s===e,t=a.offset);const l=e===void 0?this.styles:{line:this.styles[e]};for(const c in l)for(const u in l[c]){const d=parseInt(u,10);if(d>=n&&(!i||d<t))for(const f in l[c][u])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){const s=this._styleMap[e];super._setStyleDeclaration(s.line,s.offset+t,n)}_deleteStyleDeclaration(e,t){const n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const n=this.getGraphemeDataForRender(e),s=[];for(let i=0;i<n.wordsData.length;i++)s.push(...this._wrapLine(i,t,n));return this.isWrapping=!1,s}getGraphemeDataForRender(e){const t=this.splitByGrapheme,n=t?"":" ";let s=0;return{wordsData:e.map((i,o)=>{let a=0;const l=t?this.graphemeSplit(i):this.wordSplit(i);return l.length===0?[{word:[],width:0}]:l.map(c=>{const u=t?[c]:this.graphemeSplit(c),d=this._measureWord(u,o,a);return s=Math.max(d,s),a+=u.length+n.length,{word:u,width:d}})}),largestWordWidth:s}}_measureWord(e,t){let n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=0;for(let o=0,a=e.length;o<a;o++)i+=this._getGraphemeBox(e[o],t,o+s,n,!0).kernedWidth,n=e[o];return i}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:s,wordsData:i}=n,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),l=this.splitByGrapheme,c=[],u=l?"":" ";let d=0,f=[],p=0,m=0,v=!0;t-=o;const T=Math.max(t,s,this.dynamicMinWidth),w=i[e];let y;for(p=0,y=0;y<w.length;y++){const{word:C,width:k}=w[y];p+=C.length,d+=m+k-a,d>T&&!v?(c.push(f),f=[],d=k,v=!0):d+=a,v||l||f.push(u),f=f.concat(C),m=l?0:this._measureWord([u],e,p),p++,v=!1}return y&&c.push(f),s+o>this.dynamicMinWidth&&(this.dynamicMinWidth=s-a+o),c}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),s=new Array(n.length);for(let i=0;i<n.length;i++)s[i]=n[i].join("");return t.lines=s,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const n=parseInt(t,10);if(this._textLines[n]){const s=this._styleMap[t].line;e.set("".concat(s),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}F(Vo,"type","Textbox"),F(Vo,"textLayoutProperties",[...js.textLayoutProperties,"width"]),F(Vo,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),oe.setClass(Vo);class Jb extends Qm{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:n}=e,{clipPath:s,group:i}=n;if(!s||!this.shouldPerformLayout(e))return;const{width:o,height:a}=Hs(qD(n,s)),l=new U(o,a);if(s.absolutePositioned)return{center:bl(s.getRelativeCenterPoint(),void 0,i?i.calcTransformMatrix():void 0),size:l};{const c=s.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:u=new U,correction:d=new U}=this.calcBoundingBox(t,e)||{};return{center:u.add(c),correction:d.subtract(c),size:l}}return{center:n.getRelativeCenterPoint().add(c),size:l}}}}F(Jb,"type","clip-path"),oe.setClass(Jb);class Zb extends Qm{getInitialSize(e,t){let{target:n}=e,{size:s}=t;return new U(n.width||s.x,n.height||s.y)}}F(Zb,"type","fixed"),oe.setClass(Zb);class Hq extends gh{subscribeTargets(e){const t=e.target;e.targets.reduce((n,s)=>(s.parent&&n.add(s.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})})}unsubscribeTargets(e){const t=e.target,n=t.getObjects();e.targets.reduce((s,i)=>(i.parent&&s.add(i.parent),s),new Set).forEach(s=>{!n.some(i=>i.parent===s)&&s.layoutManager.unsubscribeTargets({target:s,targets:[t]})})}}class jo extends Ho{static getDefaults(){return V(V({},super.getDefaults()),jo.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,jo.ownDefaults),this.setOptions(t);const{left:n,top:s,layoutManager:i}=t;this.groupInit(e,{left:n,top:s,layoutManager:i??new Hq})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(s=>{const i=this._objects.findIndex(a=>a.isInFrontOf(s)),o=i===-1?this.size():i;this.insertAt(o,s)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(ro("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const n=new Set;t.forEach(s=>{const{parent:i}=s;i&&n.add(i)}),e===xT?n.forEach(s=>{s._onAfterObjectsChange(ng,t)}):n.forEach(s=>{s._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const s=V(V({hasControls:!1},n),{},{forActiveSelection:!0});for(let i=0;i<this._objects.length;i++)this._objects[i]._renderControls(e,s);super._renderControls(e,t),e.restore()}}F(jo,"type","ActiveSelection"),F(jo,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),oe.setClass(jo),oe.setClass(jo,"activeSelection");class Gq{constructor(){F(this,"resources",{})}applyFilters(e,t,n,s,i){const o=i.getContext("2d");if(!o)return;o.drawImage(t,0,0,n,s);const a={sourceWidth:n,sourceHeight:s,imageData:o.getImageData(0,0,n,s),originalEl:t,originalImageData:o.getImageData(0,0,n,s),canvasEl:i,ctx:o,filterBackend:this};e.forEach(c=>{c.applyTo(a)});const{imageData:l}=a;return l.width===n&&l.height===s||(i.width=l.width,i.height=l.height),o.putImageData(l,0,0),a}}class cM{constructor(){let{tileSize:e=Ae.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};F(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),F(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const n=mn({width:e,height:t}),s=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});s&&(s.clearColor(0,0,0,0),this.canvas=n,this.gl=s)}applyFilters(e,t,n,s,i,o){const a=this.gl,l=i.getContext("2d");if(!a||!l)return;let c;o&&(c=this.getCachedTexture(o,t));const u={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:a,sourceTexture:this.createTexture(a,n,s,c?void 0:t),targetTexture:this.createTexture(a,n,s),originalTexture:c||this.createTexture(a,n,s,c?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:i},d=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,d),e.forEach(f=>{f&&f.applyTo(u)}),function(f){const p=f.targetCanvas,m=p.width,v=p.height,T=f.destinationWidth,w=f.destinationHeight;m===T&&v===w||(p.width=T,p.height=w)}(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(d),l.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,s,i){const{NEAREST:o,TEXTURE_2D:a,RGBA:l,UNSIGNED_BYTE:c,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:d,TEXTURE_MIN_FILTER:f,TEXTURE_WRAP_S:p,TEXTURE_WRAP_T:m}=e,v=e.createTexture();return e.bindTexture(a,v),e.texParameteri(a,d,i||o),e.texParameteri(a,f,i||o),e.texParameteri(a,p,u),e.texParameteri(a,m,u),s?e.texImage2D(a,0,l,l,c,s):e.texImage2D(a,0,l,t,n,0,l,c,null),v}getCachedTexture(e,t,n){const{textureCache:s}=this;if(s[e])return s[e];{const i=this.createTexture(this.gl,t.width,t.height,t,n);return i&&(s[e]=i),i}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const n=e.canvas,s=t.targetCanvas,i=s.getContext("2d");if(!i)return;i.translate(0,s.height),i.scale(1,-1);const o=n.height-s.height;i.drawImage(n,0,o,s.width,s.height,0,0,s.width,s.height)}copyGLTo2DPutImageData(e,t){const n=t.targetCanvas.getContext("2d"),s=t.destinationWidth,i=t.destinationHeight,o=s*i*4;if(!n)return;const a=new Uint8Array(this.imageBuffer,0,o),l=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,s,i,e.RGBA,e.UNSIGNED_BYTE,a);const c=new ImageData(l,s,i);n.putImageData(c,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const n=e.getExtension("WEBGL_debug_renderer_info");if(n){const s=e.getParameter(n.UNMASKED_RENDERER_WEBGL),i=e.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(t.renderer=s.toLowerCase()),i&&(t.vendor=i.toLowerCase())}return this.gpuInfo=t,t}}let Iv;function qq(){const{WebGLProbe:r}=ms();return r.queryWebGL(oi()),Ae.enableGLFiltering&&r.isSupported(Ae.textureSize)?new cM({tileSize:Ae.textureSize}):new Gq}function Pv(){return!Iv&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Iv=qq()),Iv}const Yq=["filters","resizeFilter","src","crossOrigin","type"],uM=["cropX","cropY"];class br extends ar{static getDefaults(){return V(V({},super.getDefaults()),br.ownDefaults)}constructor(e,t){super(),F(this,"_lastScaleX",1),F(this,"_lastScaleY",1),F(this,"_filterScalingX",1),F(this,"_filterScalingY",1),this.filters=[],Object.assign(this,br.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(no()),this.setElement(typeof e=="string"?(this.canvas&&In(this.canvas.getElement())||oc()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){var t;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(n),(t=e.classList)===null||t===void 0||t.add(br.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=Pv(!1);t instanceof cM&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&ms().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(n=>{n&&t.push(n.toObject())}),V(V({},super.toObject([...uM,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,n=-this.width/2,s=-this.height/2;let i=[],o=[],a="",l="";if(!t)return[];if(this.hasCrop()){const c=no();i.push('<clipPath id="imageCrop_'+c+`">
`,'	<rect x="'+n+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+c+')" '}if(this.imageSmoothing||(l=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(s-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(l).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const c=this.fill;this.fill=null,o=['	<rect x="'.concat(n,'" y="').concat(s,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=c}return i=this.paintFirst!==Ot?i.concat(o,e):i.concat(e,o),i}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Wf(e,{crossOrigin:t,signal:n}).then(s=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(s)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.x,i=n.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||s>t&&i>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=i);const a=mn(o),{width:l,height:c}=o;this._element=a,this._lastScaleX=e.scaleX=s,this._lastScaleY=e.scaleY=i,Pv().applyFilters([e],o,l,c,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(i=>i&&!i.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,n=t.naturalWidth||t.width,s=t.naturalHeight||t.height;if(this._element===this._originalElement){const i=mn({width:n,height:s});this._element=i,this._filteredEl=i}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1);Pv().applyFilters(e,this._originalElement,n,s,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const n=this._filterScalingX,s=this._filterScalingY,i=this.width,o=this.height,a=Math.max(this.cropX,0),l=Math.max(this.cropY,0),c=t.naturalWidth||t.width,u=t.naturalHeight||t.height,d=a*n,f=l*s,p=Math.min(i*n,c-d),m=Math.min(o*s,u-f),v=-i/2,T=-o/2,w=Math.min(i,c/n-a),y=Math.min(o,u/s-l);t&&e.drawImage(t,d,f,p,m,v,T,w,y)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){const e=jH(this.preserveAspectRatio||""),t=this.width,n=this.height,s={width:t,height:n};let i,o=this._element.width,a=this._element.height,l=1,c=1,u=0,d=0,f=0,p=0;return!e||e.alignX===Mr&&e.alignY===Mr?(l=t/o,c=n/a):(e.meetOrSlice==="meet"&&(l=c=tq(this._element,s),i=(t-o*l)/2,e.alignX==="Min"&&(u=-i),e.alignX==="Max"&&(u=i),i=(n-a*c)/2,e.alignY==="Min"&&(d=-i),e.alignY==="Max"&&(d=i)),e.meetOrSlice==="slice"&&(l=c=rq(this._element,s),i=o-t/l,e.alignX==="Mid"&&(f=i/2),e.alignX==="Max"&&(f=i),i=a-n/c,e.alignY==="Mid"&&(p=i/2),e.alignY==="Max"&&(p=i),o=t/l,a=n/c)),{width:o,height:a,scaleX:l,scaleY:c,offsetLeft:u,offsetTop:d,cropX:f,cropY:p}}static fromObject(e,t){let{filters:n,resizeFilter:s,src:i,crossOrigin:o,type:a}=e,l=Ze(e,Yq);return Promise.all([Wf(i,V(V({},t),{},{crossOrigin:o})),n&&hh(n,t),s&&hh([s],t),qm(l,t)]).then(c=>{let[u,d=[],[f]=[],p={}]=c;return new this(u,V(V({},l),{},{src:i,filters:d,resizeFilter:f},p))})}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;return Wf(e,{crossOrigin:t,signal:n}).then(i=>new this(i,s))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const s=ui(e,this.ATTRIBUTE_NAMES,n);return this.fromURL(s["xlink:href"]||s.href,t,s).catch(i=>(ro("log","Unable to parse Image",i),null))}}F(br,"type","Image"),F(br,"cacheProperties",[...ci,...uM]),F(br,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),F(br,"CSS_CANVAS","canvas-img"),F(br,"ATTRIBUTE_NAMES",[...fo,"x","y","width","height","preserveAspectRatio","xlink:href","href","crossOrigin","image-rendering"]),oe.setClass(br),oe.setSVGClass(br);Xm(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const Zm=r=>r.webgl!==void 0,bT="precision highp float",Xq=`
    `.concat(bT,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),Kq=["type"],Qq=["type"],Jq=new RegExp(bT,"g");class Dt{get type(){return this.constructor.type}constructor(){let e=Ze(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Kq);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return Xq}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:s="highp"}}=ms();s!=="highp"&&(t=t.replace(Jq,bT.replace("highp",s)));const i=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!i||!o||!a)throw new ns("Vertex, fragment shader or program creation error");if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new ns("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new ns("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(a,i),e.attachShader(a,o),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new ns('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));const l=this.getUniformLocations(e,a)||{};return l.uStepW=e.getUniformLocation(a,"uStepW"),l.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:l}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const n=this.constructor.uniformLocations,s={};for(let i=0;i<n.length;i++)s[n[i]]=e.getUniformLocation(t,n[i]);return s}sendAttributeData(e,t,n){const s=t.aPosition,i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.enableVertexAttribArray(s),e.vertexAttribPointer(s,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const n=e.destinationWidth,s=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===s||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,s)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){Zm(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:n}=e,s=mn({width:t,height:n});e.helpLayer=s}}toObject(){const e=Object.keys(this.constructor.defaults||{});return V({type:this.type},e.reduce((t,n)=>(t[n]=this[n],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(Ze(e,Qq))}}F(Dt,"type","BaseFilter"),F(Dt,"uniformLocations",[]);const Zq={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class qd extends Dt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(Zq[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const n=new Ve(this.color).getSource(),s=this.alpha,i=n[0]*s,o=n[1]*s,a=n[2]*s,l=1-s;for(let c=0;c<t.length;c+=4){const u=t[c],d=t[c+1],f=t[c+2];let p,m,v;switch(this.mode){case"multiply":p=u*i/255,m=d*o/255,v=f*a/255;break;case"screen":p=255-(255-u)*(255-i)/255,m=255-(255-d)*(255-o)/255,v=255-(255-f)*(255-a)/255;break;case"add":p=u+i,m=d+o,v=f+a;break;case"difference":p=Math.abs(u-i),m=Math.abs(d-o),v=Math.abs(f-a);break;case"subtract":p=u-i,m=d-o,v=f-a;break;case"darken":p=Math.min(u,i),m=Math.min(d,o),v=Math.min(f,a);break;case"lighten":p=Math.max(u,i),m=Math.max(d,o),v=Math.max(f,a);break;case"overlay":p=i<128?2*u*i/255:255-2*(255-u)*(255-i)/255,m=o<128?2*d*o/255:255-2*(255-d)*(255-o)/255,v=a<128?2*f*a/255:255-2*(255-f)*(255-a)/255;break;case"exclusion":p=i+u-2*i*u/255,m=o+d-2*o*d/255,v=a+f-2*a*f/255;break;case"tint":p=i+u*l,m=o+d*l,v=a+f*l}t[c]=p,t[c+1]=m,t[c+2]=v}}sendUniformData(e,t){const n=new Ve(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}}F(qd,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),F(qd,"type","BlendColor"),F(qd,"uniformLocations",["uColor"]),oe.setClass(qd);const eY={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},tY=["type","image"];class Yd extends Dt{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return eY[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:s},filterBackend:{resources:i}}=e;const o=this.image;i.blendImage||(i.blendImage=oi());const a=i.blendImage,l=a.getContext("2d");a.width!==n||a.height!==s?(a.width=n,a.height=s):l.clearRect(0,0,n,s),l.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),l.drawImage(o.getElement(),0,0,n,s);const c=l.getImageData(0,0,n,s).data;for(let u=0;u<t.length;u+=4){const d=t[u],f=t[u+1],p=t[u+2],m=t[u+3],v=c[u],T=c[u+1],w=c[u+2],y=c[u+3];switch(this.mode){case"multiply":t[u]=d*v/255,t[u+1]=f*T/255,t[u+2]=p*w/255,t[u+3]=m*y/255;break;case"mask":t[u+3]=y}}}sendUniformData(e,t){const n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return V(V({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:n,image:s}=e,i=Ze(e,tY);return br.fromObject(s,t).then(o=>new this(V(V({},i),{},{image:o})))}}F(Yd,"type","BlendImage"),F(Yd,"defaults",{mode:"multiply",alpha:1}),F(Yd,"uniformLocations",["uTransformMatrix","uImage"]),oe.setClass(Yd);class Xd extends Dt{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float totalC = 0.0;
      float totalA = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        vec4 sample = texture2D(uTexture, vTexCoord + uDelta * percent);
        float weight = 1.0 - abs(percent);
        float alpha = weight * sample.a;
        color.rgb += sample.rgb * alpha;
        color.a += alpha;
        totalA += weight;
        totalC += alpha;
      }
      gl_FragColor.rgb = color.rgb / totalC;
      gl_FragColor.a = color.a / totalA;
    }
  `}applyTo(e){Zm(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){let{imageData:{data:t,width:n,height:s}}=e;this.aspectRatio=n/s,this.horizontal=!0;let i=this.getBlurValue()*n;const o=new Uint8ClampedArray(t),a=15,l=4*n;for(let c=0;c<t.length;c+=4){let u=0,d=0,f=0,p=0,m=0;const v=c-c%l,T=v+l;for(let w=-14;w<a;w++){const y=w/a,C=4*Math.floor(i*y),k=1-Math.abs(y);let O=c+C;O<v?O=v:O>T&&(O=T);const M=t[O+3]*k;u+=t[O]*M,d+=t[O+1]*M,f+=t[O+2]*M,p+=M,m+=k}o[c]=u/p,o[c+1]=d/p,o[c+2]=f/p,o[c+3]=p/m}this.horizontal=!1,i=this.getBlurValue()*s;for(let c=0;c<o.length;c+=4){let u=0,d=0,f=0,p=0,m=0;const v=c%l,T=o.length-l+v;for(let w=-14;w<a;w++){const y=w/a,C=Math.floor(i*y)*l,k=1-Math.abs(y);let O=c+C;O<v?O=v:O>T&&(O=T);const M=o[O+3]*k;u+=o[O]*M,d+=o[O+1]*M,f+=o[O+2]*M,p+=M,m+=k}t[c]=u/p,t[c+1]=d/p,t[c+2]=f/p,t[c+3]=p/m}}sendUniformData(e,t){const n=this.chooseRightDelta();e.uniform2fv(t.uDelta,n)}isNeutralState(){return this.blur===0}getBlurValue(){let e=1;const{horizontal:t,aspectRatio:n}=this;return t?n>1&&(e=1/n):n<1&&(e=n),e*this.blur*.12}chooseRightDelta(){const e=this.getBlurValue();return this.horizontal?[e,0]:[0,e]}}F(Xd,"type","Blur"),F(Xd,"defaults",{blur:0}),F(Xd,"uniformLocations",["uDelta"]),oe.setClass(Xd);class Kd extends Dt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.round(255*this.brightness);for(let s=0;s<t.length;s+=4)t[s]+=n,t[s+1]+=n,t[s+2]+=n}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}F(Kd,"type","Brightness"),F(Kd,"defaults",{brightness:0}),F(Kd,"uniformLocations",["uBrightness"]),oe.setClass(Kd);const hM={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class ul extends Dt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,n=this.matrix,s=this.colorsOnly;for(let i=0;i<t.length;i+=4){const o=t[i],a=t[i+1],l=t[i+2];if(t[i]=o*n[0]+a*n[1]+l*n[2]+255*n[4],t[i+1]=o*n[5]+a*n[6]+l*n[7]+255*n[9],t[i+2]=o*n[10]+a*n[11]+l*n[12]+255*n[14],!s){const c=t[i+3];t[i]+=c*n[3],t[i+1]+=c*n[8],t[i+2]+=c*n[13],t[i+3]=o*n[15]+a*n[16]+l*n[17]+c*n[18]+255*n[19]}}}sendUniformData(e,t){const n=this.matrix,s=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],i=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,s),e.uniform4fv(t.uConstants,i)}toObject(){return V(V({},super.toObject()),{},{matrix:[...this.matrix]})}}function _a(r,e){var t;const n=(F(t=class extends ul{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",r),F(t,"defaults",{colorsOnly:!1,matrix:e}),t);return oe.setClass(n,r),n}F(ul,"type","ColorMatrix"),F(ul,"defaults",hM),F(ul,"uniformLocations",["uColorMatrix","uConstants"]),oe.setClass(ul);_a("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);_a("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);_a("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);_a("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);_a("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);_a("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);_a("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class eA extends Dt{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){Zm(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(n=>oe.getClass(n.type).fromObject(n,t))).then(n=>new this({subFilters:n}))}}F(eA,"type","Composed"),oe.setClass(eA);class Qd extends Dt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const n=Math.floor(255*this.contrast),s=259*(n+255)/(255*(259-n));for(let i=0;i<t.length;i+=4)t[i]=s*(t[i]-128)+128,t[i+1]=s*(t[i+1]-128)+128,t[i+2]=s*(t[i+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}F(Qd,"type","Contrast"),F(Qd,"defaults",{contrast:0}),F(Qd,"uniformLocations",["uContrast"]),oe.setClass(Qd);const rY={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Jd extends Dt{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return rY[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,n=t.data,s=this.matrix,i=Math.round(Math.sqrt(s.length)),o=Math.floor(i/2),a=t.width,l=t.height,c=e.ctx.createImageData(a,l),u=c.data,d=this.opaque?1:0;let f,p,m,v,T,w,y,C,k,O,M,x,E;for(M=0;M<l;M++)for(O=0;O<a;O++){for(T=4*(M*a+O),f=0,p=0,m=0,v=0,E=0;E<i;E++)for(x=0;x<i;x++)y=M+E-o,w=O+x-o,y<0||y>=l||w<0||w>=a||(C=4*(y*a+w),k=s[E*i+x],f+=n[C]*k,p+=n[C+1]*k,m+=n[C+2]*k,d||(v+=n[C+3]*k));u[T]=f,u[T+1]=p,u[T+2]=m,u[T+3]=d?n[T+3]:v}e.imageData=c}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return V(V({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}F(Jd,"type","Convolute"),F(Jd,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),F(Jd,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),oe.setClass(Jd);const dM="Gamma";class Zd extends Dt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.gamma,s=1/n[0],i=1/n[1],o=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let l=0;l<256;l++)a.r[l]=255*Math.pow(l/255,s),a.g[l]=255*Math.pow(l/255,i),a.b[l]=255*Math.pow(l/255,o);for(let l=0;l<t.length;l+=4)t[l]=a.r[t[l]],t[l+1]=a.g[t[l+1]],t[l+2]=a.b[t[l+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:dM,gamma:this.gamma.concat()}}}F(Zd,"type",dM),F(Zd,"defaults",{gamma:[1,1,1]}),F(Zd,"uniformLocations",["uGamma"]),oe.setClass(Zd);const nY={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class ef extends Dt{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,s=0;s<t.length;s+=4){const i=t[s],o=t[s+1],a=t[s+2];switch(this.mode){case"average":n=(i+o+a)/3;break;case"lightness":n=(Math.min(i,o,a)+Math.max(i,o,a))/2;break;case"luminosity":n=.21*i+.72*o+.07*a}t[s+2]=t[s+1]=t[s]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return nY[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}F(ef,"type","Grayscale"),F(ef,"defaults",{mode:"average"}),F(ef,"uniformLocations",["uMode"]),oe.setClass(ef);const sY=V(V({},hM),{},{rotation:0});class Rv extends ul{calculateMatrix(){const e=this.rotation*Math.PI,t=si(e),n=ii(e),s=1/3,i=Math.sqrt(s)*n,o=1-t;this.matrix=[t+o/3,s*o-i,s*o+i,0,0,s*o+i,t+s*o,s*o-i,0,0,s*o-i,s*o+i,t+s*o,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}F(Rv,"type","HueRotation"),F(Rv,"defaults",sY),oe.setClass(Rv);class tf extends Dt{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}F(tf,"type","Invert"),F(tf,"defaults",{alpha:!1,invert:!0}),F(tf,"uniformLocations",["uInvert","uAlpha"]),oe.setClass(tf);class rf extends Dt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=this.noise;for(let s=0;s<t.length;s+=4){const i=(.5-Math.random())*n;t[s]+=i,t[s+1]+=i,t[s+2]+=i}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}F(rf,"type","Noise"),F(rf,"defaults",{noise:0}),F(rf,"uniformLocations",["uNoise","uSeed"]),oe.setClass(rf);class nf extends Dt{applyTo2d(e){let{imageData:{data:t,width:n,height:s}}=e;for(let i=0;i<s;i+=this.blocksize)for(let o=0;o<n;o+=this.blocksize){const a=4*i*n+4*o,l=t[a],c=t[a+1],u=t[a+2],d=t[a+3];for(let f=i;f<Math.min(i+this.blocksize,s);f++)for(let p=o;p<Math.min(o+this.blocksize,n);p++){const m=4*f*n+4*p;t[m]=l,t[m+1]=c,t[m+2]=u,t[m+3]=d}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}F(nf,"type","Pixelate"),F(nf,"defaults",{blocksize:4}),F(nf,"uniformLocations",["uBlocksize"]),oe.setClass(nf);class sf extends Dt{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=255*this.distance,s=new Ve(this.color).getSource(),i=[s[0]-n,s[1]-n,s[2]-n],o=[s[0]+n,s[1]+n,s[2]+n];for(let a=0;a<t.length;a+=4){const l=t[a],c=t[a+1],u=t[a+2];l>i[0]&&c>i[1]&&u>i[2]&&l<o[0]&&c<o[1]&&u<o[2]&&(t[a+3]=0)}}sendUniformData(e,t){const n=new Ve(this.color).getSource(),s=this.distance,i=[0+n[0]/255-s,0+n[1]/255-s,0+n[2]/255-s,1],o=[n[0]/255+s,n[1]/255+s,n[2]/255+s,1];e.uniform4fv(t.uLow,i),e.uniform4fv(t.uHigh,o)}}F(sf,"type","RemoveColor"),F(sf,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),F(sf,"uniformLocations",["uLow","uHigh"]),oe.setClass(sf);class of extends Dt{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),s=new Array(n);for(let i=1;i<=n;i++)s[i-1]=e(i*t);return s}generateShader(e){const t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((n,s)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(s,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(s,`];
              sum += 2.0 * uTaps[`).concat(s,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){Zm(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){const t=e.imageData,n=this.scaleX,s=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/s;const i=t.width,o=t.height,a=Math.round(i*n),l=Math.round(o*s);let c;c=this.resizeType==="sliceHack"?this.sliceByTwo(e,i,o,a,l):this.resizeType==="hermite"?this.hermiteFastResize(e,i,o,a,l):this.resizeType==="bilinear"?this.bilinearFiltering(e,i,o,a,l):this.resizeType==="lanczos"?this.lanczosResize(e,i,o,a,l):new ImageData(a,l),e.imageData=c}sliceByTwo(e,t,n,s,i){const o=e.imageData,a=.5;let l=!1,c=!1,u=t*a,d=n*a;const f=e.filterBackend.resources;let p=0,m=0;const v=t;let T=0;f.sliceByTwo||(f.sliceByTwo=oi());const w=f.sliceByTwo;(w.width<1.5*t||w.height<n)&&(w.width=1.5*t,w.height=n);const y=w.getContext("2d");for(y.clearRect(0,0,1.5*t,n),y.putImageData(o,0,0),s=Math.floor(s),i=Math.floor(i);!l||!c;)t=u,n=d,s<Math.floor(u*a)?u=Math.floor(u*a):(u=s,l=!0),i<Math.floor(d*a)?d=Math.floor(d*a):(d=i,c=!0),y.drawImage(w,p,m,t,n,v,T,u,d),p=v,m=T,T+=d;return y.getImageData(p,m,s,i)}lanczosResize(e,t,n,s,i){const o=e.imageData.data,a=e.ctx.createImageData(s,i),l=a.data,c=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,d=this.rcpScaleY,f=2/this.rcpScaleX,p=2/this.rcpScaleY,m=Math.ceil(u*this.lanczosLobes/2),v=Math.ceil(d*this.lanczosLobes/2),T={},w={x:0,y:0},y={x:0,y:0};return function C(k){let O,M,x,E,A,P,R,_,b,B,te;for(w.x=(k+.5)*u,y.x=Math.floor(w.x),O=0;O<i;O++){for(w.y=(O+.5)*d,y.y=Math.floor(w.y),A=0,P=0,R=0,_=0,b=0,M=y.x-m;M<=y.x+m;M++)if(!(M<0||M>=t)){B=Math.floor(1e3*Math.abs(M-w.x)),T[B]||(T[B]={});for(let ue=y.y-v;ue<=y.y+v;ue++)ue<0||ue>=n||(te=Math.floor(1e3*Math.abs(ue-w.y)),T[B][te]||(T[B][te]=c(Math.sqrt(Math.pow(B*f,2)+Math.pow(te*p,2))/1e3)),x=T[B][te],x>0&&(E=4*(ue*t+M),A+=x,P+=x*o[E],R+=x*o[E+1],_+=x*o[E+2],b+=x*o[E+3]))}E=4*(O*s+k),l[E]=P/A,l[E+1]=R/A,l[E+2]=_/A,l[E+3]=b/A}return++k<s?C(k):a}(0)}bilinearFiltering(e,t,n,s,i){let o,a,l,c,u,d,f,p,m,v,T,w,y,C=0;const k=this.rcpScaleX,O=this.rcpScaleY,M=4*(t-1),x=e.imageData.data,E=e.ctx.createImageData(s,i),A=E.data;for(f=0;f<i;f++)for(p=0;p<s;p++)for(u=Math.floor(k*p),d=Math.floor(O*f),m=k*p-u,v=O*f-d,y=4*(d*t+u),T=0;T<4;T++)o=x[y+T],a=x[y+4+T],l=x[y+M+T],c=x[y+M+4+T],w=o*(1-m)*(1-v)+a*m*(1-v)+l*v*(1-m)+c*m*v,A[C++]=w;return E}hermiteFastResize(e,t,n,s,i){const o=this.rcpScaleX,a=this.rcpScaleY,l=Math.ceil(o/2),c=Math.ceil(a/2),u=e.imageData.data,d=e.ctx.createImageData(s,i),f=d.data;for(let p=0;p<i;p++)for(let m=0;m<s;m++){const v=4*(m+p*s);let T=0,w=0,y=0,C=0,k=0,O=0,M=0;const x=(p+.5)*a;for(let E=Math.floor(p*a);E<(p+1)*a;E++){const A=Math.abs(x-(E+.5))/c,P=(m+.5)*o,R=A*A;for(let _=Math.floor(m*o);_<(m+1)*o;_++){let b=Math.abs(P-(_+.5))/l;const B=Math.sqrt(R+b*b);B>1&&B<-1||(T=2*B*B*B-3*B*B+1,T>0&&(b=4*(_+E*t),M+=T*u[b+3],y+=T,u[b+3]<255&&(T=T*u[b+3]/250),C+=T*u[b],k+=T*u[b+1],O+=T*u[b+2],w+=T))}}f[v]=C/w,f[v+1]=k/w,f[v+2]=O/w,f[v+3]=M/y}return d}}F(of,"type","Resize"),F(of,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),F(of,"uniformLocations",["uDelta","uTaps"]),oe.setClass(of);class af extends Dt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.saturation;for(let s=0;s<t.length;s+=4){const i=t[s],o=t[s+1],a=t[s+2],l=Math.max(i,o,a);t[s]+=l!==i?(l-i)*n:0,t[s+1]+=l!==o?(l-o)*n:0,t[s+2]+=l!==a?(l-a)*n:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}F(af,"type","Saturation"),F(af,"defaults",{saturation:0}),F(af,"uniformLocations",["uSaturation"]),oe.setClass(af);class lf extends Dt{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const n=-this.vibrance;for(let s=0;s<t.length;s+=4){const i=t[s],o=t[s+1],a=t[s+2],l=Math.max(i,o,a),c=(i+o+a)/3,u=2*Math.abs(l-c)/255*n;t[s]+=l!==i?(l-i)*u:0,t[s+1]+=l!==o?(l-o)*u:0,t[s+2]+=l!==a?(l-a)*u:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}F(lf,"type","Vibrance"),F(lf,"defaults",{vibrance:0}),F(lf,"uniformLocations",["uVibrance"]),oe.setClass(lf);const iY=r=>{if(!r)return null;const e=document.createElement("canvas");e.width=r.width,e.height=r.height;const t=e.getContext("2d");if(!t)return null;const n=r.getElement();return t.drawImage(n,0,0),t.getImageData(0,0,r.width,r.height)},F_=r=>{const e=document.createElement("canvas");e.width=r.width,e.height=r.height;const t=e.getContext("2d");return t?(t.putImageData(r,0,0),e.toDataURL()):""},tA=async(r,e)=>new Promise((t,n)=>{br.fromURL(r,{crossOrigin:"anonymous"}).then(s=>{s.set({left:e.left,top:e.top,scaleX:e.scaleX,scaleY:e.scaleY,originX:"center",originY:"center"}),t(s)}).catch(s=>{console.error("createFabricImage: Error loading image:",s),n(s)})}),oY=(r,e)=>{const t=e.width||800,n=e.height||600,s=r.width/r.height,i=t/n;let o=1;s>i?o=t/r.width:o=n/r.height,r.scale(o*.9),r.set({left:t/2,top:n/2,originX:"center",originY:"center"})},rA="/default-image.jpg",aY=r=>new Promise((e,t)=>{const n=new Image;n.crossOrigin="Anonymous",n.onload=()=>{const s=document.createElement("canvas");s.width=n.width,s.height=n.height;const i=s.getContext("2d");if(!i){t(new Error("Could not get canvas context"));return}i.drawImage(n,0,0);const o=i.getImageData(0,0,s.width,s.height);e(o),se(ie,"load_image_data",{url:n.src,width:n.width,height:n.height})},n.onerror=t,n.src=r}),lY=(r,e=400,t=300)=>{const n=document.createElement("canvas"),s=n.getContext("2d");if(!s)throw se(ie,"scale_image_data_error",{message:"Could not get canvas context"}),new Error("Could not get canvas context");let i=r.width,o=r.height;i>o?i>e&&(o=Math.round(o*e/i),i=e):o>t&&(i=Math.round(i*t/o),o=t),n.width=i,n.height=o;const a=document.createElement("canvas");a.width=r.width,a.height=r.height;const l=a.getContext("2d");if(!l)throw se(ie,"scale_image_data_error",{message:"Could not get temporary canvas context"}),new Error("Could not get temp canvas context");return l.putImageData(r,0,0),s.drawImage(a,0,0,r.width,r.height,0,0,i,o),se(ie,"scale_image_data",{originalWidth:r.width,originalHeight:r.height,scaledWidth:i,scaledHeight:o}),s.getImageData(0,0,i,o)},cY=async r=>{try{const e=await aY(rA),t=lY(e),n=await cD(t,r);return se(ie,"generate_preset_preview",{filters:JSON.stringify(r),originalWidth:e.width,originalHeight:e.height,processedWidth:n.width,processedHeight:n.height}),F_(n)}catch(e){return se(ie,"generate_preset_preview_error",{message:e.message}),rA}};class ca{static async savePreset(e,t,n,s){try{const i=await cY(n.filters);return{id:(await Az(Mf(bi,this.COLLECTION_NAME),{name:n.name,filters:n.filters,userId:e,userName:t,userPhotoURL:s||"",previewUrl:i,downloads:0,createdAt:fv(),updatedAt:fv()})).id,name:n.name,filters:n.filters,userId:e,userName:t,userPhotoURL:s||"",previewUrl:i,downloads:0,createdAt:Ue.now(),updatedAt:Ue.now()}}catch(i){throw se(ie,"save_preset_error",{userId:e,message:i.message}),console.error("Error saving preset:",i),new Error("Failed to save preset")}}static async getUserPresets(e){try{const t=g_(Mf(bi,this.COLLECTION_NAME),eO("userId","==",e),Nf("updatedAt","desc")),n=await m_(t),s=[];return n.forEach(i=>{const o=i.data();s.push({id:i.id,name:o.name,filters:o.filters,userId:o.userId,userName:o.userName,userPhotoURL:o.userPhotoURL,previewUrl:o.previewUrl,downloads:o.downloads||0,createdAt:o.createdAt,updatedAt:o.updatedAt})}),s}catch(t){throw se(ie,"fetch_user_presets_error",{userId:e,message:t.message}),new Error("Failed to fetch presets")}}static async getPublicPresets(){try{const e=g_(Mf(bi,this.COLLECTION_NAME),Nf("downloads","desc"),Nf("createdAt","desc")),t=await m_(e),n=[];return t.forEach(s=>{const i=s.data();n.push({id:s.id,name:i.name,filters:i.filters,userId:i.userId,userName:i.userName,userPhotoURL:i.userPhotoURL,previewUrl:i.previewUrl,downloads:i.downloads||0,createdAt:i.createdAt,updatedAt:i.updatedAt})}),se(ie,"fetch_public_presets",{count:n.length}),n}catch(e){throw se(ie,"fetch_public_presets_error",{message:e.message}),new Error("Failed to fetch public presets")}}static async deletePreset(e){try{await bz(ah(bi,this.COLLECTION_NAME,e)),se(ie,"preset_deleted",{presetId:e})}catch(t){throw se(ie,"delete_preset_error",{message:t.message}),new Error("Failed to delete preset")}}static async incrementDownloads(e){try{await xz(ah(bi,this.COLLECTION_NAME,e),{downloads:Iz(1),updatedAt:fv()}),se(ie,"preset_downloaded",{presetId:e})}catch(t){throw se(ie,"increment_downloads_error",{presetId:e,message:t.message}),new Error("Failed to increment downloads")}}}ad(ca,"COLLECTION_NAME","presets");const uY={brightness:0,contrast:0,saturation:0,blur:0,sharpen:0,hue:0,hslSaturation:0,lightness:0,curves:null},Ov={imageUrl:null,activeFilters:uY,cloudPresets:[],presetsLoading:!1,presetsError:null},Gf=lS("edit/saveCloudPreset",async({userId:r,userName:e,userPhotoURL:t,preset:n})=>await ca.savePreset(r,e,n,t)),qf=lS("edit/loadCloudPresets",async r=>await ca.getUserPresets(r)),Yf=lS("edit/deleteCloudPreset",async r=>(await ca.deletePreset(r),r)),AT=nP({name:"edit",initialState:Ov,reducers:{setImageUrl:(r,e)=>{r.imageUrl=e.payload,r.activeFilters={...Ov.activeFilters}},applyFilter:(r,e)=>{const{type:t,value:n}=e.payload;switch(t){case"brightness":r.activeFilters.brightness=n;break;case"contrast":r.activeFilters.contrast=n;break;case"saturation":r.activeFilters.saturation=n;break;case"blur":r.activeFilters.blur=n;break;case"sharpen":r.activeFilters.sharpen=n;break;case"hue":r.activeFilters.hue=n;break;case"hslSaturation":r.activeFilters.hslSaturation=n;break;case"lightness":r.activeFilters.lightness=n;break;case"curves":r.activeFilters.curves=n;break;case"reset":r.activeFilters.blur=0,r.activeFilters.brightness=0,r.activeFilters.contrast=0,r.activeFilters.curves=null,r.activeFilters.hslSaturation=0,r.activeFilters.hue=0,r.activeFilters.lightness=0,r.activeFilters.saturation=0,r.activeFilters.sharpen=0;break;case"resetHsl":r.activeFilters.hue=0,r.activeFilters.hslSaturation=0,r.activeFilters.lightness=0;break}},resetFilters:r=>{r.activeFilters={...Ov.activeFilters}},applyCloudPreset:(r,e)=>{r.activeFilters=e.payload.filters},clearPresetsError:r=>{r.presetsError=null}},extraReducers:r=>{r.addCase(Gf.pending,e=>{e.presetsLoading=!0,e.presetsError=null}).addCase(Gf.fulfilled,(e,t)=>{e.presetsLoading=!1,e.cloudPresets.unshift(t.payload),se(ie,"prest_saved",{presetName:t.payload.name})}).addCase(Gf.rejected,(e,t)=>{e.presetsLoading=!1,e.presetsError=t.error.message||"Failed to save preset",se(ie,"save_preset_error",{message:t.error.message})}).addCase(qf.pending,e=>{e.presetsLoading=!0,e.presetsError=null}).addCase(qf.fulfilled,(e,t)=>{e.presetsLoading=!1,e.cloudPresets=t.payload,se(ie,"presets_loaded",{count:t.payload.length})}).addCase(qf.rejected,(e,t)=>{e.presetsLoading=!1,e.presetsError=t.error.message||"Failed to load presets",se(ie,"load_presets_error",{message:t.error.message})}).addCase(Yf.pending,e=>{e.presetsLoading=!0}).addCase(Yf.fulfilled,(e,t)=>{e.presetsLoading=!1,e.cloudPresets=e.cloudPresets.filter(n=>n.id!==t.payload),se(ie,"preset_deleted",{presetId:t.payload})}).addCase(Yf.rejected,(e,t)=>{e.presetsLoading=!1,e.presetsError=t.error.message||"Failed to delete preset",se(ie,"delete_preset_error",{message:t.error.message})})}}),{setImageUrl:gK,applyFilter:Pn,resetFilters:fM,applyCloudPreset:hY,clearPresetsError:nA}=AT.actions,dY={user:null,isAuthorized:!1,isLoading:!0,error:null,isRegistering:!1},pM=nP({name:"auth",initialState:dY,reducers:{setUser:(r,e)=>{if(r.user=e.payload,r.isAuthorized=!!e.payload,r.isLoading=!1,r.error=null,e.payload&&e.payload.email){const t=e.payload.email||"No email";se(ie,"user_login",{email:t})}},setLoading:(r,e)=>{r.isLoading=e.payload},setRegistering:(r,e)=>{r.isRegistering=e.payload},setError:(r,e)=>{r.error=e.payload,r.isLoading=!1,se(ie,"auth_error",{message:e.payload})},clearError:r=>{r.error=null},logout:(r,e)=>{r.user=null,r.isAuthorized=!1,r.isLoading=!1,r.error=null,se(ie,"user_logout")}}}),{setUser:sA,setLoading:To,setRegistering:fY,setError:Co,clearError:mK,logout:yK}=pM.actions,pY=pM.reducer,gY=G2({edit:AT.reducer,auth:pY}),mY={edit:{...AT.getInitialState(),presets:[],cloudPresets:[]},auth:{user:null,isAuthorized:!1,isLoading:!0,isRegistering:!1,error:null}},yY=d$({reducer:gY,preloadedState:mY,middleware:r=>r({serializableCheck:{ignoredActions:["edit/applyFilter","auth/setUser","edit/saveCloudPreset/fulfilled","edit/loadCloudPresets/fulfilled","edit/deleteCloudPreset/fulfilled","edit/updateCloudPreset/fulfilled"],ignoredPaths:["edit.activeFilters.curves","auth.user","edit.cloudPresets"]}})}),wa=()=>iV(),ys=lV,cf=r=>{switch(r){case"auth/email-already-in-use":return"Email is used already";case"auth/invalid-email":return"Invalid email format";case"auth/operation-not-allowed":return"Operation is not allowed";case"auth/weak-password":return"Weak password";case"auth/user-disabled":return"User is disabled";case"auth/user-not-found":return"User is not found";case"auth/wrong-password":return"Wrong password";case"auth/popup-closed-by-user":return"Authorization was cancelled by user";case"auth/popup-blocked":return"Popup was blocked by browser";case"auth/network-request-failed":return"Network error";default:return"Auth error"}},vY=async r=>{if(!(r!=null&&r.uid))return;const e=ah(bi,"users",r.uid);(await nO(e)).exists()||await Ez(e,{displayName:r.displayName||"",email:r.email||"",photoURL:r.photoURL||"",createdAt:Ue.now()})},kT=()=>{const r=wa();return L.useEffect(()=>{const i=N8(Ya,o=>{r(sA(o)),r(To(!1)),o&&vY(o)});return()=>{i()}},[r]),{login:async(i,o)=>{try{return r(To(!0)),r(Co(null)),await R8(Ya,i,o),se(ie,"user_login",{email:i}),{success:!0}}catch(a){const l=cf(a.code);return r(Co(l)),r(To(!1)),se(ie,"auth_error",{message:l}),{success:!1,error:l}}},loginWithGoogle:async()=>{try{return r(To(!0)),r(Co(null)),await tW(Ya,aD),{success:!0}}catch(i){const o=cf(i.code);return r(Co(o)),r(To(!1)),se(ie,"auth_error",{message:o}),{success:!1,error:o}}},register:async(i,o)=>{try{return r(To(!0)),r(Co(null)),await P8(Ya,i,o),se(ie,"user_register",{email:i}),{success:!0}}catch(a){const l=cf(a.code);return r(Co(l)),r(To(!1)),se(ie,"register_error",{message:l}),{success:!1,error:l}}},logout:async()=>{try{return await F8(Ya),r(sA(null)),se(ie,"user_logout"),{success:!0}}catch(i){const o=cf(i.code);return r(Co(o)),se(ie,"logout_error",{message:o}),{success:!1,error:o}}}}},_Y=()=>{kT();const{user:r}=ys(s=>s.auth);if(!r)return null;const e=(s,i)=>s?s.split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2):i?i[0].toUpperCase():"U",t=r.photoURL,n=e(r.displayName,r.email);return D.jsx("div",{className:"user-avatar-container",children:D.jsx(Jo,{to:`/users/${r.uid}`,children:t?D.jsx("img",{src:t,alt:"avatar",className:"user-avatar-image",referrerPolicy:"no-referrer"}):D.jsx("div",{className:"user-avatar-initials",children:n})})})},wY=()=>{var o;const{isAuthorized:r,user:e,isRegistering:t}=ys(a=>a.auth),{logout:n}=kT(),s=kg(),i=async()=>{await n(),se(ie,"user_logout"),s("/")};return D.jsx("header",{className:"header",children:D.jsxs("div",{className:"header-content",children:[D.jsx(Jo,{to:"/",children:D.jsx("img",{src:"/photoeditor/logo.svg",alt:"logo",className:"logo"})}),r?D.jsxs("div",{className:"header-user-content",children:[D.jsxs("span",{className:"user-greeting",children:["Welcome, ",(e==null?void 0:e.displayName)||((o=e==null?void 0:e.email)==null?void 0:o.split("@")[0]),"!"]}),D.jsx(_Y,{}),D.jsx("button",{type:"button",className:"logout-btn",onClick:i,children:"Log out"})]}):D.jsx(Jo,{to:"/auth",className:"login-link",children:"Log In"})]})})},SY=async(r,e)=>{if(!(!r||!e))try{const t=document.createElement("canvas"),n=e.width*(e.scaleX||1),s=e.height*(e.scaleY||1);t.width=n,t.height=s;const i=t.getContext("2d");if(i){r.renderAll();const o=r.toDataURL({format:"png",quality:1,left:(e.left||0)-n/2,top:(e.top||0)-s/2,width:n,height:s,multiplier:1}),a=new Image;a.onload=()=>{if(a.width>0&&a.height>0){i.drawImage(a,0,0,n,s);const l=t.toDataURL("image/png",1);gM(l,"edited_image.png"),se(ie,"image_saved",{width:n,height:s})}else Dv(r)},a.onerror=()=>{se(ie,"image_save_error",{message:"Image loading failed"}),Dv(r)},a.src=o}}catch(t){se(ie,"image_save_error",{message:t.message}),Dv(r)}},Dv=r=>{if(r)try{const e=r.backgroundColor;r.backgroundColor="",r.renderAll();const t=r.toDataURL({format:"png",multiplier:1});r.backgroundColor=e||"",r.renderAll(),gM(t,"edited_image.png"),se(ie,"image_saved_fallback",{message:"Fallback save method used"})}catch(e){se(ie,"image_save_fallback_error",{message:e.message})}},gM=(r,e)=>{const t=document.createElement("a");t.href=r,t.download=e,document.body.appendChild(t),t.click(),setTimeout(()=>{document.body.removeChild(t)},100)},TY=(r,e,t,n,s)=>{const i=L.useRef(null),o=L.useRef(null),a=L.useRef(r),l=L.useRef(e),c=L.useRef(t),u=L.useRef(n),d=L.useRef(s);a.current=r,l.current=e,c.current=t,u.current=n,d.current=s,i.current===null&&(i.current=JSON.parse(JSON.stringify(n)));const f=L.useCallback(async()=>{const m=a.current,v=l.current,T=c.current,w=u.current,y=d.current;if(!(!v||!T||!m)&&!mH(w,i.current)){se(ie,"apply_filters",{filters:w});try{if(!gH(w)){const M=F_(T),x=await tA(M,v);m.remove(v),m.add(x),m.renderAll(),y(x),i.current=JSON.parse(JSON.stringify(w));return}const C=await cD(T,w),k=F_(C),O=await tA(k,v);m.remove(v),m.add(O),m.renderAll(),y(O),i.current=JSON.parse(JSON.stringify(w)),se(ie,"filters_applied",{filters:w})}catch(C){se(ie,"apply_filters_error",{message:C instanceof Error?C.message:"Unknown error applying filters"})}}},[]),p=L.useCallback(()=>{o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{f()},100)},[]);return{applyFiltersToImage:f,debouncedApplyFilters:p}},CY=r=>{r.strokeStyle="#444",r.lineWidth=.5;for(let e=0;e<=256;e+=32)r.beginPath(),r.moveTo(0,e),r.lineTo(256,e),r.stroke();for(let e=0;e<=256;e+=32)r.beginPath(),r.moveTo(e,0),r.lineTo(e,256),r.stroke();r.strokeStyle="#666",r.lineWidth=1,r.beginPath(),r.moveTo(0,0),r.lineTo(256,256),r.stroke()},EY=(r,e)=>{const t=[...e].sort((n,s)=>n.x-s.x);if(r.strokeStyle="#d62a55",r.lineWidth=2,r.beginPath(),t.length>=2){r.moveTo(t[0].x,t[0].y);for(let n=0;n<t.length-1;n++){const s=t[n],i=t[n+1],o=(s.x+i.x)/2,a=(s.y+i.y)/2;r.quadraticCurveTo(s.x,s.y,o,a)}r.quadraticCurveTo(t[t.length-1].x,t[t.length-1].y,t[t.length-1].x,t[t.length-1].y)}r.stroke()},xY=(r,e,t)=>{e.forEach((n,s)=>{r.fillStyle=s===t?"#fff":"##d62a55",r.beginPath(),r.arc(n.x,n.y,6,0,Math.PI*2),r.fill(),r.strokeStyle="#000",r.lineWidth=1,r.beginPath(),r.arc(n.x,n.y,6,0,Math.PI*2),r.stroke()})},bY=(r,e)=>{const t=[...e].sort((n,s)=>n.x-s.x);if(r<=t[0].x)return t[0].y;if(r>=t[t.length-1].x)return t[t.length-1].y;for(let n=0;n<t.length-1;n++){const s=t[n],i=t[n+1];if(r>=s.x&&r<=i.x){const o=(r-s.x)/(i.x-s.x);return s.y+o*(i.y-s.y)}}return 0},iA=(r,e,t)=>{for(let n=0;n<t.length;n++){const s=t[n];if(Math.sqrt(Math.pow(s.x-r,2)+Math.pow(s.y-e,2))<=10)return n}return null},AY=()=>{const r=wa(),e=L.useRef(null),[t,n]=L.useState(null),[s,i]=L.useState(!1),[o,a]=L.useState([{x:0,y:0},{x:255,y:255}]);L.useEffect(()=>{const m=e.current;if(!m)return;const v=m.getContext("2d");if(!v)return;v.clearRect(0,0,256,256),CY(v),EY(v,o),xY(v,o,t);const T=setTimeout(()=>{l()},100);return()=>clearTimeout(T)},[o]);const l=()=>{const m=new Array(256).fill(0).map((T,w)=>Math.round(bY(w,o))),v=m.every((T,w)=>Math.abs(T-w)<2);r(Pn(v?{type:"curves",value:null}:{type:"curves",value:m})),se(ie,"apply_curves")},c=m=>{const v=e.current;if(!v)return;const T=v.getBoundingClientRect(),w=m.clientX-T.left,y=m.clientY-T.top,C=iA(w,y,o);if(C!==null)n(C),i(!0);else{const k={x:w,y};a([...o,k]),n(o.length),i(!0)}},u=m=>{if(!s||t===null)return;const v=e.current;if(!v)return;const T=v.getBoundingClientRect(),w=Math.max(0,Math.min(256,m.clientX-T.left)),y=Math.max(0,Math.min(256,m.clientY-T.top)),C=[...o];C[t]={x:w,y},a(C)},d=()=>{i(!1)},f=m=>{const v=e.current;if(!v)return;const T=v.getBoundingClientRect(),w=m.clientX-T.left,y=m.clientY-T.top,C=iA(w,y,o);if(C!==null&&o.length>2){const k=[...o];k.splice(C,1),a(k),n(null)}},p=()=>{a([{x:0,y:0},{x:255,y:255}]),n(null)};return D.jsxs("div",{className:"curve-editor",children:[D.jsx("canvas",{className:"curve-canvas","data-testid":"curve-canvas",ref:e,width:256,height:256,onMouseDown:c,onMouseMove:u,onMouseUp:d,onMouseLeave:d,onDoubleClick:f}),D.jsx("div",{className:"curve-controls",children:D.jsx("button",{className:"reset-curve-button",onClick:p,children:"Reset Curve"})})]})},Ai=({min:r,max:e,value:t,onChange:n})=>{const[s,i]=L.useState(t);nr.useEffect(()=>{i(t)},[t]);const o=l=>(l-r)/(e-r)*100,a=l=>{const c=parseInt(l.target.value);i(c),n(c)};return D.jsxs("div",{className:"range-slider-container",children:[D.jsx("input",{type:"range",min:r,max:e,value:s,onChange:a,className:"range-slider-input",step:1}),D.jsxs("div",{className:"range-slider-styled",children:[D.jsx("div",{className:"range-slider-track",children:D.jsx("div",{className:"range-slider-fill",style:{width:`${o(s)}%`}})}),D.jsx("div",{className:"range-slider-thumb",style:{left:`${o(s)}%`}})]})]})},kY=()=>{const r=wa(),[e,t]=L.useState(0),[n,s]=L.useState(0),[i,o]=L.useState(0),a=[{h:0,s:100,l:50},{h:30,s:100,l:50},{h:60,s:100,l:50},{h:120,s:100,l:50},{h:180,s:100,l:50},{h:240,s:100,l:50},{h:270,s:100,l:50},{h:300,s:100,l:50}],l=p=>{t(p),r(Pn({type:"hue",value:p})),se(ie,"apply_hue",{value:p})},c=p=>{s(p),r(Pn({type:"hslSaturation",value:p})),se(ie,"apply_hsl_saturation",{value:p})},u=p=>{o(p),r(Pn({type:"lightness",value:p})),se(ie,"apply_lightness",{value:p})},d=p=>{const m=(p.h+e)%360,v=Math.max(0,Math.min(100,p.s+n)),T=Math.max(0,Math.min(100,p.l+i));return`hsl(${m}, ${v}%, ${T}%)`},f=()=>{t(0),s(0),o(0),r(Pn({type:"resetHsl",value:null}))};return D.jsxs("div",{className:"hsl-editor",children:[D.jsxs("div",{className:"hsl-preview",children:[D.jsx("div",{className:"hsl-preview-title",children:"Color Preview"}),D.jsxs("div",{className:"hsl-preview-colors",children:[D.jsxs("div",{className:"hsl-preview-row",children:[D.jsx("div",{className:"hsl-preview-label",children:"Original"}),D.jsx("div",{className:"hsl-preview-swatches",children:a.map((p,m)=>D.jsx("div",{className:"hsl-preview-swatch",style:{backgroundColor:`hsl(${p.h}, ${p.s}%, ${p.l}%)`}},m))})]}),D.jsxs("div",{className:"hsl-preview-row",children:[D.jsx("div",{className:"hsl-preview-label",children:"Modified"}),D.jsx("div",{className:"hsl-preview-swatches",children:a.map((p,m)=>D.jsx("div",{className:"hsl-preview-swatch",style:{backgroundColor:d(p)}},m))})]})]})]}),D.jsxs("div",{className:"hsl-controls",children:[D.jsxs("div",{className:"control-group",children:[D.jsx("label",{children:"Hue Rotation"}),D.jsxs("div",{className:"hue-slider-container",children:[D.jsx("div",{className:"hue-track"}),D.jsx(Ai,{min:-180,max:180,value:e,onChange:l})]})]}),D.jsxs("div",{className:"control-group",children:[D.jsx("label",{children:"Saturation"}),D.jsx(Ai,{min:-100,max:100,value:n,onChange:c})]}),D.jsxs("div",{className:"control-group",children:[D.jsx("label",{children:"Lightness"}),D.jsx(Ai,{min:-100,max:100,value:i,onChange:u})]}),D.jsx("button",{className:"reset-button",onClick:f,children:"Reset HSL"})]})]})},IY=()=>{const r=wa(),{activeFilters:e,cloudPresets:t,presetsLoading:n,presetsError:s}=ys(m=>m.edit),{user:i,isAuthorized:o}=ys(m=>m.auth),[a,l]=L.useState(""),[c,u]=L.useState(!1);L.useEffect(()=>{o&&(i!=null&&i.uid)&&r(qf(i.uid))},[o,i==null?void 0:i.uid,r]),L.useEffect(()=>()=>{r(nA())},[r]);const d=async()=>{if(!(!a.trim()||!(i!=null&&i.uid)))try{await r(Gf({userId:i.uid,userName:i.displayName&&i.displayName.trim()?i.displayName:i.email?i.email.split("@")[0]:"Unknown User",userPhotoURL:i.photoURL||"",preset:{name:a.trim(),filters:e}})).unwrap(),l(""),u(!1),se(ie,"save_preset")}catch(m){se(ie,"save_preset_error",{message:m})}},f=m=>{r(hY(m)),se(ie,"apply_preset",{preset:m})},p=async m=>{try{await r(Yf(m)).unwrap(),se(ie,"delete_preset",{presetId:m})}catch(v){se(ie,"delete_preset_error",{message:v})}};return o?D.jsxs("div",{className:"preset-manager",children:[D.jsxs("div",{className:"presets-header",children:[D.jsx("h3",{children:"Presets"}),D.jsx("button",{onClick:()=>u(!0),className:"add-preset-btn",disabled:n,children:n?"...":"Save preset"})]}),s&&D.jsxs("div",{className:"error-message",children:[s,D.jsx("button",{onClick:()=>r(nA()),children:"✕"})]}),c&&D.jsxs("div",{className:"add-preset-form",children:[D.jsx("input",{type:"text",value:a,onChange:m=>l(m.target.value),placeholder:"Preset name",className:"preset-name-input",autoFocus:!0,onKeyDown:m=>{m.key==="Enter"&&d()}}),D.jsxs("div",{className:"form-buttons",children:[D.jsx("button",{onClick:d,disabled:!a.trim()||n,className:"save-btn",children:"Save"}),D.jsx("button",{onClick:()=>{u(!1),l("")},className:"cancel-btn",children:"Cancel"})]})]}),D.jsxs("div",{className:"presets-list",children:[n&&t.length===0&&D.jsx("div",{className:"loading",children:"Loading presets..."}),t.length===0&&!n&&D.jsx("div",{className:"empty-state",children:D.jsx("p",{children:"You have no saved presets"})}),t.map(m=>D.jsxs("div",{className:"preset-item",children:[D.jsx("div",{className:"preset-info",children:D.jsx("span",{className:"preset-name",children:m.name})}),D.jsxs("div",{className:"preset-actions",children:[D.jsx("button",{onClick:()=>f(m),className:"apply-btn",children:"Apply"}),D.jsx("button",{onClick:()=>p(m.id),className:"delete-btn",disabled:n,children:"Delete"})]})]},m.id))]})]}):D.jsx("div",{className:"preset-manager",children:D.jsx("div",{className:"auth-notice",children:D.jsx("p",{children:"Log in to save and apply presets"})})})},PY=({canvas:r,image:e})=>{const t=wa(),n=ys(f=>f.edit.activeFilters),[s,i]=L.useState("basic"),o=f=>{t(Pn({type:"brightness",value:f}))},a=f=>{t(Pn({type:"contrast",value:f}))},l=f=>{t(Pn({type:"saturation",value:f}))},c=f=>{t(Pn({type:"blur",value:f}))},u=f=>{t(Pn({type:"sharpen",value:f}))},d=()=>{t(fM())};return D.jsxs("div",{className:"toolbar",children:[D.jsxs("div",{className:"toolbar-tabs",children:[D.jsx("button",{className:`toolbar-tab ${s==="basic"?"active":""}`,onClick:()=>i("basic"),children:"Basic"}),D.jsx("button",{className:`toolbar-tab ${s==="curves"?"active":""}`,onClick:()=>i("curves"),children:"Curves"}),D.jsx("button",{className:`toolbar-tab ${s==="hsl"?"active":""}`,onClick:()=>i("hsl"),children:"HSL"}),D.jsx("button",{className:`toolbar-tab ${s==="presets"?"active":""}`,onClick:()=>i("presets"),children:"Presets"})]}),D.jsxs("div",{className:"toolbar-content",children:[s==="basic"&&D.jsxs("div",{className:"basic-controls",children:[D.jsx("h3",{children:"Adjustments"}),D.jsxs("div",{className:"control-group",children:[D.jsx("label",{children:"Brightness"}),D.jsx(Ai,{min:-100,max:100,value:n.brightness,onChange:o})]}),D.jsxs("div",{className:"control-group",children:[D.jsx("label",{children:"Contrast"}),D.jsx(Ai,{min:-100,max:100,value:n.contrast,onChange:a})]}),D.jsxs("div",{className:"control-group",children:[D.jsx("label",{children:"Saturation"}),D.jsx(Ai,{min:-100,max:100,value:n.saturation,onChange:l})]}),D.jsxs("div",{className:"control-group",children:[D.jsx("label",{children:"Blur"}),D.jsx(Ai,{min:0,max:20,value:n.blur,onChange:c})]}),D.jsxs("div",{className:"control-group",children:[D.jsx("label",{children:"Sharpen"}),D.jsx(Ai,{min:0,max:100,value:n.sharpen,onChange:u})]}),D.jsx("button",{className:"reset-button",onClick:d,children:"Reset All"})]}),s==="curves"&&D.jsxs("div",{className:"curves-controls",children:[D.jsx("h3",{children:"Curve Adjustments"}),D.jsxs("div",{className:"curve-selector",children:[D.jsx("button",{className:"curve-channel active",children:"RGB"}),D.jsx("button",{className:"curve-channel",children:"Red"}),D.jsx("button",{className:"curve-channel",children:"Green"}),D.jsx("button",{className:"curve-channel",children:"Blue"})]}),D.jsx(AY,{})]}),s==="hsl"&&D.jsxs("div",{className:"hsl-controls",children:[D.jsx("h3",{children:"HSL Adjustments"}),D.jsx(kY,{})]}),s==="presets"&&D.jsx("div",{className:"presets-controls",children:D.jsx(IY,{})})]})]})},RY=()=>{const r=L.useRef(null),[e,t]=L.useState(null),[n,s]=L.useState(null),[i,o]=L.useState(null),a=L.useRef(null),l=wa(),c=ys(y=>y.edit.activeFilters),{debouncedApplyFilters:u}=TY(e,n,i,c,s),d=L.useRef(u);d.current=u,L.useEffect(()=>{if(r.current)return lD().then(()=>{if(!r.current)return;const y=new M_(r.current,{backgroundColor:"#1e1e1e",width:800,height:600});t(y)}).catch(y=>se(ie,"wasm_init_error",{error:y})),()=>{e&&e.dispose()}},[]),L.useEffect(()=>{d.current&&(se(ie,"apply_filters",{filters:c}),d.current())},[c]);const f=y=>{var k;const C=(k=y.target.files)==null?void 0:k[0];!C||!e||(p(C),se(ie,"file_upload",{file:C}))},p=y=>{if(!e)return;const C=new FileReader;C.onload=k=>{var M;const O=(M=k.target)==null?void 0:M.result;typeof O=="string"&&br.fromURL(O).then(x=>{e.clear(),oY(x,e),e.add(x),e.renderAll(),s(x),l(fM());const E=iY(x);E&&o(E)}).catch(x=>{se(ie,"upload_error",{file:y})})},C.readAsDataURL(y)},m=y=>{y.preventDefault(),y.stopPropagation()},v=y=>{y.preventDefault(),y.stopPropagation();const C=y.dataTransfer.files;if(C.length>0){const k=C[0];k.type.match(/image.*/)&&p(k)}},T=()=>{var y;(y=a.current)==null||y.click()},w=()=>{e&&n&&(SY(e,n),se(ie,"save_image",{image:n}))};return D.jsxs("div",{className:"photo-editor",children:[D.jsx("div",{className:"editor-header",children:D.jsxs("div",{className:"editor-actions",children:[D.jsx("button",{onClick:T,className:"action-button",children:"Open Image"}),D.jsx("button",{onClick:w,className:"action-button",disabled:!n,children:"Save Image"})]})}),!n&&D.jsx("div",{className:"placeholder",onDragOver:m,onDrop:v,children:D.jsx("p",{children:'Drag and drop an image here or click "Open Image" to start'})}),D.jsxs("div",{className:"editor-main",children:[D.jsx("div",{className:"canvas-container",children:D.jsx("canvas",{ref:r})}),n&&D.jsx(PY,{canvas:e,image:n})]}),D.jsx("input",{type:"file",ref:a,onChange:f,accept:"image/*",style:{display:"none"}})]})};var zh=r=>r.type==="checkbox",$o=r=>r instanceof Date,pr=r=>r==null;const mM=r=>typeof r=="object";var mt=r=>!pr(r)&&!Array.isArray(r)&&mM(r)&&!$o(r),OY=r=>mt(r)&&r.target?zh(r.target)?r.target.checked:r.target.value:r,DY=r=>r.substring(0,r.search(/\.\d+(\.|$)/))||r,MY=(r,e)=>r.has(DY(e)),NY=r=>{const e=r.constructor&&r.constructor.prototype;return mt(e)&&e.hasOwnProperty("isPrototypeOf")},IT=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Mt(r){let e;const t=Array.isArray(r),n=typeof FileList<"u"?r instanceof FileList:!1;if(r instanceof Date)e=new Date(r);else if(!(IT&&(r instanceof Blob||n))&&(t||mt(r)))if(e=t?[]:Object.create(Object.getPrototypeOf(r)),!t&&!NY(r))e=r;else for(const s in r)r.hasOwnProperty(s)&&(e[s]=Mt(r[s]));else return r;return e}var ey=r=>/^\w*$/.test(r),St=r=>r===void 0,PT=r=>Array.isArray(r)?r.filter(Boolean):[],RT=r=>PT(r.replace(/["|']|\]/g,"").split(/\.|\[/)),le=(r,e,t)=>{if(!e||!mt(r))return t;const n=(ey(e)?[e]:RT(e)).reduce((s,i)=>pr(s)?s:s[i],r);return St(n)||n===r?St(r[e])?t:r[e]:n},Kn=r=>typeof r=="boolean",ze=(r,e,t)=>{let n=-1;const s=ey(e)?[e]:RT(e),i=s.length,o=i-1;for(;++n<i;){const a=s[n];let l=t;if(n!==o){const c=r[a];l=mt(c)||Array.isArray(c)?c:isNaN(+s[n+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;r[a]=l,r=r[a]}};const oA={BLUR:"blur",FOCUS_OUT:"focusout"},Rn={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},bs={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},FY=nr.createContext(null);FY.displayName="HookFormContext";var LY=(r,e,t,n=!0)=>{const s={defaultValues:e._defaultValues};for(const i in r)Object.defineProperty(s,i,{get:()=>{const o=i;return e._proxyFormState[o]!==Rn.all&&(e._proxyFormState[o]=!n||Rn.all),r[o]}});return s};const VY=typeof window<"u"?nr.useLayoutEffect:nr.useEffect;var ss=r=>typeof r=="string",jY=(r,e,t,n,s)=>ss(r)?(n&&e.watch.add(r),le(t,r,s)):Array.isArray(r)?r.map(i=>(n&&e.watch.add(i),le(t,i))):(n&&(e.watchAll=!0),t),L_=r=>pr(r)||!mM(r);function ki(r,e,t=new WeakSet){if(L_(r)||L_(e))return r===e;if($o(r)&&$o(e))return r.getTime()===e.getTime();const n=Object.keys(r),s=Object.keys(e);if(n.length!==s.length)return!1;if(t.has(r)||t.has(e))return!0;t.add(r),t.add(e);for(const i of n){const o=r[i];if(!s.includes(i))return!1;if(i!=="ref"){const a=e[i];if($o(o)&&$o(a)||mt(o)&&mt(a)||Array.isArray(o)&&Array.isArray(a)?!ki(o,a,t):o!==a)return!1}}return!0}var yM=(r,e,t,n,s)=>e?{...t[r],types:{...t[r]&&t[r].types?t[r].types:{},[n]:s||!0}}:{},xu=r=>Array.isArray(r)?r:[r],aA=()=>{let r=[];return{get observers(){return r},next:s=>{for(const i of r)i.next&&i.next(s)},subscribe:s=>(r.push(s),{unsubscribe:()=>{r=r.filter(i=>i!==s)}}),unsubscribe:()=>{r=[]}}},Cr=r=>mt(r)&&!Object.keys(r).length,OT=r=>r.type==="file",On=r=>typeof r=="function",og=r=>{if(!IT)return!1;const e=r?r.ownerDocument:0;return r instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},vM=r=>r.type==="select-multiple",DT=r=>r.type==="radio",$Y=r=>DT(r)||zh(r),Mv=r=>og(r)&&r.isConnected;function UY(r,e){const t=e.slice(0,-1).length;let n=0;for(;n<t;)r=St(r)?n++:r[e[n++]];return r}function BY(r){for(const e in r)if(r.hasOwnProperty(e)&&!St(r[e]))return!1;return!0}function _t(r,e){const t=Array.isArray(e)?e:ey(e)?[e]:RT(e),n=t.length===1?r:UY(r,t),s=t.length-1,i=t[s];return n&&delete n[i],s!==0&&(mt(n)&&Cr(n)||Array.isArray(n)&&BY(n))&&_t(r,t.slice(0,-1)),r}var _M=r=>{for(const e in r)if(On(r[e]))return!0;return!1};function ag(r,e={}){const t=Array.isArray(r);if(mt(r)||t)for(const n in r)Array.isArray(r[n])||mt(r[n])&&!_M(r[n])?(e[n]=Array.isArray(r[n])?[]:{},ag(r[n],e[n])):pr(r[n])||(e[n]=!0);return e}function wM(r,e,t){const n=Array.isArray(r);if(mt(r)||n)for(const s in r)Array.isArray(r[s])||mt(r[s])&&!_M(r[s])?St(e)||L_(t[s])?t[s]=Array.isArray(r[s])?ag(r[s],[]):{...ag(r[s])}:wM(r[s],pr(e)?{}:e[s],t[s]):t[s]=!ki(r[s],e[s]);return t}var Uc=(r,e)=>wM(r,e,ag(e));const lA={value:!1,isValid:!1},cA={value:!0,isValid:!0};var SM=r=>{if(Array.isArray(r)){if(r.length>1){const e=r.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return r[0].checked&&!r[0].disabled?r[0].attributes&&!St(r[0].attributes.value)?St(r[0].value)||r[0].value===""?cA:{value:r[0].value,isValid:!0}:cA:lA}return lA},TM=(r,{valueAsNumber:e,valueAsDate:t,setValueAs:n})=>St(r)?r:e?r===""?NaN:r&&+r:t&&ss(r)?new Date(r):n?n(r):r;const uA={isValid:!1,value:null};var CM=r=>Array.isArray(r)?r.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,uA):uA;function hA(r){const e=r.ref;return OT(e)?e.files:DT(e)?CM(r.refs).value:vM(e)?[...e.selectedOptions].map(({value:t})=>t):zh(e)?SM(r.refs).value:TM(St(e.value)?r.ref.value:e.value,r)}var zY=(r,e,t,n)=>{const s={};for(const i of r){const o=le(e,i);o&&ze(s,i,o._f)}return{criteriaMode:t,names:[...r],fields:s,shouldUseNativeValidation:n}},lg=r=>r instanceof RegExp,Bc=r=>St(r)?r:lg(r)?r.source:mt(r)?lg(r.value)?r.value.source:r.value:r,dA=r=>({isOnSubmit:!r||r===Rn.onSubmit,isOnBlur:r===Rn.onBlur,isOnChange:r===Rn.onChange,isOnAll:r===Rn.all,isOnTouch:r===Rn.onTouched});const fA="AsyncFunction";var WY=r=>!!r&&!!r.validate&&!!(On(r.validate)&&r.validate.constructor.name===fA||mt(r.validate)&&Object.values(r.validate).find(e=>e.constructor.name===fA)),HY=r=>r.mount&&(r.required||r.min||r.max||r.maxLength||r.minLength||r.pattern||r.validate),pA=(r,e,t)=>!t&&(e.watchAll||e.watch.has(r)||[...e.watch].some(n=>r.startsWith(n)&&/^\.\w+/.test(r.slice(n.length))));const bu=(r,e,t,n)=>{for(const s of t||Object.keys(r)){const i=le(r,s);if(i){const{_f:o,...a}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!n)return!0;if(o.ref&&e(o.ref,o.name)&&!n)return!0;if(bu(a,e))break}else if(mt(a)&&bu(a,e))break}}};function gA(r,e,t){const n=le(r,t);if(n||ey(t))return{error:n,name:t};const s=t.split(".");for(;s.length;){const i=s.join("."),o=le(e,i),a=le(r,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(a&&a.type)return{name:i,error:a};if(a&&a.root&&a.root.type)return{name:`${i}.root`,error:a.root};s.pop()}return{name:t}}var GY=(r,e,t,n)=>{t(r);const{name:s,...i}=r;return Cr(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!n||Rn.all))},qY=(r,e,t)=>!r||!e||r===e||xu(r).some(n=>n&&(t?n===e:n.startsWith(e)||e.startsWith(n))),YY=(r,e,t,n,s)=>s.isOnAll?!1:!t&&s.isOnTouch?!(e||r):(t?n.isOnBlur:s.isOnBlur)?!r:(t?n.isOnChange:s.isOnChange)?r:!0,XY=(r,e)=>!PT(le(r,e)).length&&_t(r,e),KY=(r,e,t)=>{const n=xu(le(r,t));return ze(n,"root",e[t]),ze(r,t,n),r},Xf=r=>ss(r);function mA(r,e,t="validate"){if(Xf(r)||Array.isArray(r)&&r.every(Xf)||Kn(r)&&!r)return{type:t,message:Xf(r)?r:"",ref:e}}var Ba=r=>mt(r)&&!lg(r)?r:{value:r,message:""},yA=async(r,e,t,n,s,i)=>{const{ref:o,refs:a,required:l,maxLength:c,minLength:u,min:d,max:f,pattern:p,validate:m,name:v,valueAsNumber:T,mount:w}=r._f,y=le(t,v);if(!w||e.has(v))return{};const C=a?a[0]:o,k=_=>{s&&C.reportValidity&&(C.setCustomValidity(Kn(_)?"":_||""),C.reportValidity())},O={},M=DT(o),x=zh(o),E=M||x,A=(T||OT(o))&&St(o.value)&&St(y)||og(o)&&o.value===""||y===""||Array.isArray(y)&&!y.length,P=yM.bind(null,v,n,O),R=(_,b,B,te=bs.maxLength,ue=bs.minLength)=>{const ge=_?b:B;O[v]={type:_?te:ue,message:ge,ref:o,...P(_?te:ue,ge)}};if(i?!Array.isArray(y)||!y.length:l&&(!E&&(A||pr(y))||Kn(y)&&!y||x&&!SM(a).isValid||M&&!CM(a).isValid)){const{value:_,message:b}=Xf(l)?{value:!!l,message:l}:Ba(l);if(_&&(O[v]={type:bs.required,message:b,ref:C,...P(bs.required,b)},!n))return k(b),O}if(!A&&(!pr(d)||!pr(f))){let _,b;const B=Ba(f),te=Ba(d);if(!pr(y)&&!isNaN(y)){const ue=o.valueAsNumber||y&&+y;pr(B.value)||(_=ue>B.value),pr(te.value)||(b=ue<te.value)}else{const ue=o.valueAsDate||new Date(y),ge=he=>new Date(new Date().toDateString()+" "+he),Y=o.type=="time",ce=o.type=="week";ss(B.value)&&y&&(_=Y?ge(y)>ge(B.value):ce?y>B.value:ue>new Date(B.value)),ss(te.value)&&y&&(b=Y?ge(y)<ge(te.value):ce?y<te.value:ue<new Date(te.value))}if((_||b)&&(R(!!_,B.message,te.message,bs.max,bs.min),!n))return k(O[v].message),O}if((c||u)&&!A&&(ss(y)||i&&Array.isArray(y))){const _=Ba(c),b=Ba(u),B=!pr(_.value)&&y.length>+_.value,te=!pr(b.value)&&y.length<+b.value;if((B||te)&&(R(B,_.message,b.message),!n))return k(O[v].message),O}if(p&&!A&&ss(y)){const{value:_,message:b}=Ba(p);if(lg(_)&&!y.match(_)&&(O[v]={type:bs.pattern,message:b,ref:o,...P(bs.pattern,b)},!n))return k(b),O}if(m){if(On(m)){const _=await m(y,t),b=mA(_,C);if(b&&(O[v]={...b,...P(bs.validate,b.message)},!n))return k(b.message),O}else if(mt(m)){let _={};for(const b in m){if(!Cr(_)&&!n)break;const B=mA(await m[b](y,t),C,b);B&&(_={...B,...P(b,B.message)},k(B.message),n&&(O[v]=_))}if(!Cr(_)&&(O[v]={ref:C,..._},!n))return O}}return k(!0),O};const QY={mode:Rn.onSubmit,reValidateMode:Rn.onChange,shouldFocusError:!0};function JY(r={}){let e={...QY,...r},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:On(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},n={},s=mt(e.defaultValues)||mt(e.values)?Mt(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Mt(s),o={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const f={array:aA(),state:aA()},p=e.criteriaMode===Rn.all,m=N=>$=>{clearTimeout(c),c=setTimeout(N,$)},v=async N=>{if(!e.disabled&&(u.isValid||d.isValid||N)){const $=e.resolver?Cr((await x()).errors):await A(n,!0);$!==t.isValid&&f.state.next({isValid:$})}},T=(N,$)=>{!e.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((N||Array.from(a.mount)).forEach(H=>{H&&($?ze(t.validatingFields,H,$):_t(t.validatingFields,H))}),f.state.next({validatingFields:t.validatingFields,isValidating:!Cr(t.validatingFields)}))},w=(N,$=[],H,Z,J=!0,K=!0)=>{if(Z&&H&&!e.disabled){if(o.action=!0,K&&Array.isArray(le(n,N))){const re=H(le(n,N),Z.argA,Z.argB);J&&ze(n,N,re)}if(K&&Array.isArray(le(t.errors,N))){const re=H(le(t.errors,N),Z.argA,Z.argB);J&&ze(t.errors,N,re),XY(t.errors,N)}if((u.touchedFields||d.touchedFields)&&K&&Array.isArray(le(t.touchedFields,N))){const re=H(le(t.touchedFields,N),Z.argA,Z.argB);J&&ze(t.touchedFields,N,re)}(u.dirtyFields||d.dirtyFields)&&(t.dirtyFields=Uc(s,i)),f.state.next({name:N,isDirty:R(N,$),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else ze(i,N,$)},y=(N,$)=>{ze(t.errors,N,$),f.state.next({errors:t.errors})},C=N=>{t.errors=N,f.state.next({errors:t.errors,isValid:!1})},k=(N,$,H,Z)=>{const J=le(n,N);if(J){const K=le(i,N,St(H)?le(s,N):H);St(K)||Z&&Z.defaultChecked||$?ze(i,N,$?K:hA(J._f)):B(N,K),o.mount&&v()}},O=(N,$,H,Z,J)=>{let K=!1,re=!1;const me={name:N};if(!e.disabled){if(!H||Z){(u.isDirty||d.isDirty)&&(re=t.isDirty,t.isDirty=me.isDirty=R(),K=re!==me.isDirty);const Pe=ki(le(s,N),$);re=!!le(t.dirtyFields,N),Pe?_t(t.dirtyFields,N):ze(t.dirtyFields,N,!0),me.dirtyFields=t.dirtyFields,K=K||(u.dirtyFields||d.dirtyFields)&&re!==!Pe}if(H){const Pe=le(t.touchedFields,N);Pe||(ze(t.touchedFields,N,H),me.touchedFields=t.touchedFields,K=K||(u.touchedFields||d.touchedFields)&&Pe!==H)}K&&J&&f.state.next(me)}return K?me:{}},M=(N,$,H,Z)=>{const J=le(t.errors,N),K=(u.isValid||d.isValid)&&Kn($)&&t.isValid!==$;if(e.delayError&&H?(l=m(()=>y(N,H)),l(e.delayError)):(clearTimeout(c),l=null,H?ze(t.errors,N,H):_t(t.errors,N)),(H?!ki(J,H):J)||!Cr(Z)||K){const re={...Z,...K&&Kn($)?{isValid:$}:{},errors:t.errors,name:N};t={...t,...re},f.state.next(re)}},x=async N=>{T(N,!0);const $=await e.resolver(i,e.context,zY(N||a.mount,n,e.criteriaMode,e.shouldUseNativeValidation));return T(N),$},E=async N=>{const{errors:$}=await x(N);if(N)for(const H of N){const Z=le($,H);Z?ze(t.errors,H,Z):_t(t.errors,H)}else t.errors=$;return $},A=async(N,$,H={valid:!0})=>{for(const Z in N){const J=N[Z];if(J){const{_f:K,...re}=J;if(K){const me=a.array.has(K.name),Pe=J._f&&WY(J._f);Pe&&u.validatingFields&&T([Z],!0);const ur=await yA(J,a.disabled,i,p,e.shouldUseNativeValidation&&!$,me);if(Pe&&u.validatingFields&&T([Z]),ur[K.name]&&(H.valid=!1,$))break;!$&&(le(ur,K.name)?me?KY(t.errors,ur,K.name):ze(t.errors,K.name,ur[K.name]):_t(t.errors,K.name))}!Cr(re)&&await A(re,$,H)}}return H.valid},P=()=>{for(const N of a.unMount){const $=le(n,N);$&&($._f.refs?$._f.refs.every(H=>!Mv(H)):!Mv($._f.ref))&&kt(N)}a.unMount=new Set},R=(N,$)=>!e.disabled&&(N&&$&&ze(i,N,$),!ki(he(),s)),_=(N,$,H)=>jY(N,a,{...o.mount?i:St($)?s:ss(N)?{[N]:$}:$},H,$),b=N=>PT(le(o.mount?i:s,N,e.shouldUnregister?le(s,N,[]):[])),B=(N,$,H={})=>{const Z=le(n,N);let J=$;if(Z){const K=Z._f;K&&(!K.disabled&&ze(i,N,TM($,K)),J=og(K.ref)&&pr($)?"":$,vM(K.ref)?[...K.ref.options].forEach(re=>re.selected=J.includes(re.value)):K.refs?zh(K.ref)?K.refs.forEach(re=>{(!re.defaultChecked||!re.disabled)&&(Array.isArray(J)?re.checked=!!J.find(me=>me===re.value):re.checked=J===re.value||!!J)}):K.refs.forEach(re=>re.checked=re.value===J):OT(K.ref)?K.ref.value="":(K.ref.value=J,K.ref.type||f.state.next({name:N,values:Mt(i)})))}(H.shouldDirty||H.shouldTouch)&&O(N,J,H.shouldTouch,H.shouldDirty,!0),H.shouldValidate&&ce(N)},te=(N,$,H)=>{for(const Z in $){if(!$.hasOwnProperty(Z))return;const J=$[Z],K=N+"."+Z,re=le(n,K);(a.array.has(N)||mt(J)||re&&!re._f)&&!$o(J)?te(K,J,H):B(K,J,H)}},ue=(N,$,H={})=>{const Z=le(n,N),J=a.array.has(N),K=Mt($);ze(i,N,K),J?(f.array.next({name:N,values:Mt(i)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&H.shouldDirty&&f.state.next({name:N,dirtyFields:Uc(s,i),isDirty:R(N,K)})):Z&&!Z._f&&!pr(K)?te(N,K,H):B(N,K,H),pA(N,a)&&f.state.next({...t,name:N}),f.state.next({name:o.mount?N:void 0,values:Mt(i)})},ge=async N=>{o.mount=!0;const $=N.target;let H=$.name,Z=!0;const J=le(n,H),K=Pe=>{Z=Number.isNaN(Pe)||$o(Pe)&&isNaN(Pe.getTime())||ki(Pe,le(i,H,Pe))},re=dA(e.mode),me=dA(e.reValidateMode);if(J){let Pe,ur;const go=$.type?hA(J._f):OY(N),Hn=N.type===oA.BLUR||N.type===oA.FOCUS_OUT,mo=!HY(J._f)&&!e.resolver&&!le(t.errors,H)&&!J._f.deps||YY(Hn,le(t.touchedFields,H),t.isSubmitted,me,re),Aa=pA(H,a,Hn);ze(i,H,go),Hn?(!$||!$.readOnly)&&(J._f.onBlur&&J._f.onBlur(N),l&&l(0)):J._f.onChange&&J._f.onChange(N);const ka=O(H,go,Hn),gc=!Cr(ka)||Aa;if(!Hn&&f.state.next({name:H,type:N.type,values:Mt(i)}),mo)return(u.isValid||d.isValid)&&(e.mode==="onBlur"?Hn&&v():Hn||v()),gc&&f.state.next({name:H,...Aa?{}:ka});if(!Hn&&Aa&&f.state.next({...t}),e.resolver){const{errors:Hh}=await x([H]);if(K(go),Z){const sy=gA(t.errors,n,H),Ia=gA(Hh,n,sy.name||H);Pe=Ia.error,H=Ia.name,ur=Cr(Hh)}}else T([H],!0),Pe=(await yA(J,a.disabled,i,p,e.shouldUseNativeValidation))[H],T([H]),K(go),Z&&(Pe?ur=!1:(u.isValid||d.isValid)&&(ur=await A(n,!0)));Z&&(J._f.deps&&ce(J._f.deps),M(H,ur,Pe,ka))}},Y=(N,$)=>{if(le(t.errors,$)&&N.focus)return N.focus(),1},ce=async(N,$={})=>{let H,Z;const J=xu(N);if(e.resolver){const K=await E(St(N)?N:J);H=Cr(K),Z=N?!J.some(re=>le(K,re)):H}else N?(Z=(await Promise.all(J.map(async K=>{const re=le(n,K);return await A(re&&re._f?{[K]:re}:re)}))).every(Boolean),!(!Z&&!t.isValid)&&v()):Z=H=await A(n);return f.state.next({...!ss(N)||(u.isValid||d.isValid)&&H!==t.isValid?{}:{name:N},...e.resolver||!N?{isValid:H}:{},errors:t.errors}),$.shouldFocus&&!Z&&bu(n,Y,N?J:a.mount),Z},he=N=>{const $={...o.mount?i:s};return St(N)?$:ss(N)?le($,N):N.map(H=>le($,H))},Ie=(N,$)=>({invalid:!!le(($||t).errors,N),isDirty:!!le(($||t).dirtyFields,N),error:le(($||t).errors,N),isValidating:!!le(t.validatingFields,N),isTouched:!!le(($||t).touchedFields,N)}),xe=N=>{N&&xu(N).forEach($=>_t(t.errors,$)),f.state.next({errors:N?t.errors:{}})},De=(N,$,H)=>{const Z=(le(n,N,{_f:{}})._f||{}).ref,J=le(t.errors,N)||{},{ref:K,message:re,type:me,...Pe}=J;ze(t.errors,N,{...Pe,...$,ref:Z}),f.state.next({name:N,errors:t.errors,isValid:!1}),H&&H.shouldFocus&&Z&&Z.focus&&Z.focus()},vt=(N,$)=>On(N)?f.state.subscribe({next:H=>"values"in H&&N(_(void 0,$),H)}):_(N,$,!0),jt=N=>f.state.subscribe({next:$=>{qY(N.name,$.name,N.exact)&&GY($,N.formState||u,ny,N.reRenderRoot)&&N.callback({values:{...i},...t,...$,defaultValues:s})}}).unsubscribe,At=N=>(o.mount=!0,d={...d,...N.formState},jt({...N,formState:d})),kt=(N,$={})=>{for(const H of N?xu(N):a.mount)a.mount.delete(H),a.array.delete(H),$.keepValue||(_t(n,H),_t(i,H)),!$.keepError&&_t(t.errors,H),!$.keepDirty&&_t(t.dirtyFields,H),!$.keepTouched&&_t(t.touchedFields,H),!$.keepIsValidating&&_t(t.validatingFields,H),!e.shouldUnregister&&!$.keepDefaultValue&&_t(s,H);f.state.next({values:Mt(i)}),f.state.next({...t,...$.keepDirty?{isDirty:R()}:{}}),!$.keepIsValid&&v()},Ta=({disabled:N,name:$})=>{(Kn(N)&&o.mount||N||a.disabled.has($))&&(N?a.disabled.add($):a.disabled.delete($))},Ts=(N,$={})=>{let H=le(n,N);const Z=Kn($.disabled)||Kn(e.disabled);return ze(n,N,{...H||{},_f:{...H&&H._f?H._f:{ref:{name:N}},name:N,mount:!0,...$}}),a.mount.add(N),H?Ta({disabled:Kn($.disabled)?$.disabled:e.disabled,name:N}):k(N,!0,$.value),{...Z?{disabled:$.disabled||e.disabled}:{},...e.progressive?{required:!!$.required,min:Bc($.min),max:Bc($.max),minLength:Bc($.minLength),maxLength:Bc($.maxLength),pattern:Bc($.pattern)}:{},name:N,onChange:ge,onBlur:ge,ref:J=>{if(J){Ts(N,$),H=le(n,N);const K=St(J.value)&&J.querySelectorAll&&J.querySelectorAll("input,select,textarea")[0]||J,re=$Y(K),me=H._f.refs||[];if(re?me.find(Pe=>Pe===K):K===H._f.ref)return;ze(n,N,{_f:{...H._f,...re?{refs:[...me.filter(Mv),K,...Array.isArray(le(s,N))?[{}]:[]],ref:{type:K.type,name:N}}:{ref:K}}}),k(N,!1,void 0,K)}else H=le(n,N,{}),H._f&&(H._f.mount=!1),(e.shouldUnregister||$.shouldUnregister)&&!(MY(a.array,N)&&o.action)&&a.unMount.add(N)}}},$t=()=>e.shouldFocusError&&bu(n,Y,a.mount),Ca=N=>{Kn(N)&&(f.state.next({disabled:N}),bu(n,($,H)=>{const Z=le(n,H);Z&&($.disabled=Z._f.disabled||N,Array.isArray(Z._f.refs)&&Z._f.refs.forEach(J=>{J.disabled=Z._f.disabled||N}))},0,!1))},Ea=(N,$)=>async H=>{let Z;H&&(H.preventDefault&&H.preventDefault(),H.persist&&H.persist());let J=Mt(i);if(f.state.next({isSubmitting:!0}),e.resolver){const{errors:K,values:re}=await x();t.errors=K,J=Mt(re)}else await A(n);if(a.disabled.size)for(const K of a.disabled)_t(J,K);if(_t(t.errors,"root"),Cr(t.errors)){f.state.next({errors:{}});try{await N(J,H)}catch(K){Z=K}}else $&&await $({...t.errors},H),$t(),setTimeout($t);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Cr(t.errors)&&!Z,submitCount:t.submitCount+1,errors:t.errors}),Z)throw Z},fc=(N,$={})=>{le(n,N)&&(St($.defaultValue)?ue(N,Mt(le(s,N))):(ue(N,$.defaultValue),ze(s,N,Mt($.defaultValue))),$.keepTouched||_t(t.touchedFields,N),$.keepDirty||(_t(t.dirtyFields,N),t.isDirty=$.defaultValue?R(N,Mt(le(s,N))):R()),$.keepError||(_t(t.errors,N),u.isValid&&v()),f.state.next({...t}))},xa=(N,$={})=>{const H=N?Mt(N):s,Z=Mt(H),J=Cr(N),K=J?s:Z;if($.keepDefaultValues||(s=H),!$.keepValues){if($.keepDirtyValues){const re=new Set([...a.mount,...Object.keys(Uc(s,i))]);for(const me of Array.from(re))le(t.dirtyFields,me)?ze(K,me,le(i,me)):ue(me,le(K,me))}else{if(IT&&St(N))for(const re of a.mount){const me=le(n,re);if(me&&me._f){const Pe=Array.isArray(me._f.refs)?me._f.refs[0]:me._f.ref;if(og(Pe)){const ur=Pe.closest("form");if(ur){ur.reset();break}}}}if($.keepFieldsRef)for(const re of a.mount)ue(re,le(K,re));else n={}}i=e.shouldUnregister?$.keepDefaultValues?Mt(s):{}:Mt(K),f.array.next({values:{...K}}),f.state.next({values:{...K}})}a={mount:$.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!$.keepIsValid||!!$.keepDirtyValues,o.watch=!!e.shouldUnregister,f.state.next({submitCount:$.keepSubmitCount?t.submitCount:0,isDirty:J?!1:$.keepDirty?t.isDirty:!!($.keepDefaultValues&&!ki(N,s)),isSubmitted:$.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:J?{}:$.keepDirtyValues?$.keepDefaultValues&&i?Uc(s,i):t.dirtyFields:$.keepDefaultValues&&N?Uc(s,N):$.keepDirty?t.dirtyFields:{},touchedFields:$.keepTouched?t.touchedFields:{},errors:$.keepErrors?t.errors:{},isSubmitSuccessful:$.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},ba=(N,$)=>xa(On(N)?N(i):N,$),Wh=(N,$={})=>{const H=le(n,N),Z=H&&H._f;if(Z){const J=Z.refs?Z.refs[0]:Z.ref;J.focus&&(J.focus(),$.shouldSelect&&On(J.select)&&J.select())}},ny=N=>{t={...t,...N}},pc={control:{register:Ts,unregister:kt,getFieldState:Ie,handleSubmit:Ea,setError:De,_subscribe:jt,_runSchema:x,_focusError:$t,_getWatch:_,_getDirty:R,_setValid:v,_setFieldArray:w,_setDisabledField:Ta,_setErrors:C,_getFieldArray:b,_reset:xa,_resetDefaultValues:()=>On(e.defaultValues)&&e.defaultValues().then(N=>{ba(N,e.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:P,_disableForm:Ca,_subjects:f,_proxyFormState:u,get _fields(){return n},get _formValues(){return i},get _state(){return o},set _state(N){o=N},get _defaultValues(){return s},get _names(){return a},set _names(N){a=N},get _formState(){return t},get _options(){return e},set _options(N){e={...e,...N}}},subscribe:At,trigger:ce,register:Ts,handleSubmit:Ea,watch:vt,setValue:ue,getValues:he,reset:ba,resetField:fc,clearErrors:xe,unregister:kt,setError:De,setFocus:Wh,getFieldState:Ie};return{...pc,formControl:pc}}function vA(r={}){const e=nr.useRef(void 0),t=nr.useRef(void 0),[n,s]=nr.useState({isDirty:!1,isValidating:!1,isLoading:On(r.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1,isReady:!1,defaultValues:On(r.defaultValues)?void 0:r.defaultValues});if(!e.current)if(r.formControl)e.current={...r.formControl,formState:n},r.defaultValues&&!On(r.defaultValues)&&r.formControl.reset(r.defaultValues,r.resetOptions);else{const{formControl:o,...a}=JY(r);e.current={...a,formState:n}}const i=e.current.control;return i._options=r,VY(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>s({...i._formState}),reRenderRoot:!0});return s(a=>({...a,isReady:!0})),i._formState.isReady=!0,o},[i]),nr.useEffect(()=>i._disableForm(r.disabled),[i,r.disabled]),nr.useEffect(()=>{r.mode&&(i._options.mode=r.mode),r.reValidateMode&&(i._options.reValidateMode=r.reValidateMode)},[i,r.mode,r.reValidateMode]),nr.useEffect(()=>{r.errors&&(i._setErrors(r.errors),i._focusError())},[i,r.errors]),nr.useEffect(()=>{r.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,r.shouldUnregister]),nr.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==n.isDirty&&i._subjects.state.next({isDirty:o})}},[i,n.isDirty]),nr.useEffect(()=>{r.values&&!ki(r.values,t.current)?(i._reset(r.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=r.values,s(o=>({...o}))):i._resetDefaultValues()},[i,r.values]),nr.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=LY(n,i),e.current}const _A=(r,e,t)=>{if(r&&"reportValidity"in r){const n=le(t,e);r.setCustomValidity(n&&n.message||""),r.reportValidity()}},EM=(r,e)=>{for(const t in e.fields){const n=e.fields[t];n&&n.ref&&"reportValidity"in n.ref?_A(n.ref,t,r):n&&n.refs&&n.refs.forEach(s=>_A(s,t,r))}},ZY=(r,e)=>{e.shouldUseNativeValidation&&EM(r,e);const t={};for(const n in r){const s=le(e.fields,n),i=Object.assign(r[n]||{},{ref:s&&s.ref});if(eX(e.names||Object.keys(r),n)){const o=Object.assign({},le(t,n));ze(o,"root",i),ze(t,n,o)}else ze(t,n,i)}return t},eX=(r,e)=>{const t=wA(e);return r.some(n=>wA(n).match(`^${t}\\.\\d+`))};function wA(r){return r.replace(/\]|\[/g,"")}function SA(r,e,t){return t===void 0&&(t={}),function(n,s,i){try{return Promise.resolve(function(o,a){try{var l=(e!=null&&e.context,Promise.resolve(r[t.mode==="sync"?"validateSync":"validate"](n,Object.assign({abortEarly:!1},e,{context:s}))).then(function(c){return i.shouldUseNativeValidation&&EM({},i),{values:t.raw?Object.assign({},n):c,errors:{}}}))}catch(c){return a(c)}return l&&l.then?l.then(void 0,a):l}(0,function(o){if(!o.inner)throw o;return{values:{},errors:ZY((a=o,l=!i.shouldUseNativeValidation&&i.criteriaMode==="all",(a.inner||[]).reduce(function(c,u){if(c[u.path]||(c[u.path]={message:u.message,type:u.type}),l){var d=c[u.path].types,f=d&&d[u.type];c[u.path]=yM(u.path,l,c,u.type,f?[].concat(f,u.message):u.message)}return c},{})),i)};var a,l}))}catch(o){return Promise.reject(o)}}}function Sa(r){this._maxSize=r,this.clear()}Sa.prototype.clear=function(){this._size=0,this._values=Object.create(null)};Sa.prototype.get=function(r){return this._values[r]};Sa.prototype.set=function(r,e){return this._size>=this._maxSize&&this.clear(),r in this._values||this._size++,this._values[r]=e};var tX=/[^.^\]^[]+|(?=\[\]|\.\.)/g,xM=/^\d+$/,rX=/^\d/,nX=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,sX=/^\s*(['"]?)(.*?)(\1)\s*$/,MT=512,TA=new Sa(MT),CA=new Sa(MT),EA=new Sa(MT),Go={Cache:Sa,split:V_,normalizePath:Nv,setter:function(r){var e=Nv(r);return CA.get(r)||CA.set(r,function(n,s){for(var i=0,o=e.length,a=n;i<o-1;){var l=e[i];if(l==="__proto__"||l==="constructor"||l==="prototype")return n;a=a[e[i++]]}a[e[i]]=s})},getter:function(r,e){var t=Nv(r);return EA.get(r)||EA.set(r,function(s){for(var i=0,o=t.length;i<o;)if(s!=null||!e)s=s[t[i++]];else return;return s})},join:function(r){return r.reduce(function(e,t){return e+(NT(t)||xM.test(t)?"["+t+"]":(e?".":"")+t)},"")},forEach:function(r,e,t){iX(Array.isArray(r)?r:V_(r),e,t)}};function Nv(r){return TA.get(r)||TA.set(r,V_(r).map(function(e){return e.replace(sX,"$2")}))}function V_(r){return r.match(tX)||[""]}function iX(r,e,t){var n=r.length,s,i,o,a;for(i=0;i<n;i++)s=r[i],s&&(lX(s)&&(s='"'+s+'"'),a=NT(s),o=!a&&/^\d+$/.test(s),e.call(t,s,a,o,i,r))}function NT(r){return typeof r=="string"&&r&&["'",'"'].indexOf(r.charAt(0))!==-1}function oX(r){return r.match(rX)&&!r.match(xM)}function aX(r){return nX.test(r)}function lX(r){return!NT(r)&&(oX(r)||aX(r))}const cX=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['’](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['’](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['’](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,ty=r=>r.match(cX)||[],ry=r=>r[0].toUpperCase()+r.slice(1),FT=(r,e)=>ty(r).join(e).toLowerCase(),bM=r=>ty(r).reduce((e,t)=>`${e}${e?t[0].toUpperCase()+t.slice(1).toLowerCase():t.toLowerCase()}`,""),uX=r=>ry(bM(r)),hX=r=>FT(r,"_"),dX=r=>FT(r,"-"),fX=r=>ry(FT(r," ")),pX=r=>ty(r).map(ry).join(" ");var Fv={words:ty,upperFirst:ry,camelCase:bM,pascalCase:uX,snakeCase:hX,kebabCase:dX,sentenceCase:fX,titleCase:pX},LT={exports:{}};LT.exports=function(r){return AM(gX(r),r)};LT.exports.array=AM;function AM(r,e){var t=r.length,n=new Array(t),s={},i=t,o=mX(e),a=yX(r);for(e.forEach(function(c){if(!a.has(c[0])||!a.has(c[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});i--;)s[i]||l(r[i],i,new Set);return n;function l(c,u,d){if(d.has(c)){var f;try{f=", node was:"+JSON.stringify(c)}catch{f=""}throw new Error("Cyclic dependency"+f)}if(!a.has(c))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(c));if(!s[u]){s[u]=!0;var p=o.get(c)||new Set;if(p=Array.from(p),u=p.length){d.add(c);do{var m=p[--u];l(m,a.get(m),d)}while(u);d.delete(c)}n[--t]=c}}}function gX(r){for(var e=new Set,t=0,n=r.length;t<n;t++){var s=r[t];e.add(s[0]),e.add(s[1])}return Array.from(e)}function mX(r){for(var e=new Map,t=0,n=r.length;t<n;t++){var s=r[t];e.has(s[0])||e.set(s[0],new Set),e.has(s[1])||e.set(s[1],new Set),e.get(s[0]).add(s[1])}return e}function yX(r){for(var e=new Map,t=0,n=r.length;t<n;t++)e.set(r[t],t);return e}var vX=LT.exports;const _X=PA(vX),wX=Object.prototype.toString,SX=Error.prototype.toString,TX=RegExp.prototype.toString,CX=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",EX=/^Symbol\((.*)\)(.*)$/;function xX(r){return r!=+r?"NaN":r===0&&1/r<0?"-0":""+r}function xA(r,e=!1){if(r==null||r===!0||r===!1)return""+r;const t=typeof r;if(t==="number")return xX(r);if(t==="string")return e?`"${r}"`:r;if(t==="function")return"[Function "+(r.name||"anonymous")+"]";if(t==="symbol")return CX.call(r).replace(EX,"Symbol($1)");const n=wX.call(r).slice(8,-1);return n==="Date"?isNaN(r.getTime())?""+r:r.toISOString(r):n==="Error"||r instanceof Error?"["+SX.call(r)+"]":n==="RegExp"?TX.call(r):null}function Wi(r,e){let t=xA(r,e);return t!==null?t:JSON.stringify(r,function(n,s){let i=xA(this[n],e);return i!==null?i:s},2)}function kM(r){return r==null?[]:[].concat(r)}let IM,PM,RM,bX=/\$\{\s*(\w+)\s*\}/g;IM=Symbol.toStringTag;class bA{constructor(e,t,n,s){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[IM]="Error",this.name="ValidationError",this.value=t,this.path=n,this.type=s,this.errors=[],this.inner=[],kM(e).forEach(i=>{if(gr.isError(i)){this.errors.push(...i.errors);const o=i.inner.length?i.inner:[i];this.inner.push(...o)}else this.errors.push(i)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}PM=Symbol.hasInstance;RM=Symbol.toStringTag;class gr extends Error{static formatError(e,t){const n=t.label||t.path||"this";return t=Object.assign({},t,{path:n,originalPath:t.path}),typeof e=="string"?e.replace(bX,(s,i)=>Wi(t[i])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,n,s,i){const o=new bA(e,t,n,s);if(i)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[RM]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,gr)}static[PM](e){return bA[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let Qn={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:r,type:e,value:t,originalValue:n})=>{const s=n!=null&&n!==t?` (cast from the value \`${Wi(n,!0)}\`).`:".";return e!=="mixed"?`${r} must be a \`${e}\` type, but the final value was: \`${Wi(t,!0)}\``+s:`${r} must match the configured type. The validated value was: \`${Wi(t,!0)}\``+s}},Tr={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},AX={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},j_={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},kX={isValue:"${path} field must be ${value}"},Kf={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},IX={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},PX={notType:r=>{const{path:e,value:t,spec:n}=r,s=n.types.length;if(Array.isArray(t)){if(t.length<s)return`${e} tuple value has too few items, expected a length of ${s} but got ${t.length} for value: \`${Wi(t,!0)}\``;if(t.length>s)return`${e} tuple value has too many items, expected a length of ${s} but got ${t.length} for value: \`${Wi(t,!0)}\``}return gr.formatError(Qn.notType,r)}};Object.assign(Object.create(null),{mixed:Qn,string:Tr,number:AX,date:j_,object:Kf,array:IX,boolean:kX,tuple:PX});const VT=r=>r&&r.__isYupSchema__;class cg{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:n,then:s,otherwise:i}=t,o=typeof n=="function"?n:(...a)=>a.every(l=>l===n);return new cg(e,(a,l)=>{var c;let u=o(...a)?s:i;return(c=u==null?void 0:u(l))!=null?c:l})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let n=this.refs.map(i=>i.getValue(t==null?void 0:t.value,t==null?void 0:t.parent,t==null?void 0:t.context)),s=this.fn(n,e,t);if(s===void 0||s===e)return e;if(!VT(s))throw new TypeError("conditions must return a schema object");return s.resolve(t)}}const uf={context:"$",value:"."};function RX(r,e){return new po(r,e)}class po{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===uf.context,this.isValue=this.key[0]===uf.value,this.isSibling=!this.isContext&&!this.isValue;let n=this.isContext?uf.context:this.isValue?uf.value:"";this.path=this.key.slice(n.length),this.getter=this.path&&Go.getter(this.path,!0),this.map=t.map}getValue(e,t,n){let s=this.isContext?n:this.isValue?e:t;return this.getter&&(s=this.getter(s||{})),this.map&&(s=this.map(s)),s}cast(e,t){return this.getValue(e,t==null?void 0:t.parent,t==null?void 0:t.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}po.prototype.__isYupRef=!0;const Uo=r=>r==null;function za(r){function e({value:t,path:n="",options:s,originalValue:i,schema:o},a,l){const{name:c,test:u,params:d,message:f,skipAbsent:p}=r;let{parent:m,context:v,abortEarly:T=o.spec.abortEarly,disableStackTrace:w=o.spec.disableStackTrace}=s;const y={value:t,parent:m,context:v};function C(R={}){const _=OM(Object.assign({value:t,originalValue:i,label:o.spec.label,path:R.path||n,spec:o.spec,disableStackTrace:R.disableStackTrace||w},d,R.params),y),b=new gr(gr.formatError(R.message||f,_),t,_.path,R.type||c,_.disableStackTrace);return b.params=_,b}const k=T?a:l;let O={path:n,parent:m,type:c,from:s.from,createError:C,resolve(R){return DM(R,y)},options:s,originalValue:i,schema:o};const M=R=>{gr.isError(R)?k(R):R?l(null):k(C())},x=R=>{gr.isError(R)?k(R):a(R)};if(p&&Uo(t))return M(!0);let A;try{var P;if(A=u.call(O,t,O),typeof((P=A)==null?void 0:P.then)=="function"){if(s.sync)throw new Error(`Validation test of type: "${O.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(A).then(M,x)}}catch(R){x(R);return}M(A)}return e.OPTIONS=r,e}function OM(r,e){if(!r)return r;for(const t of Object.keys(r))r[t]=DM(r[t],e);return r}function DM(r,e){return po.isRef(r)?r.getValue(e.value,e.parent,e.context):r}function OX(r,e,t,n=t){let s,i,o;return e?(Go.forEach(e,(a,l,c)=>{let u=l?a.slice(1,a.length-1):a;r=r.resolve({context:n,parent:s,value:t});let d=r.type==="tuple",f=c?parseInt(u,10):0;if(r.innerType||d){if(d&&!c)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&f>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${a}, in the path: ${e}. because there is no value at that index. `);s=t,t=t&&t[f],r=d?r.spec.types[f]:r.innerType}if(!c){if(!r.fields||!r.fields[u])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${r.type}")`);s=t,t=t&&t[u],r=r.fields[u]}i=u,o=l?"["+a+"]":"."+a}),{schema:r,parent:s,parentPath:i}):{parent:s,parentPath:e,schema:r}}class ug extends Set{describe(){const e=[];for(const t of this.values())e.push(po.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const n of this.values())t.push(e(n));return t}clone(){return new ug(this.values())}merge(e,t){const n=this.clone();return e.forEach(s=>n.add(s)),t.forEach(s=>n.delete(s)),n}}function hl(r,e=new Map){if(VT(r)||!r||typeof r!="object")return r;if(e.has(r))return e.get(r);let t;if(r instanceof Date)t=new Date(r.getTime()),e.set(r,t);else if(r instanceof RegExp)t=new RegExp(r),e.set(r,t);else if(Array.isArray(r)){t=new Array(r.length),e.set(r,t);for(let n=0;n<r.length;n++)t[n]=hl(r[n],e)}else if(r instanceof Map){t=new Map,e.set(r,t);for(const[n,s]of r.entries())t.set(n,hl(s,e))}else if(r instanceof Set){t=new Set,e.set(r,t);for(const n of r)t.add(hl(n,e))}else if(r instanceof Object){t={},e.set(r,t);for(const[n,s]of Object.entries(r))t[n]=hl(s,e)}else throw Error(`Unable to clone ${r}`);return t}function DX(r){if(!(r!=null&&r.length))return;const e=[];let t="",n=!1,s=!1;for(let i=0;i<r.length;i++){const o=r[i];if(o==="["&&!s){t&&(e.push(...t.split(".").filter(Boolean)),t=""),n=!0;continue}if(o==="]"&&!s){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),n=!1;continue}if(o==='"'){s=!s;continue}if(o==="."&&!n&&!s){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function MX(r,e){const t=e?`${e}.${r.path}`:r.path;return r.errors.map(n=>({message:n,path:DX(t)}))}function MM(r,e){var t;if(!((t=r.inner)!=null&&t.length)&&r.errors.length)return MX(r,e);const n=e?`${e}.${r.path}`:r.path;return r.inner.flatMap(s=>MM(s,n))}class vs{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new ug,this._blacklist=new ug,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(Qn.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e==null?void 0:e.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=hl(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let n=e(this);return this._mutate=t,n}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,n=e.clone();const s=Object.assign({},t.spec,n.spec);return n.spec=s,n.internalTests=Object.assign({},t.internalTests,n.internalTests),n._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),n._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),n.tests=t.tests,n.exclusiveTests=t.exclusiveTests,n.withMutation(i=>{e.tests.forEach(o=>{i.test(o.OPTIONS)})}),n.transforms=[...t.transforms,...n.transforms],n}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let n=t.conditions;t=t.clone(),t.conditions=[],t=n.reduce((s,i)=>i.resolve(s,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,n,s,i;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(n=e.abortEarly)!=null?n:this.spec.abortEarly,recursive:(s=e.recursive)!=null?s:this.spec.recursive,disableStackTrace:(i=e.disableStackTrace)!=null?i:this.spec.disableStackTrace})}cast(e,t={}){let n=this.resolve(Object.assign({value:e},t)),s=t.assert==="ignore-optionality",i=n._cast(e,t);if(t.assert!==!1&&!n.isType(i)){if(s&&Uo(i))return i;let o=Wi(e),a=Wi(i);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${n.type}". 

attempted value: ${o} 
`+(a!==o?`result of cast: ${a}`:""))}return i}_cast(e,t){let n=e===void 0?e:this.transforms.reduce((s,i)=>i.call(this,s,e,this),e);return n===void 0&&(n=this.getDefault(t)),n}_validate(e,t={},n,s){let{path:i,originalValue:o=e,strict:a=this.spec.strict}=t,l=e;a||(l=this._cast(l,Object.assign({assert:!1},t)));let c=[];for(let u of Object.values(this.internalTests))u&&c.push(u);this.runTests({path:i,value:l,originalValue:o,options:t,tests:c},n,u=>{if(u.length)return s(u,l);this.runTests({path:i,value:l,originalValue:o,options:t,tests:this.tests},n,s)})}runTests(e,t,n){let s=!1,{tests:i,value:o,originalValue:a,path:l,options:c}=e,u=v=>{s||(s=!0,t(v,o))},d=v=>{s||(s=!0,n(v,o))},f=i.length,p=[];if(!f)return d([]);let m={value:o,originalValue:a,path:l,options:c,schema:this};for(let v=0;v<i.length;v++){const T=i[v];T(m,u,function(y){y&&(Array.isArray(y)?p.push(...y):p.push(y)),--f<=0&&d(p)})}}asNestedTest({key:e,index:t,parent:n,parentPath:s,originalParent:i,options:o}){const a=e??t;if(a==null)throw TypeError("Must include `key` or `index` for nested validations");const l=typeof a=="number";let c=n[a];const u=Object.assign({},o,{strict:!0,parent:n,value:c,originalValue:i[a],key:void 0,[l?"index":"key"]:a,path:l||a.includes(".")?`${s||""}[${l?a:`"${a}"`}]`:(s?`${s}.`:"")+e});return(d,f,p)=>this.resolve(u)._validate(c,u,f,p)}validate(e,t){var n;let s=this.resolve(Object.assign({},t,{value:e})),i=(n=t==null?void 0:t.disableStackTrace)!=null?n:s.spec.disableStackTrace;return new Promise((o,a)=>s._validate(e,t,(l,c)=>{gr.isError(l)&&(l.value=c),a(l)},(l,c)=>{l.length?a(new gr(l,c,void 0,void 0,i)):o(c)}))}validateSync(e,t){var n;let s=this.resolve(Object.assign({},t,{value:e})),i,o=(n=t==null?void 0:t.disableStackTrace)!=null?n:s.spec.disableStackTrace;return s._validate(e,Object.assign({},t,{sync:!0}),(a,l)=>{throw gr.isError(a)&&(a.value=l),a},(a,l)=>{if(a.length)throw new gr(a,e,void 0,void 0,o);i=l}),i}isValid(e,t){return this.validate(e,t).then(()=>!0,n=>{if(gr.isError(n))return!1;throw n})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(n){if(gr.isError(n))return!1;throw n}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):hl(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const n=this.clone({nullable:e});return n.internalTests.nullable=za({message:t,name:"nullable",test(s){return s===null?this.schema.spec.nullable:!0}}),n}optionality(e,t){const n=this.clone({optional:e});return n.internalTests.optionality=za({message:t,name:"optionality",test(s){return s===void 0?this.schema.spec.optional:!0}}),n}optional(){return this.optionality(!0)}defined(e=Qn.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=Qn.notNull){return this.nullability(!1,e)}required(e=Qn.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=Qn.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let n=this.clone(),s=za(t),i=t.exclusive||t.name&&n.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(n.exclusiveTests[t.name]=!!t.exclusive),n.tests=n.tests.filter(o=>!(o.OPTIONS.name===t.name&&(i||o.OPTIONS.test===s.OPTIONS.test))),n.tests.push(s),n}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let n=this.clone(),s=kM(e).map(i=>new po(i));return s.forEach(i=>{i.isSibling&&n.deps.push(i.key)}),n.conditions.push(typeof t=="function"?new cg(s,t):cg.fromOptions(s,t)),n}typeError(e){let t=this.clone();return t.internalTests.typeError=za({message:e,name:"typeError",skipAbsent:!0,test(n){return this.schema._typeCheck(n)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=Qn.oneOf){let n=this.clone();return e.forEach(s=>{n._whitelist.add(s),n._blacklist.delete(s)}),n.internalTests.whiteList=za({message:t,name:"oneOf",skipAbsent:!0,test(s){let i=this.schema._whitelist,o=i.resolveAll(this.resolve);return o.includes(s)?!0:this.createError({params:{values:Array.from(i).join(", "),resolved:o}})}}),n}notOneOf(e,t=Qn.notOneOf){let n=this.clone();return e.forEach(s=>{n._blacklist.add(s),n._whitelist.delete(s)}),n.internalTests.blacklist=za({message:t,name:"notOneOf",test(s){let i=this.schema._blacklist,o=i.resolveAll(this.resolve);return o.includes(s)?this.createError({params:{values:Array.from(i).join(", "),resolved:o}}):!0}}),n}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:n,meta:s,optional:i,nullable:o}=t.spec;return{meta:s,label:n,optional:i,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((l,c,u)=>u.findIndex(d=>d.OPTIONS.name===l.OPTIONS.name)===c).map(l=>{const c=l.OPTIONS.params&&e?OM(Object.assign({},l.OPTIONS.params),e):l.OPTIONS.params;return{name:l.OPTIONS.name,params:c}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(n){try{return{value:await e.validate(n,{abortEarly:!1})}}catch(s){if(s instanceof gr)return{issues:MM(s)};throw s}}}}}vs.prototype.__isYupSchema__=!0;for(const r of["validate","validateSync"])vs.prototype[`${r}At`]=function(e,t,n={}){const{parent:s,parentPath:i,schema:o}=OX(this,e,t,n.context);return o[r](s&&s[i],Object.assign({},n,{parent:s,path:e}))};for(const r of["equals","is"])vs.prototype[r]=vs.prototype.oneOf;for(const r of["not","nope"])vs.prototype[r]=vs.prototype.notOneOf;const NX=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function FX(r){const e=$_(r);if(!e)return Date.parse?Date.parse(r):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function $_(r){var e,t;const n=NX.exec(r);return n?{year:As(n[1]),month:As(n[2],1)-1,day:As(n[3],1),hour:As(n[4]),minute:As(n[5]),second:As(n[6]),millisecond:n[7]?As(n[7].substring(0,3)):0,precision:(e=(t=n[7])==null?void 0:t.length)!=null?e:void 0,z:n[8]||void 0,plusMinus:n[9]||void 0,hourOffset:As(n[10]),minuteOffset:As(n[11])}:null}function As(r,e=0){return Number(r)||e}let LX=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,VX=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,jX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,$X="^\\d{4}-\\d{2}-\\d{2}",UX="\\d{2}:\\d{2}:\\d{2}",BX="(([+-]\\d{2}(:?\\d{2})?)|Z)",zX=new RegExp(`${$X}T${UX}(\\.\\d+)?${BX}$`),WX=r=>Uo(r)||r===r.trim(),HX={}.toString();function Il(){return new NM}class NM extends vs{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t,n)=>{if(!n.spec.coerce||n.isType(e)||Array.isArray(e))return e;const s=e!=null&&e.toString?e.toString():e;return s===HX?e:s})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||Qn.required,name:"required",skipAbsent:!0,test:n=>!!n.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=Tr.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(n){return n.length===this.resolve(e)}})}min(e,t=Tr.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(n){return n.length>=this.resolve(e)}})}max(e,t=Tr.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(n){return n.length<=this.resolve(e)}})}matches(e,t){let n=!1,s,i;return t&&(typeof t=="object"?{excludeEmptyString:n=!1,message:s,name:i}=t:s=t),this.test({name:i||"matches",message:s||Tr.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&n||o.search(e)!==-1})}email(e=Tr.email){return this.matches(LX,{name:"email",message:e,excludeEmptyString:!0})}url(e=Tr.url){return this.matches(VX,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=Tr.uuid){return this.matches(jX,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",n,s;return e&&(typeof e=="object"?{message:t="",allowOffset:n=!1,precision:s=void 0}=e:t=e),this.matches(zX,{name:"datetime",message:t||Tr.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||Tr.datetime_offset,params:{allowOffset:n},skipAbsent:!0,test:i=>{if(!i||n)return!0;const o=$_(i);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||Tr.datetime_precision,params:{precision:s},skipAbsent:!0,test:i=>{if(!i||s==null)return!0;const o=$_(i);return o?o.precision===s:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=Tr.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:WX})}lowercase(e=Tr.lowercase){return this.transform(t=>Uo(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Uo(t)||t===t.toLowerCase()})}uppercase(e=Tr.uppercase){return this.transform(t=>Uo(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Uo(t)||t===t.toUpperCase()})}}Il.prototype=NM.prototype;let GX=new Date(""),qX=r=>Object.prototype.toString.call(r)==="[object Date]";class jT extends vs{constructor(){super({type:"date",check(e){return qX(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t,n)=>!n.spec.coerce||n.isType(e)||e===null?e:(e=FX(e),isNaN(e)?jT.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let n;if(po.isRef(e))n=e;else{let s=this.cast(e);if(!this._typeCheck(s))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);n=s}return n}min(e,t=j_.min){let n=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s>=this.resolve(n)}})}max(e,t=j_.max){let n=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(s){return s<=this.resolve(n)}})}}jT.INVALID_DATE=GX;function YX(r,e=[]){let t=[],n=new Set,s=new Set(e.map(([o,a])=>`${o}-${a}`));function i(o,a){let l=Go.split(o)[0];n.add(l),s.has(`${a}-${l}`)||t.push([a,l])}for(const o of Object.keys(r)){let a=r[o];n.add(o),po.isRef(a)&&a.isSibling?i(a.path,o):VT(a)&&"deps"in a&&a.deps.forEach(l=>i(l,o))}return _X.array(Array.from(n),t).reverse()}function AA(r,e){let t=1/0;return r.some((n,s)=>{var i;if((i=e.path)!=null&&i.includes(n))return t=s,!0}),t}function FM(r){return(e,t)=>AA(r,e)-AA(r,t)}const XX=(r,e,t)=>{if(typeof r!="string")return r;let n=r;try{n=JSON.parse(r)}catch{}return t.isType(n)?n:r};function Qf(r){if("fields"in r){const e={};for(const[t,n]of Object.entries(r.fields))e[t]=Qf(n);return r.setFields(e)}if(r.type==="array"){const e=r.optional();return e.innerType&&(e.innerType=Qf(e.innerType)),e}return r.type==="tuple"?r.optional().clone({types:r.spec.types.map(Qf)}):"optional"in r?r.optional():r}const KX=(r,e)=>{const t=[...Go.normalizePath(e)];if(t.length===1)return t[0]in r;let n=t.pop(),s=Go.getter(Go.join(t),!0)(r);return!!(s&&n in s)};let kA=r=>Object.prototype.toString.call(r)==="[object Object]";function IA(r,e){let t=Object.keys(r.fields);return Object.keys(e).filter(n=>t.indexOf(n)===-1)}const QX=FM([]);function $T(r){return new LM(r)}class LM extends vs{constructor(e){super({type:"object",check(t){return kA(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=QX,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var n;let s=super._cast(e,t);if(s===void 0)return this.getDefault(t);if(!this._typeCheck(s))return s;let i=this.fields,o=(n=t.stripUnknown)!=null?n:this.spec.noUnknown,a=[].concat(this._nodes,Object.keys(s).filter(d=>!this._nodes.includes(d))),l={},c=Object.assign({},t,{parent:l,__validating:t.__validating||!1}),u=!1;for(const d of a){let f=i[d],p=d in s;if(f){let m,v=s[d];c.path=(t.path?`${t.path}.`:"")+d,f=f.resolve({value:v,context:t.context,parent:l});let T=f instanceof vs?f.spec:void 0,w=T==null?void 0:T.strict;if(T!=null&&T.strip){u=u||d in s;continue}m=!t.__validating||!w?f.cast(s[d],c):s[d],m!==void 0&&(l[d]=m)}else p&&!o&&(l[d]=s[d]);(p!==d in l||l[d]!==s[d])&&(u=!0)}return u?l:s}_validate(e,t={},n,s){let{from:i=[],originalValue:o=e,recursive:a=this.spec.recursive}=t;t.from=[{schema:this,value:o},...i],t.__validating=!0,t.originalValue=o,super._validate(e,t,n,(l,c)=>{if(!a||!kA(c)){s(l,c);return}o=o||c;let u=[];for(let d of this._nodes){let f=this.fields[d];!f||po.isRef(f)||u.push(f.asNestedTest({options:t,key:d,parent:c,parentPath:t.path,originalParent:o}))}this.runTests({tests:u,value:c,originalValue:o,options:t},n,d=>{s(d.sort(this._sortErrors).concat(l),c)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),n=t.fields;for(let[s,i]of Object.entries(this.fields)){const o=n[s];n[s]=o===void 0?i:o}return t.withMutation(s=>s.setFields(n,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(n=>{var s;const i=this.fields[n];let o=e;(s=o)!=null&&s.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[n]})),t[n]=i&&"getDefault"in i?i.getDefault(o):void 0}),t}setFields(e,t){let n=this.clone();return n.fields=e,n._nodes=YX(e,t),n._sortErrors=FM(Object.keys(e)),t&&(n._excludedEdges=t),n}shape(e,t=[]){return this.clone().withMutation(n=>{let s=n._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),s=[...n._excludedEdges,...t]),n.setFields(Object.assign(n.fields,e),s)})}partial(){const e={};for(const[t,n]of Object.entries(this.fields))e[t]="optional"in n&&n.optional instanceof Function?n.optional():n;return this.setFields(e)}deepPartial(){return Qf(this)}pick(e){const t={};for(const n of e)this.fields[n]&&(t[n]=this.fields[n]);return this.setFields(t,this._excludedEdges.filter(([n,s])=>e.includes(n)&&e.includes(s)))}omit(e){const t=[];for(const n of Object.keys(this.fields))e.includes(n)||t.push(n);return this.pick(t)}from(e,t,n){let s=Go.getter(e,!0);return this.transform(i=>{if(!i)return i;let o=i;return KX(i,e)&&(o=Object.assign({},i),n||delete o[e],o[t]=s(i)),o})}json(){return this.transform(XX)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||Kf.exact,test(t){if(t==null)return!0;const n=IA(this.schema,t);return n.length===0||this.createError({params:{properties:n.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=Kf.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let n=this.test({name:"noUnknown",exclusive:!0,message:t,test(s){if(s==null)return!0;const i=IA(this.schema,s);return!e||i.length===0||this.createError({params:{unknown:i.join(", ")}})}});return n.spec.noUnknown=e,n}unknown(e=!0,t=Kf.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const n={};for(const s of Object.keys(t))n[e(s)]=t[s];return n})}camelCase(){return this.transformKeys(Fv.camelCase)}snakeCase(){return this.transformKeys(Fv.snakeCase)}constantCase(){return this.transformKeys(e=>Fv.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),n=super.describe(e);n.fields={};for(const[i,o]of Object.entries(t.fields)){var s;let a=e;(s=a)!=null&&s.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[i]})),n.fields[i]=o.describe(a)}return n}}$T.prototype=LM.prototype;const JX=$T().shape({email:Il().email("Enter valid email").required("Email is required").test("is-valid-email","Enter correct email",r=>r?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r):!1),password:Il().min(6,"There is minimum 6 symbols").required("Password is requires")}),ZX=$T().shape({email:Il().email("Input valid email").required("Email is required").test("is-valid-email","Enter correct email",r=>r?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r):!1),password:Il().min(8,"There is minimum 8 symbols").required("Password is required").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,"The password must contain at least one uppercase letter, one lowercase letter, one digit, and one special character."),confirmPassword:Il().oneOf([RX("password")],"Passwords must match").required("Password confirmation is required")}),eK=r=>{if(!r)return{strength:0,label:""};let e=0;r.length>=8&&e++,/[a-z]/.test(r)&&e++,/[A-Z]/.test(r)&&e++,/[0-9]/.test(r)&&e++,/[@$!%*?&]/.test(r)&&e++;let t="";return e<=2?t="weak":e<=4?t="medium":t="hard",{strength:e,label:t}},tK=({password:r})=>{const{strength:e,label:t}=eK(r);if(!r)return null;let n="";return e<=2?n="password-weak":e<=4?n="password-medium":n="password-strong",D.jsxs("span",{className:`password-strength ${n}`,children:["Password strength: ",t]})},rK=()=>{const r=kg(),{login:e,loginWithGoogle:t,register:n}=kT(),{isLoading:s,error:i,isAuthorized:o,isRegistering:a}=ys(b=>b.auth),l=wa(),[c,u]=L.useState(null),{register:d,handleSubmit:f,formState:{errors:p,isValid:m},reset:v,watch:T}=vA({resolver:SA(JX),mode:"onChange",reValidateMode:"onChange"}),{register:w,handleSubmit:y,formState:{errors:C,isValid:k},reset:O,watch:M}=vA({resolver:SA(ZX),mode:"onChange",reValidateMode:"onChange"}),x=T(),E=M();L.useEffect(()=>{o&&r("/")},[o,r]);const A=async b=>{if(!m)return;u(null);const B=await e(b.email,b.password);se(ie,"user_login",{email:b.email}),B.success||(u(B.error||"Auth error"),se(ie,"login_error",{message:B.error}))},P=async()=>{u(null),await t()},R=async b=>{if(!k)return;u(null);const B=await n(b.email,b.password);se(ie,"user_regiter",{email:b.email}),B.success||(u(B.error||"Register error"),se(ie,"register_error",{message:B.error}))},_=()=>{l(fY(!a)),v(),O(),u(null),se(ie,"switch_auth_mode")};return D.jsxs("div",{className:"auth-form-container",children:[a?D.jsx("h2",{className:"form-title",children:"Sign Up"}):D.jsx("h2",{className:"form-title",children:"Log In"}),(i||c)&&D.jsx("div",{className:"error-message",children:i||c}),D.jsxs("button",{type:"button",onClick:P,disabled:s,className:"google-button",children:[D.jsxs("svg",{className:"google-icon",viewBox:"0 0 24 24",children:[D.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),D.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),D.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),D.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),s?"...":"Authorize with Google"]}),D.jsx("div",{className:"divider"}),D.jsxs("form",{className:"auth-form",onSubmit:a?y(R):f(A),children:[D.jsxs("div",{className:"form-group",children:[D.jsx("label",{htmlFor:"email",children:"Email"}),D.jsx("input",{type:"email",id:"email",...a?w("email"):d("email"),className:a?C.email?"error":E.email?"valid":"":p.email?"error":x.email?"valid":""}),a?C.email&&D.jsx("span",{className:"field-error",children:C.email.message}):p.email&&D.jsx("span",{className:"field-error",children:p.email.message})]}),D.jsxs("div",{className:"form-group",children:[D.jsx("label",{htmlFor:"password",children:"Password"}),D.jsx("input",{type:"password",id:"password",...a?w("password"):d("password"),className:a?C.password?"error":E.password?"valid":"":p.password?"error":x.password?"valid":""}),a?C.password&&D.jsx("span",{className:"field-error",children:C.password.message}):p.password&&D.jsx("span",{className:"field-error",children:p.password.message})]}),a&&E.password&&D.jsx(tK,{password:E.password}),a&&D.jsxs("div",{className:"form-group",children:[D.jsx("label",{htmlFor:"confirmPassword",children:"Confirm Password"}),D.jsx("input",{type:"password",id:"confirmPassword",...w("confirmPassword"),className:C.confirmPassword?"error":E.confirmPassword?"valid":""}),C.confirmPassword&&D.jsx("span",{className:"field-error",children:C.confirmPassword.message})]}),D.jsx("button",{type:"submit",disabled:s||(a?!k:!m),className:"submit-button",children:a?s?"Signing Up...":"Sign Up":s?"Logging In...":"Log In"})]}),D.jsxs("p",{className:"switch-form",children:[a?"Already have an account?":"Don't have an account?"," ",D.jsx("button",{type:"button",onClick:_,className:"submit-button link",children:a?"Log In":"Sign Up"})]})]})},nK=({userId:r,displayName:e,photoURL:t,email:n})=>{const i=((o,a)=>o?o.split(" ").map(l=>l[0]).join("").toUpperCase().slice(0,2):a?a[0].toUpperCase():"U")(e,n);return D.jsx(Jo,{to:`/users/${r}`,className:"user-avatar-inline",children:t?D.jsx("img",{src:t,alt:e||"User",className:"user-avatar-image user-avatar-inline-img"}):D.jsx("div",{className:"user-avatar-initials user-avatar-inline-img",children:i})})},sK=({preset:r})=>{const e=ys(i=>i.auth.user),t=e&&e.uid===r.userId,n=async()=>{try{await ca.savePreset((e==null?void 0:e.uid)||"unknown",(e==null?void 0:e.displayName)||(e==null?void 0:e.email)||"Unknown User",{name:r.name,filters:r.filters},(e==null?void 0:e.photoURL)||"")}catch(i){se(ie,"save_preset_error",{message:i})}},s=nr.useMemo(()=>{if(!r.userName)return"";const i=r.userName.indexOf("@");return i>0?r.userName.slice(0,i):r.userName},[r.userName]);return D.jsxs("div",{className:"feed-card",children:[D.jsx("div",{className:"feed-image-container",children:D.jsx("img",{src:r.previewUrl,alt:r.name,className:"feed-image-save"})}),D.jsxs("div",{className:"feed-card-left",children:[D.jsxs("div",{className:"feed-user-info",children:[D.jsx(nK,{userId:r.userId,displayName:s,photoURL:r.userPhotoURL}),D.jsx("span",{className:"feed-author-name",children:s})]}),D.jsxs("div",{className:"feed-card-info",children:[D.jsx("h3",{className:"feed-preset-name",children:r.name}),!t&&D.jsx("button",{className:"feed-save-preset-btn",onClick:n,title:"Save preset to my account",children:"Save"})]})]})]})},VM=()=>D.jsx("div",{className:"loader-container",children:D.jsx("div",{className:"loader"})}),iK=({userId:r})=>{const[e,t]=L.useState([]),[n,s]=L.useState(!0),[i,o]=L.useState(null);return L.useEffect(()=>{(async()=>{try{s(!0);let l;r?l=await ca.getUserPresets(r):l=await ca.getPublicPresets(),t(l),se(ie,"fetch_presets",{userId:r||"public",count:l.length})}catch(l){o("Failed to load presets"),se(ie,"fetch_presets_error",{userId:r||"public",message:l.message})}finally{s(!1)}})()},[r]),n?D.jsx(VM,{}):i?D.jsx("div",{className:"error-message",children:i}):e.length===0?D.jsx("div",{className:"empty",children:D.jsx("p",{children:"No presets found"})}):D.jsxs("div",{className:"preset-feed",children:[D.jsx("h2",{className:"explore",children:"Explore"}),e.map(a=>D.jsx(sK,{preset:a},a.id))]})},oK=({preset:r})=>D.jsxs("div",{className:"preset-card",children:[D.jsx("div",{className:"preset-image-container",children:D.jsx("img",{src:r.previewUrl,alt:r.name,className:"preset-image"})}),D.jsx("h3",{className:"preset-name",children:r.name})]}),aK=({presets:r})=>D.jsx("div",{className:"preset-grid",children:r.map(e=>D.jsx(oK,{preset:e},e.id))}),lK=()=>{var d,f;const{uid:r}=VV(),e=ys(p=>p.auth.user),[t,n]=L.useState(null),[s,i]=L.useState([]),[o,a]=L.useState(!0),[l,c]=L.useState(null);if(L.useEffect(()=>{(async()=>{if(!r){c("User ID not provided"),a(!1);return}try{a(!0);const m=await nO(ah(bi,"users",r));if(m.exists()){const y=m.data();let C;y.createdAt&&typeof y.createdAt.toDate=="function"?C=y.createdAt.toDate():typeof y.createdAt=="string"?C=new Date(y.createdAt):C=new Date;const k={uid:m.id,...y,createdAt:C};n(k)}else{c("User not found"),a(!1);return}const v=g_(Mf(bi,"presets"),eO("userId","==",r),Nf("createdAt","desc")),T=await m_(v),w=[];T.forEach(y=>{const C=y.data();let k;C.createdAt&&typeof C.createdAt.toDate=="function"?k=C.createdAt.toDate():typeof C.createdAt=="string"?k=new Date(C.createdAt):k=new Date,w.push({id:y.id,...C,createdAt:k})}),i(w)}catch(m){c("Failed to load user data"),console.error("Error fetching user data:",m)}finally{a(!1)}})()},[r]),o)return D.jsx(VM,{});if(l)return D.jsx("div",{className:"error-message",children:l});if(!t)return D.jsx("div",{className:"error-message",children:"User not found"});const u=(e==null?void 0:e.uid)===r;return D.jsxs("div",{className:"user-profile",children:[D.jsxs("div",{className:"profile-header",children:[D.jsx("div",{className:"profile-avatar",children:t.photoURL?D.jsx("img",{src:t.photoURL,alt:t.displayName||"User",className:"avatar-image"}):D.jsx("div",{className:"avatar-placeholder",children:((d=t.displayName)==null?void 0:d[0])||((f=t.email)==null?void 0:f[0])||"U"})}),D.jsxs("div",{className:"profile-info",children:[D.jsx("h1",{className:"profile-name",children:t.displayName||t.email.split("@")[0]}),D.jsx("p",{className:"profile-email",children:t.email}),D.jsxs("p",{className:"profile-stats",children:[s.length," presets • Joined"," ",new Date(t.createdAt).toLocaleDateString()]})]})]}),D.jsxs("div",{className:"profile-content",children:[D.jsx("h2",{children:u?"My Presets":"User Presets"}),s.length>0?D.jsx(aK,{presets:s}):D.jsxs("div",{className:"empty-state",children:[D.jsx("p",{children:"No presets yet"}),u&&D.jsx(Jo,{to:"/",className:"create-preset-button",children:"Create Your First Preset"})]})]})]})},cK=()=>{const{isAuthorized:r}=ys(t=>t.auth),e=kg();return D.jsx("button",{className:`floating-home-btn ${!r&&"hidden"}`,title:"Go to Preset Feed",onClick:()=>e("/feed"),children:D.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[D.jsx("path",{d:"M3 9.5L12 4l9 5.5V20a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9.5z"}),D.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})})};function uK(){return D.jsxs("div",{className:"App",children:[D.jsx(wY,{}),D.jsxs(ZV,{children:[D.jsx(qc,{path:"/",element:D.jsx(RY,{})}),D.jsx(qc,{path:"/auth",element:D.jsx(rK,{})}),D.jsx(qc,{path:"/feed",element:D.jsx(iK,{})}),D.jsx(qc,{path:"/users/:uid",element:D.jsx(lK,{})})]}),D.jsx(cK,{})]})}const hK=async()=>{await O8(Ya,IO)};hK().then(()=>{zI(document.getElementById("root")).render(D.jsx(L.StrictMode,{children:D.jsx(Tj,{children:D.jsxs(rV,{store:yY,children:[D.jsx(U3,{}),D.jsx(uK,{})]})})}))});
